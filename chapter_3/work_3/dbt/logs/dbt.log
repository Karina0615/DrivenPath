[0m10:57:12.987510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cf2e5d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77d1743950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cf7d6630>]}


============================== 10:57:13.011851 | 392a45e0-8e1a-4e15-99b5-7edd68fd7e02 ==============================
[0m10:57:13.011851 [info ] [MainThread]: Running with dbt=1.8.0
[0m10:57:13.012705 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select tag:staging', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:57:13.287926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '392a45e0-8e1a-4e15-99b5-7edd68fd7e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfd50830>]}
[0m10:57:13.346908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '392a45e0-8e1a-4e15-99b5-7edd68fd7e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cf26a540>]}
[0m10:57:13.348119 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:57:13.437687 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m10:57:13.439449 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m10:57:13.440360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '392a45e0-8e1a-4e15-99b5-7edd68fd7e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfad1bb0>]}
[0m10:57:14.732081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '392a45e0-8e1a-4e15-99b5-7edd68fd7e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cd9605f0>]}
[0m10:57:14.852412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '392a45e0-8e1a-4e15-99b5-7edd68fd7e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cead2000>]}
[0m10:57:14.853073 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m10:57:14.853795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '392a45e0-8e1a-4e15-99b5-7edd68fd7e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77ceab39e0>]}
[0m10:57:14.855860 [info ] [MainThread]: 
[0m10:57:14.856822 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:57:14.862635 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m10:57:14.900158 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m10:57:14.901115 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m10:57:14.901966 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:57:14.907174 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.005 seconds
[0m10:57:14.909347 [debug] [ThreadPool]: On list_airflow: Close
[0m10:57:14.910549 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now create_airflow_lead_staging)
[0m10:57:14.911509 [debug] [ThreadPool]: Creating schema "database: "airflow"
schema: "lead_staging"
"
[0m10:57:14.917300 [debug] [ThreadPool]: Using postgres connection "create_airflow_lead_staging"
[0m10:57:14.918047 [debug] [ThreadPool]: On create_airflow_lead_staging: BEGIN
[0m10:57:14.918774 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:57:14.923100 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m10:57:14.923855 [debug] [ThreadPool]: Using postgres connection "create_airflow_lead_staging"
[0m10:57:14.924537 [debug] [ThreadPool]: On create_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "create_airflow_lead_staging"} */
create schema if not exists "lead_staging"
[0m10:57:14.925684 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m10:57:14.927111 [debug] [ThreadPool]: On create_airflow_lead_staging: COMMIT
[0m10:57:14.927730 [debug] [ThreadPool]: Using postgres connection "create_airflow_lead_staging"
[0m10:57:14.928338 [debug] [ThreadPool]: On create_airflow_lead_staging: COMMIT
[0m10:57:14.929535 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m10:57:14.930209 [debug] [ThreadPool]: On create_airflow_lead_staging: Close
[0m10:57:14.932525 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_airflow_lead_staging, now list_airflow_lead_trusted)
[0m10:57:14.939131 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m10:57:14.939911 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m10:57:14.940630 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:57:14.945035 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m10:57:14.945812 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m10:57:14.946478 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m10:57:14.954039 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m10:57:14.955716 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m10:57:14.956573 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m10:57:14.957581 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now list_airflow_lead_staging)
[0m10:57:14.960152 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m10:57:14.960821 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m10:57:14.961419 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:57:14.965394 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m10:57:14.966095 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m10:57:14.966712 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m10:57:14.970080 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m10:57:14.971759 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m10:57:14.972594 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m10:57:14.980067 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:14.980709 [debug] [MainThread]: On master: BEGIN
[0m10:57:14.981348 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:57:14.985340 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m10:57:14.985986 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:14.986658 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:57:14.990504 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m10:57:14.992301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '392a45e0-8e1a-4e15-99b5-7edd68fd7e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cdd14b60>]}
[0m10:57:14.993074 [debug] [MainThread]: On master: ROLLBACK
[0m10:57:14.993798 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:14.994406 [debug] [MainThread]: On master: BEGIN
[0m10:57:14.995264 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:57:14.995839 [debug] [MainThread]: On master: COMMIT
[0m10:57:14.996454 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:14.997060 [debug] [MainThread]: On master: COMMIT
[0m10:57:14.997889 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:57:14.998465 [debug] [MainThread]: On master: Close
[0m10:57:14.999285 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:57:14.999985 [info ] [MainThread]: 
[0m10:57:15.009914 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_adress
[0m10:57:15.010847 [info ] [Thread-1 (]: 1 of 5 START sql table model lead_staging.dim_address .......................... [RUN]
[0m10:57:15.011655 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now model.dbt_lead_data.staging_dim_adress)
[0m10:57:15.012335 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_adress
[0m10:57:15.070261 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_adress"
[0m10:57:15.074309 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_adress
[0m10:57:15.118220 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_adress"
[0m10:57:15.122160 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m10:57:15.122969 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: BEGIN
[0m10:57:15.123664 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:15.128235 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m10:57:15.129114 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m10:57:15.129910 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */

  
    

  create  table "airflow"."lead_staging"."dim_address__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        address,
        mac_address,
        ip_address
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:57:15.265051 [debug] [Thread-1 (]: SQL status: SELECT 100372 in 0.134 seconds
[0m10:57:15.272331 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m10:57:15.273192 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
alter table "airflow"."lead_staging"."dim_address__dbt_tmp" rename to "dim_address"
[0m10:57:15.274496 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:57:15.295017 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m10:57:15.295931 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m10:57:15.296762 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m10:57:15.298907 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:57:15.306138 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_address__dbt_backup"
[0m10:57:15.313057 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m10:57:15.313961 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
drop table if exists "airflow"."lead_staging"."dim_address__dbt_backup" cascade
[0m10:57:15.315077 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m10:57:15.318073 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: Close
[0m10:57:15.320199 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '392a45e0-8e1a-4e15-99b5-7edd68fd7e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cf7d6b10>]}
[0m10:57:15.321259 [info ] [Thread-1 (]: 1 of 5 OK created sql table model lead_staging.dim_address ..................... [[32mSELECT 100372[0m in 0.31s]
[0m10:57:15.322457 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_adress
[0m10:57:15.323349 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_date
[0m10:57:15.324226 [info ] [Thread-1 (]: 2 of 5 START sql table model lead_staging.dim_date ............................. [RUN]
[0m10:57:15.325201 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_adress, now model.dbt_lead_data.staging_dim_date)
[0m10:57:15.325932 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_date
[0m10:57:15.329759 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_date"
[0m10:57:15.331964 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_date
[0m10:57:15.336423 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_date"
[0m10:57:15.339054 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m10:57:15.339759 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: BEGIN
[0m10:57:15.340475 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:15.345135 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m10:57:15.346024 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m10:57:15.346721 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */

  
    

  create  table "airflow"."lead_staging"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        accessed_at
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:57:15.424029 [debug] [Thread-1 (]: SQL status: SELECT 100372 in 0.077 seconds
[0m10:57:15.427626 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m10:57:15.428356 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
alter table "airflow"."lead_staging"."dim_date__dbt_tmp" rename to "dim_date"
[0m10:57:15.429600 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:57:15.431896 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: COMMIT
[0m10:57:15.432584 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m10:57:15.433391 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: COMMIT
[0m10:57:15.440826 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m10:57:15.443834 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_date__dbt_backup"
[0m10:57:15.445107 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m10:57:15.445845 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
drop table if exists "airflow"."lead_staging"."dim_date__dbt_backup" cascade
[0m10:57:15.446900 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m10:57:15.448723 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: Close
[0m10:57:15.449649 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '392a45e0-8e1a-4e15-99b5-7edd68fd7e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cec167b0>]}
[0m10:57:15.450695 [info ] [Thread-1 (]: 2 of 5 OK created sql table model lead_staging.dim_date ........................ [[32mSELECT 100372[0m in 0.12s]
[0m10:57:15.451735 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_date
[0m10:57:15.452629 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_finance
[0m10:57:15.453484 [info ] [Thread-1 (]: 3 of 5 START sql table model lead_staging.dim_finance .......................... [RUN]
[0m10:57:15.454310 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_date, now model.dbt_lead_data.staging_dim_finance)
[0m10:57:15.454966 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_finance
[0m10:57:15.460002 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_finance"
[0m10:57:15.461890 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_finance
[0m10:57:15.465723 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_finance"
[0m10:57:15.467549 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m10:57:15.468260 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: BEGIN
[0m10:57:15.468966 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:15.473165 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m10:57:15.474172 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m10:57:15.475121 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */

  
    

  create  table "airflow"."lead_staging"."dim_finance__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        iban
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:57:15.576679 [debug] [Thread-1 (]: SQL status: SELECT 100372 in 0.101 seconds
[0m10:57:15.580739 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m10:57:15.581616 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
alter table "airflow"."lead_staging"."dim_finance__dbt_tmp" rename to "dim_finance"
[0m10:57:15.583011 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:57:15.585362 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: COMMIT
[0m10:57:15.586225 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m10:57:15.587086 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: COMMIT
[0m10:57:15.589244 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:57:15.592319 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_finance__dbt_backup"
[0m10:57:15.593497 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m10:57:15.594240 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
drop table if exists "airflow"."lead_staging"."dim_finance__dbt_backup" cascade
[0m10:57:15.595253 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m10:57:15.597185 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: Close
[0m10:57:15.598164 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '392a45e0-8e1a-4e15-99b5-7edd68fd7e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77ce9abda0>]}
[0m10:57:15.599145 [info ] [Thread-1 (]: 3 of 5 OK created sql table model lead_staging.dim_finance ..................... [[32mSELECT 100372[0m in 0.14s]
[0m10:57:15.600252 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_finance
[0m10:57:15.601180 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_person
[0m10:57:15.602217 [info ] [Thread-1 (]: 4 of 5 START sql table model lead_staging.dim_person ........................... [RUN]
[0m10:57:15.603153 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_finance, now model.dbt_lead_data.staging_dim_person)
[0m10:57:15.603907 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_person
[0m10:57:15.607480 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_person"
[0m10:57:15.609483 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_person
[0m10:57:15.613856 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_person"
[0m10:57:15.615978 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m10:57:15.616701 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: BEGIN
[0m10:57:15.617574 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:15.622509 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m10:57:15.623391 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m10:57:15.624139 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */

  
    

  create  table "airflow"."lead_staging"."dim_person__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        person_name,
        user_name,
        email,
        phone,
        birth_date,
        personal_number
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:57:15.773138 [debug] [Thread-1 (]: SQL status: SELECT 100372 in 0.148 seconds
[0m10:57:15.777678 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m10:57:15.778835 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
alter table "airflow"."lead_staging"."dim_person__dbt_tmp" rename to "dim_person"
[0m10:57:15.780391 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:57:15.783676 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: COMMIT
[0m10:57:15.784822 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m10:57:15.785892 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: COMMIT
[0m10:57:15.809102 [debug] [Thread-1 (]: SQL status: COMMIT in 0.022 seconds
[0m10:57:15.813302 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_person__dbt_backup"
[0m10:57:15.814841 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m10:57:15.815927 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
drop table if exists "airflow"."lead_staging"."dim_person__dbt_backup" cascade
[0m10:57:15.817316 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m10:57:15.819695 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: Close
[0m10:57:15.821067 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '392a45e0-8e1a-4e15-99b5-7edd68fd7e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cddb74d0>]}
[0m10:57:15.822271 [info ] [Thread-1 (]: 4 of 5 OK created sql table model lead_staging.dim_person ...................... [[32mSELECT 100372[0m in 0.22s]
[0m10:57:15.823537 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_person
[0m10:57:15.824633 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_fact_network_usage
[0m10:57:15.826056 [info ] [Thread-1 (]: 5 of 5 START sql table model lead_staging.fact_network_usage ................... [RUN]
[0m10:57:15.827186 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_person, now model.dbt_lead_data.staging_fact_network_usage)
[0m10:57:15.828125 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_fact_network_usage
[0m10:57:15.832652 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_fact_network_usage"
[0m10:57:15.835980 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_fact_network_usage
[0m10:57:15.841620 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_fact_network_usage"
[0m10:57:15.844456 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m10:57:15.845504 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: BEGIN
[0m10:57:15.846838 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:15.853353 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m10:57:15.854426 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m10:57:15.855386 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */

  
    

  create  table "airflow"."lead_staging"."fact_network_usage__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        session_duration,
        download_speed,
        upload_speed,
        consumed_traffic
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:57:16.000549 [debug] [Thread-1 (]: SQL status: SELECT 100372 in 0.144 seconds
[0m10:57:16.004521 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m10:57:16.005372 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
alter table "airflow"."lead_staging"."fact_network_usage__dbt_tmp" rename to "fact_network_usage"
[0m10:57:16.006574 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:57:16.008858 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: COMMIT
[0m10:57:16.009655 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m10:57:16.010511 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: COMMIT
[0m10:57:16.016613 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m10:57:16.021066 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."fact_network_usage__dbt_backup"
[0m10:57:16.022329 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m10:57:16.023075 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
drop table if exists "airflow"."lead_staging"."fact_network_usage__dbt_backup" cascade
[0m10:57:16.024133 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m10:57:16.026030 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: Close
[0m10:57:16.027042 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '392a45e0-8e1a-4e15-99b5-7edd68fd7e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77ce9eca70>]}
[0m10:57:16.028023 [info ] [Thread-1 (]: 5 of 5 OK created sql table model lead_staging.fact_network_usage .............. [[32mSELECT 100372[0m in 0.20s]
[0m10:57:16.029226 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_fact_network_usage
[0m10:57:16.031369 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:16.031956 [debug] [MainThread]: On master: BEGIN
[0m10:57:16.032511 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:57:16.036661 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m10:57:16.037332 [debug] [MainThread]: On master: COMMIT
[0m10:57:16.037970 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:16.038505 [debug] [MainThread]: On master: COMMIT
[0m10:57:16.039296 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:57:16.039896 [debug] [MainThread]: On master: Close
[0m10:57:16.040590 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:57:16.041273 [debug] [MainThread]: Connection 'model.dbt_lead_data.staging_fact_network_usage' was properly closed.
[0m10:57:16.041956 [info ] [MainThread]: 
[0m10:57:16.042578 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 1.19 seconds (1.19s).
[0m10:57:16.044750 [debug] [MainThread]: Command end result
[0m10:57:16.089325 [info ] [MainThread]: 
[0m10:57:16.090043 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:57:16.091017 [info ] [MainThread]: 
[0m10:57:16.092100 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m10:57:16.093530 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.195838, "process_user_time": 4.206831, "process_kernel_time": 0.216669, "process_mem_max_rss": "127312", "process_in_blocks": "6904", "process_out_blocks": "4056"}
[0m10:57:16.094367 [debug] [MainThread]: Command `dbt run` succeeded at 10:57:16.094241 after 3.20 seconds
[0m10:57:16.094972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cf23b620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cd51c290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cd504860>]}
[0m10:57:16.095531 [debug] [MainThread]: Flushing usage events
[0m10:57:20.340463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8714ee2780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f871520b3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f871534b6e0>]}


============================== 10:57:20.346980 | 3e677b04-2b98-47ca-ae63-a81a8b78c78e ==============================
[0m10:57:20.346980 [info ] [MainThread]: Running with dbt=1.8.0
[0m10:57:20.347924 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select tag:trusted', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:57:20.524639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e677b04-2b98-47ca-ae63-a81a8b78c78e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8715df6fc0>]}
[0m10:57:20.589658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3e677b04-2b98-47ca-ae63-a81a8b78c78e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8714b646e0>]}
[0m10:57:20.591095 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:57:20.685255 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m10:57:20.821499 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:57:20.822389 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:57:20.862807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e677b04-2b98-47ca-ae63-a81a8b78c78e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8714b654f0>]}
[0m10:57:20.992902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e677b04-2b98-47ca-ae63-a81a8b78c78e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f871450cfb0>]}
[0m10:57:20.993789 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m10:57:20.994589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e677b04-2b98-47ca-ae63-a81a8b78c78e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8714b66e40>]}
[0m10:57:20.996987 [info ] [MainThread]: 
[0m10:57:20.998028 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:57:21.004010 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m10:57:21.041721 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m10:57:21.042759 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m10:57:21.043532 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:57:21.048903 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.005 seconds
[0m10:57:21.050870 [debug] [ThreadPool]: On list_airflow: Close
[0m10:57:21.052077 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now create_airflow_lead_trusted)
[0m10:57:21.052890 [debug] [ThreadPool]: Creating schema "database: "airflow"
schema: "lead_trusted"
"
[0m10:57:21.059014 [debug] [ThreadPool]: Using postgres connection "create_airflow_lead_trusted"
[0m10:57:21.059685 [debug] [ThreadPool]: On create_airflow_lead_trusted: BEGIN
[0m10:57:21.060287 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:57:21.064295 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m10:57:21.064979 [debug] [ThreadPool]: Using postgres connection "create_airflow_lead_trusted"
[0m10:57:21.065605 [debug] [ThreadPool]: On create_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "create_airflow_lead_trusted"} */
create schema if not exists "lead_trusted"
[0m10:57:21.066652 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m10:57:21.068026 [debug] [ThreadPool]: On create_airflow_lead_trusted: COMMIT
[0m10:57:21.068608 [debug] [ThreadPool]: Using postgres connection "create_airflow_lead_trusted"
[0m10:57:21.069289 [debug] [ThreadPool]: On create_airflow_lead_trusted: COMMIT
[0m10:57:21.071052 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m10:57:21.071700 [debug] [ThreadPool]: On create_airflow_lead_trusted: Close
[0m10:57:21.074192 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_airflow_lead_trusted, now list_airflow_lead_trusted)
[0m10:57:21.080866 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m10:57:21.081540 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m10:57:21.082228 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:57:21.086182 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m10:57:21.086905 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m10:57:21.087606 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m10:57:21.090630 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m10:57:21.092349 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m10:57:21.093115 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m10:57:21.094106 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now list_airflow_lead_staging)
[0m10:57:21.096533 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m10:57:21.097144 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m10:57:21.097743 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:57:21.101550 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m10:57:21.102345 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m10:57:21.103040 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m10:57:21.106148 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m10:57:21.108044 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m10:57:21.109023 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m10:57:21.116536 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:21.117270 [debug] [MainThread]: On master: BEGIN
[0m10:57:21.117886 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:57:21.122122 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m10:57:21.122881 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:21.123597 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:57:21.127275 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m10:57:21.129263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e677b04-2b98-47ca-ae63-a81a8b78c78e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87151771d0>]}
[0m10:57:21.130118 [debug] [MainThread]: On master: ROLLBACK
[0m10:57:21.131041 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:21.131671 [debug] [MainThread]: On master: BEGIN
[0m10:57:21.132801 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:57:21.133479 [debug] [MainThread]: On master: COMMIT
[0m10:57:21.134230 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:21.134943 [debug] [MainThread]: On master: COMMIT
[0m10:57:21.135820 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:57:21.136468 [debug] [MainThread]: On master: Close
[0m10:57:21.137430 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:57:21.138274 [info ] [MainThread]: 
[0m10:57:21.148725 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_non_pii_data
[0m10:57:21.149773 [info ] [Thread-1 (]: 1 of 4 START sql table model lead_trusted.non_pii_data ......................... [RUN]
[0m10:57:21.150872 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now model.dbt_lead_data.trusted_non_pii_data)
[0m10:57:21.151581 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_non_pii_data
[0m10:57:21.161667 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_non_pii_data"
[0m10:57:21.164098 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_non_pii_data
[0m10:57:21.207347 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_non_pii_data"
[0m10:57:21.209747 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m10:57:21.210633 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: BEGIN
[0m10:57:21.211340 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:21.215408 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m10:57:21.216112 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m10:57:21.216830 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */

  
    

  create  table "airflow"."lead_trusted"."non_pii_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        '***MASKED***' AS person_name,
        SUBSTRING(dp.user_name, 1, 5) || '*****'  user_name,
        SUBSTRING(dp.email, 1, 5) || '*****' AS email,
        '***MASKED***'  AS personal_number, 
        '***MASKED***' AS birth_date, 
        '***MASKED***' AS address,
        '***MASKED***'  AS phone, 
        SUBSTRING(da.mac_address, 1, 5) || '*****' AS mac_address,
        SUBSTRING(da.ip_address, 1, 5) || '*****' AS ip_address,
        SUBSTRING(df.iban, 1, 5) || '*****' AS iban,
        dd.accessed_at,
        fnu.session_duration,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.consumed_traffic,
        fnu.unique_id
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    INNER JOIN
        "airflow"."lead_staging"."dim_address" da ON fnu.unique_id = da.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_date" dd ON da.unique_id = dd.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_finance" df ON dd.unique_id = df.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_person" dp ON df.unique_id = dp.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:57:23.184591 [debug] [Thread-1 (]: SQL status: SELECT 100372 in 1.967 seconds
[0m10:57:23.191559 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m10:57:23.192378 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
alter table "airflow"."lead_trusted"."non_pii_data__dbt_tmp" rename to "non_pii_data"
[0m10:57:23.193543 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:57:23.212618 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: COMMIT
[0m10:57:23.213393 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m10:57:23.214023 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: COMMIT
[0m10:57:23.236633 [debug] [Thread-1 (]: SQL status: COMMIT in 0.022 seconds
[0m10:57:23.243619 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."non_pii_data__dbt_backup"
[0m10:57:23.249880 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m10:57:23.250678 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
drop table if exists "airflow"."lead_trusted"."non_pii_data__dbt_backup" cascade
[0m10:57:23.251796 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m10:57:23.254620 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: Close
[0m10:57:23.256382 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e677b04-2b98-47ca-ae63-a81a8b78c78e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87163d60f0>]}
[0m10:57:23.257355 [info ] [Thread-1 (]: 1 of 4 OK created sql table model lead_trusted.non_pii_data .................... [[32mSELECT 100372[0m in 2.10s]
[0m10:57:23.258589 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_non_pii_data
[0m10:57:23.259434 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_payment_data
[0m10:57:23.260260 [info ] [Thread-1 (]: 2 of 4 START sql table model lead_trusted.payment_data ......................... [RUN]
[0m10:57:23.261128 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_non_pii_data, now model.dbt_lead_data.trusted_payment_data)
[0m10:57:23.261749 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_payment_data
[0m10:57:23.265636 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_payment_data"
[0m10:57:23.268012 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_payment_data
[0m10:57:23.272213 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_payment_data"
[0m10:57:23.274313 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m10:57:23.275027 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: BEGIN
[0m10:57:23.275627 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:23.279976 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m10:57:23.280730 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m10:57:23.281589 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */

  
    

  create  table "airflow"."lead_trusted"."payment_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        fnu.unique_id,
        df.iban,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.session_duration,
        fnu.consumed_traffic,
        ((fnu.download_speed + fnu.upload_speed + 1)/2) + (fnu.consumed_traffic / (fnu.session_duration + 1)) AS payment_amount
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    JOIN
        "airflow"."lead_staging"."dim_finance" df
    ON
	    fnu.unique_id = df.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:57:23.806075 [debug] [Thread-1 (]: SQL status: SELECT 100372 in 0.524 seconds
[0m10:57:23.809431 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m10:57:23.810080 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
alter table "airflow"."lead_trusted"."payment_data__dbt_tmp" rename to "payment_data"
[0m10:57:23.811048 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:57:23.812832 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: COMMIT
[0m10:57:23.813525 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m10:57:23.814282 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: COMMIT
[0m10:57:23.818019 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m10:57:23.820643 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."payment_data__dbt_backup"
[0m10:57:23.821790 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m10:57:23.822556 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
drop table if exists "airflow"."lead_trusted"."payment_data__dbt_backup" cascade
[0m10:57:23.823610 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m10:57:23.825558 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: Close
[0m10:57:23.826511 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e677b04-2b98-47ca-ae63-a81a8b78c78e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87129b3f80>]}
[0m10:57:23.827384 [info ] [Thread-1 (]: 2 of 4 OK created sql table model lead_trusted.payment_data .................... [[32mSELECT 100372[0m in 0.57s]
[0m10:57:23.828372 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_payment_data
[0m10:57:23.829132 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_pii_data
[0m10:57:23.829976 [info ] [Thread-1 (]: 3 of 4 START sql table model lead_trusted.pii_data ............................. [RUN]
[0m10:57:23.830742 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_payment_data, now model.dbt_lead_data.trusted_pii_data)
[0m10:57:23.831582 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_pii_data
[0m10:57:23.836389 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_pii_data"
[0m10:57:23.838275 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_pii_data
[0m10:57:23.843830 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_pii_data"
[0m10:57:23.845727 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m10:57:23.846438 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: BEGIN
[0m10:57:23.847115 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:23.851690 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m10:57:23.852575 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m10:57:23.853359 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */

  
    

  create  table "airflow"."lead_trusted"."pii_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        dp.person_name,
        dp.user_name,
        dp.email,
        dp.personal_number, 
        dp.birth_date, 
        da.address,
        dp.phone, 
        da.mac_address,
        da.ip_address,
        df.iban,
        dd.accessed_at,
        fnu.session_duration,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.consumed_traffic,
        fnu.unique_id
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    INNER JOIN
        "airflow"."lead_staging"."dim_address" da ON fnu.unique_id = da.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_date" dd ON da.unique_id = dd.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_finance" df ON dd.unique_id = df.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_person" dp ON df.unique_id = dp.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:57:25.855157 [debug] [Thread-1 (]: SQL status: SELECT 100372 in 2.001 seconds
[0m10:57:25.859333 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m10:57:25.860091 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */
alter table "airflow"."lead_trusted"."pii_data__dbt_tmp" rename to "pii_data"
[0m10:57:25.861166 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:57:25.863190 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: COMMIT
[0m10:57:25.863908 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m10:57:25.864636 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: COMMIT
[0m10:57:25.870570 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m10:57:25.873598 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."pii_data__dbt_backup"
[0m10:57:25.874702 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m10:57:25.875451 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */
drop table if exists "airflow"."lead_trusted"."pii_data__dbt_backup" cascade
[0m10:57:25.876457 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m10:57:25.878230 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: Close
[0m10:57:25.879104 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e677b04-2b98-47ca-ae63-a81a8b78c78e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87129af8c0>]}
[0m10:57:25.880008 [info ] [Thread-1 (]: 3 of 4 OK created sql table model lead_trusted.pii_data ........................ [[32mSELECT 100372[0m in 2.05s]
[0m10:57:25.881133 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_pii_data
[0m10:57:25.881926 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_technical_data
[0m10:57:25.882709 [info ] [Thread-1 (]: 4 of 4 START sql table model lead_trusted.technical_data ....................... [RUN]
[0m10:57:25.883555 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_pii_data, now model.dbt_lead_data.trusted_technical_data)
[0m10:57:25.884252 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_technical_data
[0m10:57:25.888521 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_technical_data"
[0m10:57:25.891365 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_technical_data
[0m10:57:25.895778 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_technical_data"
[0m10:57:25.899141 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m10:57:25.899965 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: BEGIN
[0m10:57:25.900820 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:25.905401 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m10:57:25.906260 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m10:57:25.907010 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */

  
    

  create  table "airflow"."lead_trusted"."technical_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        fnu.unique_id,
        da.address,
        da.mac_address,
        da.ip_address,
        fnu.download_speed,
        fnu.upload_speed,
        ROUND((fnu.session_duration/60), 1) as min_session_duration,
        CASE 
            WHEN fnu.download_speed < 50 OR fnu.upload_speed < 30 OR fnu.session_duration/60 < 1 THEN true
            ELSE false
        END AS technical_issue
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    JOIN
        "airflow"."lead_staging"."dim_address" da
    ON
	    fnu.unique_id = da.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:57:26.489872 [debug] [Thread-1 (]: SQL status: SELECT 100372 in 0.582 seconds
[0m10:57:26.493450 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m10:57:26.494140 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
alter table "airflow"."lead_trusted"."technical_data__dbt_tmp" rename to "technical_data"
[0m10:57:26.495071 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:57:26.496879 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: COMMIT
[0m10:57:26.497523 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m10:57:26.498166 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: COMMIT
[0m10:57:26.504914 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m10:57:26.507777 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."technical_data__dbt_backup"
[0m10:57:26.508931 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m10:57:26.509660 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
drop table if exists "airflow"."lead_trusted"."technical_data__dbt_backup" cascade
[0m10:57:26.510722 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m10:57:26.512602 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: Close
[0m10:57:26.513513 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e677b04-2b98-47ca-ae63-a81a8b78c78e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8711d08e90>]}
[0m10:57:26.514483 [info ] [Thread-1 (]: 4 of 4 OK created sql table model lead_trusted.technical_data .................. [[32mSELECT 100372[0m in 0.63s]
[0m10:57:26.515501 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_technical_data
[0m10:57:26.517678 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:26.518470 [debug] [MainThread]: On master: BEGIN
[0m10:57:26.519163 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:57:26.523323 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m10:57:26.524153 [debug] [MainThread]: On master: COMMIT
[0m10:57:26.524969 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:26.525636 [debug] [MainThread]: On master: COMMIT
[0m10:57:26.526489 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:57:26.527232 [debug] [MainThread]: On master: Close
[0m10:57:26.528186 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:57:26.528907 [debug] [MainThread]: Connection 'model.dbt_lead_data.trusted_technical_data' was properly closed.
[0m10:57:26.529661 [info ] [MainThread]: 
[0m10:57:26.530426 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 5.53 seconds (5.53s).
[0m10:57:26.532308 [debug] [MainThread]: Command end result
[0m10:57:26.587100 [info ] [MainThread]: 
[0m10:57:26.588039 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:57:26.588980 [info ] [MainThread]: 
[0m10:57:26.589936 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m10:57:26.591402 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.308841, "process_user_time": 2.770224, "process_kernel_time": 0.147502, "process_mem_max_rss": "121692", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:57:26.592350 [debug] [MainThread]: Command `dbt run` succeeded at 10:57:26.592209 after 6.31 seconds
[0m10:57:26.593051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87156a0a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8715710a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f871589c740>]}
[0m10:57:26.593773 [debug] [MainThread]: Flushing usage events
[0m10:19:53.982326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4e8f45c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4e8d824b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4e8f451c0>]}


============================== 10:19:54.006697 | 32366fca-979c-44a6-a061-f2448f2f82c4 ==============================
[0m10:19:54.006697 [info ] [MainThread]: Running with dbt=1.8.0
[0m10:19:54.007712 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select tag:staging', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:19:54.217660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '32366fca-979c-44a6-a061-f2448f2f82c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4ea24be90>]}
[0m10:19:54.286291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '32366fca-979c-44a6-a061-f2448f2f82c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4e9a50c20>]}
[0m10:19:54.287574 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:19:54.378409 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m10:19:54.523210 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:19:54.523912 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:19:54.562261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '32366fca-979c-44a6-a061-f2448f2f82c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4e87319d0>]}
[0m10:19:54.699166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '32366fca-979c-44a6-a061-f2448f2f82c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4e77adcd0>]}
[0m10:19:54.700091 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m10:19:54.700825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32366fca-979c-44a6-a061-f2448f2f82c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4e77c67e0>]}
[0m10:19:54.703338 [info ] [MainThread]: 
[0m10:19:54.704506 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:19:54.710210 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m10:19:54.752182 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m10:19:54.753107 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m10:19:54.753805 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:19:54.759820 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.006 seconds
[0m10:19:54.761931 [debug] [ThreadPool]: On list_airflow: Close
[0m10:19:54.764806 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_staging)
[0m10:19:54.771784 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m10:19:54.772644 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m10:19:54.773409 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:19:54.779004 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m10:19:54.780063 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m10:19:54.780821 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m10:19:54.784683 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.003 seconds
[0m10:19:54.786636 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m10:19:54.787697 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m10:19:54.788753 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now list_airflow_lead_trusted)
[0m10:19:54.792499 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m10:19:54.793306 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m10:19:54.793918 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:19:54.798281 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m10:19:54.799132 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m10:19:54.799798 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m10:19:54.803055 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m10:19:54.804948 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m10:19:54.805959 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m10:19:54.813320 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:54.814187 [debug] [MainThread]: On master: BEGIN
[0m10:19:54.814909 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:19:54.819569 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m10:19:54.820339 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:54.821083 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:19:54.825368 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m10:19:54.827471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32366fca-979c-44a6-a061-f2448f2f82c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4e77c8980>]}
[0m10:19:54.828403 [debug] [MainThread]: On master: ROLLBACK
[0m10:19:54.829348 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:54.830065 [debug] [MainThread]: On master: BEGIN
[0m10:19:54.831149 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:19:54.831869 [debug] [MainThread]: On master: COMMIT
[0m10:19:54.832626 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:54.833407 [debug] [MainThread]: On master: COMMIT
[0m10:19:54.834434 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:19:54.835193 [debug] [MainThread]: On master: Close
[0m10:19:54.836219 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:19:54.836977 [info ] [MainThread]: 
[0m10:19:54.848297 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_adress
[0m10:19:54.849299 [info ] [Thread-1 (]: 1 of 5 START sql table model lead_staging.dim_address .......................... [RUN]
[0m10:19:54.850205 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now model.dbt_lead_data.staging_dim_adress)
[0m10:19:54.850878 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_adress
[0m10:19:54.860475 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_adress"
[0m10:19:54.863320 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_adress
[0m10:19:54.908885 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_adress"
[0m10:19:54.911620 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m10:19:54.912288 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: BEGIN
[0m10:19:54.912911 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:19:54.917739 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m10:19:54.918659 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m10:19:54.919449 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */

  
    

  create  table "airflow"."lead_staging"."dim_address__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        address,
        mac_address,
        ip_address
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:19:55.066165 [debug] [Thread-1 (]: SQL status: SELECT 101388 in 0.146 seconds
[0m10:19:55.075280 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m10:19:55.076118 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
alter table "airflow"."lead_staging"."dim_address" rename to "dim_address__dbt_backup"
[0m10:19:55.077273 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:19:55.080862 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m10:19:55.081679 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
alter table "airflow"."lead_staging"."dim_address__dbt_tmp" rename to "dim_address"
[0m10:19:55.082998 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:19:55.105710 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m10:19:55.106604 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m10:19:55.107364 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m10:19:55.108768 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:19:55.115476 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_address__dbt_backup"
[0m10:19:55.121692 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m10:19:55.122446 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
drop table if exists "airflow"."lead_staging"."dim_address__dbt_backup" cascade
[0m10:19:55.128206 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m10:19:55.131149 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: Close
[0m10:19:55.132945 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32366fca-979c-44a6-a061-f2448f2f82c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4ea24a990>]}
[0m10:19:55.133937 [info ] [Thread-1 (]: 1 of 5 OK created sql table model lead_staging.dim_address ..................... [[32mSELECT 101388[0m in 0.28s]
[0m10:19:55.135066 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_adress
[0m10:19:55.135925 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_date
[0m10:19:55.136776 [info ] [Thread-1 (]: 2 of 5 START sql table model lead_staging.dim_date ............................. [RUN]
[0m10:19:55.137608 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_adress, now model.dbt_lead_data.staging_dim_date)
[0m10:19:55.138338 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_date
[0m10:19:55.141974 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_date"
[0m10:19:55.143850 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_date
[0m10:19:55.147864 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_date"
[0m10:19:55.149840 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m10:19:55.150559 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: BEGIN
[0m10:19:55.151268 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:19:55.155732 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m10:19:55.156533 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m10:19:55.157184 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */

  
    

  create  table "airflow"."lead_staging"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        accessed_at
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:19:55.233943 [debug] [Thread-1 (]: SQL status: SELECT 101388 in 0.076 seconds
[0m10:19:55.237717 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m10:19:55.238532 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
alter table "airflow"."lead_staging"."dim_date" rename to "dim_date__dbt_backup"
[0m10:19:55.239885 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:19:55.243338 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m10:19:55.244112 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
alter table "airflow"."lead_staging"."dim_date__dbt_tmp" rename to "dim_date"
[0m10:19:55.245193 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:19:55.247473 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: COMMIT
[0m10:19:55.248161 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m10:19:55.248820 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: COMMIT
[0m10:19:55.261773 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m10:19:55.264945 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_date__dbt_backup"
[0m10:19:55.266183 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m10:19:55.266898 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
drop table if exists "airflow"."lead_staging"."dim_date__dbt_backup" cascade
[0m10:19:55.269377 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m10:19:55.271120 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: Close
[0m10:19:55.272288 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32366fca-979c-44a6-a061-f2448f2f82c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4e674b860>]}
[0m10:19:55.273293 [info ] [Thread-1 (]: 2 of 5 OK created sql table model lead_staging.dim_date ........................ [[32mSELECT 101388[0m in 0.13s]
[0m10:19:55.274355 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_date
[0m10:19:55.275186 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_finance
[0m10:19:55.276038 [info ] [Thread-1 (]: 3 of 5 START sql table model lead_staging.dim_finance .......................... [RUN]
[0m10:19:55.276855 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_date, now model.dbt_lead_data.staging_dim_finance)
[0m10:19:55.277545 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_finance
[0m10:19:55.281075 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_finance"
[0m10:19:55.283191 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_finance
[0m10:19:55.287223 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_finance"
[0m10:19:55.289294 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m10:19:55.289942 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: BEGIN
[0m10:19:55.290588 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:19:55.295208 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m10:19:55.295915 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m10:19:55.296655 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */

  
    

  create  table "airflow"."lead_staging"."dim_finance__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        iban
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:19:55.388551 [debug] [Thread-1 (]: SQL status: SELECT 101388 in 0.091 seconds
[0m10:19:55.392418 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m10:19:55.393165 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
alter table "airflow"."lead_staging"."dim_finance" rename to "dim_finance__dbt_backup"
[0m10:19:55.394376 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:19:55.399313 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m10:19:55.400092 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
alter table "airflow"."lead_staging"."dim_finance__dbt_tmp" rename to "dim_finance"
[0m10:19:55.401127 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:19:55.403615 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: COMMIT
[0m10:19:55.404328 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m10:19:55.405053 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: COMMIT
[0m10:19:55.426185 [debug] [Thread-1 (]: SQL status: COMMIT in 0.020 seconds
[0m10:19:55.429220 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_finance__dbt_backup"
[0m10:19:55.430612 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m10:19:55.431329 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
drop table if exists "airflow"."lead_staging"."dim_finance__dbt_backup" cascade
[0m10:19:55.434039 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m10:19:55.435983 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: Close
[0m10:19:55.436972 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32366fca-979c-44a6-a061-f2448f2f82c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4e5b9b5f0>]}
[0m10:19:55.438009 [info ] [Thread-1 (]: 3 of 5 OK created sql table model lead_staging.dim_finance ..................... [[32mSELECT 101388[0m in 0.16s]
[0m10:19:55.439127 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_finance
[0m10:19:55.440059 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_person
[0m10:19:55.440987 [info ] [Thread-1 (]: 4 of 5 START sql table model lead_staging.dim_person ........................... [RUN]
[0m10:19:55.441881 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_finance, now model.dbt_lead_data.staging_dim_person)
[0m10:19:55.442642 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_person
[0m10:19:55.446274 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_person"
[0m10:19:55.448286 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_person
[0m10:19:55.452479 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_person"
[0m10:19:55.454357 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m10:19:55.454989 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: BEGIN
[0m10:19:55.455728 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:19:55.460376 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m10:19:55.461194 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m10:19:55.461864 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */

  
    

  create  table "airflow"."lead_staging"."dim_person__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        person_name,
        user_name,
        email,
        phone,
        birth_date,
        personal_number
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:19:55.612498 [debug] [Thread-1 (]: SQL status: SELECT 101388 in 0.150 seconds
[0m10:19:55.616497 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m10:19:55.617282 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
alter table "airflow"."lead_staging"."dim_person" rename to "dim_person__dbt_backup"
[0m10:19:55.618508 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:19:55.621847 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m10:19:55.622726 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
alter table "airflow"."lead_staging"."dim_person__dbt_tmp" rename to "dim_person"
[0m10:19:55.624247 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:19:55.626904 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: COMMIT
[0m10:19:55.627836 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m10:19:55.628716 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: COMMIT
[0m10:19:55.636957 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m10:19:55.640171 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_person__dbt_backup"
[0m10:19:55.641666 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m10:19:55.642538 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
drop table if exists "airflow"."lead_staging"."dim_person__dbt_backup" cascade
[0m10:19:55.646921 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m10:19:55.649038 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: Close
[0m10:19:55.649961 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32366fca-979c-44a6-a061-f2448f2f82c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4e5b63050>]}
[0m10:19:55.650945 [info ] [Thread-1 (]: 4 of 5 OK created sql table model lead_staging.dim_person ...................... [[32mSELECT 101388[0m in 0.21s]
[0m10:19:55.651987 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_person
[0m10:19:55.652823 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_fact_network_usage
[0m10:19:55.653691 [info ] [Thread-1 (]: 5 of 5 START sql table model lead_staging.fact_network_usage ................... [RUN]
[0m10:19:55.654540 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_person, now model.dbt_lead_data.staging_fact_network_usage)
[0m10:19:55.655300 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_fact_network_usage
[0m10:19:55.659606 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_fact_network_usage"
[0m10:19:55.662131 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_fact_network_usage
[0m10:19:55.666355 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_fact_network_usage"
[0m10:19:55.668274 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m10:19:55.669016 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: BEGIN
[0m10:19:55.669749 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:19:55.676917 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m10:19:55.678832 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m10:19:55.679941 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */

  
    

  create  table "airflow"."lead_staging"."fact_network_usage__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        session_duration,
        download_speed,
        upload_speed,
        consumed_traffic
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:19:55.777636 [debug] [Thread-1 (]: SQL status: SELECT 101388 in 0.097 seconds
[0m10:19:55.781404 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m10:19:55.782205 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
alter table "airflow"."lead_staging"."fact_network_usage" rename to "fact_network_usage__dbt_backup"
[0m10:19:55.783389 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:19:55.786649 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m10:19:55.787514 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
alter table "airflow"."lead_staging"."fact_network_usage__dbt_tmp" rename to "fact_network_usage"
[0m10:19:55.788706 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:19:55.791569 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: COMMIT
[0m10:19:55.792507 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m10:19:55.793258 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: COMMIT
[0m10:19:55.801401 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m10:19:55.805910 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."fact_network_usage__dbt_backup"
[0m10:19:55.807580 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m10:19:55.808422 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
drop table if exists "airflow"."lead_staging"."fact_network_usage__dbt_backup" cascade
[0m10:19:55.811667 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m10:19:55.813624 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: Close
[0m10:19:55.814547 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32366fca-979c-44a6-a061-f2448f2f82c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4e5bc22d0>]}
[0m10:19:55.815509 [info ] [Thread-1 (]: 5 of 5 OK created sql table model lead_staging.fact_network_usage .............. [[32mSELECT 101388[0m in 0.16s]
[0m10:19:55.816690 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_fact_network_usage
[0m10:19:55.819192 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:55.819874 [debug] [MainThread]: On master: BEGIN
[0m10:19:55.820579 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:19:55.825197 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m10:19:55.826058 [debug] [MainThread]: On master: COMMIT
[0m10:19:55.826710 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:55.827379 [debug] [MainThread]: On master: COMMIT
[0m10:19:55.828220 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:19:55.828893 [debug] [MainThread]: On master: Close
[0m10:19:55.829792 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:19:55.830496 [debug] [MainThread]: Connection 'model.dbt_lead_data.staging_fact_network_usage' was properly closed.
[0m10:19:55.831278 [info ] [MainThread]: 
[0m10:19:55.832121 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 1.13 seconds (1.13s).
[0m10:19:55.834304 [debug] [MainThread]: Command end result
[0m10:19:55.890173 [info ] [MainThread]: 
[0m10:19:55.891268 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:19:55.892469 [info ] [MainThread]: 
[0m10:19:55.893412 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m10:19:55.894742 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.0122557, "process_user_time": 3.081633, "process_kernel_time": 0.171706, "process_mem_max_rss": "122552", "process_in_blocks": "528", "process_out_blocks": "4056"}
[0m10:19:55.895664 [debug] [MainThread]: Command `dbt run` succeeded at 10:19:55.895533 after 2.01 seconds
[0m10:19:55.896371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4e8cd89e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4e9912360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4e7b1a570>]}
[0m10:19:55.897106 [debug] [MainThread]: Flushing usage events
[0m10:19:59.835760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47f9045ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47f9434a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47f9aa1df0>]}


============================== 10:19:59.842407 | 0e0e5d9a-9673-497c-9b62-d9335fa048e4 ==============================
[0m10:19:59.842407 [info ] [MainThread]: Running with dbt=1.8.0
[0m10:19:59.843341 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select tag:trusted', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:20:00.037486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0e0e5d9a-9673-497c-9b62-d9335fa048e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47f8c22960>]}
[0m10:20:00.095316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0e0e5d9a-9673-497c-9b62-d9335fa048e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47f939cef0>]}
[0m10:20:00.096344 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:20:00.176989 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m10:20:00.283815 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:20:00.284639 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:20:00.317577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0e0e5d9a-9673-497c-9b62-d9335fa048e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47f939f350>]}
[0m10:20:00.432110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0e0e5d9a-9673-497c-9b62-d9335fa048e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47f7b982f0>]}
[0m10:20:00.432783 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m10:20:00.433485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e0e5d9a-9673-497c-9b62-d9335fa048e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47f9855c40>]}
[0m10:20:00.435905 [info ] [MainThread]: 
[0m10:20:00.437370 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:20:00.443817 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m10:20:00.477170 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m10:20:00.477870 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m10:20:00.478628 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:20:00.483548 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.005 seconds
[0m10:20:00.485356 [debug] [ThreadPool]: On list_airflow: Close
[0m10:20:00.487779 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_staging)
[0m10:20:00.493974 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m10:20:00.494659 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m10:20:00.495322 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:20:00.499521 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m10:20:00.500273 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m10:20:00.500906 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m10:20:00.503883 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m10:20:00.505783 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m10:20:00.506632 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m10:20:00.507614 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now list_airflow_lead_trusted)
[0m10:20:00.510661 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m10:20:00.511303 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m10:20:00.511877 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:20:00.515599 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m10:20:00.516238 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m10:20:00.516844 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m10:20:00.519762 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m10:20:00.521486 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m10:20:00.522258 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m10:20:00.528774 [debug] [MainThread]: Using postgres connection "master"
[0m10:20:00.529516 [debug] [MainThread]: On master: BEGIN
[0m10:20:00.530229 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:20:00.534259 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m10:20:00.534915 [debug] [MainThread]: Using postgres connection "master"
[0m10:20:00.535667 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:20:00.538775 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m10:20:00.540528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e0e5d9a-9673-497c-9b62-d9335fa048e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47f8782c00>]}
[0m10:20:00.541292 [debug] [MainThread]: On master: ROLLBACK
[0m10:20:00.541938 [debug] [MainThread]: Using postgres connection "master"
[0m10:20:00.542606 [debug] [MainThread]: On master: BEGIN
[0m10:20:00.543444 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:20:00.543986 [debug] [MainThread]: On master: COMMIT
[0m10:20:00.544597 [debug] [MainThread]: Using postgres connection "master"
[0m10:20:00.545136 [debug] [MainThread]: On master: COMMIT
[0m10:20:00.545843 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:20:00.546478 [debug] [MainThread]: On master: Close
[0m10:20:00.547195 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:20:00.547793 [info ] [MainThread]: 
[0m10:20:00.556547 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_non_pii_data
[0m10:20:00.557358 [info ] [Thread-1 (]: 1 of 4 START sql table model lead_trusted.non_pii_data ......................... [RUN]
[0m10:20:00.558336 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now model.dbt_lead_data.trusted_non_pii_data)
[0m10:20:00.558976 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_non_pii_data
[0m10:20:00.568075 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_non_pii_data"
[0m10:20:00.570333 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_non_pii_data
[0m10:20:00.608824 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_non_pii_data"
[0m10:20:00.610980 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m10:20:00.611564 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: BEGIN
[0m10:20:00.612118 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:20:00.615694 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m10:20:00.616497 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m10:20:00.617098 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */

  
    

  create  table "airflow"."lead_trusted"."non_pii_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        '***MASKED***' AS person_name,
        SUBSTRING(dp.user_name, 1, 5) || '*****'  user_name,
        SUBSTRING(dp.email, 1, 5) || '*****' AS email,
        '***MASKED***'  AS personal_number, 
        '***MASKED***' AS birth_date, 
        '***MASKED***' AS address,
        '***MASKED***'  AS phone, 
        SUBSTRING(da.mac_address, 1, 5) || '*****' AS mac_address,
        SUBSTRING(da.ip_address, 1, 5) || '*****' AS ip_address,
        SUBSTRING(df.iban, 1, 5) || '*****' AS iban,
        dd.accessed_at,
        fnu.session_duration,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.consumed_traffic,
        fnu.unique_id
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    INNER JOIN
        "airflow"."lead_staging"."dim_address" da ON fnu.unique_id = da.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_date" dd ON da.unique_id = dd.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_finance" df ON dd.unique_id = df.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_person" dp ON df.unique_id = dp.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:20:02.452707 [debug] [Thread-1 (]: SQL status: SELECT 101388 in 1.835 seconds
[0m10:20:02.460257 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m10:20:02.460980 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
alter table "airflow"."lead_trusted"."non_pii_data" rename to "non_pii_data__dbt_backup"
[0m10:20:02.462746 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:20:02.466318 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m10:20:02.467317 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
alter table "airflow"."lead_trusted"."non_pii_data__dbt_tmp" rename to "non_pii_data"
[0m10:20:02.468436 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:20:02.490941 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: COMMIT
[0m10:20:02.491942 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m10:20:02.492829 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: COMMIT
[0m10:20:02.502621 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m10:20:02.510699 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."non_pii_data__dbt_backup"
[0m10:20:02.517885 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m10:20:02.518787 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
drop table if exists "airflow"."lead_trusted"."non_pii_data__dbt_backup" cascade
[0m10:20:02.523814 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m10:20:02.526905 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: Close
[0m10:20:02.528879 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e0e5d9a-9673-497c-9b62-d9335fa048e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47fa0ddb80>]}
[0m10:20:02.530017 [info ] [Thread-1 (]: 1 of 4 OK created sql table model lead_trusted.non_pii_data .................... [[32mSELECT 101388[0m in 1.97s]
[0m10:20:02.531246 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_non_pii_data
[0m10:20:02.532148 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_payment_data
[0m10:20:02.533119 [info ] [Thread-1 (]: 2 of 4 START sql table model lead_trusted.payment_data ......................... [RUN]
[0m10:20:02.533987 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_non_pii_data, now model.dbt_lead_data.trusted_payment_data)
[0m10:20:02.534882 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_payment_data
[0m10:20:02.538882 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_payment_data"
[0m10:20:02.541717 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_payment_data
[0m10:20:02.545743 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_payment_data"
[0m10:20:02.548109 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m10:20:02.548798 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: BEGIN
[0m10:20:02.549537 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:20:02.554389 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m10:20:02.555254 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m10:20:02.556098 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */

  
    

  create  table "airflow"."lead_trusted"."payment_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        fnu.unique_id,
        df.iban,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.session_duration,
        fnu.consumed_traffic,
        ((fnu.download_speed + fnu.upload_speed + 1)/2) + (fnu.consumed_traffic / (fnu.session_duration + 1)) AS payment_amount
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    JOIN
        "airflow"."lead_staging"."dim_finance" df
    ON
	    fnu.unique_id = df.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:20:03.162511 [debug] [Thread-1 (]: SQL status: SELECT 101388 in 0.605 seconds
[0m10:20:03.166335 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m10:20:03.167118 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
alter table "airflow"."lead_trusted"."payment_data" rename to "payment_data__dbt_backup"
[0m10:20:03.168385 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:20:03.172317 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m10:20:03.173273 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
alter table "airflow"."lead_trusted"."payment_data__dbt_tmp" rename to "payment_data"
[0m10:20:03.174554 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:20:03.177097 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: COMMIT
[0m10:20:03.177866 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m10:20:03.178664 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: COMMIT
[0m10:20:03.190451 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m10:20:03.193598 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."payment_data__dbt_backup"
[0m10:20:03.194795 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m10:20:03.195539 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
drop table if exists "airflow"."lead_trusted"."payment_data__dbt_backup" cascade
[0m10:20:03.199159 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m10:20:03.201052 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: Close
[0m10:20:03.201961 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e0e5d9a-9673-497c-9b62-d9335fa048e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47f5b8b890>]}
[0m10:20:03.203259 [info ] [Thread-1 (]: 2 of 4 OK created sql table model lead_trusted.payment_data .................... [[32mSELECT 101388[0m in 0.67s]
[0m10:20:03.204541 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_payment_data
[0m10:20:03.205497 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_pii_data
[0m10:20:03.206514 [info ] [Thread-1 (]: 3 of 4 START sql table model lead_trusted.pii_data ............................. [RUN]
[0m10:20:03.207484 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_payment_data, now model.dbt_lead_data.trusted_pii_data)
[0m10:20:03.208246 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_pii_data
[0m10:20:03.213220 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_pii_data"
[0m10:20:03.215115 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_pii_data
[0m10:20:03.220767 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_pii_data"
[0m10:20:03.223110 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m10:20:03.223819 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: BEGIN
[0m10:20:03.224532 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:20:03.229429 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m10:20:03.230369 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m10:20:03.231152 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */

  
    

  create  table "airflow"."lead_trusted"."pii_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        dp.person_name,
        dp.user_name,
        dp.email,
        dp.personal_number, 
        dp.birth_date, 
        da.address,
        dp.phone, 
        da.mac_address,
        da.ip_address,
        df.iban,
        dd.accessed_at,
        fnu.session_duration,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.consumed_traffic,
        fnu.unique_id
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    INNER JOIN
        "airflow"."lead_staging"."dim_address" da ON fnu.unique_id = da.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_date" dd ON da.unique_id = dd.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_finance" df ON dd.unique_id = df.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_person" dp ON df.unique_id = dp.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:20:05.352130 [debug] [Thread-1 (]: SQL status: SELECT 101388 in 2.120 seconds
[0m10:20:05.355494 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m10:20:05.356508 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */
alter table "airflow"."lead_trusted"."pii_data" rename to "pii_data__dbt_backup"
[0m10:20:05.357976 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:20:05.361738 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m10:20:05.362505 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */
alter table "airflow"."lead_trusted"."pii_data__dbt_tmp" rename to "pii_data"
[0m10:20:05.364057 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:20:05.366780 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: COMMIT
[0m10:20:05.367560 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m10:20:05.368320 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: COMMIT
[0m10:20:05.374730 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m10:20:05.377964 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."pii_data__dbt_backup"
[0m10:20:05.379350 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m10:20:05.380129 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */
drop table if exists "airflow"."lead_trusted"."pii_data__dbt_backup" cascade
[0m10:20:05.385898 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m10:20:05.388011 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: Close
[0m10:20:05.388969 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e0e5d9a-9673-497c-9b62-d9335fa048e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47f42067e0>]}
[0m10:20:05.390072 [info ] [Thread-1 (]: 3 of 4 OK created sql table model lead_trusted.pii_data ........................ [[32mSELECT 101388[0m in 2.18s]
[0m10:20:05.391445 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_pii_data
[0m10:20:05.392508 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_technical_data
[0m10:20:05.393611 [info ] [Thread-1 (]: 4 of 4 START sql table model lead_trusted.technical_data ....................... [RUN]
[0m10:20:05.394499 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_pii_data, now model.dbt_lead_data.trusted_technical_data)
[0m10:20:05.395278 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_technical_data
[0m10:20:05.399345 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_technical_data"
[0m10:20:05.401839 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_technical_data
[0m10:20:05.406160 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_technical_data"
[0m10:20:05.408649 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m10:20:05.409454 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: BEGIN
[0m10:20:05.410193 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:20:05.415221 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m10:20:05.416153 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m10:20:05.416912 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */

  
    

  create  table "airflow"."lead_trusted"."technical_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        fnu.unique_id,
        da.address,
        da.mac_address,
        da.ip_address,
        fnu.download_speed,
        fnu.upload_speed,
        ROUND((fnu.session_duration/60), 1) as min_session_duration,
        CASE 
            WHEN fnu.download_speed < 50 OR fnu.upload_speed < 30 OR fnu.session_duration/60 < 1 THEN true
            ELSE false
        END AS technical_issue
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    JOIN
        "airflow"."lead_staging"."dim_address" da
    ON
	    fnu.unique_id = da.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:20:06.080960 [debug] [Thread-1 (]: SQL status: SELECT 101388 in 0.663 seconds
[0m10:20:06.084948 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m10:20:06.085847 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
alter table "airflow"."lead_trusted"."technical_data" rename to "technical_data__dbt_backup"
[0m10:20:06.087262 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:20:06.091345 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m10:20:06.092219 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
alter table "airflow"."lead_trusted"."technical_data__dbt_tmp" rename to "technical_data"
[0m10:20:06.093384 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:20:06.095699 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: COMMIT
[0m10:20:06.096411 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m10:20:06.097110 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: COMMIT
[0m10:20:06.102595 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m10:20:06.105635 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."technical_data__dbt_backup"
[0m10:20:06.106798 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m10:20:06.107660 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
drop table if exists "airflow"."lead_trusted"."technical_data__dbt_backup" cascade
[0m10:20:06.111893 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m10:20:06.113882 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: Close
[0m10:20:06.114813 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e0e5d9a-9673-497c-9b62-d9335fa048e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47f67d2330>]}
[0m10:20:06.115874 [info ] [Thread-1 (]: 4 of 4 OK created sql table model lead_trusted.technical_data .................. [[32mSELECT 101388[0m in 0.72s]
[0m10:20:06.116982 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_technical_data
[0m10:20:06.119407 [debug] [MainThread]: Using postgres connection "master"
[0m10:20:06.120150 [debug] [MainThread]: On master: BEGIN
[0m10:20:06.120797 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:20:06.124955 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m10:20:06.125788 [debug] [MainThread]: On master: COMMIT
[0m10:20:06.126613 [debug] [MainThread]: Using postgres connection "master"
[0m10:20:06.127353 [debug] [MainThread]: On master: COMMIT
[0m10:20:06.128184 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:20:06.128882 [debug] [MainThread]: On master: Close
[0m10:20:06.129712 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:20:06.130438 [debug] [MainThread]: Connection 'model.dbt_lead_data.trusted_technical_data' was properly closed.
[0m10:20:06.131236 [info ] [MainThread]: 
[0m10:20:06.132098 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 5.69 seconds (5.69s).
[0m10:20:06.133897 [debug] [MainThread]: Command end result
[0m10:20:06.189861 [info ] [MainThread]: 
[0m10:20:06.191268 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:20:06.192205 [info ] [MainThread]: 
[0m10:20:06.193116 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m10:20:06.195113 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.4160423, "process_user_time": 2.671292, "process_kernel_time": 0.144559, "process_mem_max_rss": "121344", "process_in_blocks": "1872", "process_out_blocks": "0"}
[0m10:20:06.195934 [debug] [MainThread]: Command `dbt run` succeeded at 10:20:06.195806 after 6.42 seconds
[0m10:20:06.196620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47f8bd5460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47f8dbb410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47f8e65f40>]}
[0m10:20:06.197320 [debug] [MainThread]: Flushing usage events
[0m10:21:12.152186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb66b382ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6693e2750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6693e1550>]}


============================== 10:21:12.159235 | 5f715d64-4b75-4215-a1f2-a3e7631308f9 ==============================
[0m10:21:12.159235 [info ] [MainThread]: Running with dbt=1.8.0
[0m10:21:12.160235 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select tag:staging', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:21:12.364994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f715d64-4b75-4215-a1f2-a3e7631308f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb66ab868a0>]}
[0m10:21:12.430436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f715d64-4b75-4215-a1f2-a3e7631308f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb669dcdc10>]}
[0m10:21:12.431790 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:21:12.517830 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m10:21:12.656657 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:21:12.658120 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:21:12.699433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f715d64-4b75-4215-a1f2-a3e7631308f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb66813ce00>]}
[0m10:21:12.820914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f715d64-4b75-4215-a1f2-a3e7631308f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb668171820>]}
[0m10:21:12.821636 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m10:21:12.822271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f715d64-4b75-4215-a1f2-a3e7631308f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb667d9dd90>]}
[0m10:21:12.824700 [info ] [MainThread]: 
[0m10:21:12.825596 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:21:12.830974 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m10:21:12.869207 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m10:21:12.870039 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m10:21:12.870711 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:21:12.875670 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.005 seconds
[0m10:21:12.877682 [debug] [ThreadPool]: On list_airflow: Close
[0m10:21:12.880127 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_trusted)
[0m10:21:12.886795 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m10:21:12.887523 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m10:21:12.888116 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:21:12.892022 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m10:21:12.892786 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m10:21:12.893519 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m10:21:12.896768 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m10:21:12.898742 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m10:21:12.899638 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m10:21:12.900654 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now list_airflow_lead_staging)
[0m10:21:12.903940 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m10:21:12.904613 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m10:21:12.905212 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:21:12.908991 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m10:21:12.909680 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m10:21:12.910274 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m10:21:12.913275 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m10:21:12.915038 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m10:21:12.915853 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m10:21:12.922902 [debug] [MainThread]: Using postgres connection "master"
[0m10:21:12.923645 [debug] [MainThread]: On master: BEGIN
[0m10:21:12.924292 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:21:12.928124 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m10:21:12.928841 [debug] [MainThread]: Using postgres connection "master"
[0m10:21:12.929612 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:21:12.933068 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m10:21:12.934957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f715d64-4b75-4215-a1f2-a3e7631308f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6698b7020>]}
[0m10:21:12.935798 [debug] [MainThread]: On master: ROLLBACK
[0m10:21:12.936673 [debug] [MainThread]: Using postgres connection "master"
[0m10:21:12.937338 [debug] [MainThread]: On master: BEGIN
[0m10:21:12.938394 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:21:12.939069 [debug] [MainThread]: On master: COMMIT
[0m10:21:12.939817 [debug] [MainThread]: Using postgres connection "master"
[0m10:21:12.940509 [debug] [MainThread]: On master: COMMIT
[0m10:21:12.941301 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:21:12.941983 [debug] [MainThread]: On master: Close
[0m10:21:12.942820 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:21:12.943559 [info ] [MainThread]: 
[0m10:21:12.953567 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_adress
[0m10:21:12.954642 [info ] [Thread-1 (]: 1 of 5 START sql table model lead_staging.dim_address .......................... [RUN]
[0m10:21:12.955602 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now model.dbt_lead_data.staging_dim_adress)
[0m10:21:12.956316 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_adress
[0m10:21:12.964934 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_adress"
[0m10:21:12.967498 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_adress
[0m10:21:13.007914 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_adress"
[0m10:21:13.009921 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m10:21:13.010564 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: BEGIN
[0m10:21:13.011112 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:21:13.014916 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m10:21:13.015554 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m10:21:13.016256 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */

  
    

  create  table "airflow"."lead_staging"."dim_address__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        address,
        mac_address,
        ip_address
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:21:13.118302 [debug] [Thread-1 (]: SQL status: SELECT 102322 in 0.101 seconds
[0m10:21:13.126059 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m10:21:13.126954 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
alter table "airflow"."lead_staging"."dim_address" rename to "dim_address__dbt_backup"
[0m10:21:13.128204 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:21:13.131820 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m10:21:13.132609 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
alter table "airflow"."lead_staging"."dim_address__dbt_tmp" rename to "dim_address"
[0m10:21:13.133781 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:21:13.154784 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m10:21:13.155563 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m10:21:13.156566 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m10:21:13.166535 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m10:21:13.173368 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_address__dbt_backup"
[0m10:21:13.179777 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m10:21:13.180584 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
drop table if exists "airflow"."lead_staging"."dim_address__dbt_backup" cascade
[0m10:21:13.184114 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m10:21:13.187011 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: Close
[0m10:21:13.188909 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f715d64-4b75-4215-a1f2-a3e7631308f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb66a619cd0>]}
[0m10:21:13.189948 [info ] [Thread-1 (]: 1 of 5 OK created sql table model lead_staging.dim_address ..................... [[32mSELECT 102322[0m in 0.23s]
[0m10:21:13.191050 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_adress
[0m10:21:13.191898 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_date
[0m10:21:13.192824 [info ] [Thread-1 (]: 2 of 5 START sql table model lead_staging.dim_date ............................. [RUN]
[0m10:21:13.193681 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_adress, now model.dbt_lead_data.staging_dim_date)
[0m10:21:13.194374 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_date
[0m10:21:13.197996 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_date"
[0m10:21:13.199888 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_date
[0m10:21:13.203897 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_date"
[0m10:21:13.205629 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m10:21:13.206321 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: BEGIN
[0m10:21:13.207052 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:21:13.211725 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m10:21:13.212618 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m10:21:13.213331 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */

  
    

  create  table "airflow"."lead_staging"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        accessed_at
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:21:13.318859 [debug] [Thread-1 (]: SQL status: SELECT 102322 in 0.105 seconds
[0m10:21:13.322738 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m10:21:13.323749 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
alter table "airflow"."lead_staging"."dim_date" rename to "dim_date__dbt_backup"
[0m10:21:13.324966 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:21:13.328268 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m10:21:13.329040 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
alter table "airflow"."lead_staging"."dim_date__dbt_tmp" rename to "dim_date"
[0m10:21:13.330136 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:21:13.332585 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: COMMIT
[0m10:21:13.333380 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m10:21:13.334161 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: COMMIT
[0m10:21:13.337014 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m10:21:13.339826 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_date__dbt_backup"
[0m10:21:13.341010 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m10:21:13.341753 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
drop table if exists "airflow"."lead_staging"."dim_date__dbt_backup" cascade
[0m10:21:13.344863 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m10:21:13.346670 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: Close
[0m10:21:13.347600 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f715d64-4b75-4215-a1f2-a3e7631308f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6660b03e0>]}
[0m10:21:13.348561 [info ] [Thread-1 (]: 2 of 5 OK created sql table model lead_staging.dim_date ........................ [[32mSELECT 102322[0m in 0.15s]
[0m10:21:13.349718 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_date
[0m10:21:13.350553 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_finance
[0m10:21:13.351362 [info ] [Thread-1 (]: 3 of 5 START sql table model lead_staging.dim_finance .......................... [RUN]
[0m10:21:13.352220 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_date, now model.dbt_lead_data.staging_dim_finance)
[0m10:21:13.352898 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_finance
[0m10:21:13.356382 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_finance"
[0m10:21:13.358257 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_finance
[0m10:21:13.363531 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_finance"
[0m10:21:13.365493 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m10:21:13.366174 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: BEGIN
[0m10:21:13.366847 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:21:13.371140 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m10:21:13.371926 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m10:21:13.372692 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */

  
    

  create  table "airflow"."lead_staging"."dim_finance__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        iban
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:21:13.447928 [debug] [Thread-1 (]: SQL status: SELECT 102322 in 0.074 seconds
[0m10:21:13.451574 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m10:21:13.452390 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
alter table "airflow"."lead_staging"."dim_finance" rename to "dim_finance__dbt_backup"
[0m10:21:13.453663 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:21:13.457307 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m10:21:13.458116 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
alter table "airflow"."lead_staging"."dim_finance__dbt_tmp" rename to "dim_finance"
[0m10:21:13.459266 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:21:13.461823 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: COMMIT
[0m10:21:13.462626 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m10:21:13.463352 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: COMMIT
[0m10:21:13.489260 [debug] [Thread-1 (]: SQL status: COMMIT in 0.025 seconds
[0m10:21:13.492492 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_finance__dbt_backup"
[0m10:21:13.493912 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m10:21:13.494658 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
drop table if exists "airflow"."lead_staging"."dim_finance__dbt_backup" cascade
[0m10:21:13.498114 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m10:21:13.500030 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: Close
[0m10:21:13.500995 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f715d64-4b75-4215-a1f2-a3e7631308f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6660e17c0>]}
[0m10:21:13.502022 [info ] [Thread-1 (]: 3 of 5 OK created sql table model lead_staging.dim_finance ..................... [[32mSELECT 102322[0m in 0.15s]
[0m10:21:13.503103 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_finance
[0m10:21:13.504026 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_person
[0m10:21:13.504970 [info ] [Thread-1 (]: 4 of 5 START sql table model lead_staging.dim_person ........................... [RUN]
[0m10:21:13.505844 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_finance, now model.dbt_lead_data.staging_dim_person)
[0m10:21:13.506615 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_person
[0m10:21:13.510344 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_person"
[0m10:21:13.512609 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_person
[0m10:21:13.517010 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_person"
[0m10:21:13.519100 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m10:21:13.519857 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: BEGIN
[0m10:21:13.520569 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:21:13.525224 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m10:21:13.526340 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m10:21:13.527220 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */

  
    

  create  table "airflow"."lead_staging"."dim_person__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        person_name,
        user_name,
        email,
        phone,
        birth_date,
        personal_number
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:21:13.647161 [debug] [Thread-1 (]: SQL status: SELECT 102322 in 0.119 seconds
[0m10:21:13.651341 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m10:21:13.652309 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
alter table "airflow"."lead_staging"."dim_person" rename to "dim_person__dbt_backup"
[0m10:21:13.653672 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:21:13.657316 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m10:21:13.658170 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
alter table "airflow"."lead_staging"."dim_person__dbt_tmp" rename to "dim_person"
[0m10:21:13.659428 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:21:13.661864 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: COMMIT
[0m10:21:13.662598 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m10:21:13.663261 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: COMMIT
[0m10:21:13.752989 [debug] [Thread-1 (]: SQL status: COMMIT in 0.089 seconds
[0m10:21:13.756210 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_person__dbt_backup"
[0m10:21:13.757479 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m10:21:13.758280 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
drop table if exists "airflow"."lead_staging"."dim_person__dbt_backup" cascade
[0m10:21:13.762291 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m10:21:13.764298 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: Close
[0m10:21:13.765303 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f715d64-4b75-4215-a1f2-a3e7631308f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6660dae40>]}
[0m10:21:13.766299 [info ] [Thread-1 (]: 4 of 5 OK created sql table model lead_staging.dim_person ...................... [[32mSELECT 102322[0m in 0.26s]
[0m10:21:13.767338 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_person
[0m10:21:13.768180 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_fact_network_usage
[0m10:21:13.769090 [info ] [Thread-1 (]: 5 of 5 START sql table model lead_staging.fact_network_usage ................... [RUN]
[0m10:21:13.769950 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_person, now model.dbt_lead_data.staging_fact_network_usage)
[0m10:21:13.770718 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_fact_network_usage
[0m10:21:13.774666 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_fact_network_usage"
[0m10:21:13.776675 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_fact_network_usage
[0m10:21:13.780728 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_fact_network_usage"
[0m10:21:13.782839 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m10:21:13.783622 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: BEGIN
[0m10:21:13.784274 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:21:13.788900 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m10:21:13.789743 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m10:21:13.790525 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */

  
    

  create  table "airflow"."lead_staging"."fact_network_usage__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        session_duration,
        download_speed,
        upload_speed,
        consumed_traffic
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:21:13.876282 [debug] [Thread-1 (]: SQL status: SELECT 102322 in 0.085 seconds
[0m10:21:13.881558 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m10:21:13.882618 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
alter table "airflow"."lead_staging"."fact_network_usage" rename to "fact_network_usage__dbt_backup"
[0m10:21:13.884009 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:21:13.887643 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m10:21:13.888519 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
alter table "airflow"."lead_staging"."fact_network_usage__dbt_tmp" rename to "fact_network_usage"
[0m10:21:13.889992 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:21:13.892516 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: COMMIT
[0m10:21:13.893435 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m10:21:13.894416 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: COMMIT
[0m10:21:13.898762 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m10:21:13.902136 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."fact_network_usage__dbt_backup"
[0m10:21:13.903481 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m10:21:13.904639 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
drop table if exists "airflow"."lead_staging"."fact_network_usage__dbt_backup" cascade
[0m10:21:13.908628 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m10:21:13.910804 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: Close
[0m10:21:13.911846 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f715d64-4b75-4215-a1f2-a3e7631308f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb66608fb90>]}
[0m10:21:13.912837 [info ] [Thread-1 (]: 5 of 5 OK created sql table model lead_staging.fact_network_usage .............. [[32mSELECT 102322[0m in 0.14s]
[0m10:21:13.913899 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_fact_network_usage
[0m10:21:13.917044 [debug] [MainThread]: Using postgres connection "master"
[0m10:21:13.917928 [debug] [MainThread]: On master: BEGIN
[0m10:21:13.918738 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:21:13.922830 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m10:21:13.923701 [debug] [MainThread]: On master: COMMIT
[0m10:21:13.924398 [debug] [MainThread]: Using postgres connection "master"
[0m10:21:13.925181 [debug] [MainThread]: On master: COMMIT
[0m10:21:13.926065 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:21:13.926796 [debug] [MainThread]: On master: Close
[0m10:21:13.927686 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:21:13.928300 [debug] [MainThread]: Connection 'model.dbt_lead_data.staging_fact_network_usage' was properly closed.
[0m10:21:13.929138 [info ] [MainThread]: 
[0m10:21:13.929914 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 1.10 seconds (1.10s).
[0m10:21:13.932014 [debug] [MainThread]: Command end result
[0m10:21:13.984125 [info ] [MainThread]: 
[0m10:21:13.984999 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:21:13.985788 [info ] [MainThread]: 
[0m10:21:13.986828 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m10:21:13.988196 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.9124242, "process_user_time": 3.025287, "process_kernel_time": 0.201617, "process_mem_max_rss": "123304", "process_in_blocks": "88", "process_out_blocks": "0"}
[0m10:21:13.989115 [debug] [MainThread]: Command `dbt run` succeeded at 10:21:13.988977 after 1.91 seconds
[0m10:21:13.989906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb668170e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6690e6570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6690e66c0>]}
[0m10:21:13.990640 [debug] [MainThread]: Flushing usage events
[0m10:21:17.733718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1759546840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1759dd9dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f175bcfbc20>]}


============================== 10:21:17.740366 | d005425c-2a41-4739-922f-7f2625483126 ==============================
[0m10:21:17.740366 [info ] [MainThread]: Running with dbt=1.8.0
[0m10:21:17.741577 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select tag:trusted', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:21:17.933426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd005425c-2a41-4739-922f-7f2625483126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f175a491c40>]}
[0m10:21:17.998596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd005425c-2a41-4739-922f-7f2625483126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1759593e30>]}
[0m10:21:18.000283 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:21:18.088341 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m10:21:18.203937 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:21:18.204609 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:21:18.239573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd005425c-2a41-4739-922f-7f2625483126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1758579070>]}
[0m10:21:18.359135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd005425c-2a41-4739-922f-7f2625483126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17585bda90>]}
[0m10:21:18.359801 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m10:21:18.360388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd005425c-2a41-4739-922f-7f2625483126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f175856fd70>]}
[0m10:21:18.362710 [info ] [MainThread]: 
[0m10:21:18.363698 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:21:18.368604 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m10:21:18.403749 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m10:21:18.404438 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m10:21:18.405057 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:21:18.410368 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.005 seconds
[0m10:21:18.412140 [debug] [ThreadPool]: On list_airflow: Close
[0m10:21:18.414693 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_staging)
[0m10:21:18.421145 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m10:21:18.421918 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m10:21:18.422542 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:21:18.426661 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m10:21:18.427318 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m10:21:18.428005 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m10:21:18.431035 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m10:21:18.432805 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m10:21:18.433672 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m10:21:18.434709 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now list_airflow_lead_trusted)
[0m10:21:18.438046 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m10:21:18.438739 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m10:21:18.439342 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:21:18.443189 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m10:21:18.443991 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m10:21:18.444688 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m10:21:18.447628 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m10:21:18.449397 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m10:21:18.450159 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m10:21:18.457087 [debug] [MainThread]: Using postgres connection "master"
[0m10:21:18.457819 [debug] [MainThread]: On master: BEGIN
[0m10:21:18.458460 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:21:18.462634 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m10:21:18.463341 [debug] [MainThread]: Using postgres connection "master"
[0m10:21:18.464107 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:21:18.467405 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m10:21:18.469229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd005425c-2a41-4739-922f-7f2625483126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f175a831c10>]}
[0m10:21:18.470070 [debug] [MainThread]: On master: ROLLBACK
[0m10:21:18.470974 [debug] [MainThread]: Using postgres connection "master"
[0m10:21:18.471710 [debug] [MainThread]: On master: BEGIN
[0m10:21:18.472786 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:21:18.473583 [debug] [MainThread]: On master: COMMIT
[0m10:21:18.474311 [debug] [MainThread]: Using postgres connection "master"
[0m10:21:18.475075 [debug] [MainThread]: On master: COMMIT
[0m10:21:18.475928 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:21:18.476621 [debug] [MainThread]: On master: Close
[0m10:21:18.477555 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:21:18.478277 [info ] [MainThread]: 
[0m10:21:18.488057 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_non_pii_data
[0m10:21:18.488946 [info ] [Thread-1 (]: 1 of 4 START sql table model lead_trusted.non_pii_data ......................... [RUN]
[0m10:21:18.489858 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now model.dbt_lead_data.trusted_non_pii_data)
[0m10:21:18.490581 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_non_pii_data
[0m10:21:18.500639 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_non_pii_data"
[0m10:21:18.502911 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_non_pii_data
[0m10:21:18.543780 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_non_pii_data"
[0m10:21:18.546248 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m10:21:18.546848 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: BEGIN
[0m10:21:18.547407 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:21:18.551228 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m10:21:18.551905 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m10:21:18.552575 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */

  
    

  create  table "airflow"."lead_trusted"."non_pii_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        '***MASKED***' AS person_name,
        SUBSTRING(dp.user_name, 1, 5) || '*****'  user_name,
        SUBSTRING(dp.email, 1, 5) || '*****' AS email,
        '***MASKED***'  AS personal_number, 
        '***MASKED***' AS birth_date, 
        '***MASKED***' AS address,
        '***MASKED***'  AS phone, 
        SUBSTRING(da.mac_address, 1, 5) || '*****' AS mac_address,
        SUBSTRING(da.ip_address, 1, 5) || '*****' AS ip_address,
        SUBSTRING(df.iban, 1, 5) || '*****' AS iban,
        dd.accessed_at,
        fnu.session_duration,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.consumed_traffic,
        fnu.unique_id
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    INNER JOIN
        "airflow"."lead_staging"."dim_address" da ON fnu.unique_id = da.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_date" dd ON da.unique_id = dd.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_finance" df ON dd.unique_id = df.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_person" dp ON df.unique_id = dp.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:21:20.326311 [debug] [Thread-1 (]: SQL status: SELECT 102322 in 1.773 seconds
[0m10:21:20.332654 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m10:21:20.333389 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
alter table "airflow"."lead_trusted"."non_pii_data" rename to "non_pii_data__dbt_backup"
[0m10:21:20.334578 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:21:20.337675 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m10:21:20.338317 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
alter table "airflow"."lead_trusted"."non_pii_data__dbt_tmp" rename to "non_pii_data"
[0m10:21:20.339360 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:21:20.359221 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: COMMIT
[0m10:21:20.360018 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m10:21:20.360590 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: COMMIT
[0m10:21:20.367254 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m10:21:20.374127 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."non_pii_data__dbt_backup"
[0m10:21:20.380174 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m10:21:20.380896 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
drop table if exists "airflow"."lead_trusted"."non_pii_data__dbt_backup" cascade
[0m10:21:20.385565 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m10:21:20.388494 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: Close
[0m10:21:20.390321 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd005425c-2a41-4739-922f-7f2625483126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f175aa2dcd0>]}
[0m10:21:20.391333 [info ] [Thread-1 (]: 1 of 4 OK created sql table model lead_trusted.non_pii_data .................... [[32mSELECT 102322[0m in 1.90s]
[0m10:21:20.392533 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_non_pii_data
[0m10:21:20.393380 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_payment_data
[0m10:21:20.394268 [info ] [Thread-1 (]: 2 of 4 START sql table model lead_trusted.payment_data ......................... [RUN]
[0m10:21:20.395090 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_non_pii_data, now model.dbt_lead_data.trusted_payment_data)
[0m10:21:20.395815 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_payment_data
[0m10:21:20.399711 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_payment_data"
[0m10:21:20.401902 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_payment_data
[0m10:21:20.405823 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_payment_data"
[0m10:21:20.408031 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m10:21:20.408719 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: BEGIN
[0m10:21:20.409341 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:21:20.413875 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m10:21:20.414743 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m10:21:20.415441 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */

  
    

  create  table "airflow"."lead_trusted"."payment_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        fnu.unique_id,
        df.iban,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.session_duration,
        fnu.consumed_traffic,
        ((fnu.download_speed + fnu.upload_speed + 1)/2) + (fnu.consumed_traffic / (fnu.session_duration + 1)) AS payment_amount
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    JOIN
        "airflow"."lead_staging"."dim_finance" df
    ON
	    fnu.unique_id = df.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:21:20.957407 [debug] [Thread-1 (]: SQL status: SELECT 102322 in 0.541 seconds
[0m10:21:20.961881 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m10:21:20.962898 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
alter table "airflow"."lead_trusted"."payment_data" rename to "payment_data__dbt_backup"
[0m10:21:20.964135 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:21:20.968038 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m10:21:20.968989 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
alter table "airflow"."lead_trusted"."payment_data__dbt_tmp" rename to "payment_data"
[0m10:21:20.970135 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:21:20.972842 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: COMMIT
[0m10:21:20.973700 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m10:21:20.974398 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: COMMIT
[0m10:21:20.977891 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m10:21:20.980964 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."payment_data__dbt_backup"
[0m10:21:20.982184 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m10:21:20.982942 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
drop table if exists "airflow"."lead_trusted"."payment_data__dbt_backup" cascade
[0m10:21:20.986731 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m10:21:20.988807 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: Close
[0m10:21:20.990219 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd005425c-2a41-4739-922f-7f2625483126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1756333fe0>]}
[0m10:21:20.991447 [info ] [Thread-1 (]: 2 of 4 OK created sql table model lead_trusted.payment_data .................... [[32mSELECT 102322[0m in 0.60s]
[0m10:21:20.992722 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_payment_data
[0m10:21:20.993509 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_pii_data
[0m10:21:20.994459 [info ] [Thread-1 (]: 3 of 4 START sql table model lead_trusted.pii_data ............................. [RUN]
[0m10:21:20.995494 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_payment_data, now model.dbt_lead_data.trusted_pii_data)
[0m10:21:20.996291 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_pii_data
[0m10:21:21.002691 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_pii_data"
[0m10:21:21.005113 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_pii_data
[0m10:21:21.011808 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_pii_data"
[0m10:21:21.013618 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m10:21:21.014462 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: BEGIN
[0m10:21:21.015178 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:21:21.020000 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m10:21:21.020773 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m10:21:21.021511 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */

  
    

  create  table "airflow"."lead_trusted"."pii_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        dp.person_name,
        dp.user_name,
        dp.email,
        dp.personal_number, 
        dp.birth_date, 
        da.address,
        dp.phone, 
        da.mac_address,
        da.ip_address,
        df.iban,
        dd.accessed_at,
        fnu.session_duration,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.consumed_traffic,
        fnu.unique_id
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    INNER JOIN
        "airflow"."lead_staging"."dim_address" da ON fnu.unique_id = da.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_date" dd ON da.unique_id = dd.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_finance" df ON dd.unique_id = df.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_person" dp ON df.unique_id = dp.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:21:22.966749 [debug] [Thread-1 (]: SQL status: SELECT 102322 in 1.944 seconds
[0m10:21:22.970193 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m10:21:22.971116 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */
alter table "airflow"."lead_trusted"."pii_data" rename to "pii_data__dbt_backup"
[0m10:21:22.972387 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:21:22.975913 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m10:21:22.976674 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */
alter table "airflow"."lead_trusted"."pii_data__dbt_tmp" rename to "pii_data"
[0m10:21:22.977725 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:21:22.980534 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: COMMIT
[0m10:21:22.981427 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m10:21:22.982233 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: COMMIT
[0m10:21:23.007565 [debug] [Thread-1 (]: SQL status: COMMIT in 0.024 seconds
[0m10:21:23.011223 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."pii_data__dbt_backup"
[0m10:21:23.012540 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m10:21:23.013356 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */
drop table if exists "airflow"."lead_trusted"."pii_data__dbt_backup" cascade
[0m10:21:23.019776 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m10:21:23.021917 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: Close
[0m10:21:23.023037 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd005425c-2a41-4739-922f-7f2625483126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1756339bb0>]}
[0m10:21:23.024102 [info ] [Thread-1 (]: 3 of 4 OK created sql table model lead_trusted.pii_data ........................ [[32mSELECT 102322[0m in 2.03s]
[0m10:21:23.025365 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_pii_data
[0m10:21:23.026237 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_technical_data
[0m10:21:23.027182 [info ] [Thread-1 (]: 4 of 4 START sql table model lead_trusted.technical_data ....................... [RUN]
[0m10:21:23.028086 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_pii_data, now model.dbt_lead_data.trusted_technical_data)
[0m10:21:23.028891 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_technical_data
[0m10:21:23.033026 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_technical_data"
[0m10:21:23.035542 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_technical_data
[0m10:21:23.040062 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_technical_data"
[0m10:21:23.042407 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m10:21:23.043213 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: BEGIN
[0m10:21:23.044039 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:21:23.048687 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m10:21:23.049533 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m10:21:23.050382 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */

  
    

  create  table "airflow"."lead_trusted"."technical_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        fnu.unique_id,
        da.address,
        da.mac_address,
        da.ip_address,
        fnu.download_speed,
        fnu.upload_speed,
        ROUND((fnu.session_duration/60), 1) as min_session_duration,
        CASE 
            WHEN fnu.download_speed < 50 OR fnu.upload_speed < 30 OR fnu.session_duration/60 < 1 THEN true
            ELSE false
        END AS technical_issue
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    JOIN
        "airflow"."lead_staging"."dim_address" da
    ON
	    fnu.unique_id = da.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:21:23.620117 [debug] [Thread-1 (]: SQL status: SELECT 102322 in 0.569 seconds
[0m10:21:23.623852 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m10:21:23.624629 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
alter table "airflow"."lead_trusted"."technical_data" rename to "technical_data__dbt_backup"
[0m10:21:23.625795 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:21:23.629070 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m10:21:23.629899 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
alter table "airflow"."lead_trusted"."technical_data__dbt_tmp" rename to "technical_data"
[0m10:21:23.631014 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:21:23.633395 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: COMMIT
[0m10:21:23.634191 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m10:21:23.634987 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: COMMIT
[0m10:21:23.640725 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m10:21:23.643662 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."technical_data__dbt_backup"
[0m10:21:23.644851 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m10:21:23.645533 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
drop table if exists "airflow"."lead_trusted"."technical_data__dbt_backup" cascade
[0m10:21:23.649828 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m10:21:23.651643 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: Close
[0m10:21:23.652540 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd005425c-2a41-4739-922f-7f2625483126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17564d40e0>]}
[0m10:21:23.653455 [info ] [Thread-1 (]: 4 of 4 OK created sql table model lead_trusted.technical_data .................. [[32mSELECT 102322[0m in 0.62s]
[0m10:21:23.654581 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_technical_data
[0m10:21:23.656840 [debug] [MainThread]: Using postgres connection "master"
[0m10:21:23.657565 [debug] [MainThread]: On master: BEGIN
[0m10:21:23.658199 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:21:23.662294 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m10:21:23.663001 [debug] [MainThread]: On master: COMMIT
[0m10:21:23.663681 [debug] [MainThread]: Using postgres connection "master"
[0m10:21:23.664254 [debug] [MainThread]: On master: COMMIT
[0m10:21:23.665171 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:21:23.665846 [debug] [MainThread]: On master: Close
[0m10:21:23.666786 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:21:23.667471 [debug] [MainThread]: Connection 'model.dbt_lead_data.trusted_technical_data' was properly closed.
[0m10:21:23.668201 [info ] [MainThread]: 
[0m10:21:23.669072 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 5.30 seconds (5.30s).
[0m10:21:23.670986 [debug] [MainThread]: Command end result
[0m10:21:23.725093 [info ] [MainThread]: 
[0m10:21:23.726013 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:21:23.726909 [info ] [MainThread]: 
[0m10:21:23.728001 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m10:21:23.729538 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.054205, "process_user_time": 2.839505, "process_kernel_time": 0.152476, "process_mem_max_rss": "121576", "process_in_blocks": "488", "process_out_blocks": "0"}
[0m10:21:23.730488 [debug] [MainThread]: Command `dbt run` succeeded at 10:21:23.730359 after 6.06 seconds
[0m10:21:23.731203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1759772540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1759833bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1756347a70>]}
[0m10:21:23.731966 [debug] [MainThread]: Flushing usage events
[0m10:23:19.368852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34310bbbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f343199af00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3430d7e840>]}


============================== 10:23:19.376686 | 3a9fa2a4-e393-4a1c-bda2-7759d513ccdd ==============================
[0m10:23:19.376686 [info ] [MainThread]: Running with dbt=1.8.0
[0m10:23:19.377754 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select tag:staging', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:23:19.667759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a9fa2a4-e393-4a1c-bda2-7759d513ccdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3431c8ef30>]}
[0m10:23:19.747085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3a9fa2a4-e393-4a1c-bda2-7759d513ccdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34308c56a0>]}
[0m10:23:19.748419 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:23:19.851598 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m10:23:20.005697 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:23:20.006770 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:23:20.050765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3a9fa2a4-e393-4a1c-bda2-7759d513ccdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34315a88c0>]}
[0m10:23:20.214954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3a9fa2a4-e393-4a1c-bda2-7759d513ccdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f342fdc1340>]}
[0m10:23:20.216570 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m10:23:20.217657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a9fa2a4-e393-4a1c-bda2-7759d513ccdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f342fd8db50>]}
[0m10:23:20.220734 [info ] [MainThread]: 
[0m10:23:20.221965 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:23:20.228925 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m10:23:20.281866 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m10:23:20.282729 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m10:23:20.283596 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:23:20.290848 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.007 seconds
[0m10:23:20.293862 [debug] [ThreadPool]: On list_airflow: Close
[0m10:23:20.297633 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_staging)
[0m10:23:20.306477 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m10:23:20.308289 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m10:23:20.309564 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:23:20.315360 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m10:23:20.316435 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m10:23:20.317326 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m10:23:20.320879 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.003 seconds
[0m10:23:20.323052 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m10:23:20.324290 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m10:23:20.325575 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now list_airflow_lead_trusted)
[0m10:23:20.329232 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m10:23:20.330342 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m10:23:20.331311 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:23:20.335996 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m10:23:20.337015 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m10:23:20.337826 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m10:23:20.341842 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m10:23:20.343947 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m10:23:20.345097 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m10:23:20.355935 [debug] [MainThread]: Using postgres connection "master"
[0m10:23:20.356992 [debug] [MainThread]: On master: BEGIN
[0m10:23:20.357872 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:23:20.362486 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m10:23:20.363407 [debug] [MainThread]: Using postgres connection "master"
[0m10:23:20.364391 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:23:20.368437 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m10:23:20.371103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a9fa2a4-e393-4a1c-bda2-7759d513ccdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f342ddec920>]}
[0m10:23:20.372415 [debug] [MainThread]: On master: ROLLBACK
[0m10:23:20.373803 [debug] [MainThread]: Using postgres connection "master"
[0m10:23:20.374893 [debug] [MainThread]: On master: BEGIN
[0m10:23:20.376383 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m10:23:20.377143 [debug] [MainThread]: On master: COMMIT
[0m10:23:20.378088 [debug] [MainThread]: Using postgres connection "master"
[0m10:23:20.378927 [debug] [MainThread]: On master: COMMIT
[0m10:23:20.379998 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:23:20.380837 [debug] [MainThread]: On master: Close
[0m10:23:20.381847 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:23:20.382758 [info ] [MainThread]: 
[0m10:23:20.397565 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_adress
[0m10:23:20.399121 [info ] [Thread-1 (]: 1 of 5 START sql table model lead_staging.dim_address .......................... [RUN]
[0m10:23:20.400200 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now model.dbt_lead_data.staging_dim_adress)
[0m10:23:20.401167 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_adress
[0m10:23:20.412596 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_adress"
[0m10:23:20.415416 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_adress
[0m10:23:20.464920 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_adress"
[0m10:23:20.467915 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m10:23:20.468831 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: BEGIN
[0m10:23:20.469631 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:23:20.474804 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m10:23:20.475939 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m10:23:20.476891 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */

  
    

  create  table "airflow"."lead_staging"."dim_address__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        address,
        mac_address,
        ip_address
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:23:20.742111 [debug] [Thread-1 (]: SQL status: SELECT 202694 in 0.264 seconds
[0m10:23:20.749675 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m10:23:20.750513 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
alter table "airflow"."lead_staging"."dim_address" rename to "dim_address__dbt_backup"
[0m10:23:20.751903 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:23:20.755580 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m10:23:20.756383 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
alter table "airflow"."lead_staging"."dim_address__dbt_tmp" rename to "dim_address"
[0m10:23:20.757558 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:23:20.780028 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m10:23:20.780990 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m10:23:20.781818 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m10:23:20.804419 [debug] [Thread-1 (]: SQL status: COMMIT in 0.022 seconds
[0m10:23:20.811491 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_address__dbt_backup"
[0m10:23:20.817964 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m10:23:20.818707 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
drop table if exists "airflow"."lead_staging"."dim_address__dbt_backup" cascade
[0m10:23:20.823115 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m10:23:20.826088 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: Close
[0m10:23:20.827999 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a9fa2a4-e393-4a1c-bda2-7759d513ccdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3432275d60>]}
[0m10:23:20.828966 [info ] [Thread-1 (]: 1 of 5 OK created sql table model lead_staging.dim_address ..................... [[32mSELECT 202694[0m in 0.43s]
[0m10:23:20.830034 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_adress
[0m10:23:20.830883 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_date
[0m10:23:20.831745 [info ] [Thread-1 (]: 2 of 5 START sql table model lead_staging.dim_date ............................. [RUN]
[0m10:23:20.832603 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_adress, now model.dbt_lead_data.staging_dim_date)
[0m10:23:20.833321 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_date
[0m10:23:20.836895 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_date"
[0m10:23:20.839311 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_date
[0m10:23:20.843251 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_date"
[0m10:23:20.845151 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m10:23:20.845858 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: BEGIN
[0m10:23:20.846566 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:23:20.850975 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m10:23:20.851809 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m10:23:20.852570 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */

  
    

  create  table "airflow"."lead_staging"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        accessed_at
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:23:21.035517 [debug] [Thread-1 (]: SQL status: SELECT 202694 in 0.182 seconds
[0m10:23:21.039750 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m10:23:21.040697 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
alter table "airflow"."lead_staging"."dim_date" rename to "dim_date__dbt_backup"
[0m10:23:21.042067 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:23:21.045760 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m10:23:21.046617 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
alter table "airflow"."lead_staging"."dim_date__dbt_tmp" rename to "dim_date"
[0m10:23:21.047909 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:23:21.050384 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: COMMIT
[0m10:23:21.051233 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m10:23:21.052056 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: COMMIT
[0m10:23:21.058503 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m10:23:21.061768 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_date__dbt_backup"
[0m10:23:21.063075 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m10:23:21.063855 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
drop table if exists "airflow"."lead_staging"."dim_date__dbt_backup" cascade
[0m10:23:21.066377 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m10:23:21.068470 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: Close
[0m10:23:21.069522 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a9fa2a4-e393-4a1c-bda2-7759d513ccdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f342ddde120>]}
[0m10:23:21.070500 [info ] [Thread-1 (]: 2 of 5 OK created sql table model lead_staging.dim_date ........................ [[32mSELECT 202694[0m in 0.24s]
[0m10:23:21.071431 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_date
[0m10:23:21.072218 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_finance
[0m10:23:21.073181 [info ] [Thread-1 (]: 3 of 5 START sql table model lead_staging.dim_finance .......................... [RUN]
[0m10:23:21.074107 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_date, now model.dbt_lead_data.staging_dim_finance)
[0m10:23:21.074783 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_finance
[0m10:23:21.078677 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_finance"
[0m10:23:21.080571 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_finance
[0m10:23:21.086688 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_finance"
[0m10:23:21.088708 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m10:23:21.089462 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: BEGIN
[0m10:23:21.090146 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:23:21.095895 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m10:23:21.096648 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m10:23:21.097594 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */

  
    

  create  table "airflow"."lead_staging"."dim_finance__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        iban
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:23:21.311600 [debug] [Thread-1 (]: SQL status: SELECT 202694 in 0.213 seconds
[0m10:23:21.315688 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m10:23:21.316557 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
alter table "airflow"."lead_staging"."dim_finance" rename to "dim_finance__dbt_backup"
[0m10:23:21.317988 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:23:21.321957 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m10:23:21.322927 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
alter table "airflow"."lead_staging"."dim_finance__dbt_tmp" rename to "dim_finance"
[0m10:23:21.324192 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:23:21.326705 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: COMMIT
[0m10:23:21.327553 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m10:23:21.328316 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: COMMIT
[0m10:23:21.332746 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m10:23:21.336032 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_finance__dbt_backup"
[0m10:23:21.337457 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m10:23:21.338206 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
drop table if exists "airflow"."lead_staging"."dim_finance__dbt_backup" cascade
[0m10:23:21.341164 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m10:23:21.343241 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: Close
[0m10:23:21.344259 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a9fa2a4-e393-4a1c-bda2-7759d513ccdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f342fd70e90>]}
[0m10:23:21.345191 [info ] [Thread-1 (]: 3 of 5 OK created sql table model lead_staging.dim_finance ..................... [[32mSELECT 202694[0m in 0.27s]
[0m10:23:21.346198 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_finance
[0m10:23:21.346971 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_person
[0m10:23:21.347760 [info ] [Thread-1 (]: 4 of 5 START sql table model lead_staging.dim_person ........................... [RUN]
[0m10:23:21.348655 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_finance, now model.dbt_lead_data.staging_dim_person)
[0m10:23:21.349370 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_person
[0m10:23:21.353222 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_person"
[0m10:23:21.355482 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_person
[0m10:23:21.360529 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_person"
[0m10:23:21.362370 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m10:23:21.363206 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: BEGIN
[0m10:23:21.363954 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:23:21.368928 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m10:23:21.369730 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m10:23:21.370468 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */

  
    

  create  table "airflow"."lead_staging"."dim_person__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        person_name,
        user_name,
        email,
        phone,
        birth_date,
        personal_number
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:23:21.739350 [debug] [Thread-1 (]: SQL status: SELECT 202694 in 0.368 seconds
[0m10:23:21.743052 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m10:23:21.743939 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
alter table "airflow"."lead_staging"."dim_person" rename to "dim_person__dbt_backup"
[0m10:23:21.745185 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:23:21.748528 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m10:23:21.749312 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
alter table "airflow"."lead_staging"."dim_person__dbt_tmp" rename to "dim_person"
[0m10:23:21.750590 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:23:21.753045 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: COMMIT
[0m10:23:21.753897 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m10:23:21.754677 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: COMMIT
[0m10:23:21.756218 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:23:21.759102 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_person__dbt_backup"
[0m10:23:21.760317 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m10:23:21.761040 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
drop table if exists "airflow"."lead_staging"."dim_person__dbt_backup" cascade
[0m10:23:21.764911 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m10:23:21.766782 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: Close
[0m10:23:21.767698 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a9fa2a4-e393-4a1c-bda2-7759d513ccdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f342db277a0>]}
[0m10:23:21.768598 [info ] [Thread-1 (]: 4 of 5 OK created sql table model lead_staging.dim_person ...................... [[32mSELECT 202694[0m in 0.42s]
[0m10:23:21.769567 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_person
[0m10:23:21.770296 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_fact_network_usage
[0m10:23:21.771058 [info ] [Thread-1 (]: 5 of 5 START sql table model lead_staging.fact_network_usage ................... [RUN]
[0m10:23:21.771927 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_person, now model.dbt_lead_data.staging_fact_network_usage)
[0m10:23:21.772677 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_fact_network_usage
[0m10:23:21.776400 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_fact_network_usage"
[0m10:23:21.778763 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_fact_network_usage
[0m10:23:21.782744 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_fact_network_usage"
[0m10:23:21.784795 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m10:23:21.785506 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: BEGIN
[0m10:23:21.786131 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:23:21.790658 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m10:23:21.791476 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m10:23:21.792200 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */

  
    

  create  table "airflow"."lead_staging"."fact_network_usage__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        session_duration,
        download_speed,
        upload_speed,
        consumed_traffic
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:23:21.981796 [debug] [Thread-1 (]: SQL status: SELECT 202694 in 0.189 seconds
[0m10:23:21.987051 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m10:23:21.987947 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
alter table "airflow"."lead_staging"."fact_network_usage" rename to "fact_network_usage__dbt_backup"
[0m10:23:21.989333 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:23:21.993054 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m10:23:21.993993 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
alter table "airflow"."lead_staging"."fact_network_usage__dbt_tmp" rename to "fact_network_usage"
[0m10:23:21.995169 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:23:21.997654 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: COMMIT
[0m10:23:21.998497 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m10:23:21.999375 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: COMMIT
[0m10:23:22.005204 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m10:23:22.008533 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."fact_network_usage__dbt_backup"
[0m10:23:22.009796 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m10:23:22.010615 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
drop table if exists "airflow"."lead_staging"."fact_network_usage__dbt_backup" cascade
[0m10:23:22.014262 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m10:23:22.016300 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: Close
[0m10:23:22.017321 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a9fa2a4-e393-4a1c-bda2-7759d513ccdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f342db1e240>]}
[0m10:23:22.018363 [info ] [Thread-1 (]: 5 of 5 OK created sql table model lead_staging.fact_network_usage .............. [[32mSELECT 202694[0m in 0.25s]
[0m10:23:22.019427 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_fact_network_usage
[0m10:23:22.021668 [debug] [MainThread]: Using postgres connection "master"
[0m10:23:22.022319 [debug] [MainThread]: On master: BEGIN
[0m10:23:22.022880 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:23:22.027140 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m10:23:22.027801 [debug] [MainThread]: On master: COMMIT
[0m10:23:22.028456 [debug] [MainThread]: Using postgres connection "master"
[0m10:23:22.029188 [debug] [MainThread]: On master: COMMIT
[0m10:23:22.030037 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:23:22.030682 [debug] [MainThread]: On master: Close
[0m10:23:22.031592 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:23:22.032311 [debug] [MainThread]: Connection 'model.dbt_lead_data.staging_fact_network_usage' was properly closed.
[0m10:23:22.033156 [info ] [MainThread]: 
[0m10:23:22.033971 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 1.81 seconds (1.81s).
[0m10:23:22.035985 [debug] [MainThread]: Command end result
[0m10:23:22.091624 [info ] [MainThread]: 
[0m10:23:22.092998 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:23:22.094062 [info ] [MainThread]: 
[0m10:23:22.095025 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m10:23:22.096443 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.7856705, "process_user_time": 3.196678, "process_kernel_time": 0.202963, "process_mem_max_rss": "121464", "process_in_blocks": "2472", "process_out_blocks": "0"}
[0m10:23:22.097425 [debug] [MainThread]: Command `dbt run` succeeded at 10:23:22.097286 after 2.79 seconds
[0m10:23:22.098253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34310a5400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3430dc85c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3430dc2ea0>]}
[0m10:23:22.099109 [debug] [MainThread]: Flushing usage events
[0m10:23:25.940483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaa5e42570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaa6518fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaa6000110>]}


============================== 10:23:25.949005 | 287ff295-72f7-4cc7-a042-57e3b3b9e05a ==============================
[0m10:23:25.949005 [info ] [MainThread]: Running with dbt=1.8.0
[0m10:23:25.950414 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select tag:trusted', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:23:26.170952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '287ff295-72f7-4cc7-a042-57e3b3b9e05a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaa5cde810>]}
[0m10:23:26.244344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '287ff295-72f7-4cc7-a042-57e3b3b9e05a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaa6c1eea0>]}
[0m10:23:26.245779 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:23:26.345160 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m10:23:26.468595 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:23:26.469362 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:23:26.505296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '287ff295-72f7-4cc7-a042-57e3b3b9e05a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaa64acf50>]}
[0m10:23:26.628561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '287ff295-72f7-4cc7-a042-57e3b3b9e05a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaa49c91f0>]}
[0m10:23:26.629370 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m10:23:26.630080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '287ff295-72f7-4cc7-a042-57e3b3b9e05a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaa4d1d1f0>]}
[0m10:23:26.632530 [info ] [MainThread]: 
[0m10:23:26.633529 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:23:26.639481 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m10:23:26.673808 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m10:23:26.674575 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m10:23:26.675262 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:23:26.680406 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.005 seconds
[0m10:23:26.682384 [debug] [ThreadPool]: On list_airflow: Close
[0m10:23:26.685002 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_staging)
[0m10:23:26.691361 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m10:23:26.692112 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m10:23:26.692798 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:23:26.697120 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m10:23:26.697868 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m10:23:26.698590 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m10:23:26.701629 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m10:23:26.703486 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m10:23:26.704357 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m10:23:26.705305 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now list_airflow_lead_trusted)
[0m10:23:26.708529 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m10:23:26.709336 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m10:23:26.710026 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:23:26.714173 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m10:23:26.715109 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m10:23:26.716078 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m10:23:26.718713 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m10:23:26.720368 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m10:23:26.721137 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m10:23:26.727733 [debug] [MainThread]: Using postgres connection "master"
[0m10:23:26.728493 [debug] [MainThread]: On master: BEGIN
[0m10:23:26.729230 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:23:26.733438 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m10:23:26.734117 [debug] [MainThread]: Using postgres connection "master"
[0m10:23:26.734786 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:23:26.738210 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m10:23:26.740102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '287ff295-72f7-4cc7-a042-57e3b3b9e05a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaa4d1d1f0>]}
[0m10:23:26.740855 [debug] [MainThread]: On master: ROLLBACK
[0m10:23:26.741742 [debug] [MainThread]: Using postgres connection "master"
[0m10:23:26.742483 [debug] [MainThread]: On master: BEGIN
[0m10:23:26.743554 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:23:26.744291 [debug] [MainThread]: On master: COMMIT
[0m10:23:26.744983 [debug] [MainThread]: Using postgres connection "master"
[0m10:23:26.745672 [debug] [MainThread]: On master: COMMIT
[0m10:23:26.746561 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:23:26.747346 [debug] [MainThread]: On master: Close
[0m10:23:26.748263 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:23:26.749065 [info ] [MainThread]: 
[0m10:23:26.758682 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_non_pii_data
[0m10:23:26.759560 [info ] [Thread-1 (]: 1 of 4 START sql table model lead_trusted.non_pii_data ......................... [RUN]
[0m10:23:26.760343 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now model.dbt_lead_data.trusted_non_pii_data)
[0m10:23:26.761102 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_non_pii_data
[0m10:23:26.776709 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_non_pii_data"
[0m10:23:26.779764 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_non_pii_data
[0m10:23:26.836102 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_non_pii_data"
[0m10:23:26.839149 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m10:23:26.839872 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: BEGIN
[0m10:23:26.840550 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:23:26.844577 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m10:23:26.845269 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m10:23:26.845975 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */

  
    

  create  table "airflow"."lead_trusted"."non_pii_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        '***MASKED***' AS person_name,
        SUBSTRING(dp.user_name, 1, 5) || '*****'  user_name,
        SUBSTRING(dp.email, 1, 5) || '*****' AS email,
        '***MASKED***'  AS personal_number, 
        '***MASKED***' AS birth_date, 
        '***MASKED***' AS address,
        '***MASKED***'  AS phone, 
        SUBSTRING(da.mac_address, 1, 5) || '*****' AS mac_address,
        SUBSTRING(da.ip_address, 1, 5) || '*****' AS ip_address,
        SUBSTRING(df.iban, 1, 5) || '*****' AS iban,
        dd.accessed_at,
        fnu.session_duration,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.consumed_traffic,
        fnu.unique_id
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    INNER JOIN
        "airflow"."lead_staging"."dim_address" da ON fnu.unique_id = da.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_date" dd ON da.unique_id = dd.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_finance" df ON dd.unique_id = df.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_person" dp ON df.unique_id = dp.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:23:30.387022 [debug] [Thread-1 (]: SQL status: SELECT 202694 in 3.540 seconds
[0m10:23:30.394290 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m10:23:30.395376 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
alter table "airflow"."lead_trusted"."non_pii_data" rename to "non_pii_data__dbt_backup"
[0m10:23:30.396605 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:23:30.400454 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m10:23:30.401280 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
alter table "airflow"."lead_trusted"."non_pii_data__dbt_tmp" rename to "non_pii_data"
[0m10:23:30.402425 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:23:30.425953 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: COMMIT
[0m10:23:30.426966 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m10:23:30.427837 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: COMMIT
[0m10:23:30.429655 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:23:30.437089 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."non_pii_data__dbt_backup"
[0m10:23:30.443911 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m10:23:30.444876 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
drop table if exists "airflow"."lead_trusted"."non_pii_data__dbt_backup" cascade
[0m10:23:30.449614 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m10:23:30.452800 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: Close
[0m10:23:30.454810 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '287ff295-72f7-4cc7-a042-57e3b3b9e05a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaa720dfd0>]}
[0m10:23:30.455900 [info ] [Thread-1 (]: 1 of 4 OK created sql table model lead_trusted.non_pii_data .................... [[32mSELECT 202694[0m in 3.69s]
[0m10:23:30.457156 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_non_pii_data
[0m10:23:30.458002 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_payment_data
[0m10:23:30.458905 [info ] [Thread-1 (]: 2 of 4 START sql table model lead_trusted.payment_data ......................... [RUN]
[0m10:23:30.459792 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_non_pii_data, now model.dbt_lead_data.trusted_payment_data)
[0m10:23:30.460519 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_payment_data
[0m10:23:30.464701 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_payment_data"
[0m10:23:30.467345 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_payment_data
[0m10:23:30.471608 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_payment_data"
[0m10:23:30.474218 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m10:23:30.474974 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: BEGIN
[0m10:23:30.475688 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:23:30.480705 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m10:23:30.481600 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m10:23:30.482437 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */

  
    

  create  table "airflow"."lead_trusted"."payment_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        fnu.unique_id,
        df.iban,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.session_duration,
        fnu.consumed_traffic,
        ((fnu.download_speed + fnu.upload_speed + 1)/2) + (fnu.consumed_traffic / (fnu.session_duration + 1)) AS payment_amount
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    JOIN
        "airflow"."lead_staging"."dim_finance" df
    ON
	    fnu.unique_id = df.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:23:30.865369 [debug] [Thread-1 (]: SQL status: SELECT 202694 in 0.382 seconds
[0m10:23:30.869198 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m10:23:30.869967 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
alter table "airflow"."lead_trusted"."payment_data" rename to "payment_data__dbt_backup"
[0m10:23:30.870970 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:23:30.874483 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m10:23:30.875245 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
alter table "airflow"."lead_trusted"."payment_data__dbt_tmp" rename to "payment_data"
[0m10:23:30.876288 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:23:30.878705 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: COMMIT
[0m10:23:30.879482 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m10:23:30.880185 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: COMMIT
[0m10:23:30.885048 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m10:23:30.888049 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."payment_data__dbt_backup"
[0m10:23:30.889307 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m10:23:30.890080 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
drop table if exists "airflow"."lead_trusted"."payment_data__dbt_backup" cascade
[0m10:23:30.893406 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m10:23:30.895310 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: Close
[0m10:23:30.896260 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '287ff295-72f7-4cc7-a042-57e3b3b9e05a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaa2c3c230>]}
[0m10:23:30.897275 [info ] [Thread-1 (]: 2 of 4 OK created sql table model lead_trusted.payment_data .................... [[32mSELECT 202694[0m in 0.44s]
[0m10:23:30.898375 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_payment_data
[0m10:23:30.899239 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_pii_data
[0m10:23:30.900124 [info ] [Thread-1 (]: 3 of 4 START sql table model lead_trusted.pii_data ............................. [RUN]
[0m10:23:30.901002 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_payment_data, now model.dbt_lead_data.trusted_pii_data)
[0m10:23:30.901660 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_pii_data
[0m10:23:30.906538 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_pii_data"
[0m10:23:30.908421 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_pii_data
[0m10:23:30.914084 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_pii_data"
[0m10:23:30.916109 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m10:23:30.916784 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: BEGIN
[0m10:23:30.917455 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:23:30.921948 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m10:23:30.922705 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m10:23:30.923547 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */

  
    

  create  table "airflow"."lead_trusted"."pii_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        dp.person_name,
        dp.user_name,
        dp.email,
        dp.personal_number, 
        dp.birth_date, 
        da.address,
        dp.phone, 
        da.mac_address,
        da.ip_address,
        df.iban,
        dd.accessed_at,
        fnu.session_duration,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.consumed_traffic,
        fnu.unique_id
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    INNER JOIN
        "airflow"."lead_staging"."dim_address" da ON fnu.unique_id = da.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_date" dd ON da.unique_id = dd.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_finance" df ON dd.unique_id = df.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_person" dp ON df.unique_id = dp.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:23:31.809027 [debug] [Thread-1 (]: SQL status: SELECT 202694 in 0.885 seconds
[0m10:23:31.812720 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m10:23:31.813563 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */
alter table "airflow"."lead_trusted"."pii_data" rename to "pii_data__dbt_backup"
[0m10:23:31.814739 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:23:31.818288 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m10:23:31.819017 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */
alter table "airflow"."lead_trusted"."pii_data__dbt_tmp" rename to "pii_data"
[0m10:23:31.820009 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:23:31.822536 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: COMMIT
[0m10:23:31.823256 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m10:23:31.823904 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: COMMIT
[0m10:23:31.866404 [debug] [Thread-1 (]: SQL status: COMMIT in 0.042 seconds
[0m10:23:31.869620 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."pii_data__dbt_backup"
[0m10:23:31.870825 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m10:23:31.871597 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */
drop table if exists "airflow"."lead_trusted"."pii_data__dbt_backup" cascade
[0m10:23:31.876199 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m10:23:31.878091 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: Close
[0m10:23:31.879033 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '287ff295-72f7-4cc7-a042-57e3b3b9e05a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaa2cd82c0>]}
[0m10:23:31.880078 [info ] [Thread-1 (]: 3 of 4 OK created sql table model lead_trusted.pii_data ........................ [[32mSELECT 202694[0m in 0.98s]
[0m10:23:31.881101 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_pii_data
[0m10:23:31.881881 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_technical_data
[0m10:23:31.882650 [info ] [Thread-1 (]: 4 of 4 START sql table model lead_trusted.technical_data ....................... [RUN]
[0m10:23:31.883465 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_pii_data, now model.dbt_lead_data.trusted_technical_data)
[0m10:23:31.884136 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_technical_data
[0m10:23:31.888017 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_technical_data"
[0m10:23:31.890385 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_technical_data
[0m10:23:31.894514 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_technical_data"
[0m10:23:31.896427 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m10:23:31.897130 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: BEGIN
[0m10:23:31.897759 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:23:31.902490 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m10:23:31.903345 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m10:23:31.904057 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */

  
    

  create  table "airflow"."lead_trusted"."technical_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        fnu.unique_id,
        da.address,
        da.mac_address,
        da.ip_address,
        fnu.download_speed,
        fnu.upload_speed,
        ROUND((fnu.session_duration/60), 1) as min_session_duration,
        CASE 
            WHEN fnu.download_speed < 50 OR fnu.upload_speed < 30 OR fnu.session_duration/60 < 1 THEN true
            ELSE false
        END AS technical_issue
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    JOIN
        "airflow"."lead_staging"."dim_address" da
    ON
	    fnu.unique_id = da.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:23:32.383426 [debug] [Thread-1 (]: SQL status: SELECT 202694 in 0.479 seconds
[0m10:23:32.387358 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m10:23:32.388200 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
alter table "airflow"."lead_trusted"."technical_data" rename to "technical_data__dbt_backup"
[0m10:23:32.389511 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:23:32.399319 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m10:23:32.400294 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
alter table "airflow"."lead_trusted"."technical_data__dbt_tmp" rename to "technical_data"
[0m10:23:32.401604 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:23:32.404324 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: COMMIT
[0m10:23:32.405130 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m10:23:32.406173 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: COMMIT
[0m10:23:32.410501 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m10:23:32.413748 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."technical_data__dbt_backup"
[0m10:23:32.415024 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m10:23:32.415906 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
drop table if exists "airflow"."lead_trusted"."technical_data__dbt_backup" cascade
[0m10:23:32.418681 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m10:23:32.420606 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: Close
[0m10:23:32.421559 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '287ff295-72f7-4cc7-a042-57e3b3b9e05a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaa2cdd0d0>]}
[0m10:23:32.422609 [info ] [Thread-1 (]: 4 of 4 OK created sql table model lead_trusted.technical_data .................. [[32mSELECT 202694[0m in 0.54s]
[0m10:23:32.423701 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_technical_data
[0m10:23:32.426027 [debug] [MainThread]: Using postgres connection "master"
[0m10:23:32.426682 [debug] [MainThread]: On master: BEGIN
[0m10:23:32.427337 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:23:32.431267 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m10:23:32.432039 [debug] [MainThread]: On master: COMMIT
[0m10:23:32.432748 [debug] [MainThread]: Using postgres connection "master"
[0m10:23:32.433496 [debug] [MainThread]: On master: COMMIT
[0m10:23:32.434356 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:23:32.435075 [debug] [MainThread]: On master: Close
[0m10:23:32.436001 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:23:32.436630 [debug] [MainThread]: Connection 'model.dbt_lead_data.trusted_technical_data' was properly closed.
[0m10:23:32.437412 [info ] [MainThread]: 
[0m10:23:32.438222 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 5.80 seconds (5.80s).
[0m10:23:32.440140 [debug] [MainThread]: Command end result
[0m10:23:32.494247 [info ] [MainThread]: 
[0m10:23:32.495056 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:23:32.495808 [info ] [MainThread]: 
[0m10:23:32.496892 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m10:23:32.498349 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.618529, "process_user_time": 2.814073, "process_kernel_time": 0.178349, "process_mem_max_rss": "121172", "process_in_blocks": "1248", "process_out_blocks": "0"}
[0m10:23:32.499350 [debug] [MainThread]: Command `dbt run` succeeded at 10:23:32.499207 after 6.62 seconds
[0m10:23:32.500124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaa5cd6690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaa515e750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaa2cebf20>]}
[0m10:23:32.500899 [debug] [MainThread]: Flushing usage events
[0m10:24:23.797511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573e75d7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573e272630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573e75eba0>]}


============================== 10:24:23.804537 | 02eb6e3f-8cca-47ce-b337-cb1494ad6e97 ==============================
[0m10:24:23.804537 [info ] [MainThread]: Running with dbt=1.8.0
[0m10:24:23.805954 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select tag:staging', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:24:24.038171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '02eb6e3f-8cca-47ce-b337-cb1494ad6e97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573ee894f0>]}
[0m10:24:24.110769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '02eb6e3f-8cca-47ce-b337-cb1494ad6e97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573ee8ae40>]}
[0m10:24:24.112505 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:24:24.215358 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m10:24:24.359026 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:24:24.359977 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:24:24.402076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '02eb6e3f-8cca-47ce-b337-cb1494ad6e97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573cf58bf0>]}
[0m10:24:24.546068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '02eb6e3f-8cca-47ce-b337-cb1494ad6e97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573cb91520>]}
[0m10:24:24.547042 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m10:24:24.547906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02eb6e3f-8cca-47ce-b337-cb1494ad6e97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573c332240>]}
[0m10:24:24.550559 [info ] [MainThread]: 
[0m10:24:24.551653 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:24:24.558322 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m10:24:24.598196 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m10:24:24.599498 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m10:24:24.600495 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:24:24.607363 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.007 seconds
[0m10:24:24.609417 [debug] [ThreadPool]: On list_airflow: Close
[0m10:24:24.612275 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_trusted)
[0m10:24:24.619132 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m10:24:24.619959 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m10:24:24.620719 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:24:24.625333 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m10:24:24.626249 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m10:24:24.627001 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m10:24:24.632141 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m10:24:24.634155 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m10:24:24.635125 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m10:24:24.636881 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now list_airflow_lead_staging)
[0m10:24:24.640587 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m10:24:24.641366 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m10:24:24.642112 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:24:24.646987 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m10:24:24.647863 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m10:24:24.648750 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m10:24:24.652403 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.003 seconds
[0m10:24:24.654388 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m10:24:24.655402 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m10:24:24.663009 [debug] [MainThread]: Using postgres connection "master"
[0m10:24:24.663915 [debug] [MainThread]: On master: BEGIN
[0m10:24:24.664830 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:24:24.669479 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m10:24:24.670478 [debug] [MainThread]: Using postgres connection "master"
[0m10:24:24.671332 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:24:24.675736 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m10:24:24.677839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02eb6e3f-8cca-47ce-b337-cb1494ad6e97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573da51e20>]}
[0m10:24:24.678773 [debug] [MainThread]: On master: ROLLBACK
[0m10:24:24.679736 [debug] [MainThread]: Using postgres connection "master"
[0m10:24:24.680501 [debug] [MainThread]: On master: BEGIN
[0m10:24:24.681781 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m10:24:24.682667 [debug] [MainThread]: On master: COMMIT
[0m10:24:24.683455 [debug] [MainThread]: Using postgres connection "master"
[0m10:24:24.684228 [debug] [MainThread]: On master: COMMIT
[0m10:24:24.685177 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:24:24.685946 [debug] [MainThread]: On master: Close
[0m10:24:24.686966 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:24:24.687769 [info ] [MainThread]: 
[0m10:24:24.698548 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_adress
[0m10:24:24.699644 [info ] [Thread-1 (]: 1 of 5 START sql table model lead_staging.dim_address .......................... [RUN]
[0m10:24:24.700584 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now model.dbt_lead_data.staging_dim_adress)
[0m10:24:24.701365 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_adress
[0m10:24:24.711884 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_adress"
[0m10:24:24.715597 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_adress
[0m10:24:24.765985 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_adress"
[0m10:24:24.770234 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m10:24:24.771045 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: BEGIN
[0m10:24:24.771974 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:24:24.779187 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m10:24:24.780433 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m10:24:24.781426 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */

  
    

  create  table "airflow"."lead_staging"."dim_address__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        address,
        mac_address,
        ip_address
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:24:25.371273 [debug] [Thread-1 (]: SQL status: SELECT 403438 in 0.588 seconds
[0m10:24:25.379306 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m10:24:25.380318 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
alter table "airflow"."lead_staging"."dim_address" rename to "dim_address__dbt_backup"
[0m10:24:25.384261 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m10:24:25.388473 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m10:24:25.389588 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
alter table "airflow"."lead_staging"."dim_address__dbt_tmp" rename to "dim_address"
[0m10:24:25.391027 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:24:25.417060 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m10:24:25.418153 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m10:24:25.418980 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m10:24:25.420707 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:24:25.428136 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_address__dbt_backup"
[0m10:24:25.435791 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m10:24:25.436909 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
drop table if exists "airflow"."lead_staging"."dim_address__dbt_backup" cascade
[0m10:24:25.444728 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m10:24:25.449230 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: Close
[0m10:24:25.452190 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02eb6e3f-8cca-47ce-b337-cb1494ad6e97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573f419b20>]}
[0m10:24:25.453719 [info ] [Thread-1 (]: 1 of 5 OK created sql table model lead_staging.dim_address ..................... [[32mSELECT 403438[0m in 0.75s]
[0m10:24:25.455470 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_adress
[0m10:24:25.456550 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_date
[0m10:24:25.457598 [info ] [Thread-1 (]: 2 of 5 START sql table model lead_staging.dim_date ............................. [RUN]
[0m10:24:25.458596 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_adress, now model.dbt_lead_data.staging_dim_date)
[0m10:24:25.459410 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_date
[0m10:24:25.463550 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_date"
[0m10:24:25.465906 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_date
[0m10:24:25.470422 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_date"
[0m10:24:25.472875 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m10:24:25.473686 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: BEGIN
[0m10:24:25.474532 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:24:25.483626 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m10:24:25.484466 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m10:24:25.485311 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */

  
    

  create  table "airflow"."lead_staging"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        accessed_at
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:24:25.857845 [debug] [Thread-1 (]: SQL status: SELECT 403438 in 0.372 seconds
[0m10:24:25.861725 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m10:24:25.862509 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
alter table "airflow"."lead_staging"."dim_date" rename to "dim_date__dbt_backup"
[0m10:24:25.864325 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:24:25.869389 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m10:24:25.870411 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
alter table "airflow"."lead_staging"."dim_date__dbt_tmp" rename to "dim_date"
[0m10:24:25.872881 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:24:25.875933 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: COMMIT
[0m10:24:25.877164 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m10:24:25.878415 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: COMMIT
[0m10:24:25.888555 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m10:24:25.893718 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_date__dbt_backup"
[0m10:24:25.895023 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m10:24:25.895884 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
drop table if exists "airflow"."lead_staging"."dim_date__dbt_backup" cascade
[0m10:24:25.898880 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m10:24:25.900818 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: Close
[0m10:24:25.901736 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02eb6e3f-8cca-47ce-b337-cb1494ad6e97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573aef4320>]}
[0m10:24:25.902714 [info ] [Thread-1 (]: 2 of 5 OK created sql table model lead_staging.dim_date ........................ [[32mSELECT 403438[0m in 0.44s]
[0m10:24:25.903778 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_date
[0m10:24:25.904635 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_finance
[0m10:24:25.905505 [info ] [Thread-1 (]: 3 of 5 START sql table model lead_staging.dim_finance .......................... [RUN]
[0m10:24:25.906477 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_date, now model.dbt_lead_data.staging_dim_finance)
[0m10:24:25.907282 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_finance
[0m10:24:25.910866 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_finance"
[0m10:24:25.913289 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_finance
[0m10:24:25.918840 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_finance"
[0m10:24:25.921225 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m10:24:25.921908 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: BEGIN
[0m10:24:25.922711 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:24:25.927783 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m10:24:25.928676 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m10:24:25.929427 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */

  
    

  create  table "airflow"."lead_staging"."dim_finance__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        iban
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:24:26.279316 [debug] [Thread-1 (]: SQL status: SELECT 403438 in 0.349 seconds
[0m10:24:26.283112 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m10:24:26.283896 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
alter table "airflow"."lead_staging"."dim_finance" rename to "dim_finance__dbt_backup"
[0m10:24:26.285208 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:24:26.288767 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m10:24:26.289613 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
alter table "airflow"."lead_staging"."dim_finance__dbt_tmp" rename to "dim_finance"
[0m10:24:26.290847 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:24:26.293415 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: COMMIT
[0m10:24:26.294294 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m10:24:26.295062 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: COMMIT
[0m10:24:26.298284 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m10:24:26.301304 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_finance__dbt_backup"
[0m10:24:26.302753 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m10:24:26.303593 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
drop table if exists "airflow"."lead_staging"."dim_finance__dbt_backup" cascade
[0m10:24:26.306699 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m10:24:26.308746 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: Close
[0m10:24:26.309783 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02eb6e3f-8cca-47ce-b337-cb1494ad6e97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5739502180>]}
[0m10:24:26.310830 [info ] [Thread-1 (]: 3 of 5 OK created sql table model lead_staging.dim_finance ..................... [[32mSELECT 403438[0m in 0.40s]
[0m10:24:26.312080 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_finance
[0m10:24:26.313267 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_person
[0m10:24:26.314402 [info ] [Thread-1 (]: 4 of 5 START sql table model lead_staging.dim_person ........................... [RUN]
[0m10:24:26.315459 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_finance, now model.dbt_lead_data.staging_dim_person)
[0m10:24:26.316246 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_person
[0m10:24:26.319950 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_person"
[0m10:24:26.322500 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_person
[0m10:24:26.327091 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_person"
[0m10:24:26.329329 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m10:24:26.330131 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: BEGIN
[0m10:24:26.330912 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:24:26.335990 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m10:24:26.336873 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m10:24:26.337697 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */

  
    

  create  table "airflow"."lead_staging"."dim_person__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        person_name,
        user_name,
        email,
        phone,
        birth_date,
        personal_number
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:24:26.917938 [debug] [Thread-1 (]: SQL status: SELECT 403438 in 0.579 seconds
[0m10:24:26.921851 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m10:24:26.922842 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
alter table "airflow"."lead_staging"."dim_person" rename to "dim_person__dbt_backup"
[0m10:24:26.924233 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:24:26.927781 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m10:24:26.928623 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
alter table "airflow"."lead_staging"."dim_person__dbt_tmp" rename to "dim_person"
[0m10:24:26.929952 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:24:26.932503 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: COMMIT
[0m10:24:26.933258 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m10:24:26.934027 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: COMMIT
[0m10:24:26.945518 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m10:24:26.948664 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_person__dbt_backup"
[0m10:24:26.949868 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m10:24:26.950597 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
drop table if exists "airflow"."lead_staging"."dim_person__dbt_backup" cascade
[0m10:24:26.953569 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m10:24:26.955539 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: Close
[0m10:24:26.956524 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02eb6e3f-8cca-47ce-b337-cb1494ad6e97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573ae91040>]}
[0m10:24:26.957519 [info ] [Thread-1 (]: 4 of 5 OK created sql table model lead_staging.dim_person ...................... [[32mSELECT 403438[0m in 0.64s]
[0m10:24:26.958628 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_person
[0m10:24:26.959504 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_fact_network_usage
[0m10:24:26.960384 [info ] [Thread-1 (]: 5 of 5 START sql table model lead_staging.fact_network_usage ................... [RUN]
[0m10:24:26.961401 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_person, now model.dbt_lead_data.staging_fact_network_usage)
[0m10:24:26.962232 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_fact_network_usage
[0m10:24:26.966338 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_fact_network_usage"
[0m10:24:26.969285 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_fact_network_usage
[0m10:24:26.974239 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_fact_network_usage"
[0m10:24:26.976745 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m10:24:26.977516 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: BEGIN
[0m10:24:26.978242 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:24:26.982784 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m10:24:26.983680 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m10:24:26.984444 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */

  
    

  create  table "airflow"."lead_staging"."fact_network_usage__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        session_duration,
        download_speed,
        upload_speed,
        consumed_traffic
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:24:27.612225 [debug] [Thread-1 (]: SQL status: SELECT 403438 in 0.627 seconds
[0m10:24:27.617808 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m10:24:27.618733 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
alter table "airflow"."lead_staging"."fact_network_usage" rename to "fact_network_usage__dbt_backup"
[0m10:24:27.620140 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:24:27.624064 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m10:24:27.625002 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
alter table "airflow"."lead_staging"."fact_network_usage__dbt_tmp" rename to "fact_network_usage"
[0m10:24:27.626210 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:24:27.628598 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: COMMIT
[0m10:24:27.629368 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m10:24:27.630134 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: COMMIT
[0m10:24:27.636592 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m10:24:27.639877 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."fact_network_usage__dbt_backup"
[0m10:24:27.641275 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m10:24:27.642132 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
drop table if exists "airflow"."lead_staging"."fact_network_usage__dbt_backup" cascade
[0m10:24:27.645197 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m10:24:27.647410 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: Close
[0m10:24:27.648428 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02eb6e3f-8cca-47ce-b337-cb1494ad6e97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573950dd00>]}
[0m10:24:27.649450 [info ] [Thread-1 (]: 5 of 5 OK created sql table model lead_staging.fact_network_usage .............. [[32mSELECT 403438[0m in 0.69s]
[0m10:24:27.650563 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_fact_network_usage
[0m10:24:27.652920 [debug] [MainThread]: Using postgres connection "master"
[0m10:24:27.653698 [debug] [MainThread]: On master: BEGIN
[0m10:24:27.654466 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:24:27.659020 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m10:24:27.659986 [debug] [MainThread]: On master: COMMIT
[0m10:24:27.660742 [debug] [MainThread]: Using postgres connection "master"
[0m10:24:27.661447 [debug] [MainThread]: On master: COMMIT
[0m10:24:27.662355 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:24:27.663047 [debug] [MainThread]: On master: Close
[0m10:24:27.663971 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:24:27.664762 [debug] [MainThread]: Connection 'model.dbt_lead_data.staging_fact_network_usage' was properly closed.
[0m10:24:27.665614 [info ] [MainThread]: 
[0m10:24:27.666415 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 3.11 seconds (3.11s).
[0m10:24:27.668547 [debug] [MainThread]: Command end result
[0m10:24:27.723363 [info ] [MainThread]: 
[0m10:24:27.724205 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:24:27.725181 [info ] [MainThread]: 
[0m10:24:27.726282 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m10:24:27.727976 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.005821, "process_user_time": 3.305296, "process_kernel_time": 0.196404, "process_mem_max_rss": "123232", "process_in_blocks": "816", "process_out_blocks": "0"}
[0m10:24:27.728881 [debug] [MainThread]: Command `dbt run` succeeded at 10:24:27.728756 after 4.01 seconds
[0m10:24:27.729600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573df368d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573db64830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573db64920>]}
[0m10:24:27.730609 [debug] [MainThread]: Flushing usage events
[0m10:24:31.788216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdef7347380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdef3f6b6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdef3f68c50>]}


============================== 10:24:31.796031 | a77070d1-143f-400b-aa30-06f9dc642236 ==============================
[0m10:24:31.796031 [info ] [MainThread]: Running with dbt=1.8.0
[0m10:24:31.797066 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select tag:trusted', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:24:32.013553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a77070d1-143f-400b-aa30-06f9dc642236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdef4651700>]}
[0m10:24:32.084622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a77070d1-143f-400b-aa30-06f9dc642236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdef36c7dd0>]}
[0m10:24:32.085940 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:24:32.168667 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m10:24:32.287572 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:24:32.288401 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:24:32.326633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a77070d1-143f-400b-aa30-06f9dc642236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdef2762b40>]}
[0m10:24:32.473689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a77070d1-143f-400b-aa30-06f9dc642236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdef23997f0>]}
[0m10:24:32.474621 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m10:24:32.475454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a77070d1-143f-400b-aa30-06f9dc642236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdef276fd10>]}
[0m10:24:32.478414 [info ] [MainThread]: 
[0m10:24:32.479463 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:24:32.485328 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m10:24:32.525164 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m10:24:32.526020 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m10:24:32.526776 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:24:32.532656 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.006 seconds
[0m10:24:32.534631 [debug] [ThreadPool]: On list_airflow: Close
[0m10:24:32.537329 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_trusted)
[0m10:24:32.544009 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m10:24:32.544806 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m10:24:32.545502 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:24:32.549675 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m10:24:32.550389 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m10:24:32.551022 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m10:24:32.554205 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m10:24:32.556104 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m10:24:32.557162 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m10:24:32.558103 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now list_airflow_lead_staging)
[0m10:24:32.561240 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m10:24:32.561869 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m10:24:32.562562 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:24:32.566333 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m10:24:32.566977 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m10:24:32.567625 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m10:24:32.570566 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m10:24:32.572575 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m10:24:32.573450 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m10:24:32.580797 [debug] [MainThread]: Using postgres connection "master"
[0m10:24:32.581583 [debug] [MainThread]: On master: BEGIN
[0m10:24:32.582320 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:24:32.586278 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m10:24:32.586923 [debug] [MainThread]: Using postgres connection "master"
[0m10:24:32.587648 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:24:32.591387 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m10:24:32.593340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a77070d1-143f-400b-aa30-06f9dc642236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdef33c2f90>]}
[0m10:24:32.594156 [debug] [MainThread]: On master: ROLLBACK
[0m10:24:32.595183 [debug] [MainThread]: Using postgres connection "master"
[0m10:24:32.595881 [debug] [MainThread]: On master: BEGIN
[0m10:24:32.597035 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:24:32.597846 [debug] [MainThread]: On master: COMMIT
[0m10:24:32.598619 [debug] [MainThread]: Using postgres connection "master"
[0m10:24:32.599335 [debug] [MainThread]: On master: COMMIT
[0m10:24:32.600280 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:24:32.600960 [debug] [MainThread]: On master: Close
[0m10:24:32.601880 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:24:32.602726 [info ] [MainThread]: 
[0m10:24:32.612790 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_non_pii_data
[0m10:24:32.613794 [info ] [Thread-1 (]: 1 of 4 START sql table model lead_trusted.non_pii_data ......................... [RUN]
[0m10:24:32.614783 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now model.dbt_lead_data.trusted_non_pii_data)
[0m10:24:32.615567 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_non_pii_data
[0m10:24:32.625813 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_non_pii_data"
[0m10:24:32.628253 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_non_pii_data
[0m10:24:32.670659 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_non_pii_data"
[0m10:24:32.673844 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m10:24:32.674602 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: BEGIN
[0m10:24:32.675258 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:24:32.679695 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m10:24:32.680420 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m10:24:32.681256 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */

  
    

  create  table "airflow"."lead_trusted"."non_pii_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        '***MASKED***' AS person_name,
        SUBSTRING(dp.user_name, 1, 5) || '*****'  user_name,
        SUBSTRING(dp.email, 1, 5) || '*****' AS email,
        '***MASKED***'  AS personal_number, 
        '***MASKED***' AS birth_date, 
        '***MASKED***' AS address,
        '***MASKED***'  AS phone, 
        SUBSTRING(da.mac_address, 1, 5) || '*****' AS mac_address,
        SUBSTRING(da.ip_address, 1, 5) || '*****' AS ip_address,
        SUBSTRING(df.iban, 1, 5) || '*****' AS iban,
        dd.accessed_at,
        fnu.session_duration,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.consumed_traffic,
        fnu.unique_id
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    INNER JOIN
        "airflow"."lead_staging"."dim_address" da ON fnu.unique_id = da.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_date" dd ON da.unique_id = dd.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_finance" df ON dd.unique_id = df.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_person" dp ON df.unique_id = dp.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:24:40.322005 [debug] [Thread-1 (]: SQL status: SELECT 403438 in 7.640 seconds
[0m10:24:40.329997 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m10:24:40.330907 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
alter table "airflow"."lead_trusted"."non_pii_data" rename to "non_pii_data__dbt_backup"
[0m10:24:40.332254 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:24:40.335994 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m10:24:40.336760 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
alter table "airflow"."lead_trusted"."non_pii_data__dbt_tmp" rename to "non_pii_data"
[0m10:24:40.337799 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:24:40.362053 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: COMMIT
[0m10:24:40.362988 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m10:24:40.363878 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: COMMIT
[0m10:24:40.366993 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m10:24:40.375368 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."non_pii_data__dbt_backup"
[0m10:24:40.382157 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m10:24:40.383024 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
drop table if exists "airflow"."lead_trusted"."non_pii_data__dbt_backup" cascade
[0m10:24:40.390663 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m10:24:40.394101 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: Close
[0m10:24:40.396599 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a77070d1-143f-400b-aa30-06f9dc642236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdef4c3dee0>]}
[0m10:24:40.397876 [info ] [Thread-1 (]: 1 of 4 OK created sql table model lead_trusted.non_pii_data .................... [[32mSELECT 403438[0m in 7.78s]
[0m10:24:40.399241 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_non_pii_data
[0m10:24:40.400208 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_payment_data
[0m10:24:40.401074 [info ] [Thread-1 (]: 2 of 4 START sql table model lead_trusted.payment_data ......................... [RUN]
[0m10:24:40.401948 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_non_pii_data, now model.dbt_lead_data.trusted_payment_data)
[0m10:24:40.402649 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_payment_data
[0m10:24:40.407431 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_payment_data"
[0m10:24:40.410092 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_payment_data
[0m10:24:40.414577 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_payment_data"
[0m10:24:40.416977 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m10:24:40.417686 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: BEGIN
[0m10:24:40.418348 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:24:40.423715 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m10:24:40.424868 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m10:24:40.425698 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */

  
    

  create  table "airflow"."lead_trusted"."payment_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        fnu.unique_id,
        df.iban,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.session_duration,
        fnu.consumed_traffic,
        ((fnu.download_speed + fnu.upload_speed + 1)/2) + (fnu.consumed_traffic / (fnu.session_duration + 1)) AS payment_amount
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    JOIN
        "airflow"."lead_staging"."dim_finance" df
    ON
	    fnu.unique_id = df.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:24:42.956711 [debug] [Thread-1 (]: SQL status: SELECT 403438 in 2.530 seconds
[0m10:24:42.960110 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m10:24:42.960878 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
alter table "airflow"."lead_trusted"."payment_data" rename to "payment_data__dbt_backup"
[0m10:24:42.962160 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:24:42.965499 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m10:24:42.966266 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
alter table "airflow"."lead_trusted"."payment_data__dbt_tmp" rename to "payment_data"
[0m10:24:42.967406 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:24:42.969734 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: COMMIT
[0m10:24:42.970459 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m10:24:42.971174 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: COMMIT
[0m10:24:42.975349 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m10:24:42.978058 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."payment_data__dbt_backup"
[0m10:24:42.979238 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m10:24:42.979979 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
drop table if exists "airflow"."lead_trusted"."payment_data__dbt_backup" cascade
[0m10:24:42.985031 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m10:24:42.986987 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: Close
[0m10:24:42.988108 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a77070d1-143f-400b-aa30-06f9dc642236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdef060f8f0>]}
[0m10:24:42.989117 [info ] [Thread-1 (]: 2 of 4 OK created sql table model lead_trusted.payment_data .................... [[32mSELECT 403438[0m in 2.59s]
[0m10:24:42.990217 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_payment_data
[0m10:24:42.991079 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_pii_data
[0m10:24:42.991946 [info ] [Thread-1 (]: 3 of 4 START sql table model lead_trusted.pii_data ............................. [RUN]
[0m10:24:42.992880 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_payment_data, now model.dbt_lead_data.trusted_pii_data)
[0m10:24:42.993675 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_pii_data
[0m10:24:42.998417 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_pii_data"
[0m10:24:43.000715 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_pii_data
[0m10:24:43.006230 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_pii_data"
[0m10:24:43.008273 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m10:24:43.008949 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: BEGIN
[0m10:24:43.009640 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:24:43.014222 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m10:24:43.014966 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m10:24:43.015688 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */

  
    

  create  table "airflow"."lead_trusted"."pii_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        dp.person_name,
        dp.user_name,
        dp.email,
        dp.personal_number, 
        dp.birth_date, 
        da.address,
        dp.phone, 
        da.mac_address,
        da.ip_address,
        df.iban,
        dd.accessed_at,
        fnu.session_duration,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.consumed_traffic,
        fnu.unique_id
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    INNER JOIN
        "airflow"."lead_staging"."dim_address" da ON fnu.unique_id = da.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_date" dd ON da.unique_id = dd.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_finance" df ON dd.unique_id = df.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_person" dp ON df.unique_id = dp.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:24:50.606619 [debug] [Thread-1 (]: SQL status: SELECT 403438 in 7.590 seconds
[0m10:24:50.611128 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m10:24:50.612014 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */
alter table "airflow"."lead_trusted"."pii_data" rename to "pii_data__dbt_backup"
[0m10:24:50.613324 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:24:50.617209 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m10:24:50.618007 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */
alter table "airflow"."lead_trusted"."pii_data__dbt_tmp" rename to "pii_data"
[0m10:24:50.619210 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:24:50.621775 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: COMMIT
[0m10:24:50.622720 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m10:24:50.623562 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: COMMIT
[0m10:24:50.627531 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m10:24:50.630576 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."pii_data__dbt_backup"
[0m10:24:50.631736 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m10:24:50.632490 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */
drop table if exists "airflow"."lead_trusted"."pii_data__dbt_backup" cascade
[0m10:24:50.640180 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m10:24:50.642498 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: Close
[0m10:24:50.643565 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a77070d1-143f-400b-aa30-06f9dc642236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdef050e120>]}
[0m10:24:50.644532 [info ] [Thread-1 (]: 3 of 4 OK created sql table model lead_trusted.pii_data ........................ [[32mSELECT 403438[0m in 7.65s]
[0m10:24:50.645519 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_pii_data
[0m10:24:50.646312 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_technical_data
[0m10:24:50.647219 [info ] [Thread-1 (]: 4 of 4 START sql table model lead_trusted.technical_data ....................... [RUN]
[0m10:24:50.648127 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_pii_data, now model.dbt_lead_data.trusted_technical_data)
[0m10:24:50.648848 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_technical_data
[0m10:24:50.652980 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_technical_data"
[0m10:24:50.655713 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_technical_data
[0m10:24:50.660529 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_technical_data"
[0m10:24:50.662929 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m10:24:50.663684 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: BEGIN
[0m10:24:50.664393 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:24:50.669600 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m10:24:50.670429 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m10:24:50.671246 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */

  
    

  create  table "airflow"."lead_trusted"."technical_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        fnu.unique_id,
        da.address,
        da.mac_address,
        da.ip_address,
        fnu.download_speed,
        fnu.upload_speed,
        ROUND((fnu.session_duration/60), 1) as min_session_duration,
        CASE 
            WHEN fnu.download_speed < 50 OR fnu.upload_speed < 30 OR fnu.session_duration/60 < 1 THEN true
            ELSE false
        END AS technical_issue
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    JOIN
        "airflow"."lead_staging"."dim_address" da
    ON
	    fnu.unique_id = da.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:24:53.619180 [debug] [Thread-1 (]: SQL status: SELECT 403438 in 2.943 seconds
[0m10:24:53.623013 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m10:24:53.623847 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
alter table "airflow"."lead_trusted"."technical_data" rename to "technical_data__dbt_backup"
[0m10:24:53.625043 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:24:53.628511 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m10:24:53.629288 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
alter table "airflow"."lead_trusted"."technical_data__dbt_tmp" rename to "technical_data"
[0m10:24:53.630386 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:24:53.633084 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: COMMIT
[0m10:24:53.633898 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m10:24:53.634671 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: COMMIT
[0m10:24:53.727203 [debug] [Thread-1 (]: SQL status: COMMIT in 0.092 seconds
[0m10:24:53.730312 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."technical_data__dbt_backup"
[0m10:24:53.731487 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m10:24:53.732236 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
drop table if exists "airflow"."lead_trusted"."technical_data__dbt_backup" cascade
[0m10:24:53.737164 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m10:24:53.739101 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: Close
[0m10:24:53.739956 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a77070d1-143f-400b-aa30-06f9dc642236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdef07d2c30>]}
[0m10:24:53.740970 [info ] [Thread-1 (]: 4 of 4 OK created sql table model lead_trusted.technical_data .................. [[32mSELECT 403438[0m in 3.09s]
[0m10:24:53.742053 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_technical_data
[0m10:24:53.744523 [debug] [MainThread]: Using postgres connection "master"
[0m10:24:53.745376 [debug] [MainThread]: On master: BEGIN
[0m10:24:53.746081 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:24:53.750110 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m10:24:53.750902 [debug] [MainThread]: On master: COMMIT
[0m10:24:53.751606 [debug] [MainThread]: Using postgres connection "master"
[0m10:24:53.752358 [debug] [MainThread]: On master: COMMIT
[0m10:24:53.753247 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:24:53.753984 [debug] [MainThread]: On master: Close
[0m10:24:53.755004 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:24:53.755655 [debug] [MainThread]: Connection 'model.dbt_lead_data.trusted_technical_data' was properly closed.
[0m10:24:53.756462 [info ] [MainThread]: 
[0m10:24:53.757219 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 21.28 seconds (21.28s).
[0m10:24:53.759019 [debug] [MainThread]: Command end result
[0m10:24:53.812814 [info ] [MainThread]: 
[0m10:24:53.813649 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:24:53.814497 [info ] [MainThread]: 
[0m10:24:53.815509 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m10:24:53.817014 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 22.093216, "process_user_time": 2.919053, "process_kernel_time": 0.166658, "process_mem_max_rss": "122852", "process_in_blocks": "880", "process_out_blocks": "0"}
[0m10:24:53.817955 [debug] [MainThread]: Command `dbt run` succeeded at 10:24:53.817815 after 22.09 seconds
[0m10:24:53.818720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdef3a3a9c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdef40fbb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdef1b66e70>]}
[0m10:24:53.819429 [debug] [MainThread]: Flushing usage events
