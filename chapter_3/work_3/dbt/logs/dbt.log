[0m10:57:12.987510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cf2e5d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77d1743950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cf7d6630>]}


============================== 10:57:13.011851 | 392a45e0-8e1a-4e15-99b5-7edd68fd7e02 ==============================
[0m10:57:13.011851 [info ] [MainThread]: Running with dbt=1.8.0
[0m10:57:13.012705 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select tag:staging', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:57:13.287926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '392a45e0-8e1a-4e15-99b5-7edd68fd7e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfd50830>]}
[0m10:57:13.346908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '392a45e0-8e1a-4e15-99b5-7edd68fd7e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cf26a540>]}
[0m10:57:13.348119 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:57:13.437687 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m10:57:13.439449 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m10:57:13.440360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '392a45e0-8e1a-4e15-99b5-7edd68fd7e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfad1bb0>]}
[0m10:57:14.732081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '392a45e0-8e1a-4e15-99b5-7edd68fd7e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cd9605f0>]}
[0m10:57:14.852412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '392a45e0-8e1a-4e15-99b5-7edd68fd7e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cead2000>]}
[0m10:57:14.853073 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m10:57:14.853795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '392a45e0-8e1a-4e15-99b5-7edd68fd7e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77ceab39e0>]}
[0m10:57:14.855860 [info ] [MainThread]: 
[0m10:57:14.856822 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:57:14.862635 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m10:57:14.900158 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m10:57:14.901115 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m10:57:14.901966 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:57:14.907174 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.005 seconds
[0m10:57:14.909347 [debug] [ThreadPool]: On list_airflow: Close
[0m10:57:14.910549 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now create_airflow_lead_staging)
[0m10:57:14.911509 [debug] [ThreadPool]: Creating schema "database: "airflow"
schema: "lead_staging"
"
[0m10:57:14.917300 [debug] [ThreadPool]: Using postgres connection "create_airflow_lead_staging"
[0m10:57:14.918047 [debug] [ThreadPool]: On create_airflow_lead_staging: BEGIN
[0m10:57:14.918774 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:57:14.923100 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m10:57:14.923855 [debug] [ThreadPool]: Using postgres connection "create_airflow_lead_staging"
[0m10:57:14.924537 [debug] [ThreadPool]: On create_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "create_airflow_lead_staging"} */
create schema if not exists "lead_staging"
[0m10:57:14.925684 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m10:57:14.927111 [debug] [ThreadPool]: On create_airflow_lead_staging: COMMIT
[0m10:57:14.927730 [debug] [ThreadPool]: Using postgres connection "create_airflow_lead_staging"
[0m10:57:14.928338 [debug] [ThreadPool]: On create_airflow_lead_staging: COMMIT
[0m10:57:14.929535 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m10:57:14.930209 [debug] [ThreadPool]: On create_airflow_lead_staging: Close
[0m10:57:14.932525 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_airflow_lead_staging, now list_airflow_lead_trusted)
[0m10:57:14.939131 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m10:57:14.939911 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m10:57:14.940630 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:57:14.945035 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m10:57:14.945812 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m10:57:14.946478 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m10:57:14.954039 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.007 seconds
[0m10:57:14.955716 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m10:57:14.956573 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m10:57:14.957581 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now list_airflow_lead_staging)
[0m10:57:14.960152 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m10:57:14.960821 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m10:57:14.961419 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:57:14.965394 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m10:57:14.966095 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m10:57:14.966712 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m10:57:14.970080 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m10:57:14.971759 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m10:57:14.972594 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m10:57:14.980067 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:14.980709 [debug] [MainThread]: On master: BEGIN
[0m10:57:14.981348 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:57:14.985340 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m10:57:14.985986 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:14.986658 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:57:14.990504 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m10:57:14.992301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '392a45e0-8e1a-4e15-99b5-7edd68fd7e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cdd14b60>]}
[0m10:57:14.993074 [debug] [MainThread]: On master: ROLLBACK
[0m10:57:14.993798 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:14.994406 [debug] [MainThread]: On master: BEGIN
[0m10:57:14.995264 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:57:14.995839 [debug] [MainThread]: On master: COMMIT
[0m10:57:14.996454 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:14.997060 [debug] [MainThread]: On master: COMMIT
[0m10:57:14.997889 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:57:14.998465 [debug] [MainThread]: On master: Close
[0m10:57:14.999285 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:57:14.999985 [info ] [MainThread]: 
[0m10:57:15.009914 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_adress
[0m10:57:15.010847 [info ] [Thread-1 (]: 1 of 5 START sql table model lead_staging.dim_address .......................... [RUN]
[0m10:57:15.011655 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now model.dbt_lead_data.staging_dim_adress)
[0m10:57:15.012335 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_adress
[0m10:57:15.070261 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_adress"
[0m10:57:15.074309 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_adress
[0m10:57:15.118220 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_adress"
[0m10:57:15.122160 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m10:57:15.122969 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: BEGIN
[0m10:57:15.123664 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:15.128235 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m10:57:15.129114 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m10:57:15.129910 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */

  
    

  create  table "airflow"."lead_staging"."dim_address__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        address,
        mac_address,
        ip_address
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:57:15.265051 [debug] [Thread-1 (]: SQL status: SELECT 100372 in 0.134 seconds
[0m10:57:15.272331 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m10:57:15.273192 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
alter table "airflow"."lead_staging"."dim_address__dbt_tmp" rename to "dim_address"
[0m10:57:15.274496 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:57:15.295017 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m10:57:15.295931 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m10:57:15.296762 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m10:57:15.298907 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:57:15.306138 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_address__dbt_backup"
[0m10:57:15.313057 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m10:57:15.313961 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
drop table if exists "airflow"."lead_staging"."dim_address__dbt_backup" cascade
[0m10:57:15.315077 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m10:57:15.318073 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: Close
[0m10:57:15.320199 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '392a45e0-8e1a-4e15-99b5-7edd68fd7e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cf7d6b10>]}
[0m10:57:15.321259 [info ] [Thread-1 (]: 1 of 5 OK created sql table model lead_staging.dim_address ..................... [[32mSELECT 100372[0m in 0.31s]
[0m10:57:15.322457 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_adress
[0m10:57:15.323349 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_date
[0m10:57:15.324226 [info ] [Thread-1 (]: 2 of 5 START sql table model lead_staging.dim_date ............................. [RUN]
[0m10:57:15.325201 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_adress, now model.dbt_lead_data.staging_dim_date)
[0m10:57:15.325932 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_date
[0m10:57:15.329759 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_date"
[0m10:57:15.331964 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_date
[0m10:57:15.336423 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_date"
[0m10:57:15.339054 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m10:57:15.339759 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: BEGIN
[0m10:57:15.340475 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:15.345135 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m10:57:15.346024 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m10:57:15.346721 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */

  
    

  create  table "airflow"."lead_staging"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        accessed_at
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:57:15.424029 [debug] [Thread-1 (]: SQL status: SELECT 100372 in 0.077 seconds
[0m10:57:15.427626 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m10:57:15.428356 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
alter table "airflow"."lead_staging"."dim_date__dbt_tmp" rename to "dim_date"
[0m10:57:15.429600 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:57:15.431896 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: COMMIT
[0m10:57:15.432584 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m10:57:15.433391 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: COMMIT
[0m10:57:15.440826 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m10:57:15.443834 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_date__dbt_backup"
[0m10:57:15.445107 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m10:57:15.445845 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
drop table if exists "airflow"."lead_staging"."dim_date__dbt_backup" cascade
[0m10:57:15.446900 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m10:57:15.448723 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: Close
[0m10:57:15.449649 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '392a45e0-8e1a-4e15-99b5-7edd68fd7e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cec167b0>]}
[0m10:57:15.450695 [info ] [Thread-1 (]: 2 of 5 OK created sql table model lead_staging.dim_date ........................ [[32mSELECT 100372[0m in 0.12s]
[0m10:57:15.451735 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_date
[0m10:57:15.452629 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_finance
[0m10:57:15.453484 [info ] [Thread-1 (]: 3 of 5 START sql table model lead_staging.dim_finance .......................... [RUN]
[0m10:57:15.454310 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_date, now model.dbt_lead_data.staging_dim_finance)
[0m10:57:15.454966 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_finance
[0m10:57:15.460002 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_finance"
[0m10:57:15.461890 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_finance
[0m10:57:15.465723 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_finance"
[0m10:57:15.467549 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m10:57:15.468260 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: BEGIN
[0m10:57:15.468966 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:15.473165 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m10:57:15.474172 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m10:57:15.475121 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */

  
    

  create  table "airflow"."lead_staging"."dim_finance__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        iban
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:57:15.576679 [debug] [Thread-1 (]: SQL status: SELECT 100372 in 0.101 seconds
[0m10:57:15.580739 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m10:57:15.581616 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
alter table "airflow"."lead_staging"."dim_finance__dbt_tmp" rename to "dim_finance"
[0m10:57:15.583011 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:57:15.585362 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: COMMIT
[0m10:57:15.586225 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m10:57:15.587086 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: COMMIT
[0m10:57:15.589244 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:57:15.592319 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_finance__dbt_backup"
[0m10:57:15.593497 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m10:57:15.594240 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
drop table if exists "airflow"."lead_staging"."dim_finance__dbt_backup" cascade
[0m10:57:15.595253 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m10:57:15.597185 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: Close
[0m10:57:15.598164 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '392a45e0-8e1a-4e15-99b5-7edd68fd7e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77ce9abda0>]}
[0m10:57:15.599145 [info ] [Thread-1 (]: 3 of 5 OK created sql table model lead_staging.dim_finance ..................... [[32mSELECT 100372[0m in 0.14s]
[0m10:57:15.600252 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_finance
[0m10:57:15.601180 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_person
[0m10:57:15.602217 [info ] [Thread-1 (]: 4 of 5 START sql table model lead_staging.dim_person ........................... [RUN]
[0m10:57:15.603153 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_finance, now model.dbt_lead_data.staging_dim_person)
[0m10:57:15.603907 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_person
[0m10:57:15.607480 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_person"
[0m10:57:15.609483 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_person
[0m10:57:15.613856 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_person"
[0m10:57:15.615978 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m10:57:15.616701 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: BEGIN
[0m10:57:15.617574 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:15.622509 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m10:57:15.623391 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m10:57:15.624139 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */

  
    

  create  table "airflow"."lead_staging"."dim_person__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        person_name,
        user_name,
        email,
        phone,
        birth_date,
        personal_number
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:57:15.773138 [debug] [Thread-1 (]: SQL status: SELECT 100372 in 0.148 seconds
[0m10:57:15.777678 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m10:57:15.778835 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
alter table "airflow"."lead_staging"."dim_person__dbt_tmp" rename to "dim_person"
[0m10:57:15.780391 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:57:15.783676 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: COMMIT
[0m10:57:15.784822 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m10:57:15.785892 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: COMMIT
[0m10:57:15.809102 [debug] [Thread-1 (]: SQL status: COMMIT in 0.022 seconds
[0m10:57:15.813302 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_person__dbt_backup"
[0m10:57:15.814841 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m10:57:15.815927 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
drop table if exists "airflow"."lead_staging"."dim_person__dbt_backup" cascade
[0m10:57:15.817316 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m10:57:15.819695 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: Close
[0m10:57:15.821067 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '392a45e0-8e1a-4e15-99b5-7edd68fd7e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cddb74d0>]}
[0m10:57:15.822271 [info ] [Thread-1 (]: 4 of 5 OK created sql table model lead_staging.dim_person ...................... [[32mSELECT 100372[0m in 0.22s]
[0m10:57:15.823537 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_person
[0m10:57:15.824633 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_fact_network_usage
[0m10:57:15.826056 [info ] [Thread-1 (]: 5 of 5 START sql table model lead_staging.fact_network_usage ................... [RUN]
[0m10:57:15.827186 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_person, now model.dbt_lead_data.staging_fact_network_usage)
[0m10:57:15.828125 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_fact_network_usage
[0m10:57:15.832652 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_fact_network_usage"
[0m10:57:15.835980 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_fact_network_usage
[0m10:57:15.841620 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_fact_network_usage"
[0m10:57:15.844456 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m10:57:15.845504 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: BEGIN
[0m10:57:15.846838 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:15.853353 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m10:57:15.854426 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m10:57:15.855386 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */

  
    

  create  table "airflow"."lead_staging"."fact_network_usage__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        session_duration,
        download_speed,
        upload_speed,
        consumed_traffic
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:57:16.000549 [debug] [Thread-1 (]: SQL status: SELECT 100372 in 0.144 seconds
[0m10:57:16.004521 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m10:57:16.005372 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
alter table "airflow"."lead_staging"."fact_network_usage__dbt_tmp" rename to "fact_network_usage"
[0m10:57:16.006574 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:57:16.008858 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: COMMIT
[0m10:57:16.009655 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m10:57:16.010511 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: COMMIT
[0m10:57:16.016613 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m10:57:16.021066 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."fact_network_usage__dbt_backup"
[0m10:57:16.022329 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m10:57:16.023075 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
drop table if exists "airflow"."lead_staging"."fact_network_usage__dbt_backup" cascade
[0m10:57:16.024133 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m10:57:16.026030 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: Close
[0m10:57:16.027042 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '392a45e0-8e1a-4e15-99b5-7edd68fd7e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77ce9eca70>]}
[0m10:57:16.028023 [info ] [Thread-1 (]: 5 of 5 OK created sql table model lead_staging.fact_network_usage .............. [[32mSELECT 100372[0m in 0.20s]
[0m10:57:16.029226 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_fact_network_usage
[0m10:57:16.031369 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:16.031956 [debug] [MainThread]: On master: BEGIN
[0m10:57:16.032511 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:57:16.036661 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m10:57:16.037332 [debug] [MainThread]: On master: COMMIT
[0m10:57:16.037970 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:16.038505 [debug] [MainThread]: On master: COMMIT
[0m10:57:16.039296 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:57:16.039896 [debug] [MainThread]: On master: Close
[0m10:57:16.040590 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:57:16.041273 [debug] [MainThread]: Connection 'model.dbt_lead_data.staging_fact_network_usage' was properly closed.
[0m10:57:16.041956 [info ] [MainThread]: 
[0m10:57:16.042578 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 1.19 seconds (1.19s).
[0m10:57:16.044750 [debug] [MainThread]: Command end result
[0m10:57:16.089325 [info ] [MainThread]: 
[0m10:57:16.090043 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:57:16.091017 [info ] [MainThread]: 
[0m10:57:16.092100 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m10:57:16.093530 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.195838, "process_user_time": 4.206831, "process_kernel_time": 0.216669, "process_mem_max_rss": "127312", "process_in_blocks": "6904", "process_out_blocks": "4056"}
[0m10:57:16.094367 [debug] [MainThread]: Command `dbt run` succeeded at 10:57:16.094241 after 3.20 seconds
[0m10:57:16.094972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cf23b620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cd51c290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cd504860>]}
[0m10:57:16.095531 [debug] [MainThread]: Flushing usage events
[0m10:57:20.340463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8714ee2780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f871520b3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f871534b6e0>]}


============================== 10:57:20.346980 | 3e677b04-2b98-47ca-ae63-a81a8b78c78e ==============================
[0m10:57:20.346980 [info ] [MainThread]: Running with dbt=1.8.0
[0m10:57:20.347924 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select tag:trusted', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:57:20.524639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e677b04-2b98-47ca-ae63-a81a8b78c78e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8715df6fc0>]}
[0m10:57:20.589658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3e677b04-2b98-47ca-ae63-a81a8b78c78e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8714b646e0>]}
[0m10:57:20.591095 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:57:20.685255 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m10:57:20.821499 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:57:20.822389 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:57:20.862807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e677b04-2b98-47ca-ae63-a81a8b78c78e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8714b654f0>]}
[0m10:57:20.992902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e677b04-2b98-47ca-ae63-a81a8b78c78e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f871450cfb0>]}
[0m10:57:20.993789 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m10:57:20.994589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e677b04-2b98-47ca-ae63-a81a8b78c78e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8714b66e40>]}
[0m10:57:20.996987 [info ] [MainThread]: 
[0m10:57:20.998028 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:57:21.004010 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m10:57:21.041721 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m10:57:21.042759 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m10:57:21.043532 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:57:21.048903 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.005 seconds
[0m10:57:21.050870 [debug] [ThreadPool]: On list_airflow: Close
[0m10:57:21.052077 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now create_airflow_lead_trusted)
[0m10:57:21.052890 [debug] [ThreadPool]: Creating schema "database: "airflow"
schema: "lead_trusted"
"
[0m10:57:21.059014 [debug] [ThreadPool]: Using postgres connection "create_airflow_lead_trusted"
[0m10:57:21.059685 [debug] [ThreadPool]: On create_airflow_lead_trusted: BEGIN
[0m10:57:21.060287 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:57:21.064295 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m10:57:21.064979 [debug] [ThreadPool]: Using postgres connection "create_airflow_lead_trusted"
[0m10:57:21.065605 [debug] [ThreadPool]: On create_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "create_airflow_lead_trusted"} */
create schema if not exists "lead_trusted"
[0m10:57:21.066652 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m10:57:21.068026 [debug] [ThreadPool]: On create_airflow_lead_trusted: COMMIT
[0m10:57:21.068608 [debug] [ThreadPool]: Using postgres connection "create_airflow_lead_trusted"
[0m10:57:21.069289 [debug] [ThreadPool]: On create_airflow_lead_trusted: COMMIT
[0m10:57:21.071052 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m10:57:21.071700 [debug] [ThreadPool]: On create_airflow_lead_trusted: Close
[0m10:57:21.074192 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_airflow_lead_trusted, now list_airflow_lead_trusted)
[0m10:57:21.080866 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m10:57:21.081540 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m10:57:21.082228 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:57:21.086182 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m10:57:21.086905 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m10:57:21.087606 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m10:57:21.090630 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m10:57:21.092349 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m10:57:21.093115 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m10:57:21.094106 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now list_airflow_lead_staging)
[0m10:57:21.096533 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m10:57:21.097144 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m10:57:21.097743 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:57:21.101550 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m10:57:21.102345 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m10:57:21.103040 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m10:57:21.106148 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m10:57:21.108044 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m10:57:21.109023 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m10:57:21.116536 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:21.117270 [debug] [MainThread]: On master: BEGIN
[0m10:57:21.117886 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:57:21.122122 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m10:57:21.122881 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:21.123597 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:57:21.127275 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m10:57:21.129263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e677b04-2b98-47ca-ae63-a81a8b78c78e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87151771d0>]}
[0m10:57:21.130118 [debug] [MainThread]: On master: ROLLBACK
[0m10:57:21.131041 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:21.131671 [debug] [MainThread]: On master: BEGIN
[0m10:57:21.132801 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:57:21.133479 [debug] [MainThread]: On master: COMMIT
[0m10:57:21.134230 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:21.134943 [debug] [MainThread]: On master: COMMIT
[0m10:57:21.135820 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:57:21.136468 [debug] [MainThread]: On master: Close
[0m10:57:21.137430 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:57:21.138274 [info ] [MainThread]: 
[0m10:57:21.148725 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_non_pii_data
[0m10:57:21.149773 [info ] [Thread-1 (]: 1 of 4 START sql table model lead_trusted.non_pii_data ......................... [RUN]
[0m10:57:21.150872 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now model.dbt_lead_data.trusted_non_pii_data)
[0m10:57:21.151581 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_non_pii_data
[0m10:57:21.161667 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_non_pii_data"
[0m10:57:21.164098 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_non_pii_data
[0m10:57:21.207347 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_non_pii_data"
[0m10:57:21.209747 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m10:57:21.210633 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: BEGIN
[0m10:57:21.211340 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:21.215408 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m10:57:21.216112 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m10:57:21.216830 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */

  
    

  create  table "airflow"."lead_trusted"."non_pii_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        '***MASKED***' AS person_name,
        SUBSTRING(dp.user_name, 1, 5) || '*****'  user_name,
        SUBSTRING(dp.email, 1, 5) || '*****' AS email,
        '***MASKED***'  AS personal_number, 
        '***MASKED***' AS birth_date, 
        '***MASKED***' AS address,
        '***MASKED***'  AS phone, 
        SUBSTRING(da.mac_address, 1, 5) || '*****' AS mac_address,
        SUBSTRING(da.ip_address, 1, 5) || '*****' AS ip_address,
        SUBSTRING(df.iban, 1, 5) || '*****' AS iban,
        dd.accessed_at,
        fnu.session_duration,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.consumed_traffic,
        fnu.unique_id
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    INNER JOIN
        "airflow"."lead_staging"."dim_address" da ON fnu.unique_id = da.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_date" dd ON da.unique_id = dd.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_finance" df ON dd.unique_id = df.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_person" dp ON df.unique_id = dp.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:57:23.184591 [debug] [Thread-1 (]: SQL status: SELECT 100372 in 1.967 seconds
[0m10:57:23.191559 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m10:57:23.192378 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
alter table "airflow"."lead_trusted"."non_pii_data__dbt_tmp" rename to "non_pii_data"
[0m10:57:23.193543 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:57:23.212618 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: COMMIT
[0m10:57:23.213393 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m10:57:23.214023 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: COMMIT
[0m10:57:23.236633 [debug] [Thread-1 (]: SQL status: COMMIT in 0.022 seconds
[0m10:57:23.243619 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."non_pii_data__dbt_backup"
[0m10:57:23.249880 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m10:57:23.250678 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
drop table if exists "airflow"."lead_trusted"."non_pii_data__dbt_backup" cascade
[0m10:57:23.251796 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m10:57:23.254620 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: Close
[0m10:57:23.256382 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e677b04-2b98-47ca-ae63-a81a8b78c78e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87163d60f0>]}
[0m10:57:23.257355 [info ] [Thread-1 (]: 1 of 4 OK created sql table model lead_trusted.non_pii_data .................... [[32mSELECT 100372[0m in 2.10s]
[0m10:57:23.258589 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_non_pii_data
[0m10:57:23.259434 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_payment_data
[0m10:57:23.260260 [info ] [Thread-1 (]: 2 of 4 START sql table model lead_trusted.payment_data ......................... [RUN]
[0m10:57:23.261128 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_non_pii_data, now model.dbt_lead_data.trusted_payment_data)
[0m10:57:23.261749 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_payment_data
[0m10:57:23.265636 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_payment_data"
[0m10:57:23.268012 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_payment_data
[0m10:57:23.272213 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_payment_data"
[0m10:57:23.274313 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m10:57:23.275027 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: BEGIN
[0m10:57:23.275627 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:23.279976 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m10:57:23.280730 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m10:57:23.281589 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */

  
    

  create  table "airflow"."lead_trusted"."payment_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        fnu.unique_id,
        df.iban,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.session_duration,
        fnu.consumed_traffic,
        ((fnu.download_speed + fnu.upload_speed + 1)/2) + (fnu.consumed_traffic / (fnu.session_duration + 1)) AS payment_amount
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    JOIN
        "airflow"."lead_staging"."dim_finance" df
    ON
	    fnu.unique_id = df.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:57:23.806075 [debug] [Thread-1 (]: SQL status: SELECT 100372 in 0.524 seconds
[0m10:57:23.809431 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m10:57:23.810080 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
alter table "airflow"."lead_trusted"."payment_data__dbt_tmp" rename to "payment_data"
[0m10:57:23.811048 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:57:23.812832 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: COMMIT
[0m10:57:23.813525 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m10:57:23.814282 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: COMMIT
[0m10:57:23.818019 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m10:57:23.820643 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."payment_data__dbt_backup"
[0m10:57:23.821790 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m10:57:23.822556 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
drop table if exists "airflow"."lead_trusted"."payment_data__dbt_backup" cascade
[0m10:57:23.823610 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m10:57:23.825558 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: Close
[0m10:57:23.826511 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e677b04-2b98-47ca-ae63-a81a8b78c78e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87129b3f80>]}
[0m10:57:23.827384 [info ] [Thread-1 (]: 2 of 4 OK created sql table model lead_trusted.payment_data .................... [[32mSELECT 100372[0m in 0.57s]
[0m10:57:23.828372 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_payment_data
[0m10:57:23.829132 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_pii_data
[0m10:57:23.829976 [info ] [Thread-1 (]: 3 of 4 START sql table model lead_trusted.pii_data ............................. [RUN]
[0m10:57:23.830742 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_payment_data, now model.dbt_lead_data.trusted_pii_data)
[0m10:57:23.831582 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_pii_data
[0m10:57:23.836389 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_pii_data"
[0m10:57:23.838275 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_pii_data
[0m10:57:23.843830 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_pii_data"
[0m10:57:23.845727 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m10:57:23.846438 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: BEGIN
[0m10:57:23.847115 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:23.851690 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m10:57:23.852575 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m10:57:23.853359 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */

  
    

  create  table "airflow"."lead_trusted"."pii_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        dp.person_name,
        dp.user_name,
        dp.email,
        dp.personal_number, 
        dp.birth_date, 
        da.address,
        dp.phone, 
        da.mac_address,
        da.ip_address,
        df.iban,
        dd.accessed_at,
        fnu.session_duration,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.consumed_traffic,
        fnu.unique_id
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    INNER JOIN
        "airflow"."lead_staging"."dim_address" da ON fnu.unique_id = da.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_date" dd ON da.unique_id = dd.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_finance" df ON dd.unique_id = df.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_person" dp ON df.unique_id = dp.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:57:25.855157 [debug] [Thread-1 (]: SQL status: SELECT 100372 in 2.001 seconds
[0m10:57:25.859333 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m10:57:25.860091 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */
alter table "airflow"."lead_trusted"."pii_data__dbt_tmp" rename to "pii_data"
[0m10:57:25.861166 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:57:25.863190 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: COMMIT
[0m10:57:25.863908 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m10:57:25.864636 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: COMMIT
[0m10:57:25.870570 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m10:57:25.873598 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."pii_data__dbt_backup"
[0m10:57:25.874702 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m10:57:25.875451 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */
drop table if exists "airflow"."lead_trusted"."pii_data__dbt_backup" cascade
[0m10:57:25.876457 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m10:57:25.878230 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: Close
[0m10:57:25.879104 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e677b04-2b98-47ca-ae63-a81a8b78c78e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87129af8c0>]}
[0m10:57:25.880008 [info ] [Thread-1 (]: 3 of 4 OK created sql table model lead_trusted.pii_data ........................ [[32mSELECT 100372[0m in 2.05s]
[0m10:57:25.881133 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_pii_data
[0m10:57:25.881926 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_technical_data
[0m10:57:25.882709 [info ] [Thread-1 (]: 4 of 4 START sql table model lead_trusted.technical_data ....................... [RUN]
[0m10:57:25.883555 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_pii_data, now model.dbt_lead_data.trusted_technical_data)
[0m10:57:25.884252 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_technical_data
[0m10:57:25.888521 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_technical_data"
[0m10:57:25.891365 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_technical_data
[0m10:57:25.895778 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_technical_data"
[0m10:57:25.899141 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m10:57:25.899965 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: BEGIN
[0m10:57:25.900820 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:25.905401 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m10:57:25.906260 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m10:57:25.907010 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */

  
    

  create  table "airflow"."lead_trusted"."technical_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        fnu.unique_id,
        da.address,
        da.mac_address,
        da.ip_address,
        fnu.download_speed,
        fnu.upload_speed,
        ROUND((fnu.session_duration/60), 1) as min_session_duration,
        CASE 
            WHEN fnu.download_speed < 50 OR fnu.upload_speed < 30 OR fnu.session_duration/60 < 1 THEN true
            ELSE false
        END AS technical_issue
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    JOIN
        "airflow"."lead_staging"."dim_address" da
    ON
	    fnu.unique_id = da.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:57:26.489872 [debug] [Thread-1 (]: SQL status: SELECT 100372 in 0.582 seconds
[0m10:57:26.493450 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m10:57:26.494140 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
alter table "airflow"."lead_trusted"."technical_data__dbt_tmp" rename to "technical_data"
[0m10:57:26.495071 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:57:26.496879 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: COMMIT
[0m10:57:26.497523 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m10:57:26.498166 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: COMMIT
[0m10:57:26.504914 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m10:57:26.507777 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."technical_data__dbt_backup"
[0m10:57:26.508931 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m10:57:26.509660 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
drop table if exists "airflow"."lead_trusted"."technical_data__dbt_backup" cascade
[0m10:57:26.510722 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m10:57:26.512602 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: Close
[0m10:57:26.513513 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e677b04-2b98-47ca-ae63-a81a8b78c78e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8711d08e90>]}
[0m10:57:26.514483 [info ] [Thread-1 (]: 4 of 4 OK created sql table model lead_trusted.technical_data .................. [[32mSELECT 100372[0m in 0.63s]
[0m10:57:26.515501 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_technical_data
[0m10:57:26.517678 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:26.518470 [debug] [MainThread]: On master: BEGIN
[0m10:57:26.519163 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:57:26.523323 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m10:57:26.524153 [debug] [MainThread]: On master: COMMIT
[0m10:57:26.524969 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:26.525636 [debug] [MainThread]: On master: COMMIT
[0m10:57:26.526489 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:57:26.527232 [debug] [MainThread]: On master: Close
[0m10:57:26.528186 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:57:26.528907 [debug] [MainThread]: Connection 'model.dbt_lead_data.trusted_technical_data' was properly closed.
[0m10:57:26.529661 [info ] [MainThread]: 
[0m10:57:26.530426 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 5.53 seconds (5.53s).
[0m10:57:26.532308 [debug] [MainThread]: Command end result
[0m10:57:26.587100 [info ] [MainThread]: 
[0m10:57:26.588039 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:57:26.588980 [info ] [MainThread]: 
[0m10:57:26.589936 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m10:57:26.591402 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.308841, "process_user_time": 2.770224, "process_kernel_time": 0.147502, "process_mem_max_rss": "121692", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:57:26.592350 [debug] [MainThread]: Command `dbt run` succeeded at 10:57:26.592209 after 6.31 seconds
[0m10:57:26.593051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87156a0a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8715710a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f871589c740>]}
[0m10:57:26.593773 [debug] [MainThread]: Flushing usage events
[0m10:19:53.982326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4e8f45c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4e8d824b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4e8f451c0>]}


============================== 10:19:54.006697 | 32366fca-979c-44a6-a061-f2448f2f82c4 ==============================
[0m10:19:54.006697 [info ] [MainThread]: Running with dbt=1.8.0
[0m10:19:54.007712 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select tag:staging', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:19:54.217660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '32366fca-979c-44a6-a061-f2448f2f82c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4ea24be90>]}
[0m10:19:54.286291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '32366fca-979c-44a6-a061-f2448f2f82c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4e9a50c20>]}
[0m10:19:54.287574 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:19:54.378409 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m10:19:54.523210 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:19:54.523912 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:19:54.562261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '32366fca-979c-44a6-a061-f2448f2f82c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4e87319d0>]}
[0m10:19:54.699166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '32366fca-979c-44a6-a061-f2448f2f82c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4e77adcd0>]}
[0m10:19:54.700091 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m10:19:54.700825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32366fca-979c-44a6-a061-f2448f2f82c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4e77c67e0>]}
[0m10:19:54.703338 [info ] [MainThread]: 
[0m10:19:54.704506 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:19:54.710210 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m10:19:54.752182 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m10:19:54.753107 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m10:19:54.753805 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:19:54.759820 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.006 seconds
[0m10:19:54.761931 [debug] [ThreadPool]: On list_airflow: Close
[0m10:19:54.764806 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_staging)
[0m10:19:54.771784 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m10:19:54.772644 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m10:19:54.773409 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:19:54.779004 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m10:19:54.780063 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m10:19:54.780821 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m10:19:54.784683 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.003 seconds
[0m10:19:54.786636 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m10:19:54.787697 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m10:19:54.788753 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now list_airflow_lead_trusted)
[0m10:19:54.792499 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m10:19:54.793306 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m10:19:54.793918 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:19:54.798281 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m10:19:54.799132 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m10:19:54.799798 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m10:19:54.803055 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m10:19:54.804948 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m10:19:54.805959 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m10:19:54.813320 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:54.814187 [debug] [MainThread]: On master: BEGIN
[0m10:19:54.814909 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:19:54.819569 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m10:19:54.820339 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:54.821083 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:19:54.825368 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m10:19:54.827471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32366fca-979c-44a6-a061-f2448f2f82c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4e77c8980>]}
[0m10:19:54.828403 [debug] [MainThread]: On master: ROLLBACK
[0m10:19:54.829348 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:54.830065 [debug] [MainThread]: On master: BEGIN
[0m10:19:54.831149 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:19:54.831869 [debug] [MainThread]: On master: COMMIT
[0m10:19:54.832626 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:54.833407 [debug] [MainThread]: On master: COMMIT
[0m10:19:54.834434 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:19:54.835193 [debug] [MainThread]: On master: Close
[0m10:19:54.836219 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:19:54.836977 [info ] [MainThread]: 
[0m10:19:54.848297 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_adress
[0m10:19:54.849299 [info ] [Thread-1 (]: 1 of 5 START sql table model lead_staging.dim_address .......................... [RUN]
[0m10:19:54.850205 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now model.dbt_lead_data.staging_dim_adress)
[0m10:19:54.850878 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_adress
[0m10:19:54.860475 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_adress"
[0m10:19:54.863320 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_adress
[0m10:19:54.908885 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_adress"
[0m10:19:54.911620 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m10:19:54.912288 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: BEGIN
[0m10:19:54.912911 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:19:54.917739 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m10:19:54.918659 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m10:19:54.919449 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */

  
    

  create  table "airflow"."lead_staging"."dim_address__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        address,
        mac_address,
        ip_address
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:19:55.066165 [debug] [Thread-1 (]: SQL status: SELECT 101388 in 0.146 seconds
[0m10:19:55.075280 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m10:19:55.076118 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
alter table "airflow"."lead_staging"."dim_address" rename to "dim_address__dbt_backup"
[0m10:19:55.077273 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:19:55.080862 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m10:19:55.081679 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
alter table "airflow"."lead_staging"."dim_address__dbt_tmp" rename to "dim_address"
[0m10:19:55.082998 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:19:55.105710 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m10:19:55.106604 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m10:19:55.107364 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m10:19:55.108768 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:19:55.115476 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_address__dbt_backup"
[0m10:19:55.121692 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m10:19:55.122446 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
drop table if exists "airflow"."lead_staging"."dim_address__dbt_backup" cascade
[0m10:19:55.128206 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m10:19:55.131149 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: Close
[0m10:19:55.132945 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32366fca-979c-44a6-a061-f2448f2f82c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4ea24a990>]}
[0m10:19:55.133937 [info ] [Thread-1 (]: 1 of 5 OK created sql table model lead_staging.dim_address ..................... [[32mSELECT 101388[0m in 0.28s]
[0m10:19:55.135066 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_adress
[0m10:19:55.135925 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_date
[0m10:19:55.136776 [info ] [Thread-1 (]: 2 of 5 START sql table model lead_staging.dim_date ............................. [RUN]
[0m10:19:55.137608 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_adress, now model.dbt_lead_data.staging_dim_date)
[0m10:19:55.138338 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_date
[0m10:19:55.141974 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_date"
[0m10:19:55.143850 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_date
[0m10:19:55.147864 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_date"
[0m10:19:55.149840 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m10:19:55.150559 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: BEGIN
[0m10:19:55.151268 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:19:55.155732 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m10:19:55.156533 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m10:19:55.157184 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */

  
    

  create  table "airflow"."lead_staging"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        accessed_at
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:19:55.233943 [debug] [Thread-1 (]: SQL status: SELECT 101388 in 0.076 seconds
[0m10:19:55.237717 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m10:19:55.238532 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
alter table "airflow"."lead_staging"."dim_date" rename to "dim_date__dbt_backup"
[0m10:19:55.239885 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:19:55.243338 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m10:19:55.244112 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
alter table "airflow"."lead_staging"."dim_date__dbt_tmp" rename to "dim_date"
[0m10:19:55.245193 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:19:55.247473 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: COMMIT
[0m10:19:55.248161 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m10:19:55.248820 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: COMMIT
[0m10:19:55.261773 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m10:19:55.264945 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_date__dbt_backup"
[0m10:19:55.266183 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m10:19:55.266898 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
drop table if exists "airflow"."lead_staging"."dim_date__dbt_backup" cascade
[0m10:19:55.269377 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m10:19:55.271120 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: Close
[0m10:19:55.272288 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32366fca-979c-44a6-a061-f2448f2f82c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4e674b860>]}
[0m10:19:55.273293 [info ] [Thread-1 (]: 2 of 5 OK created sql table model lead_staging.dim_date ........................ [[32mSELECT 101388[0m in 0.13s]
[0m10:19:55.274355 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_date
[0m10:19:55.275186 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_finance
[0m10:19:55.276038 [info ] [Thread-1 (]: 3 of 5 START sql table model lead_staging.dim_finance .......................... [RUN]
[0m10:19:55.276855 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_date, now model.dbt_lead_data.staging_dim_finance)
[0m10:19:55.277545 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_finance
[0m10:19:55.281075 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_finance"
[0m10:19:55.283191 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_finance
[0m10:19:55.287223 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_finance"
[0m10:19:55.289294 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m10:19:55.289942 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: BEGIN
[0m10:19:55.290588 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:19:55.295208 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m10:19:55.295915 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m10:19:55.296655 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */

  
    

  create  table "airflow"."lead_staging"."dim_finance__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        iban
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:19:55.388551 [debug] [Thread-1 (]: SQL status: SELECT 101388 in 0.091 seconds
[0m10:19:55.392418 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m10:19:55.393165 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
alter table "airflow"."lead_staging"."dim_finance" rename to "dim_finance__dbt_backup"
[0m10:19:55.394376 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:19:55.399313 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m10:19:55.400092 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
alter table "airflow"."lead_staging"."dim_finance__dbt_tmp" rename to "dim_finance"
[0m10:19:55.401127 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:19:55.403615 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: COMMIT
[0m10:19:55.404328 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m10:19:55.405053 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: COMMIT
[0m10:19:55.426185 [debug] [Thread-1 (]: SQL status: COMMIT in 0.020 seconds
[0m10:19:55.429220 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_finance__dbt_backup"
[0m10:19:55.430612 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m10:19:55.431329 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
drop table if exists "airflow"."lead_staging"."dim_finance__dbt_backup" cascade
[0m10:19:55.434039 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m10:19:55.435983 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: Close
[0m10:19:55.436972 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32366fca-979c-44a6-a061-f2448f2f82c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4e5b9b5f0>]}
[0m10:19:55.438009 [info ] [Thread-1 (]: 3 of 5 OK created sql table model lead_staging.dim_finance ..................... [[32mSELECT 101388[0m in 0.16s]
[0m10:19:55.439127 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_finance
[0m10:19:55.440059 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_person
[0m10:19:55.440987 [info ] [Thread-1 (]: 4 of 5 START sql table model lead_staging.dim_person ........................... [RUN]
[0m10:19:55.441881 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_finance, now model.dbt_lead_data.staging_dim_person)
[0m10:19:55.442642 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_person
[0m10:19:55.446274 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_person"
[0m10:19:55.448286 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_person
[0m10:19:55.452479 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_person"
[0m10:19:55.454357 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m10:19:55.454989 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: BEGIN
[0m10:19:55.455728 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:19:55.460376 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m10:19:55.461194 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m10:19:55.461864 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */

  
    

  create  table "airflow"."lead_staging"."dim_person__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        person_name,
        user_name,
        email,
        phone,
        birth_date,
        personal_number
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:19:55.612498 [debug] [Thread-1 (]: SQL status: SELECT 101388 in 0.150 seconds
[0m10:19:55.616497 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m10:19:55.617282 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
alter table "airflow"."lead_staging"."dim_person" rename to "dim_person__dbt_backup"
[0m10:19:55.618508 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:19:55.621847 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m10:19:55.622726 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
alter table "airflow"."lead_staging"."dim_person__dbt_tmp" rename to "dim_person"
[0m10:19:55.624247 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:19:55.626904 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: COMMIT
[0m10:19:55.627836 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m10:19:55.628716 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: COMMIT
[0m10:19:55.636957 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m10:19:55.640171 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_person__dbt_backup"
[0m10:19:55.641666 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m10:19:55.642538 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
drop table if exists "airflow"."lead_staging"."dim_person__dbt_backup" cascade
[0m10:19:55.646921 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m10:19:55.649038 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: Close
[0m10:19:55.649961 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32366fca-979c-44a6-a061-f2448f2f82c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4e5b63050>]}
[0m10:19:55.650945 [info ] [Thread-1 (]: 4 of 5 OK created sql table model lead_staging.dim_person ...................... [[32mSELECT 101388[0m in 0.21s]
[0m10:19:55.651987 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_person
[0m10:19:55.652823 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_fact_network_usage
[0m10:19:55.653691 [info ] [Thread-1 (]: 5 of 5 START sql table model lead_staging.fact_network_usage ................... [RUN]
[0m10:19:55.654540 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_person, now model.dbt_lead_data.staging_fact_network_usage)
[0m10:19:55.655300 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_fact_network_usage
[0m10:19:55.659606 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_fact_network_usage"
[0m10:19:55.662131 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_fact_network_usage
[0m10:19:55.666355 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_fact_network_usage"
[0m10:19:55.668274 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m10:19:55.669016 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: BEGIN
[0m10:19:55.669749 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:19:55.676917 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m10:19:55.678832 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m10:19:55.679941 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */

  
    

  create  table "airflow"."lead_staging"."fact_network_usage__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        session_duration,
        download_speed,
        upload_speed,
        consumed_traffic
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:19:55.777636 [debug] [Thread-1 (]: SQL status: SELECT 101388 in 0.097 seconds
[0m10:19:55.781404 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m10:19:55.782205 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
alter table "airflow"."lead_staging"."fact_network_usage" rename to "fact_network_usage__dbt_backup"
[0m10:19:55.783389 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:19:55.786649 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m10:19:55.787514 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
alter table "airflow"."lead_staging"."fact_network_usage__dbt_tmp" rename to "fact_network_usage"
[0m10:19:55.788706 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:19:55.791569 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: COMMIT
[0m10:19:55.792507 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m10:19:55.793258 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: COMMIT
[0m10:19:55.801401 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m10:19:55.805910 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."fact_network_usage__dbt_backup"
[0m10:19:55.807580 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m10:19:55.808422 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
drop table if exists "airflow"."lead_staging"."fact_network_usage__dbt_backup" cascade
[0m10:19:55.811667 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m10:19:55.813624 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: Close
[0m10:19:55.814547 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32366fca-979c-44a6-a061-f2448f2f82c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4e5bc22d0>]}
[0m10:19:55.815509 [info ] [Thread-1 (]: 5 of 5 OK created sql table model lead_staging.fact_network_usage .............. [[32mSELECT 101388[0m in 0.16s]
[0m10:19:55.816690 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_fact_network_usage
[0m10:19:55.819192 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:55.819874 [debug] [MainThread]: On master: BEGIN
[0m10:19:55.820579 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:19:55.825197 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m10:19:55.826058 [debug] [MainThread]: On master: COMMIT
[0m10:19:55.826710 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:55.827379 [debug] [MainThread]: On master: COMMIT
[0m10:19:55.828220 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:19:55.828893 [debug] [MainThread]: On master: Close
[0m10:19:55.829792 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:19:55.830496 [debug] [MainThread]: Connection 'model.dbt_lead_data.staging_fact_network_usage' was properly closed.
[0m10:19:55.831278 [info ] [MainThread]: 
[0m10:19:55.832121 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 1.13 seconds (1.13s).
[0m10:19:55.834304 [debug] [MainThread]: Command end result
[0m10:19:55.890173 [info ] [MainThread]: 
[0m10:19:55.891268 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:19:55.892469 [info ] [MainThread]: 
[0m10:19:55.893412 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m10:19:55.894742 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.0122557, "process_user_time": 3.081633, "process_kernel_time": 0.171706, "process_mem_max_rss": "122552", "process_in_blocks": "528", "process_out_blocks": "4056"}
[0m10:19:55.895664 [debug] [MainThread]: Command `dbt run` succeeded at 10:19:55.895533 after 2.01 seconds
[0m10:19:55.896371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4e8cd89e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4e9912360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4e7b1a570>]}
[0m10:19:55.897106 [debug] [MainThread]: Flushing usage events
[0m10:19:59.835760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47f9045ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47f9434a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47f9aa1df0>]}


============================== 10:19:59.842407 | 0e0e5d9a-9673-497c-9b62-d9335fa048e4 ==============================
[0m10:19:59.842407 [info ] [MainThread]: Running with dbt=1.8.0
[0m10:19:59.843341 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select tag:trusted', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:20:00.037486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0e0e5d9a-9673-497c-9b62-d9335fa048e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47f8c22960>]}
[0m10:20:00.095316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0e0e5d9a-9673-497c-9b62-d9335fa048e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47f939cef0>]}
[0m10:20:00.096344 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:20:00.176989 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m10:20:00.283815 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:20:00.284639 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:20:00.317577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0e0e5d9a-9673-497c-9b62-d9335fa048e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47f939f350>]}
[0m10:20:00.432110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0e0e5d9a-9673-497c-9b62-d9335fa048e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47f7b982f0>]}
[0m10:20:00.432783 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m10:20:00.433485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e0e5d9a-9673-497c-9b62-d9335fa048e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47f9855c40>]}
[0m10:20:00.435905 [info ] [MainThread]: 
[0m10:20:00.437370 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:20:00.443817 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m10:20:00.477170 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m10:20:00.477870 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m10:20:00.478628 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:20:00.483548 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.005 seconds
[0m10:20:00.485356 [debug] [ThreadPool]: On list_airflow: Close
[0m10:20:00.487779 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_staging)
[0m10:20:00.493974 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m10:20:00.494659 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m10:20:00.495322 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:20:00.499521 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m10:20:00.500273 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m10:20:00.500906 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m10:20:00.503883 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m10:20:00.505783 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m10:20:00.506632 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m10:20:00.507614 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now list_airflow_lead_trusted)
[0m10:20:00.510661 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m10:20:00.511303 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m10:20:00.511877 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:20:00.515599 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m10:20:00.516238 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m10:20:00.516844 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m10:20:00.519762 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m10:20:00.521486 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m10:20:00.522258 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m10:20:00.528774 [debug] [MainThread]: Using postgres connection "master"
[0m10:20:00.529516 [debug] [MainThread]: On master: BEGIN
[0m10:20:00.530229 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:20:00.534259 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m10:20:00.534915 [debug] [MainThread]: Using postgres connection "master"
[0m10:20:00.535667 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:20:00.538775 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m10:20:00.540528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e0e5d9a-9673-497c-9b62-d9335fa048e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47f8782c00>]}
[0m10:20:00.541292 [debug] [MainThread]: On master: ROLLBACK
[0m10:20:00.541938 [debug] [MainThread]: Using postgres connection "master"
[0m10:20:00.542606 [debug] [MainThread]: On master: BEGIN
[0m10:20:00.543444 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:20:00.543986 [debug] [MainThread]: On master: COMMIT
[0m10:20:00.544597 [debug] [MainThread]: Using postgres connection "master"
[0m10:20:00.545136 [debug] [MainThread]: On master: COMMIT
[0m10:20:00.545843 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:20:00.546478 [debug] [MainThread]: On master: Close
[0m10:20:00.547195 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:20:00.547793 [info ] [MainThread]: 
[0m10:20:00.556547 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_non_pii_data
[0m10:20:00.557358 [info ] [Thread-1 (]: 1 of 4 START sql table model lead_trusted.non_pii_data ......................... [RUN]
[0m10:20:00.558336 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now model.dbt_lead_data.trusted_non_pii_data)
[0m10:20:00.558976 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_non_pii_data
[0m10:20:00.568075 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_non_pii_data"
[0m10:20:00.570333 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_non_pii_data
[0m10:20:00.608824 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_non_pii_data"
[0m10:20:00.610980 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m10:20:00.611564 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: BEGIN
[0m10:20:00.612118 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:20:00.615694 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m10:20:00.616497 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m10:20:00.617098 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */

  
    

  create  table "airflow"."lead_trusted"."non_pii_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        '***MASKED***' AS person_name,
        SUBSTRING(dp.user_name, 1, 5) || '*****'  user_name,
        SUBSTRING(dp.email, 1, 5) || '*****' AS email,
        '***MASKED***'  AS personal_number, 
        '***MASKED***' AS birth_date, 
        '***MASKED***' AS address,
        '***MASKED***'  AS phone, 
        SUBSTRING(da.mac_address, 1, 5) || '*****' AS mac_address,
        SUBSTRING(da.ip_address, 1, 5) || '*****' AS ip_address,
        SUBSTRING(df.iban, 1, 5) || '*****' AS iban,
        dd.accessed_at,
        fnu.session_duration,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.consumed_traffic,
        fnu.unique_id
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    INNER JOIN
        "airflow"."lead_staging"."dim_address" da ON fnu.unique_id = da.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_date" dd ON da.unique_id = dd.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_finance" df ON dd.unique_id = df.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_person" dp ON df.unique_id = dp.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:20:02.452707 [debug] [Thread-1 (]: SQL status: SELECT 101388 in 1.835 seconds
[0m10:20:02.460257 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m10:20:02.460980 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
alter table "airflow"."lead_trusted"."non_pii_data" rename to "non_pii_data__dbt_backup"
[0m10:20:02.462746 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:20:02.466318 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m10:20:02.467317 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
alter table "airflow"."lead_trusted"."non_pii_data__dbt_tmp" rename to "non_pii_data"
[0m10:20:02.468436 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:20:02.490941 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: COMMIT
[0m10:20:02.491942 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m10:20:02.492829 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: COMMIT
[0m10:20:02.502621 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m10:20:02.510699 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."non_pii_data__dbt_backup"
[0m10:20:02.517885 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m10:20:02.518787 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
drop table if exists "airflow"."lead_trusted"."non_pii_data__dbt_backup" cascade
[0m10:20:02.523814 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m10:20:02.526905 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: Close
[0m10:20:02.528879 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e0e5d9a-9673-497c-9b62-d9335fa048e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47fa0ddb80>]}
[0m10:20:02.530017 [info ] [Thread-1 (]: 1 of 4 OK created sql table model lead_trusted.non_pii_data .................... [[32mSELECT 101388[0m in 1.97s]
[0m10:20:02.531246 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_non_pii_data
[0m10:20:02.532148 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_payment_data
[0m10:20:02.533119 [info ] [Thread-1 (]: 2 of 4 START sql table model lead_trusted.payment_data ......................... [RUN]
[0m10:20:02.533987 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_non_pii_data, now model.dbt_lead_data.trusted_payment_data)
[0m10:20:02.534882 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_payment_data
[0m10:20:02.538882 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_payment_data"
[0m10:20:02.541717 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_payment_data
[0m10:20:02.545743 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_payment_data"
[0m10:20:02.548109 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m10:20:02.548798 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: BEGIN
[0m10:20:02.549537 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:20:02.554389 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m10:20:02.555254 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m10:20:02.556098 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */

  
    

  create  table "airflow"."lead_trusted"."payment_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        fnu.unique_id,
        df.iban,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.session_duration,
        fnu.consumed_traffic,
        ((fnu.download_speed + fnu.upload_speed + 1)/2) + (fnu.consumed_traffic / (fnu.session_duration + 1)) AS payment_amount
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    JOIN
        "airflow"."lead_staging"."dim_finance" df
    ON
	    fnu.unique_id = df.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:20:03.162511 [debug] [Thread-1 (]: SQL status: SELECT 101388 in 0.605 seconds
[0m10:20:03.166335 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m10:20:03.167118 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
alter table "airflow"."lead_trusted"."payment_data" rename to "payment_data__dbt_backup"
[0m10:20:03.168385 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:20:03.172317 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m10:20:03.173273 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
alter table "airflow"."lead_trusted"."payment_data__dbt_tmp" rename to "payment_data"
[0m10:20:03.174554 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:20:03.177097 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: COMMIT
[0m10:20:03.177866 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m10:20:03.178664 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: COMMIT
[0m10:20:03.190451 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m10:20:03.193598 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."payment_data__dbt_backup"
[0m10:20:03.194795 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m10:20:03.195539 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
drop table if exists "airflow"."lead_trusted"."payment_data__dbt_backup" cascade
[0m10:20:03.199159 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m10:20:03.201052 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: Close
[0m10:20:03.201961 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e0e5d9a-9673-497c-9b62-d9335fa048e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47f5b8b890>]}
[0m10:20:03.203259 [info ] [Thread-1 (]: 2 of 4 OK created sql table model lead_trusted.payment_data .................... [[32mSELECT 101388[0m in 0.67s]
[0m10:20:03.204541 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_payment_data
[0m10:20:03.205497 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_pii_data
[0m10:20:03.206514 [info ] [Thread-1 (]: 3 of 4 START sql table model lead_trusted.pii_data ............................. [RUN]
[0m10:20:03.207484 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_payment_data, now model.dbt_lead_data.trusted_pii_data)
[0m10:20:03.208246 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_pii_data
[0m10:20:03.213220 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_pii_data"
[0m10:20:03.215115 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_pii_data
[0m10:20:03.220767 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_pii_data"
[0m10:20:03.223110 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m10:20:03.223819 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: BEGIN
[0m10:20:03.224532 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:20:03.229429 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m10:20:03.230369 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m10:20:03.231152 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */

  
    

  create  table "airflow"."lead_trusted"."pii_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        dp.person_name,
        dp.user_name,
        dp.email,
        dp.personal_number, 
        dp.birth_date, 
        da.address,
        dp.phone, 
        da.mac_address,
        da.ip_address,
        df.iban,
        dd.accessed_at,
        fnu.session_duration,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.consumed_traffic,
        fnu.unique_id
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    INNER JOIN
        "airflow"."lead_staging"."dim_address" da ON fnu.unique_id = da.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_date" dd ON da.unique_id = dd.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_finance" df ON dd.unique_id = df.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_person" dp ON df.unique_id = dp.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:20:05.352130 [debug] [Thread-1 (]: SQL status: SELECT 101388 in 2.120 seconds
[0m10:20:05.355494 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m10:20:05.356508 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */
alter table "airflow"."lead_trusted"."pii_data" rename to "pii_data__dbt_backup"
[0m10:20:05.357976 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:20:05.361738 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m10:20:05.362505 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */
alter table "airflow"."lead_trusted"."pii_data__dbt_tmp" rename to "pii_data"
[0m10:20:05.364057 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:20:05.366780 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: COMMIT
[0m10:20:05.367560 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m10:20:05.368320 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: COMMIT
[0m10:20:05.374730 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m10:20:05.377964 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."pii_data__dbt_backup"
[0m10:20:05.379350 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m10:20:05.380129 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */
drop table if exists "airflow"."lead_trusted"."pii_data__dbt_backup" cascade
[0m10:20:05.385898 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m10:20:05.388011 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: Close
[0m10:20:05.388969 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e0e5d9a-9673-497c-9b62-d9335fa048e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47f42067e0>]}
[0m10:20:05.390072 [info ] [Thread-1 (]: 3 of 4 OK created sql table model lead_trusted.pii_data ........................ [[32mSELECT 101388[0m in 2.18s]
[0m10:20:05.391445 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_pii_data
[0m10:20:05.392508 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_technical_data
[0m10:20:05.393611 [info ] [Thread-1 (]: 4 of 4 START sql table model lead_trusted.technical_data ....................... [RUN]
[0m10:20:05.394499 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_pii_data, now model.dbt_lead_data.trusted_technical_data)
[0m10:20:05.395278 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_technical_data
[0m10:20:05.399345 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_technical_data"
[0m10:20:05.401839 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_technical_data
[0m10:20:05.406160 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_technical_data"
[0m10:20:05.408649 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m10:20:05.409454 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: BEGIN
[0m10:20:05.410193 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:20:05.415221 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m10:20:05.416153 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m10:20:05.416912 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */

  
    

  create  table "airflow"."lead_trusted"."technical_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        fnu.unique_id,
        da.address,
        da.mac_address,
        da.ip_address,
        fnu.download_speed,
        fnu.upload_speed,
        ROUND((fnu.session_duration/60), 1) as min_session_duration,
        CASE 
            WHEN fnu.download_speed < 50 OR fnu.upload_speed < 30 OR fnu.session_duration/60 < 1 THEN true
            ELSE false
        END AS technical_issue
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    JOIN
        "airflow"."lead_staging"."dim_address" da
    ON
	    fnu.unique_id = da.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:20:06.080960 [debug] [Thread-1 (]: SQL status: SELECT 101388 in 0.663 seconds
[0m10:20:06.084948 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m10:20:06.085847 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
alter table "airflow"."lead_trusted"."technical_data" rename to "technical_data__dbt_backup"
[0m10:20:06.087262 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:20:06.091345 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m10:20:06.092219 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
alter table "airflow"."lead_trusted"."technical_data__dbt_tmp" rename to "technical_data"
[0m10:20:06.093384 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:20:06.095699 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: COMMIT
[0m10:20:06.096411 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m10:20:06.097110 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: COMMIT
[0m10:20:06.102595 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m10:20:06.105635 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."technical_data__dbt_backup"
[0m10:20:06.106798 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m10:20:06.107660 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
drop table if exists "airflow"."lead_trusted"."technical_data__dbt_backup" cascade
[0m10:20:06.111893 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m10:20:06.113882 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: Close
[0m10:20:06.114813 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e0e5d9a-9673-497c-9b62-d9335fa048e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47f67d2330>]}
[0m10:20:06.115874 [info ] [Thread-1 (]: 4 of 4 OK created sql table model lead_trusted.technical_data .................. [[32mSELECT 101388[0m in 0.72s]
[0m10:20:06.116982 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_technical_data
[0m10:20:06.119407 [debug] [MainThread]: Using postgres connection "master"
[0m10:20:06.120150 [debug] [MainThread]: On master: BEGIN
[0m10:20:06.120797 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:20:06.124955 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m10:20:06.125788 [debug] [MainThread]: On master: COMMIT
[0m10:20:06.126613 [debug] [MainThread]: Using postgres connection "master"
[0m10:20:06.127353 [debug] [MainThread]: On master: COMMIT
[0m10:20:06.128184 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:20:06.128882 [debug] [MainThread]: On master: Close
[0m10:20:06.129712 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:20:06.130438 [debug] [MainThread]: Connection 'model.dbt_lead_data.trusted_technical_data' was properly closed.
[0m10:20:06.131236 [info ] [MainThread]: 
[0m10:20:06.132098 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 5.69 seconds (5.69s).
[0m10:20:06.133897 [debug] [MainThread]: Command end result
[0m10:20:06.189861 [info ] [MainThread]: 
[0m10:20:06.191268 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:20:06.192205 [info ] [MainThread]: 
[0m10:20:06.193116 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m10:20:06.195113 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.4160423, "process_user_time": 2.671292, "process_kernel_time": 0.144559, "process_mem_max_rss": "121344", "process_in_blocks": "1872", "process_out_blocks": "0"}
[0m10:20:06.195934 [debug] [MainThread]: Command `dbt run` succeeded at 10:20:06.195806 after 6.42 seconds
[0m10:20:06.196620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47f8bd5460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47f8dbb410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47f8e65f40>]}
[0m10:20:06.197320 [debug] [MainThread]: Flushing usage events
[0m10:21:12.152186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb66b382ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6693e2750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6693e1550>]}


============================== 10:21:12.159235 | 5f715d64-4b75-4215-a1f2-a3e7631308f9 ==============================
[0m10:21:12.159235 [info ] [MainThread]: Running with dbt=1.8.0
[0m10:21:12.160235 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select tag:staging', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:21:12.364994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f715d64-4b75-4215-a1f2-a3e7631308f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb66ab868a0>]}
[0m10:21:12.430436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f715d64-4b75-4215-a1f2-a3e7631308f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb669dcdc10>]}
[0m10:21:12.431790 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:21:12.517830 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m10:21:12.656657 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:21:12.658120 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:21:12.699433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f715d64-4b75-4215-a1f2-a3e7631308f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb66813ce00>]}
[0m10:21:12.820914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f715d64-4b75-4215-a1f2-a3e7631308f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb668171820>]}
[0m10:21:12.821636 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m10:21:12.822271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f715d64-4b75-4215-a1f2-a3e7631308f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb667d9dd90>]}
[0m10:21:12.824700 [info ] [MainThread]: 
[0m10:21:12.825596 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:21:12.830974 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m10:21:12.869207 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m10:21:12.870039 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m10:21:12.870711 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:21:12.875670 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.005 seconds
[0m10:21:12.877682 [debug] [ThreadPool]: On list_airflow: Close
[0m10:21:12.880127 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_trusted)
[0m10:21:12.886795 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m10:21:12.887523 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m10:21:12.888116 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:21:12.892022 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m10:21:12.892786 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m10:21:12.893519 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m10:21:12.896768 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m10:21:12.898742 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m10:21:12.899638 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m10:21:12.900654 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now list_airflow_lead_staging)
[0m10:21:12.903940 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m10:21:12.904613 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m10:21:12.905212 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:21:12.908991 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m10:21:12.909680 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m10:21:12.910274 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m10:21:12.913275 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m10:21:12.915038 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m10:21:12.915853 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m10:21:12.922902 [debug] [MainThread]: Using postgres connection "master"
[0m10:21:12.923645 [debug] [MainThread]: On master: BEGIN
[0m10:21:12.924292 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:21:12.928124 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m10:21:12.928841 [debug] [MainThread]: Using postgres connection "master"
[0m10:21:12.929612 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:21:12.933068 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m10:21:12.934957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f715d64-4b75-4215-a1f2-a3e7631308f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6698b7020>]}
[0m10:21:12.935798 [debug] [MainThread]: On master: ROLLBACK
[0m10:21:12.936673 [debug] [MainThread]: Using postgres connection "master"
[0m10:21:12.937338 [debug] [MainThread]: On master: BEGIN
[0m10:21:12.938394 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:21:12.939069 [debug] [MainThread]: On master: COMMIT
[0m10:21:12.939817 [debug] [MainThread]: Using postgres connection "master"
[0m10:21:12.940509 [debug] [MainThread]: On master: COMMIT
[0m10:21:12.941301 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:21:12.941983 [debug] [MainThread]: On master: Close
[0m10:21:12.942820 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:21:12.943559 [info ] [MainThread]: 
[0m10:21:12.953567 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_adress
[0m10:21:12.954642 [info ] [Thread-1 (]: 1 of 5 START sql table model lead_staging.dim_address .......................... [RUN]
[0m10:21:12.955602 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now model.dbt_lead_data.staging_dim_adress)
[0m10:21:12.956316 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_adress
[0m10:21:12.964934 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_adress"
[0m10:21:12.967498 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_adress
[0m10:21:13.007914 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_adress"
[0m10:21:13.009921 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m10:21:13.010564 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: BEGIN
[0m10:21:13.011112 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:21:13.014916 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m10:21:13.015554 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m10:21:13.016256 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */

  
    

  create  table "airflow"."lead_staging"."dim_address__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        address,
        mac_address,
        ip_address
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:21:13.118302 [debug] [Thread-1 (]: SQL status: SELECT 102322 in 0.101 seconds
[0m10:21:13.126059 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m10:21:13.126954 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
alter table "airflow"."lead_staging"."dim_address" rename to "dim_address__dbt_backup"
[0m10:21:13.128204 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:21:13.131820 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m10:21:13.132609 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
alter table "airflow"."lead_staging"."dim_address__dbt_tmp" rename to "dim_address"
[0m10:21:13.133781 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:21:13.154784 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m10:21:13.155563 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m10:21:13.156566 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m10:21:13.166535 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m10:21:13.173368 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_address__dbt_backup"
[0m10:21:13.179777 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m10:21:13.180584 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
drop table if exists "airflow"."lead_staging"."dim_address__dbt_backup" cascade
[0m10:21:13.184114 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m10:21:13.187011 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: Close
[0m10:21:13.188909 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f715d64-4b75-4215-a1f2-a3e7631308f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb66a619cd0>]}
[0m10:21:13.189948 [info ] [Thread-1 (]: 1 of 5 OK created sql table model lead_staging.dim_address ..................... [[32mSELECT 102322[0m in 0.23s]
[0m10:21:13.191050 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_adress
[0m10:21:13.191898 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_date
[0m10:21:13.192824 [info ] [Thread-1 (]: 2 of 5 START sql table model lead_staging.dim_date ............................. [RUN]
[0m10:21:13.193681 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_adress, now model.dbt_lead_data.staging_dim_date)
[0m10:21:13.194374 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_date
[0m10:21:13.197996 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_date"
[0m10:21:13.199888 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_date
[0m10:21:13.203897 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_date"
[0m10:21:13.205629 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m10:21:13.206321 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: BEGIN
[0m10:21:13.207052 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:21:13.211725 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m10:21:13.212618 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m10:21:13.213331 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */

  
    

  create  table "airflow"."lead_staging"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        accessed_at
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:21:13.318859 [debug] [Thread-1 (]: SQL status: SELECT 102322 in 0.105 seconds
[0m10:21:13.322738 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m10:21:13.323749 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
alter table "airflow"."lead_staging"."dim_date" rename to "dim_date__dbt_backup"
[0m10:21:13.324966 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:21:13.328268 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m10:21:13.329040 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
alter table "airflow"."lead_staging"."dim_date__dbt_tmp" rename to "dim_date"
[0m10:21:13.330136 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:21:13.332585 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: COMMIT
[0m10:21:13.333380 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m10:21:13.334161 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: COMMIT
[0m10:21:13.337014 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m10:21:13.339826 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_date__dbt_backup"
[0m10:21:13.341010 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m10:21:13.341753 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
drop table if exists "airflow"."lead_staging"."dim_date__dbt_backup" cascade
[0m10:21:13.344863 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m10:21:13.346670 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: Close
[0m10:21:13.347600 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f715d64-4b75-4215-a1f2-a3e7631308f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6660b03e0>]}
[0m10:21:13.348561 [info ] [Thread-1 (]: 2 of 5 OK created sql table model lead_staging.dim_date ........................ [[32mSELECT 102322[0m in 0.15s]
[0m10:21:13.349718 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_date
[0m10:21:13.350553 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_finance
[0m10:21:13.351362 [info ] [Thread-1 (]: 3 of 5 START sql table model lead_staging.dim_finance .......................... [RUN]
[0m10:21:13.352220 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_date, now model.dbt_lead_data.staging_dim_finance)
[0m10:21:13.352898 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_finance
[0m10:21:13.356382 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_finance"
[0m10:21:13.358257 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_finance
[0m10:21:13.363531 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_finance"
[0m10:21:13.365493 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m10:21:13.366174 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: BEGIN
[0m10:21:13.366847 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:21:13.371140 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m10:21:13.371926 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m10:21:13.372692 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */

  
    

  create  table "airflow"."lead_staging"."dim_finance__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        iban
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:21:13.447928 [debug] [Thread-1 (]: SQL status: SELECT 102322 in 0.074 seconds
[0m10:21:13.451574 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m10:21:13.452390 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
alter table "airflow"."lead_staging"."dim_finance" rename to "dim_finance__dbt_backup"
[0m10:21:13.453663 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:21:13.457307 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m10:21:13.458116 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
alter table "airflow"."lead_staging"."dim_finance__dbt_tmp" rename to "dim_finance"
[0m10:21:13.459266 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:21:13.461823 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: COMMIT
[0m10:21:13.462626 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m10:21:13.463352 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: COMMIT
[0m10:21:13.489260 [debug] [Thread-1 (]: SQL status: COMMIT in 0.025 seconds
[0m10:21:13.492492 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_finance__dbt_backup"
[0m10:21:13.493912 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m10:21:13.494658 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
drop table if exists "airflow"."lead_staging"."dim_finance__dbt_backup" cascade
[0m10:21:13.498114 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m10:21:13.500030 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: Close
[0m10:21:13.500995 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f715d64-4b75-4215-a1f2-a3e7631308f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6660e17c0>]}
[0m10:21:13.502022 [info ] [Thread-1 (]: 3 of 5 OK created sql table model lead_staging.dim_finance ..................... [[32mSELECT 102322[0m in 0.15s]
[0m10:21:13.503103 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_finance
[0m10:21:13.504026 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_person
[0m10:21:13.504970 [info ] [Thread-1 (]: 4 of 5 START sql table model lead_staging.dim_person ........................... [RUN]
[0m10:21:13.505844 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_finance, now model.dbt_lead_data.staging_dim_person)
[0m10:21:13.506615 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_person
[0m10:21:13.510344 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_person"
[0m10:21:13.512609 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_person
[0m10:21:13.517010 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_person"
[0m10:21:13.519100 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m10:21:13.519857 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: BEGIN
[0m10:21:13.520569 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:21:13.525224 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m10:21:13.526340 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m10:21:13.527220 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */

  
    

  create  table "airflow"."lead_staging"."dim_person__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        person_name,
        user_name,
        email,
        phone,
        birth_date,
        personal_number
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:21:13.647161 [debug] [Thread-1 (]: SQL status: SELECT 102322 in 0.119 seconds
[0m10:21:13.651341 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m10:21:13.652309 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
alter table "airflow"."lead_staging"."dim_person" rename to "dim_person__dbt_backup"
[0m10:21:13.653672 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:21:13.657316 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m10:21:13.658170 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
alter table "airflow"."lead_staging"."dim_person__dbt_tmp" rename to "dim_person"
[0m10:21:13.659428 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:21:13.661864 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: COMMIT
[0m10:21:13.662598 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m10:21:13.663261 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: COMMIT
[0m10:21:13.752989 [debug] [Thread-1 (]: SQL status: COMMIT in 0.089 seconds
[0m10:21:13.756210 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_person__dbt_backup"
[0m10:21:13.757479 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m10:21:13.758280 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
drop table if exists "airflow"."lead_staging"."dim_person__dbt_backup" cascade
[0m10:21:13.762291 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m10:21:13.764298 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: Close
[0m10:21:13.765303 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f715d64-4b75-4215-a1f2-a3e7631308f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6660dae40>]}
[0m10:21:13.766299 [info ] [Thread-1 (]: 4 of 5 OK created sql table model lead_staging.dim_person ...................... [[32mSELECT 102322[0m in 0.26s]
[0m10:21:13.767338 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_person
[0m10:21:13.768180 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_fact_network_usage
[0m10:21:13.769090 [info ] [Thread-1 (]: 5 of 5 START sql table model lead_staging.fact_network_usage ................... [RUN]
[0m10:21:13.769950 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_person, now model.dbt_lead_data.staging_fact_network_usage)
[0m10:21:13.770718 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_fact_network_usage
[0m10:21:13.774666 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_fact_network_usage"
[0m10:21:13.776675 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_fact_network_usage
[0m10:21:13.780728 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_fact_network_usage"
[0m10:21:13.782839 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m10:21:13.783622 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: BEGIN
[0m10:21:13.784274 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:21:13.788900 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m10:21:13.789743 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m10:21:13.790525 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */

  
    

  create  table "airflow"."lead_staging"."fact_network_usage__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        session_duration,
        download_speed,
        upload_speed,
        consumed_traffic
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:21:13.876282 [debug] [Thread-1 (]: SQL status: SELECT 102322 in 0.085 seconds
[0m10:21:13.881558 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m10:21:13.882618 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
alter table "airflow"."lead_staging"."fact_network_usage" rename to "fact_network_usage__dbt_backup"
[0m10:21:13.884009 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:21:13.887643 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m10:21:13.888519 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
alter table "airflow"."lead_staging"."fact_network_usage__dbt_tmp" rename to "fact_network_usage"
[0m10:21:13.889992 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:21:13.892516 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: COMMIT
[0m10:21:13.893435 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m10:21:13.894416 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: COMMIT
[0m10:21:13.898762 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m10:21:13.902136 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."fact_network_usage__dbt_backup"
[0m10:21:13.903481 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m10:21:13.904639 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
drop table if exists "airflow"."lead_staging"."fact_network_usage__dbt_backup" cascade
[0m10:21:13.908628 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m10:21:13.910804 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: Close
[0m10:21:13.911846 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f715d64-4b75-4215-a1f2-a3e7631308f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb66608fb90>]}
[0m10:21:13.912837 [info ] [Thread-1 (]: 5 of 5 OK created sql table model lead_staging.fact_network_usage .............. [[32mSELECT 102322[0m in 0.14s]
[0m10:21:13.913899 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_fact_network_usage
[0m10:21:13.917044 [debug] [MainThread]: Using postgres connection "master"
[0m10:21:13.917928 [debug] [MainThread]: On master: BEGIN
[0m10:21:13.918738 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:21:13.922830 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m10:21:13.923701 [debug] [MainThread]: On master: COMMIT
[0m10:21:13.924398 [debug] [MainThread]: Using postgres connection "master"
[0m10:21:13.925181 [debug] [MainThread]: On master: COMMIT
[0m10:21:13.926065 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:21:13.926796 [debug] [MainThread]: On master: Close
[0m10:21:13.927686 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:21:13.928300 [debug] [MainThread]: Connection 'model.dbt_lead_data.staging_fact_network_usage' was properly closed.
[0m10:21:13.929138 [info ] [MainThread]: 
[0m10:21:13.929914 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 1.10 seconds (1.10s).
[0m10:21:13.932014 [debug] [MainThread]: Command end result
[0m10:21:13.984125 [info ] [MainThread]: 
[0m10:21:13.984999 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:21:13.985788 [info ] [MainThread]: 
[0m10:21:13.986828 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m10:21:13.988196 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.9124242, "process_user_time": 3.025287, "process_kernel_time": 0.201617, "process_mem_max_rss": "123304", "process_in_blocks": "88", "process_out_blocks": "0"}
[0m10:21:13.989115 [debug] [MainThread]: Command `dbt run` succeeded at 10:21:13.988977 after 1.91 seconds
[0m10:21:13.989906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb668170e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6690e6570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6690e66c0>]}
[0m10:21:13.990640 [debug] [MainThread]: Flushing usage events
[0m10:21:17.733718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1759546840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1759dd9dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f175bcfbc20>]}


============================== 10:21:17.740366 | d005425c-2a41-4739-922f-7f2625483126 ==============================
[0m10:21:17.740366 [info ] [MainThread]: Running with dbt=1.8.0
[0m10:21:17.741577 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select tag:trusted', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:21:17.933426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd005425c-2a41-4739-922f-7f2625483126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f175a491c40>]}
[0m10:21:17.998596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd005425c-2a41-4739-922f-7f2625483126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1759593e30>]}
[0m10:21:18.000283 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:21:18.088341 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m10:21:18.203937 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:21:18.204609 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:21:18.239573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd005425c-2a41-4739-922f-7f2625483126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1758579070>]}
[0m10:21:18.359135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd005425c-2a41-4739-922f-7f2625483126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17585bda90>]}
[0m10:21:18.359801 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m10:21:18.360388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd005425c-2a41-4739-922f-7f2625483126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f175856fd70>]}
[0m10:21:18.362710 [info ] [MainThread]: 
[0m10:21:18.363698 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:21:18.368604 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m10:21:18.403749 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m10:21:18.404438 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m10:21:18.405057 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:21:18.410368 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.005 seconds
[0m10:21:18.412140 [debug] [ThreadPool]: On list_airflow: Close
[0m10:21:18.414693 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_staging)
[0m10:21:18.421145 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m10:21:18.421918 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m10:21:18.422542 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:21:18.426661 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m10:21:18.427318 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m10:21:18.428005 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m10:21:18.431035 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m10:21:18.432805 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m10:21:18.433672 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m10:21:18.434709 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now list_airflow_lead_trusted)
[0m10:21:18.438046 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m10:21:18.438739 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m10:21:18.439342 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:21:18.443189 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m10:21:18.443991 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m10:21:18.444688 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m10:21:18.447628 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m10:21:18.449397 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m10:21:18.450159 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m10:21:18.457087 [debug] [MainThread]: Using postgres connection "master"
[0m10:21:18.457819 [debug] [MainThread]: On master: BEGIN
[0m10:21:18.458460 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:21:18.462634 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m10:21:18.463341 [debug] [MainThread]: Using postgres connection "master"
[0m10:21:18.464107 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:21:18.467405 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m10:21:18.469229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd005425c-2a41-4739-922f-7f2625483126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f175a831c10>]}
[0m10:21:18.470070 [debug] [MainThread]: On master: ROLLBACK
[0m10:21:18.470974 [debug] [MainThread]: Using postgres connection "master"
[0m10:21:18.471710 [debug] [MainThread]: On master: BEGIN
[0m10:21:18.472786 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:21:18.473583 [debug] [MainThread]: On master: COMMIT
[0m10:21:18.474311 [debug] [MainThread]: Using postgres connection "master"
[0m10:21:18.475075 [debug] [MainThread]: On master: COMMIT
[0m10:21:18.475928 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:21:18.476621 [debug] [MainThread]: On master: Close
[0m10:21:18.477555 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:21:18.478277 [info ] [MainThread]: 
[0m10:21:18.488057 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_non_pii_data
[0m10:21:18.488946 [info ] [Thread-1 (]: 1 of 4 START sql table model lead_trusted.non_pii_data ......................... [RUN]
[0m10:21:18.489858 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now model.dbt_lead_data.trusted_non_pii_data)
[0m10:21:18.490581 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_non_pii_data
[0m10:21:18.500639 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_non_pii_data"
[0m10:21:18.502911 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_non_pii_data
[0m10:21:18.543780 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_non_pii_data"
[0m10:21:18.546248 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m10:21:18.546848 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: BEGIN
[0m10:21:18.547407 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:21:18.551228 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m10:21:18.551905 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m10:21:18.552575 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */

  
    

  create  table "airflow"."lead_trusted"."non_pii_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        '***MASKED***' AS person_name,
        SUBSTRING(dp.user_name, 1, 5) || '*****'  user_name,
        SUBSTRING(dp.email, 1, 5) || '*****' AS email,
        '***MASKED***'  AS personal_number, 
        '***MASKED***' AS birth_date, 
        '***MASKED***' AS address,
        '***MASKED***'  AS phone, 
        SUBSTRING(da.mac_address, 1, 5) || '*****' AS mac_address,
        SUBSTRING(da.ip_address, 1, 5) || '*****' AS ip_address,
        SUBSTRING(df.iban, 1, 5) || '*****' AS iban,
        dd.accessed_at,
        fnu.session_duration,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.consumed_traffic,
        fnu.unique_id
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    INNER JOIN
        "airflow"."lead_staging"."dim_address" da ON fnu.unique_id = da.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_date" dd ON da.unique_id = dd.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_finance" df ON dd.unique_id = df.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_person" dp ON df.unique_id = dp.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:21:20.326311 [debug] [Thread-1 (]: SQL status: SELECT 102322 in 1.773 seconds
[0m10:21:20.332654 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m10:21:20.333389 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
alter table "airflow"."lead_trusted"."non_pii_data" rename to "non_pii_data__dbt_backup"
[0m10:21:20.334578 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:21:20.337675 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m10:21:20.338317 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
alter table "airflow"."lead_trusted"."non_pii_data__dbt_tmp" rename to "non_pii_data"
[0m10:21:20.339360 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:21:20.359221 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: COMMIT
[0m10:21:20.360018 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m10:21:20.360590 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: COMMIT
[0m10:21:20.367254 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m10:21:20.374127 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."non_pii_data__dbt_backup"
[0m10:21:20.380174 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m10:21:20.380896 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
drop table if exists "airflow"."lead_trusted"."non_pii_data__dbt_backup" cascade
[0m10:21:20.385565 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m10:21:20.388494 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: Close
[0m10:21:20.390321 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd005425c-2a41-4739-922f-7f2625483126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f175aa2dcd0>]}
[0m10:21:20.391333 [info ] [Thread-1 (]: 1 of 4 OK created sql table model lead_trusted.non_pii_data .................... [[32mSELECT 102322[0m in 1.90s]
[0m10:21:20.392533 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_non_pii_data
[0m10:21:20.393380 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_payment_data
[0m10:21:20.394268 [info ] [Thread-1 (]: 2 of 4 START sql table model lead_trusted.payment_data ......................... [RUN]
[0m10:21:20.395090 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_non_pii_data, now model.dbt_lead_data.trusted_payment_data)
[0m10:21:20.395815 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_payment_data
[0m10:21:20.399711 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_payment_data"
[0m10:21:20.401902 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_payment_data
[0m10:21:20.405823 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_payment_data"
[0m10:21:20.408031 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m10:21:20.408719 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: BEGIN
[0m10:21:20.409341 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:21:20.413875 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m10:21:20.414743 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m10:21:20.415441 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */

  
    

  create  table "airflow"."lead_trusted"."payment_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        fnu.unique_id,
        df.iban,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.session_duration,
        fnu.consumed_traffic,
        ((fnu.download_speed + fnu.upload_speed + 1)/2) + (fnu.consumed_traffic / (fnu.session_duration + 1)) AS payment_amount
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    JOIN
        "airflow"."lead_staging"."dim_finance" df
    ON
	    fnu.unique_id = df.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:21:20.957407 [debug] [Thread-1 (]: SQL status: SELECT 102322 in 0.541 seconds
[0m10:21:20.961881 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m10:21:20.962898 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
alter table "airflow"."lead_trusted"."payment_data" rename to "payment_data__dbt_backup"
[0m10:21:20.964135 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:21:20.968038 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m10:21:20.968989 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
alter table "airflow"."lead_trusted"."payment_data__dbt_tmp" rename to "payment_data"
[0m10:21:20.970135 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:21:20.972842 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: COMMIT
[0m10:21:20.973700 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m10:21:20.974398 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: COMMIT
[0m10:21:20.977891 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m10:21:20.980964 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."payment_data__dbt_backup"
[0m10:21:20.982184 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m10:21:20.982942 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
drop table if exists "airflow"."lead_trusted"."payment_data__dbt_backup" cascade
[0m10:21:20.986731 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m10:21:20.988807 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: Close
[0m10:21:20.990219 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd005425c-2a41-4739-922f-7f2625483126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1756333fe0>]}
[0m10:21:20.991447 [info ] [Thread-1 (]: 2 of 4 OK created sql table model lead_trusted.payment_data .................... [[32mSELECT 102322[0m in 0.60s]
[0m10:21:20.992722 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_payment_data
[0m10:21:20.993509 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_pii_data
[0m10:21:20.994459 [info ] [Thread-1 (]: 3 of 4 START sql table model lead_trusted.pii_data ............................. [RUN]
[0m10:21:20.995494 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_payment_data, now model.dbt_lead_data.trusted_pii_data)
[0m10:21:20.996291 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_pii_data
[0m10:21:21.002691 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_pii_data"
[0m10:21:21.005113 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_pii_data
[0m10:21:21.011808 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_pii_data"
[0m10:21:21.013618 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m10:21:21.014462 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: BEGIN
[0m10:21:21.015178 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:21:21.020000 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m10:21:21.020773 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m10:21:21.021511 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */

  
    

  create  table "airflow"."lead_trusted"."pii_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        dp.person_name,
        dp.user_name,
        dp.email,
        dp.personal_number, 
        dp.birth_date, 
        da.address,
        dp.phone, 
        da.mac_address,
        da.ip_address,
        df.iban,
        dd.accessed_at,
        fnu.session_duration,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.consumed_traffic,
        fnu.unique_id
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    INNER JOIN
        "airflow"."lead_staging"."dim_address" da ON fnu.unique_id = da.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_date" dd ON da.unique_id = dd.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_finance" df ON dd.unique_id = df.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_person" dp ON df.unique_id = dp.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:21:22.966749 [debug] [Thread-1 (]: SQL status: SELECT 102322 in 1.944 seconds
[0m10:21:22.970193 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m10:21:22.971116 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */
alter table "airflow"."lead_trusted"."pii_data" rename to "pii_data__dbt_backup"
[0m10:21:22.972387 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:21:22.975913 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m10:21:22.976674 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */
alter table "airflow"."lead_trusted"."pii_data__dbt_tmp" rename to "pii_data"
[0m10:21:22.977725 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:21:22.980534 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: COMMIT
[0m10:21:22.981427 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m10:21:22.982233 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: COMMIT
[0m10:21:23.007565 [debug] [Thread-1 (]: SQL status: COMMIT in 0.024 seconds
[0m10:21:23.011223 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."pii_data__dbt_backup"
[0m10:21:23.012540 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m10:21:23.013356 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */
drop table if exists "airflow"."lead_trusted"."pii_data__dbt_backup" cascade
[0m10:21:23.019776 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m10:21:23.021917 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: Close
[0m10:21:23.023037 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd005425c-2a41-4739-922f-7f2625483126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1756339bb0>]}
[0m10:21:23.024102 [info ] [Thread-1 (]: 3 of 4 OK created sql table model lead_trusted.pii_data ........................ [[32mSELECT 102322[0m in 2.03s]
[0m10:21:23.025365 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_pii_data
[0m10:21:23.026237 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_technical_data
[0m10:21:23.027182 [info ] [Thread-1 (]: 4 of 4 START sql table model lead_trusted.technical_data ....................... [RUN]
[0m10:21:23.028086 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_pii_data, now model.dbt_lead_data.trusted_technical_data)
[0m10:21:23.028891 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_technical_data
[0m10:21:23.033026 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_technical_data"
[0m10:21:23.035542 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_technical_data
[0m10:21:23.040062 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_technical_data"
[0m10:21:23.042407 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m10:21:23.043213 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: BEGIN
[0m10:21:23.044039 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:21:23.048687 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m10:21:23.049533 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m10:21:23.050382 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */

  
    

  create  table "airflow"."lead_trusted"."technical_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        fnu.unique_id,
        da.address,
        da.mac_address,
        da.ip_address,
        fnu.download_speed,
        fnu.upload_speed,
        ROUND((fnu.session_duration/60), 1) as min_session_duration,
        CASE 
            WHEN fnu.download_speed < 50 OR fnu.upload_speed < 30 OR fnu.session_duration/60 < 1 THEN true
            ELSE false
        END AS technical_issue
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    JOIN
        "airflow"."lead_staging"."dim_address" da
    ON
	    fnu.unique_id = da.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:21:23.620117 [debug] [Thread-1 (]: SQL status: SELECT 102322 in 0.569 seconds
[0m10:21:23.623852 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m10:21:23.624629 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
alter table "airflow"."lead_trusted"."technical_data" rename to "technical_data__dbt_backup"
[0m10:21:23.625795 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:21:23.629070 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m10:21:23.629899 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
alter table "airflow"."lead_trusted"."technical_data__dbt_tmp" rename to "technical_data"
[0m10:21:23.631014 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:21:23.633395 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: COMMIT
[0m10:21:23.634191 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m10:21:23.634987 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: COMMIT
[0m10:21:23.640725 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m10:21:23.643662 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."technical_data__dbt_backup"
[0m10:21:23.644851 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m10:21:23.645533 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
drop table if exists "airflow"."lead_trusted"."technical_data__dbt_backup" cascade
[0m10:21:23.649828 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m10:21:23.651643 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: Close
[0m10:21:23.652540 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd005425c-2a41-4739-922f-7f2625483126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17564d40e0>]}
[0m10:21:23.653455 [info ] [Thread-1 (]: 4 of 4 OK created sql table model lead_trusted.technical_data .................. [[32mSELECT 102322[0m in 0.62s]
[0m10:21:23.654581 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_technical_data
[0m10:21:23.656840 [debug] [MainThread]: Using postgres connection "master"
[0m10:21:23.657565 [debug] [MainThread]: On master: BEGIN
[0m10:21:23.658199 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:21:23.662294 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m10:21:23.663001 [debug] [MainThread]: On master: COMMIT
[0m10:21:23.663681 [debug] [MainThread]: Using postgres connection "master"
[0m10:21:23.664254 [debug] [MainThread]: On master: COMMIT
[0m10:21:23.665171 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:21:23.665846 [debug] [MainThread]: On master: Close
[0m10:21:23.666786 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:21:23.667471 [debug] [MainThread]: Connection 'model.dbt_lead_data.trusted_technical_data' was properly closed.
[0m10:21:23.668201 [info ] [MainThread]: 
[0m10:21:23.669072 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 5.30 seconds (5.30s).
[0m10:21:23.670986 [debug] [MainThread]: Command end result
[0m10:21:23.725093 [info ] [MainThread]: 
[0m10:21:23.726013 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:21:23.726909 [info ] [MainThread]: 
[0m10:21:23.728001 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m10:21:23.729538 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.054205, "process_user_time": 2.839505, "process_kernel_time": 0.152476, "process_mem_max_rss": "121576", "process_in_blocks": "488", "process_out_blocks": "0"}
[0m10:21:23.730488 [debug] [MainThread]: Command `dbt run` succeeded at 10:21:23.730359 after 6.06 seconds
[0m10:21:23.731203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1759772540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1759833bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1756347a70>]}
[0m10:21:23.731966 [debug] [MainThread]: Flushing usage events
[0m10:23:19.368852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34310bbbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f343199af00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3430d7e840>]}


============================== 10:23:19.376686 | 3a9fa2a4-e393-4a1c-bda2-7759d513ccdd ==============================
[0m10:23:19.376686 [info ] [MainThread]: Running with dbt=1.8.0
[0m10:23:19.377754 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select tag:staging', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:23:19.667759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a9fa2a4-e393-4a1c-bda2-7759d513ccdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3431c8ef30>]}
[0m10:23:19.747085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3a9fa2a4-e393-4a1c-bda2-7759d513ccdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34308c56a0>]}
[0m10:23:19.748419 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:23:19.851598 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m10:23:20.005697 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:23:20.006770 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:23:20.050765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3a9fa2a4-e393-4a1c-bda2-7759d513ccdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34315a88c0>]}
[0m10:23:20.214954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3a9fa2a4-e393-4a1c-bda2-7759d513ccdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f342fdc1340>]}
[0m10:23:20.216570 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m10:23:20.217657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a9fa2a4-e393-4a1c-bda2-7759d513ccdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f342fd8db50>]}
[0m10:23:20.220734 [info ] [MainThread]: 
[0m10:23:20.221965 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:23:20.228925 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m10:23:20.281866 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m10:23:20.282729 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m10:23:20.283596 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:23:20.290848 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.007 seconds
[0m10:23:20.293862 [debug] [ThreadPool]: On list_airflow: Close
[0m10:23:20.297633 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_staging)
[0m10:23:20.306477 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m10:23:20.308289 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m10:23:20.309564 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:23:20.315360 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m10:23:20.316435 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m10:23:20.317326 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m10:23:20.320879 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.003 seconds
[0m10:23:20.323052 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m10:23:20.324290 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m10:23:20.325575 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now list_airflow_lead_trusted)
[0m10:23:20.329232 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m10:23:20.330342 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m10:23:20.331311 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:23:20.335996 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m10:23:20.337015 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m10:23:20.337826 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m10:23:20.341842 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m10:23:20.343947 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m10:23:20.345097 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m10:23:20.355935 [debug] [MainThread]: Using postgres connection "master"
[0m10:23:20.356992 [debug] [MainThread]: On master: BEGIN
[0m10:23:20.357872 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:23:20.362486 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m10:23:20.363407 [debug] [MainThread]: Using postgres connection "master"
[0m10:23:20.364391 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:23:20.368437 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m10:23:20.371103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a9fa2a4-e393-4a1c-bda2-7759d513ccdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f342ddec920>]}
[0m10:23:20.372415 [debug] [MainThread]: On master: ROLLBACK
[0m10:23:20.373803 [debug] [MainThread]: Using postgres connection "master"
[0m10:23:20.374893 [debug] [MainThread]: On master: BEGIN
[0m10:23:20.376383 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m10:23:20.377143 [debug] [MainThread]: On master: COMMIT
[0m10:23:20.378088 [debug] [MainThread]: Using postgres connection "master"
[0m10:23:20.378927 [debug] [MainThread]: On master: COMMIT
[0m10:23:20.379998 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:23:20.380837 [debug] [MainThread]: On master: Close
[0m10:23:20.381847 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:23:20.382758 [info ] [MainThread]: 
[0m10:23:20.397565 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_adress
[0m10:23:20.399121 [info ] [Thread-1 (]: 1 of 5 START sql table model lead_staging.dim_address .......................... [RUN]
[0m10:23:20.400200 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now model.dbt_lead_data.staging_dim_adress)
[0m10:23:20.401167 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_adress
[0m10:23:20.412596 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_adress"
[0m10:23:20.415416 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_adress
[0m10:23:20.464920 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_adress"
[0m10:23:20.467915 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m10:23:20.468831 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: BEGIN
[0m10:23:20.469631 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:23:20.474804 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m10:23:20.475939 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m10:23:20.476891 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */

  
    

  create  table "airflow"."lead_staging"."dim_address__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        address,
        mac_address,
        ip_address
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:23:20.742111 [debug] [Thread-1 (]: SQL status: SELECT 202694 in 0.264 seconds
[0m10:23:20.749675 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m10:23:20.750513 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
alter table "airflow"."lead_staging"."dim_address" rename to "dim_address__dbt_backup"
[0m10:23:20.751903 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:23:20.755580 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m10:23:20.756383 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
alter table "airflow"."lead_staging"."dim_address__dbt_tmp" rename to "dim_address"
[0m10:23:20.757558 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:23:20.780028 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m10:23:20.780990 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m10:23:20.781818 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m10:23:20.804419 [debug] [Thread-1 (]: SQL status: COMMIT in 0.022 seconds
[0m10:23:20.811491 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_address__dbt_backup"
[0m10:23:20.817964 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m10:23:20.818707 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
drop table if exists "airflow"."lead_staging"."dim_address__dbt_backup" cascade
[0m10:23:20.823115 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m10:23:20.826088 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: Close
[0m10:23:20.827999 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a9fa2a4-e393-4a1c-bda2-7759d513ccdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3432275d60>]}
[0m10:23:20.828966 [info ] [Thread-1 (]: 1 of 5 OK created sql table model lead_staging.dim_address ..................... [[32mSELECT 202694[0m in 0.43s]
[0m10:23:20.830034 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_adress
[0m10:23:20.830883 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_date
[0m10:23:20.831745 [info ] [Thread-1 (]: 2 of 5 START sql table model lead_staging.dim_date ............................. [RUN]
[0m10:23:20.832603 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_adress, now model.dbt_lead_data.staging_dim_date)
[0m10:23:20.833321 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_date
[0m10:23:20.836895 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_date"
[0m10:23:20.839311 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_date
[0m10:23:20.843251 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_date"
[0m10:23:20.845151 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m10:23:20.845858 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: BEGIN
[0m10:23:20.846566 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:23:20.850975 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m10:23:20.851809 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m10:23:20.852570 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */

  
    

  create  table "airflow"."lead_staging"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        accessed_at
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:23:21.035517 [debug] [Thread-1 (]: SQL status: SELECT 202694 in 0.182 seconds
[0m10:23:21.039750 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m10:23:21.040697 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
alter table "airflow"."lead_staging"."dim_date" rename to "dim_date__dbt_backup"
[0m10:23:21.042067 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:23:21.045760 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m10:23:21.046617 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
alter table "airflow"."lead_staging"."dim_date__dbt_tmp" rename to "dim_date"
[0m10:23:21.047909 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:23:21.050384 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: COMMIT
[0m10:23:21.051233 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m10:23:21.052056 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: COMMIT
[0m10:23:21.058503 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m10:23:21.061768 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_date__dbt_backup"
[0m10:23:21.063075 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m10:23:21.063855 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
drop table if exists "airflow"."lead_staging"."dim_date__dbt_backup" cascade
[0m10:23:21.066377 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m10:23:21.068470 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: Close
[0m10:23:21.069522 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a9fa2a4-e393-4a1c-bda2-7759d513ccdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f342ddde120>]}
[0m10:23:21.070500 [info ] [Thread-1 (]: 2 of 5 OK created sql table model lead_staging.dim_date ........................ [[32mSELECT 202694[0m in 0.24s]
[0m10:23:21.071431 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_date
[0m10:23:21.072218 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_finance
[0m10:23:21.073181 [info ] [Thread-1 (]: 3 of 5 START sql table model lead_staging.dim_finance .......................... [RUN]
[0m10:23:21.074107 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_date, now model.dbt_lead_data.staging_dim_finance)
[0m10:23:21.074783 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_finance
[0m10:23:21.078677 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_finance"
[0m10:23:21.080571 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_finance
[0m10:23:21.086688 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_finance"
[0m10:23:21.088708 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m10:23:21.089462 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: BEGIN
[0m10:23:21.090146 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:23:21.095895 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m10:23:21.096648 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m10:23:21.097594 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */

  
    

  create  table "airflow"."lead_staging"."dim_finance__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        iban
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:23:21.311600 [debug] [Thread-1 (]: SQL status: SELECT 202694 in 0.213 seconds
[0m10:23:21.315688 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m10:23:21.316557 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
alter table "airflow"."lead_staging"."dim_finance" rename to "dim_finance__dbt_backup"
[0m10:23:21.317988 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:23:21.321957 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m10:23:21.322927 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
alter table "airflow"."lead_staging"."dim_finance__dbt_tmp" rename to "dim_finance"
[0m10:23:21.324192 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:23:21.326705 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: COMMIT
[0m10:23:21.327553 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m10:23:21.328316 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: COMMIT
[0m10:23:21.332746 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m10:23:21.336032 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_finance__dbt_backup"
[0m10:23:21.337457 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m10:23:21.338206 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
drop table if exists "airflow"."lead_staging"."dim_finance__dbt_backup" cascade
[0m10:23:21.341164 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m10:23:21.343241 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: Close
[0m10:23:21.344259 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a9fa2a4-e393-4a1c-bda2-7759d513ccdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f342fd70e90>]}
[0m10:23:21.345191 [info ] [Thread-1 (]: 3 of 5 OK created sql table model lead_staging.dim_finance ..................... [[32mSELECT 202694[0m in 0.27s]
[0m10:23:21.346198 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_finance
[0m10:23:21.346971 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_person
[0m10:23:21.347760 [info ] [Thread-1 (]: 4 of 5 START sql table model lead_staging.dim_person ........................... [RUN]
[0m10:23:21.348655 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_finance, now model.dbt_lead_data.staging_dim_person)
[0m10:23:21.349370 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_person
[0m10:23:21.353222 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_person"
[0m10:23:21.355482 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_person
[0m10:23:21.360529 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_person"
[0m10:23:21.362370 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m10:23:21.363206 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: BEGIN
[0m10:23:21.363954 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:23:21.368928 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m10:23:21.369730 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m10:23:21.370468 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */

  
    

  create  table "airflow"."lead_staging"."dim_person__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        person_name,
        user_name,
        email,
        phone,
        birth_date,
        personal_number
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:23:21.739350 [debug] [Thread-1 (]: SQL status: SELECT 202694 in 0.368 seconds
[0m10:23:21.743052 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m10:23:21.743939 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
alter table "airflow"."lead_staging"."dim_person" rename to "dim_person__dbt_backup"
[0m10:23:21.745185 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:23:21.748528 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m10:23:21.749312 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
alter table "airflow"."lead_staging"."dim_person__dbt_tmp" rename to "dim_person"
[0m10:23:21.750590 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:23:21.753045 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: COMMIT
[0m10:23:21.753897 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m10:23:21.754677 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: COMMIT
[0m10:23:21.756218 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:23:21.759102 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_person__dbt_backup"
[0m10:23:21.760317 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m10:23:21.761040 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
drop table if exists "airflow"."lead_staging"."dim_person__dbt_backup" cascade
[0m10:23:21.764911 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m10:23:21.766782 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: Close
[0m10:23:21.767698 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a9fa2a4-e393-4a1c-bda2-7759d513ccdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f342db277a0>]}
[0m10:23:21.768598 [info ] [Thread-1 (]: 4 of 5 OK created sql table model lead_staging.dim_person ...................... [[32mSELECT 202694[0m in 0.42s]
[0m10:23:21.769567 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_person
[0m10:23:21.770296 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_fact_network_usage
[0m10:23:21.771058 [info ] [Thread-1 (]: 5 of 5 START sql table model lead_staging.fact_network_usage ................... [RUN]
[0m10:23:21.771927 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_person, now model.dbt_lead_data.staging_fact_network_usage)
[0m10:23:21.772677 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_fact_network_usage
[0m10:23:21.776400 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_fact_network_usage"
[0m10:23:21.778763 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_fact_network_usage
[0m10:23:21.782744 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_fact_network_usage"
[0m10:23:21.784795 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m10:23:21.785506 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: BEGIN
[0m10:23:21.786131 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:23:21.790658 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m10:23:21.791476 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m10:23:21.792200 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */

  
    

  create  table "airflow"."lead_staging"."fact_network_usage__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        session_duration,
        download_speed,
        upload_speed,
        consumed_traffic
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:23:21.981796 [debug] [Thread-1 (]: SQL status: SELECT 202694 in 0.189 seconds
[0m10:23:21.987051 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m10:23:21.987947 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
alter table "airflow"."lead_staging"."fact_network_usage" rename to "fact_network_usage__dbt_backup"
[0m10:23:21.989333 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:23:21.993054 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m10:23:21.993993 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
alter table "airflow"."lead_staging"."fact_network_usage__dbt_tmp" rename to "fact_network_usage"
[0m10:23:21.995169 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:23:21.997654 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: COMMIT
[0m10:23:21.998497 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m10:23:21.999375 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: COMMIT
[0m10:23:22.005204 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m10:23:22.008533 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."fact_network_usage__dbt_backup"
[0m10:23:22.009796 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m10:23:22.010615 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
drop table if exists "airflow"."lead_staging"."fact_network_usage__dbt_backup" cascade
[0m10:23:22.014262 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m10:23:22.016300 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: Close
[0m10:23:22.017321 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a9fa2a4-e393-4a1c-bda2-7759d513ccdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f342db1e240>]}
[0m10:23:22.018363 [info ] [Thread-1 (]: 5 of 5 OK created sql table model lead_staging.fact_network_usage .............. [[32mSELECT 202694[0m in 0.25s]
[0m10:23:22.019427 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_fact_network_usage
[0m10:23:22.021668 [debug] [MainThread]: Using postgres connection "master"
[0m10:23:22.022319 [debug] [MainThread]: On master: BEGIN
[0m10:23:22.022880 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:23:22.027140 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m10:23:22.027801 [debug] [MainThread]: On master: COMMIT
[0m10:23:22.028456 [debug] [MainThread]: Using postgres connection "master"
[0m10:23:22.029188 [debug] [MainThread]: On master: COMMIT
[0m10:23:22.030037 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:23:22.030682 [debug] [MainThread]: On master: Close
[0m10:23:22.031592 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:23:22.032311 [debug] [MainThread]: Connection 'model.dbt_lead_data.staging_fact_network_usage' was properly closed.
[0m10:23:22.033156 [info ] [MainThread]: 
[0m10:23:22.033971 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 1.81 seconds (1.81s).
[0m10:23:22.035985 [debug] [MainThread]: Command end result
[0m10:23:22.091624 [info ] [MainThread]: 
[0m10:23:22.092998 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:23:22.094062 [info ] [MainThread]: 
[0m10:23:22.095025 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m10:23:22.096443 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.7856705, "process_user_time": 3.196678, "process_kernel_time": 0.202963, "process_mem_max_rss": "121464", "process_in_blocks": "2472", "process_out_blocks": "0"}
[0m10:23:22.097425 [debug] [MainThread]: Command `dbt run` succeeded at 10:23:22.097286 after 2.79 seconds
[0m10:23:22.098253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34310a5400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3430dc85c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3430dc2ea0>]}
[0m10:23:22.099109 [debug] [MainThread]: Flushing usage events
[0m10:23:25.940483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaa5e42570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaa6518fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaa6000110>]}


============================== 10:23:25.949005 | 287ff295-72f7-4cc7-a042-57e3b3b9e05a ==============================
[0m10:23:25.949005 [info ] [MainThread]: Running with dbt=1.8.0
[0m10:23:25.950414 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select tag:trusted', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:23:26.170952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '287ff295-72f7-4cc7-a042-57e3b3b9e05a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaa5cde810>]}
[0m10:23:26.244344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '287ff295-72f7-4cc7-a042-57e3b3b9e05a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaa6c1eea0>]}
[0m10:23:26.245779 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:23:26.345160 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m10:23:26.468595 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:23:26.469362 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:23:26.505296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '287ff295-72f7-4cc7-a042-57e3b3b9e05a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaa64acf50>]}
[0m10:23:26.628561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '287ff295-72f7-4cc7-a042-57e3b3b9e05a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaa49c91f0>]}
[0m10:23:26.629370 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m10:23:26.630080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '287ff295-72f7-4cc7-a042-57e3b3b9e05a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaa4d1d1f0>]}
[0m10:23:26.632530 [info ] [MainThread]: 
[0m10:23:26.633529 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:23:26.639481 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m10:23:26.673808 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m10:23:26.674575 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m10:23:26.675262 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:23:26.680406 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.005 seconds
[0m10:23:26.682384 [debug] [ThreadPool]: On list_airflow: Close
[0m10:23:26.685002 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_staging)
[0m10:23:26.691361 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m10:23:26.692112 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m10:23:26.692798 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:23:26.697120 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m10:23:26.697868 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m10:23:26.698590 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m10:23:26.701629 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m10:23:26.703486 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m10:23:26.704357 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m10:23:26.705305 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now list_airflow_lead_trusted)
[0m10:23:26.708529 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m10:23:26.709336 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m10:23:26.710026 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:23:26.714173 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m10:23:26.715109 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m10:23:26.716078 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m10:23:26.718713 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m10:23:26.720368 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m10:23:26.721137 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m10:23:26.727733 [debug] [MainThread]: Using postgres connection "master"
[0m10:23:26.728493 [debug] [MainThread]: On master: BEGIN
[0m10:23:26.729230 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:23:26.733438 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m10:23:26.734117 [debug] [MainThread]: Using postgres connection "master"
[0m10:23:26.734786 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:23:26.738210 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m10:23:26.740102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '287ff295-72f7-4cc7-a042-57e3b3b9e05a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaa4d1d1f0>]}
[0m10:23:26.740855 [debug] [MainThread]: On master: ROLLBACK
[0m10:23:26.741742 [debug] [MainThread]: Using postgres connection "master"
[0m10:23:26.742483 [debug] [MainThread]: On master: BEGIN
[0m10:23:26.743554 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:23:26.744291 [debug] [MainThread]: On master: COMMIT
[0m10:23:26.744983 [debug] [MainThread]: Using postgres connection "master"
[0m10:23:26.745672 [debug] [MainThread]: On master: COMMIT
[0m10:23:26.746561 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:23:26.747346 [debug] [MainThread]: On master: Close
[0m10:23:26.748263 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:23:26.749065 [info ] [MainThread]: 
[0m10:23:26.758682 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_non_pii_data
[0m10:23:26.759560 [info ] [Thread-1 (]: 1 of 4 START sql table model lead_trusted.non_pii_data ......................... [RUN]
[0m10:23:26.760343 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now model.dbt_lead_data.trusted_non_pii_data)
[0m10:23:26.761102 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_non_pii_data
[0m10:23:26.776709 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_non_pii_data"
[0m10:23:26.779764 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_non_pii_data
[0m10:23:26.836102 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_non_pii_data"
[0m10:23:26.839149 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m10:23:26.839872 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: BEGIN
[0m10:23:26.840550 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:23:26.844577 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m10:23:26.845269 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m10:23:26.845975 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */

  
    

  create  table "airflow"."lead_trusted"."non_pii_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        '***MASKED***' AS person_name,
        SUBSTRING(dp.user_name, 1, 5) || '*****'  user_name,
        SUBSTRING(dp.email, 1, 5) || '*****' AS email,
        '***MASKED***'  AS personal_number, 
        '***MASKED***' AS birth_date, 
        '***MASKED***' AS address,
        '***MASKED***'  AS phone, 
        SUBSTRING(da.mac_address, 1, 5) || '*****' AS mac_address,
        SUBSTRING(da.ip_address, 1, 5) || '*****' AS ip_address,
        SUBSTRING(df.iban, 1, 5) || '*****' AS iban,
        dd.accessed_at,
        fnu.session_duration,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.consumed_traffic,
        fnu.unique_id
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    INNER JOIN
        "airflow"."lead_staging"."dim_address" da ON fnu.unique_id = da.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_date" dd ON da.unique_id = dd.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_finance" df ON dd.unique_id = df.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_person" dp ON df.unique_id = dp.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:23:30.387022 [debug] [Thread-1 (]: SQL status: SELECT 202694 in 3.540 seconds
[0m10:23:30.394290 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m10:23:30.395376 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
alter table "airflow"."lead_trusted"."non_pii_data" rename to "non_pii_data__dbt_backup"
[0m10:23:30.396605 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:23:30.400454 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m10:23:30.401280 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
alter table "airflow"."lead_trusted"."non_pii_data__dbt_tmp" rename to "non_pii_data"
[0m10:23:30.402425 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:23:30.425953 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: COMMIT
[0m10:23:30.426966 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m10:23:30.427837 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: COMMIT
[0m10:23:30.429655 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:23:30.437089 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."non_pii_data__dbt_backup"
[0m10:23:30.443911 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m10:23:30.444876 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
drop table if exists "airflow"."lead_trusted"."non_pii_data__dbt_backup" cascade
[0m10:23:30.449614 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m10:23:30.452800 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: Close
[0m10:23:30.454810 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '287ff295-72f7-4cc7-a042-57e3b3b9e05a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaa720dfd0>]}
[0m10:23:30.455900 [info ] [Thread-1 (]: 1 of 4 OK created sql table model lead_trusted.non_pii_data .................... [[32mSELECT 202694[0m in 3.69s]
[0m10:23:30.457156 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_non_pii_data
[0m10:23:30.458002 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_payment_data
[0m10:23:30.458905 [info ] [Thread-1 (]: 2 of 4 START sql table model lead_trusted.payment_data ......................... [RUN]
[0m10:23:30.459792 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_non_pii_data, now model.dbt_lead_data.trusted_payment_data)
[0m10:23:30.460519 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_payment_data
[0m10:23:30.464701 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_payment_data"
[0m10:23:30.467345 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_payment_data
[0m10:23:30.471608 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_payment_data"
[0m10:23:30.474218 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m10:23:30.474974 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: BEGIN
[0m10:23:30.475688 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:23:30.480705 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m10:23:30.481600 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m10:23:30.482437 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */

  
    

  create  table "airflow"."lead_trusted"."payment_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        fnu.unique_id,
        df.iban,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.session_duration,
        fnu.consumed_traffic,
        ((fnu.download_speed + fnu.upload_speed + 1)/2) + (fnu.consumed_traffic / (fnu.session_duration + 1)) AS payment_amount
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    JOIN
        "airflow"."lead_staging"."dim_finance" df
    ON
	    fnu.unique_id = df.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:23:30.865369 [debug] [Thread-1 (]: SQL status: SELECT 202694 in 0.382 seconds
[0m10:23:30.869198 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m10:23:30.869967 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
alter table "airflow"."lead_trusted"."payment_data" rename to "payment_data__dbt_backup"
[0m10:23:30.870970 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:23:30.874483 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m10:23:30.875245 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
alter table "airflow"."lead_trusted"."payment_data__dbt_tmp" rename to "payment_data"
[0m10:23:30.876288 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:23:30.878705 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: COMMIT
[0m10:23:30.879482 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m10:23:30.880185 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: COMMIT
[0m10:23:30.885048 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m10:23:30.888049 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."payment_data__dbt_backup"
[0m10:23:30.889307 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m10:23:30.890080 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
drop table if exists "airflow"."lead_trusted"."payment_data__dbt_backup" cascade
[0m10:23:30.893406 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m10:23:30.895310 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: Close
[0m10:23:30.896260 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '287ff295-72f7-4cc7-a042-57e3b3b9e05a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaa2c3c230>]}
[0m10:23:30.897275 [info ] [Thread-1 (]: 2 of 4 OK created sql table model lead_trusted.payment_data .................... [[32mSELECT 202694[0m in 0.44s]
[0m10:23:30.898375 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_payment_data
[0m10:23:30.899239 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_pii_data
[0m10:23:30.900124 [info ] [Thread-1 (]: 3 of 4 START sql table model lead_trusted.pii_data ............................. [RUN]
[0m10:23:30.901002 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_payment_data, now model.dbt_lead_data.trusted_pii_data)
[0m10:23:30.901660 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_pii_data
[0m10:23:30.906538 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_pii_data"
[0m10:23:30.908421 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_pii_data
[0m10:23:30.914084 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_pii_data"
[0m10:23:30.916109 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m10:23:30.916784 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: BEGIN
[0m10:23:30.917455 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:23:30.921948 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m10:23:30.922705 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m10:23:30.923547 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */

  
    

  create  table "airflow"."lead_trusted"."pii_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        dp.person_name,
        dp.user_name,
        dp.email,
        dp.personal_number, 
        dp.birth_date, 
        da.address,
        dp.phone, 
        da.mac_address,
        da.ip_address,
        df.iban,
        dd.accessed_at,
        fnu.session_duration,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.consumed_traffic,
        fnu.unique_id
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    INNER JOIN
        "airflow"."lead_staging"."dim_address" da ON fnu.unique_id = da.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_date" dd ON da.unique_id = dd.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_finance" df ON dd.unique_id = df.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_person" dp ON df.unique_id = dp.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:23:31.809027 [debug] [Thread-1 (]: SQL status: SELECT 202694 in 0.885 seconds
[0m10:23:31.812720 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m10:23:31.813563 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */
alter table "airflow"."lead_trusted"."pii_data" rename to "pii_data__dbt_backup"
[0m10:23:31.814739 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:23:31.818288 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m10:23:31.819017 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */
alter table "airflow"."lead_trusted"."pii_data__dbt_tmp" rename to "pii_data"
[0m10:23:31.820009 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:23:31.822536 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: COMMIT
[0m10:23:31.823256 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m10:23:31.823904 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: COMMIT
[0m10:23:31.866404 [debug] [Thread-1 (]: SQL status: COMMIT in 0.042 seconds
[0m10:23:31.869620 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."pii_data__dbt_backup"
[0m10:23:31.870825 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m10:23:31.871597 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */
drop table if exists "airflow"."lead_trusted"."pii_data__dbt_backup" cascade
[0m10:23:31.876199 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m10:23:31.878091 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: Close
[0m10:23:31.879033 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '287ff295-72f7-4cc7-a042-57e3b3b9e05a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaa2cd82c0>]}
[0m10:23:31.880078 [info ] [Thread-1 (]: 3 of 4 OK created sql table model lead_trusted.pii_data ........................ [[32mSELECT 202694[0m in 0.98s]
[0m10:23:31.881101 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_pii_data
[0m10:23:31.881881 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_technical_data
[0m10:23:31.882650 [info ] [Thread-1 (]: 4 of 4 START sql table model lead_trusted.technical_data ....................... [RUN]
[0m10:23:31.883465 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_pii_data, now model.dbt_lead_data.trusted_technical_data)
[0m10:23:31.884136 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_technical_data
[0m10:23:31.888017 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_technical_data"
[0m10:23:31.890385 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_technical_data
[0m10:23:31.894514 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_technical_data"
[0m10:23:31.896427 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m10:23:31.897130 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: BEGIN
[0m10:23:31.897759 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:23:31.902490 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m10:23:31.903345 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m10:23:31.904057 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */

  
    

  create  table "airflow"."lead_trusted"."technical_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        fnu.unique_id,
        da.address,
        da.mac_address,
        da.ip_address,
        fnu.download_speed,
        fnu.upload_speed,
        ROUND((fnu.session_duration/60), 1) as min_session_duration,
        CASE 
            WHEN fnu.download_speed < 50 OR fnu.upload_speed < 30 OR fnu.session_duration/60 < 1 THEN true
            ELSE false
        END AS technical_issue
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    JOIN
        "airflow"."lead_staging"."dim_address" da
    ON
	    fnu.unique_id = da.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:23:32.383426 [debug] [Thread-1 (]: SQL status: SELECT 202694 in 0.479 seconds
[0m10:23:32.387358 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m10:23:32.388200 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
alter table "airflow"."lead_trusted"."technical_data" rename to "technical_data__dbt_backup"
[0m10:23:32.389511 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:23:32.399319 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m10:23:32.400294 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
alter table "airflow"."lead_trusted"."technical_data__dbt_tmp" rename to "technical_data"
[0m10:23:32.401604 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:23:32.404324 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: COMMIT
[0m10:23:32.405130 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m10:23:32.406173 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: COMMIT
[0m10:23:32.410501 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m10:23:32.413748 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."technical_data__dbt_backup"
[0m10:23:32.415024 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m10:23:32.415906 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
drop table if exists "airflow"."lead_trusted"."technical_data__dbt_backup" cascade
[0m10:23:32.418681 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m10:23:32.420606 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: Close
[0m10:23:32.421559 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '287ff295-72f7-4cc7-a042-57e3b3b9e05a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaa2cdd0d0>]}
[0m10:23:32.422609 [info ] [Thread-1 (]: 4 of 4 OK created sql table model lead_trusted.technical_data .................. [[32mSELECT 202694[0m in 0.54s]
[0m10:23:32.423701 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_technical_data
[0m10:23:32.426027 [debug] [MainThread]: Using postgres connection "master"
[0m10:23:32.426682 [debug] [MainThread]: On master: BEGIN
[0m10:23:32.427337 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:23:32.431267 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m10:23:32.432039 [debug] [MainThread]: On master: COMMIT
[0m10:23:32.432748 [debug] [MainThread]: Using postgres connection "master"
[0m10:23:32.433496 [debug] [MainThread]: On master: COMMIT
[0m10:23:32.434356 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:23:32.435075 [debug] [MainThread]: On master: Close
[0m10:23:32.436001 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:23:32.436630 [debug] [MainThread]: Connection 'model.dbt_lead_data.trusted_technical_data' was properly closed.
[0m10:23:32.437412 [info ] [MainThread]: 
[0m10:23:32.438222 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 5.80 seconds (5.80s).
[0m10:23:32.440140 [debug] [MainThread]: Command end result
[0m10:23:32.494247 [info ] [MainThread]: 
[0m10:23:32.495056 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:23:32.495808 [info ] [MainThread]: 
[0m10:23:32.496892 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m10:23:32.498349 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.618529, "process_user_time": 2.814073, "process_kernel_time": 0.178349, "process_mem_max_rss": "121172", "process_in_blocks": "1248", "process_out_blocks": "0"}
[0m10:23:32.499350 [debug] [MainThread]: Command `dbt run` succeeded at 10:23:32.499207 after 6.62 seconds
[0m10:23:32.500124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaa5cd6690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaa515e750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdaa2cebf20>]}
[0m10:23:32.500899 [debug] [MainThread]: Flushing usage events
[0m10:24:23.797511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573e75d7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573e272630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573e75eba0>]}


============================== 10:24:23.804537 | 02eb6e3f-8cca-47ce-b337-cb1494ad6e97 ==============================
[0m10:24:23.804537 [info ] [MainThread]: Running with dbt=1.8.0
[0m10:24:23.805954 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select tag:staging', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:24:24.038171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '02eb6e3f-8cca-47ce-b337-cb1494ad6e97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573ee894f0>]}
[0m10:24:24.110769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '02eb6e3f-8cca-47ce-b337-cb1494ad6e97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573ee8ae40>]}
[0m10:24:24.112505 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:24:24.215358 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m10:24:24.359026 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:24:24.359977 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:24:24.402076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '02eb6e3f-8cca-47ce-b337-cb1494ad6e97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573cf58bf0>]}
[0m10:24:24.546068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '02eb6e3f-8cca-47ce-b337-cb1494ad6e97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573cb91520>]}
[0m10:24:24.547042 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m10:24:24.547906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02eb6e3f-8cca-47ce-b337-cb1494ad6e97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573c332240>]}
[0m10:24:24.550559 [info ] [MainThread]: 
[0m10:24:24.551653 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:24:24.558322 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m10:24:24.598196 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m10:24:24.599498 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m10:24:24.600495 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:24:24.607363 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.007 seconds
[0m10:24:24.609417 [debug] [ThreadPool]: On list_airflow: Close
[0m10:24:24.612275 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_trusted)
[0m10:24:24.619132 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m10:24:24.619959 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m10:24:24.620719 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:24:24.625333 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m10:24:24.626249 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m10:24:24.627001 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m10:24:24.632141 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m10:24:24.634155 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m10:24:24.635125 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m10:24:24.636881 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now list_airflow_lead_staging)
[0m10:24:24.640587 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m10:24:24.641366 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m10:24:24.642112 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:24:24.646987 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m10:24:24.647863 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m10:24:24.648750 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m10:24:24.652403 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.003 seconds
[0m10:24:24.654388 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m10:24:24.655402 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m10:24:24.663009 [debug] [MainThread]: Using postgres connection "master"
[0m10:24:24.663915 [debug] [MainThread]: On master: BEGIN
[0m10:24:24.664830 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:24:24.669479 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m10:24:24.670478 [debug] [MainThread]: Using postgres connection "master"
[0m10:24:24.671332 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:24:24.675736 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m10:24:24.677839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02eb6e3f-8cca-47ce-b337-cb1494ad6e97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573da51e20>]}
[0m10:24:24.678773 [debug] [MainThread]: On master: ROLLBACK
[0m10:24:24.679736 [debug] [MainThread]: Using postgres connection "master"
[0m10:24:24.680501 [debug] [MainThread]: On master: BEGIN
[0m10:24:24.681781 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m10:24:24.682667 [debug] [MainThread]: On master: COMMIT
[0m10:24:24.683455 [debug] [MainThread]: Using postgres connection "master"
[0m10:24:24.684228 [debug] [MainThread]: On master: COMMIT
[0m10:24:24.685177 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:24:24.685946 [debug] [MainThread]: On master: Close
[0m10:24:24.686966 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:24:24.687769 [info ] [MainThread]: 
[0m10:24:24.698548 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_adress
[0m10:24:24.699644 [info ] [Thread-1 (]: 1 of 5 START sql table model lead_staging.dim_address .......................... [RUN]
[0m10:24:24.700584 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now model.dbt_lead_data.staging_dim_adress)
[0m10:24:24.701365 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_adress
[0m10:24:24.711884 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_adress"
[0m10:24:24.715597 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_adress
[0m10:24:24.765985 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_adress"
[0m10:24:24.770234 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m10:24:24.771045 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: BEGIN
[0m10:24:24.771974 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:24:24.779187 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m10:24:24.780433 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m10:24:24.781426 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */

  
    

  create  table "airflow"."lead_staging"."dim_address__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        address,
        mac_address,
        ip_address
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:24:25.371273 [debug] [Thread-1 (]: SQL status: SELECT 403438 in 0.588 seconds
[0m10:24:25.379306 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m10:24:25.380318 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
alter table "airflow"."lead_staging"."dim_address" rename to "dim_address__dbt_backup"
[0m10:24:25.384261 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m10:24:25.388473 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m10:24:25.389588 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
alter table "airflow"."lead_staging"."dim_address__dbt_tmp" rename to "dim_address"
[0m10:24:25.391027 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:24:25.417060 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m10:24:25.418153 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m10:24:25.418980 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m10:24:25.420707 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:24:25.428136 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_address__dbt_backup"
[0m10:24:25.435791 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m10:24:25.436909 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
drop table if exists "airflow"."lead_staging"."dim_address__dbt_backup" cascade
[0m10:24:25.444728 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m10:24:25.449230 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: Close
[0m10:24:25.452190 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02eb6e3f-8cca-47ce-b337-cb1494ad6e97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573f419b20>]}
[0m10:24:25.453719 [info ] [Thread-1 (]: 1 of 5 OK created sql table model lead_staging.dim_address ..................... [[32mSELECT 403438[0m in 0.75s]
[0m10:24:25.455470 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_adress
[0m10:24:25.456550 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_date
[0m10:24:25.457598 [info ] [Thread-1 (]: 2 of 5 START sql table model lead_staging.dim_date ............................. [RUN]
[0m10:24:25.458596 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_adress, now model.dbt_lead_data.staging_dim_date)
[0m10:24:25.459410 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_date
[0m10:24:25.463550 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_date"
[0m10:24:25.465906 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_date
[0m10:24:25.470422 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_date"
[0m10:24:25.472875 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m10:24:25.473686 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: BEGIN
[0m10:24:25.474532 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:24:25.483626 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m10:24:25.484466 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m10:24:25.485311 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */

  
    

  create  table "airflow"."lead_staging"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        accessed_at
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:24:25.857845 [debug] [Thread-1 (]: SQL status: SELECT 403438 in 0.372 seconds
[0m10:24:25.861725 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m10:24:25.862509 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
alter table "airflow"."lead_staging"."dim_date" rename to "dim_date__dbt_backup"
[0m10:24:25.864325 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:24:25.869389 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m10:24:25.870411 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
alter table "airflow"."lead_staging"."dim_date__dbt_tmp" rename to "dim_date"
[0m10:24:25.872881 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:24:25.875933 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: COMMIT
[0m10:24:25.877164 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m10:24:25.878415 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: COMMIT
[0m10:24:25.888555 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m10:24:25.893718 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_date__dbt_backup"
[0m10:24:25.895023 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m10:24:25.895884 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
drop table if exists "airflow"."lead_staging"."dim_date__dbt_backup" cascade
[0m10:24:25.898880 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m10:24:25.900818 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: Close
[0m10:24:25.901736 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02eb6e3f-8cca-47ce-b337-cb1494ad6e97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573aef4320>]}
[0m10:24:25.902714 [info ] [Thread-1 (]: 2 of 5 OK created sql table model lead_staging.dim_date ........................ [[32mSELECT 403438[0m in 0.44s]
[0m10:24:25.903778 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_date
[0m10:24:25.904635 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_finance
[0m10:24:25.905505 [info ] [Thread-1 (]: 3 of 5 START sql table model lead_staging.dim_finance .......................... [RUN]
[0m10:24:25.906477 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_date, now model.dbt_lead_data.staging_dim_finance)
[0m10:24:25.907282 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_finance
[0m10:24:25.910866 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_finance"
[0m10:24:25.913289 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_finance
[0m10:24:25.918840 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_finance"
[0m10:24:25.921225 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m10:24:25.921908 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: BEGIN
[0m10:24:25.922711 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:24:25.927783 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m10:24:25.928676 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m10:24:25.929427 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */

  
    

  create  table "airflow"."lead_staging"."dim_finance__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        iban
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:24:26.279316 [debug] [Thread-1 (]: SQL status: SELECT 403438 in 0.349 seconds
[0m10:24:26.283112 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m10:24:26.283896 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
alter table "airflow"."lead_staging"."dim_finance" rename to "dim_finance__dbt_backup"
[0m10:24:26.285208 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:24:26.288767 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m10:24:26.289613 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
alter table "airflow"."lead_staging"."dim_finance__dbt_tmp" rename to "dim_finance"
[0m10:24:26.290847 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:24:26.293415 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: COMMIT
[0m10:24:26.294294 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m10:24:26.295062 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: COMMIT
[0m10:24:26.298284 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m10:24:26.301304 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_finance__dbt_backup"
[0m10:24:26.302753 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m10:24:26.303593 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
drop table if exists "airflow"."lead_staging"."dim_finance__dbt_backup" cascade
[0m10:24:26.306699 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m10:24:26.308746 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: Close
[0m10:24:26.309783 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02eb6e3f-8cca-47ce-b337-cb1494ad6e97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5739502180>]}
[0m10:24:26.310830 [info ] [Thread-1 (]: 3 of 5 OK created sql table model lead_staging.dim_finance ..................... [[32mSELECT 403438[0m in 0.40s]
[0m10:24:26.312080 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_finance
[0m10:24:26.313267 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_person
[0m10:24:26.314402 [info ] [Thread-1 (]: 4 of 5 START sql table model lead_staging.dim_person ........................... [RUN]
[0m10:24:26.315459 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_finance, now model.dbt_lead_data.staging_dim_person)
[0m10:24:26.316246 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_person
[0m10:24:26.319950 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_person"
[0m10:24:26.322500 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_person
[0m10:24:26.327091 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_person"
[0m10:24:26.329329 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m10:24:26.330131 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: BEGIN
[0m10:24:26.330912 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:24:26.335990 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m10:24:26.336873 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m10:24:26.337697 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */

  
    

  create  table "airflow"."lead_staging"."dim_person__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        person_name,
        user_name,
        email,
        phone,
        birth_date,
        personal_number
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:24:26.917938 [debug] [Thread-1 (]: SQL status: SELECT 403438 in 0.579 seconds
[0m10:24:26.921851 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m10:24:26.922842 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
alter table "airflow"."lead_staging"."dim_person" rename to "dim_person__dbt_backup"
[0m10:24:26.924233 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:24:26.927781 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m10:24:26.928623 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
alter table "airflow"."lead_staging"."dim_person__dbt_tmp" rename to "dim_person"
[0m10:24:26.929952 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:24:26.932503 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: COMMIT
[0m10:24:26.933258 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m10:24:26.934027 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: COMMIT
[0m10:24:26.945518 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m10:24:26.948664 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_person__dbt_backup"
[0m10:24:26.949868 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m10:24:26.950597 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
drop table if exists "airflow"."lead_staging"."dim_person__dbt_backup" cascade
[0m10:24:26.953569 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m10:24:26.955539 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: Close
[0m10:24:26.956524 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02eb6e3f-8cca-47ce-b337-cb1494ad6e97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573ae91040>]}
[0m10:24:26.957519 [info ] [Thread-1 (]: 4 of 5 OK created sql table model lead_staging.dim_person ...................... [[32mSELECT 403438[0m in 0.64s]
[0m10:24:26.958628 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_person
[0m10:24:26.959504 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_fact_network_usage
[0m10:24:26.960384 [info ] [Thread-1 (]: 5 of 5 START sql table model lead_staging.fact_network_usage ................... [RUN]
[0m10:24:26.961401 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_person, now model.dbt_lead_data.staging_fact_network_usage)
[0m10:24:26.962232 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_fact_network_usage
[0m10:24:26.966338 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_fact_network_usage"
[0m10:24:26.969285 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_fact_network_usage
[0m10:24:26.974239 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_fact_network_usage"
[0m10:24:26.976745 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m10:24:26.977516 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: BEGIN
[0m10:24:26.978242 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:24:26.982784 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m10:24:26.983680 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m10:24:26.984444 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */

  
    

  create  table "airflow"."lead_staging"."fact_network_usage__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        session_duration,
        download_speed,
        upload_speed,
        consumed_traffic
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:24:27.612225 [debug] [Thread-1 (]: SQL status: SELECT 403438 in 0.627 seconds
[0m10:24:27.617808 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m10:24:27.618733 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
alter table "airflow"."lead_staging"."fact_network_usage" rename to "fact_network_usage__dbt_backup"
[0m10:24:27.620140 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:24:27.624064 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m10:24:27.625002 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
alter table "airflow"."lead_staging"."fact_network_usage__dbt_tmp" rename to "fact_network_usage"
[0m10:24:27.626210 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:24:27.628598 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: COMMIT
[0m10:24:27.629368 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m10:24:27.630134 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: COMMIT
[0m10:24:27.636592 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m10:24:27.639877 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."fact_network_usage__dbt_backup"
[0m10:24:27.641275 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m10:24:27.642132 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
drop table if exists "airflow"."lead_staging"."fact_network_usage__dbt_backup" cascade
[0m10:24:27.645197 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m10:24:27.647410 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: Close
[0m10:24:27.648428 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02eb6e3f-8cca-47ce-b337-cb1494ad6e97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573950dd00>]}
[0m10:24:27.649450 [info ] [Thread-1 (]: 5 of 5 OK created sql table model lead_staging.fact_network_usage .............. [[32mSELECT 403438[0m in 0.69s]
[0m10:24:27.650563 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_fact_network_usage
[0m10:24:27.652920 [debug] [MainThread]: Using postgres connection "master"
[0m10:24:27.653698 [debug] [MainThread]: On master: BEGIN
[0m10:24:27.654466 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:24:27.659020 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m10:24:27.659986 [debug] [MainThread]: On master: COMMIT
[0m10:24:27.660742 [debug] [MainThread]: Using postgres connection "master"
[0m10:24:27.661447 [debug] [MainThread]: On master: COMMIT
[0m10:24:27.662355 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:24:27.663047 [debug] [MainThread]: On master: Close
[0m10:24:27.663971 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:24:27.664762 [debug] [MainThread]: Connection 'model.dbt_lead_data.staging_fact_network_usage' was properly closed.
[0m10:24:27.665614 [info ] [MainThread]: 
[0m10:24:27.666415 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 3.11 seconds (3.11s).
[0m10:24:27.668547 [debug] [MainThread]: Command end result
[0m10:24:27.723363 [info ] [MainThread]: 
[0m10:24:27.724205 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:24:27.725181 [info ] [MainThread]: 
[0m10:24:27.726282 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m10:24:27.727976 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.005821, "process_user_time": 3.305296, "process_kernel_time": 0.196404, "process_mem_max_rss": "123232", "process_in_blocks": "816", "process_out_blocks": "0"}
[0m10:24:27.728881 [debug] [MainThread]: Command `dbt run` succeeded at 10:24:27.728756 after 4.01 seconds
[0m10:24:27.729600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573df368d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573db64830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573db64920>]}
[0m10:24:27.730609 [debug] [MainThread]: Flushing usage events
[0m10:24:31.788216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdef7347380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdef3f6b6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdef3f68c50>]}


============================== 10:24:31.796031 | a77070d1-143f-400b-aa30-06f9dc642236 ==============================
[0m10:24:31.796031 [info ] [MainThread]: Running with dbt=1.8.0
[0m10:24:31.797066 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select tag:trusted', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:24:32.013553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a77070d1-143f-400b-aa30-06f9dc642236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdef4651700>]}
[0m10:24:32.084622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a77070d1-143f-400b-aa30-06f9dc642236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdef36c7dd0>]}
[0m10:24:32.085940 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:24:32.168667 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m10:24:32.287572 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:24:32.288401 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:24:32.326633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a77070d1-143f-400b-aa30-06f9dc642236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdef2762b40>]}
[0m10:24:32.473689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a77070d1-143f-400b-aa30-06f9dc642236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdef23997f0>]}
[0m10:24:32.474621 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m10:24:32.475454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a77070d1-143f-400b-aa30-06f9dc642236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdef276fd10>]}
[0m10:24:32.478414 [info ] [MainThread]: 
[0m10:24:32.479463 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:24:32.485328 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m10:24:32.525164 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m10:24:32.526020 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m10:24:32.526776 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:24:32.532656 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.006 seconds
[0m10:24:32.534631 [debug] [ThreadPool]: On list_airflow: Close
[0m10:24:32.537329 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_trusted)
[0m10:24:32.544009 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m10:24:32.544806 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m10:24:32.545502 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:24:32.549675 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m10:24:32.550389 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m10:24:32.551022 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m10:24:32.554205 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m10:24:32.556104 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m10:24:32.557162 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m10:24:32.558103 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now list_airflow_lead_staging)
[0m10:24:32.561240 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m10:24:32.561869 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m10:24:32.562562 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:24:32.566333 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m10:24:32.566977 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m10:24:32.567625 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m10:24:32.570566 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m10:24:32.572575 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m10:24:32.573450 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m10:24:32.580797 [debug] [MainThread]: Using postgres connection "master"
[0m10:24:32.581583 [debug] [MainThread]: On master: BEGIN
[0m10:24:32.582320 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:24:32.586278 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m10:24:32.586923 [debug] [MainThread]: Using postgres connection "master"
[0m10:24:32.587648 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:24:32.591387 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m10:24:32.593340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a77070d1-143f-400b-aa30-06f9dc642236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdef33c2f90>]}
[0m10:24:32.594156 [debug] [MainThread]: On master: ROLLBACK
[0m10:24:32.595183 [debug] [MainThread]: Using postgres connection "master"
[0m10:24:32.595881 [debug] [MainThread]: On master: BEGIN
[0m10:24:32.597035 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:24:32.597846 [debug] [MainThread]: On master: COMMIT
[0m10:24:32.598619 [debug] [MainThread]: Using postgres connection "master"
[0m10:24:32.599335 [debug] [MainThread]: On master: COMMIT
[0m10:24:32.600280 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:24:32.600960 [debug] [MainThread]: On master: Close
[0m10:24:32.601880 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:24:32.602726 [info ] [MainThread]: 
[0m10:24:32.612790 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_non_pii_data
[0m10:24:32.613794 [info ] [Thread-1 (]: 1 of 4 START sql table model lead_trusted.non_pii_data ......................... [RUN]
[0m10:24:32.614783 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now model.dbt_lead_data.trusted_non_pii_data)
[0m10:24:32.615567 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_non_pii_data
[0m10:24:32.625813 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_non_pii_data"
[0m10:24:32.628253 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_non_pii_data
[0m10:24:32.670659 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_non_pii_data"
[0m10:24:32.673844 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m10:24:32.674602 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: BEGIN
[0m10:24:32.675258 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:24:32.679695 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m10:24:32.680420 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m10:24:32.681256 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */

  
    

  create  table "airflow"."lead_trusted"."non_pii_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        '***MASKED***' AS person_name,
        SUBSTRING(dp.user_name, 1, 5) || '*****'  user_name,
        SUBSTRING(dp.email, 1, 5) || '*****' AS email,
        '***MASKED***'  AS personal_number, 
        '***MASKED***' AS birth_date, 
        '***MASKED***' AS address,
        '***MASKED***'  AS phone, 
        SUBSTRING(da.mac_address, 1, 5) || '*****' AS mac_address,
        SUBSTRING(da.ip_address, 1, 5) || '*****' AS ip_address,
        SUBSTRING(df.iban, 1, 5) || '*****' AS iban,
        dd.accessed_at,
        fnu.session_duration,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.consumed_traffic,
        fnu.unique_id
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    INNER JOIN
        "airflow"."lead_staging"."dim_address" da ON fnu.unique_id = da.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_date" dd ON da.unique_id = dd.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_finance" df ON dd.unique_id = df.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_person" dp ON df.unique_id = dp.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:24:40.322005 [debug] [Thread-1 (]: SQL status: SELECT 403438 in 7.640 seconds
[0m10:24:40.329997 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m10:24:40.330907 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
alter table "airflow"."lead_trusted"."non_pii_data" rename to "non_pii_data__dbt_backup"
[0m10:24:40.332254 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:24:40.335994 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m10:24:40.336760 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
alter table "airflow"."lead_trusted"."non_pii_data__dbt_tmp" rename to "non_pii_data"
[0m10:24:40.337799 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:24:40.362053 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: COMMIT
[0m10:24:40.362988 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m10:24:40.363878 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: COMMIT
[0m10:24:40.366993 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m10:24:40.375368 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."non_pii_data__dbt_backup"
[0m10:24:40.382157 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m10:24:40.383024 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
drop table if exists "airflow"."lead_trusted"."non_pii_data__dbt_backup" cascade
[0m10:24:40.390663 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m10:24:40.394101 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: Close
[0m10:24:40.396599 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a77070d1-143f-400b-aa30-06f9dc642236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdef4c3dee0>]}
[0m10:24:40.397876 [info ] [Thread-1 (]: 1 of 4 OK created sql table model lead_trusted.non_pii_data .................... [[32mSELECT 403438[0m in 7.78s]
[0m10:24:40.399241 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_non_pii_data
[0m10:24:40.400208 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_payment_data
[0m10:24:40.401074 [info ] [Thread-1 (]: 2 of 4 START sql table model lead_trusted.payment_data ......................... [RUN]
[0m10:24:40.401948 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_non_pii_data, now model.dbt_lead_data.trusted_payment_data)
[0m10:24:40.402649 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_payment_data
[0m10:24:40.407431 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_payment_data"
[0m10:24:40.410092 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_payment_data
[0m10:24:40.414577 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_payment_data"
[0m10:24:40.416977 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m10:24:40.417686 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: BEGIN
[0m10:24:40.418348 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:24:40.423715 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m10:24:40.424868 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m10:24:40.425698 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */

  
    

  create  table "airflow"."lead_trusted"."payment_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        fnu.unique_id,
        df.iban,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.session_duration,
        fnu.consumed_traffic,
        ((fnu.download_speed + fnu.upload_speed + 1)/2) + (fnu.consumed_traffic / (fnu.session_duration + 1)) AS payment_amount
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    JOIN
        "airflow"."lead_staging"."dim_finance" df
    ON
	    fnu.unique_id = df.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:24:42.956711 [debug] [Thread-1 (]: SQL status: SELECT 403438 in 2.530 seconds
[0m10:24:42.960110 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m10:24:42.960878 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
alter table "airflow"."lead_trusted"."payment_data" rename to "payment_data__dbt_backup"
[0m10:24:42.962160 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:24:42.965499 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m10:24:42.966266 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
alter table "airflow"."lead_trusted"."payment_data__dbt_tmp" rename to "payment_data"
[0m10:24:42.967406 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:24:42.969734 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: COMMIT
[0m10:24:42.970459 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m10:24:42.971174 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: COMMIT
[0m10:24:42.975349 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m10:24:42.978058 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."payment_data__dbt_backup"
[0m10:24:42.979238 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m10:24:42.979979 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
drop table if exists "airflow"."lead_trusted"."payment_data__dbt_backup" cascade
[0m10:24:42.985031 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m10:24:42.986987 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: Close
[0m10:24:42.988108 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a77070d1-143f-400b-aa30-06f9dc642236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdef060f8f0>]}
[0m10:24:42.989117 [info ] [Thread-1 (]: 2 of 4 OK created sql table model lead_trusted.payment_data .................... [[32mSELECT 403438[0m in 2.59s]
[0m10:24:42.990217 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_payment_data
[0m10:24:42.991079 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_pii_data
[0m10:24:42.991946 [info ] [Thread-1 (]: 3 of 4 START sql table model lead_trusted.pii_data ............................. [RUN]
[0m10:24:42.992880 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_payment_data, now model.dbt_lead_data.trusted_pii_data)
[0m10:24:42.993675 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_pii_data
[0m10:24:42.998417 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_pii_data"
[0m10:24:43.000715 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_pii_data
[0m10:24:43.006230 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_pii_data"
[0m10:24:43.008273 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m10:24:43.008949 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: BEGIN
[0m10:24:43.009640 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:24:43.014222 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m10:24:43.014966 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m10:24:43.015688 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */

  
    

  create  table "airflow"."lead_trusted"."pii_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        dp.person_name,
        dp.user_name,
        dp.email,
        dp.personal_number, 
        dp.birth_date, 
        da.address,
        dp.phone, 
        da.mac_address,
        da.ip_address,
        df.iban,
        dd.accessed_at,
        fnu.session_duration,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.consumed_traffic,
        fnu.unique_id
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    INNER JOIN
        "airflow"."lead_staging"."dim_address" da ON fnu.unique_id = da.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_date" dd ON da.unique_id = dd.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_finance" df ON dd.unique_id = df.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_person" dp ON df.unique_id = dp.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:24:50.606619 [debug] [Thread-1 (]: SQL status: SELECT 403438 in 7.590 seconds
[0m10:24:50.611128 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m10:24:50.612014 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */
alter table "airflow"."lead_trusted"."pii_data" rename to "pii_data__dbt_backup"
[0m10:24:50.613324 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:24:50.617209 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m10:24:50.618007 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */
alter table "airflow"."lead_trusted"."pii_data__dbt_tmp" rename to "pii_data"
[0m10:24:50.619210 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:24:50.621775 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: COMMIT
[0m10:24:50.622720 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m10:24:50.623562 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: COMMIT
[0m10:24:50.627531 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m10:24:50.630576 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."pii_data__dbt_backup"
[0m10:24:50.631736 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m10:24:50.632490 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */
drop table if exists "airflow"."lead_trusted"."pii_data__dbt_backup" cascade
[0m10:24:50.640180 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m10:24:50.642498 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: Close
[0m10:24:50.643565 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a77070d1-143f-400b-aa30-06f9dc642236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdef050e120>]}
[0m10:24:50.644532 [info ] [Thread-1 (]: 3 of 4 OK created sql table model lead_trusted.pii_data ........................ [[32mSELECT 403438[0m in 7.65s]
[0m10:24:50.645519 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_pii_data
[0m10:24:50.646312 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_technical_data
[0m10:24:50.647219 [info ] [Thread-1 (]: 4 of 4 START sql table model lead_trusted.technical_data ....................... [RUN]
[0m10:24:50.648127 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_pii_data, now model.dbt_lead_data.trusted_technical_data)
[0m10:24:50.648848 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_technical_data
[0m10:24:50.652980 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_technical_data"
[0m10:24:50.655713 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_technical_data
[0m10:24:50.660529 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_technical_data"
[0m10:24:50.662929 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m10:24:50.663684 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: BEGIN
[0m10:24:50.664393 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:24:50.669600 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m10:24:50.670429 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m10:24:50.671246 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */

  
    

  create  table "airflow"."lead_trusted"."technical_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        fnu.unique_id,
        da.address,
        da.mac_address,
        da.ip_address,
        fnu.download_speed,
        fnu.upload_speed,
        ROUND((fnu.session_duration/60), 1) as min_session_duration,
        CASE 
            WHEN fnu.download_speed < 50 OR fnu.upload_speed < 30 OR fnu.session_duration/60 < 1 THEN true
            ELSE false
        END AS technical_issue
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    JOIN
        "airflow"."lead_staging"."dim_address" da
    ON
	    fnu.unique_id = da.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m10:24:53.619180 [debug] [Thread-1 (]: SQL status: SELECT 403438 in 2.943 seconds
[0m10:24:53.623013 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m10:24:53.623847 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
alter table "airflow"."lead_trusted"."technical_data" rename to "technical_data__dbt_backup"
[0m10:24:53.625043 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:24:53.628511 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m10:24:53.629288 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
alter table "airflow"."lead_trusted"."technical_data__dbt_tmp" rename to "technical_data"
[0m10:24:53.630386 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:24:53.633084 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: COMMIT
[0m10:24:53.633898 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m10:24:53.634671 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: COMMIT
[0m10:24:53.727203 [debug] [Thread-1 (]: SQL status: COMMIT in 0.092 seconds
[0m10:24:53.730312 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."technical_data__dbt_backup"
[0m10:24:53.731487 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m10:24:53.732236 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
drop table if exists "airflow"."lead_trusted"."technical_data__dbt_backup" cascade
[0m10:24:53.737164 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m10:24:53.739101 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: Close
[0m10:24:53.739956 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a77070d1-143f-400b-aa30-06f9dc642236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdef07d2c30>]}
[0m10:24:53.740970 [info ] [Thread-1 (]: 4 of 4 OK created sql table model lead_trusted.technical_data .................. [[32mSELECT 403438[0m in 3.09s]
[0m10:24:53.742053 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_technical_data
[0m10:24:53.744523 [debug] [MainThread]: Using postgres connection "master"
[0m10:24:53.745376 [debug] [MainThread]: On master: BEGIN
[0m10:24:53.746081 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:24:53.750110 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m10:24:53.750902 [debug] [MainThread]: On master: COMMIT
[0m10:24:53.751606 [debug] [MainThread]: Using postgres connection "master"
[0m10:24:53.752358 [debug] [MainThread]: On master: COMMIT
[0m10:24:53.753247 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:24:53.753984 [debug] [MainThread]: On master: Close
[0m10:24:53.755004 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:24:53.755655 [debug] [MainThread]: Connection 'model.dbt_lead_data.trusted_technical_data' was properly closed.
[0m10:24:53.756462 [info ] [MainThread]: 
[0m10:24:53.757219 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 21.28 seconds (21.28s).
[0m10:24:53.759019 [debug] [MainThread]: Command end result
[0m10:24:53.812814 [info ] [MainThread]: 
[0m10:24:53.813649 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:24:53.814497 [info ] [MainThread]: 
[0m10:24:53.815509 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m10:24:53.817014 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 22.093216, "process_user_time": 2.919053, "process_kernel_time": 0.166658, "process_mem_max_rss": "122852", "process_in_blocks": "880", "process_out_blocks": "0"}
[0m10:24:53.817955 [debug] [MainThread]: Command `dbt run` succeeded at 10:24:53.817815 after 22.09 seconds
[0m10:24:53.818720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdef3a3a9c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdef40fbb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdef1b66e70>]}
[0m10:24:53.819429 [debug] [MainThread]: Flushing usage events
[0m07:06:40.560917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52a73247a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52a599f140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52a4f5c740>]}
[0m07:06:40.560448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc05e74c920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc05ea327e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc05e74c830>]}


============================== 07:06:40.691080 | 90d3c004-85ef-4124-8b90-74fe7e68abd8 ==============================
[0m07:06:40.691080 [info ] [MainThread]: Running with dbt=1.8.0


============================== 07:06:40.692843 | 2098d7be-4d95-4eff-a34b-eb9f522e9f77 ==============================
[0m07:06:40.692843 [info ] [MainThread]: Running with dbt=1.8.0
[0m07:06:40.696731 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select tag:staging', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:06:40.698638 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select tag:staging', 'send_anonymous_usage_stats': 'True'}
[0m07:06:42.241084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2098d7be-4d95-4eff-a34b-eb9f522e9f77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc05e55a240>]}
[0m07:06:42.241974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '90d3c004-85ef-4124-8b90-74fe7e68abd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52a608c3b0>]}
[0m07:06:42.618005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2098d7be-4d95-4eff-a34b-eb9f522e9f77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc05e3d05c0>]}
[0m07:06:42.621407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '90d3c004-85ef-4124-8b90-74fe7e68abd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52a47a7a10>]}
[0m07:06:42.624835 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:06:42.627281 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:06:43.586211 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m07:06:43.608401 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m07:06:45.039168 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:06:45.039847 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:06:45.043474 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:06:45.045755 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:06:45.265925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '90d3c004-85ef-4124-8b90-74fe7e68abd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52a4527680>]}
[0m07:06:45.273553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2098d7be-4d95-4eff-a34b-eb9f522e9f77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc05e2f17c0>]}
[0m07:06:46.165343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2098d7be-4d95-4eff-a34b-eb9f522e9f77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc05d93f4d0>]}
[0m07:06:46.168204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '90d3c004-85ef-4124-8b90-74fe7e68abd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52a5fd4d10>]}
[0m07:06:46.178001 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m07:06:46.183292 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m07:06:46.188736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2098d7be-4d95-4eff-a34b-eb9f522e9f77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc05e751d60>]}
[0m07:06:46.195221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90d3c004-85ef-4124-8b90-74fe7e68abd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52a35c49b0>]}
[0m07:06:46.209004 [info ] [MainThread]: 
[0m07:06:46.212684 [info ] [MainThread]: 
[0m07:06:46.215163 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:06:46.218446 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:06:46.246083 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m07:06:46.249425 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m07:06:46.486040 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m07:06:46.486258 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m07:06:46.490563 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m07:06:46.492298 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m07:06:46.494595 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:06:46.496693 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:06:46.530603 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.035 seconds
[0m07:06:46.539506 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.043 seconds
[0m07:06:46.543344 [debug] [ThreadPool]: On list_airflow: Close
[0m07:06:46.555639 [debug] [ThreadPool]: On list_airflow: Close
[0m07:06:46.569299 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_trusted)
[0m07:06:46.576297 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_trusted)
[0m07:06:46.623948 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:06:46.625373 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:06:46.628221 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m07:06:46.629607 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m07:06:46.632133 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:06:46.634416 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:06:46.660381 [debug] [ThreadPool]: SQL status: BEGIN in 0.028 seconds
[0m07:06:46.662611 [debug] [ThreadPool]: SQL status: BEGIN in 0.028 seconds
[0m07:06:46.666009 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:06:46.667435 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:06:46.670374 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m07:06:46.672381 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m07:06:46.693388 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.014 seconds
[0m07:06:46.694432 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.019 seconds
[0m07:06:46.707365 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m07:06:46.708427 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m07:06:46.714296 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m07:06:46.716317 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m07:06:46.720956 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now list_airflow_lead_staging)
[0m07:06:46.724271 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now list_airflow_lead_staging)
[0m07:06:46.750268 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:06:46.755344 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:06:46.756354 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m07:06:46.762268 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m07:06:46.768640 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:06:46.770196 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:06:46.797386 [debug] [ThreadPool]: SQL status: BEGIN in 0.029 seconds
[0m07:06:46.803562 [debug] [ThreadPool]: SQL status: BEGIN in 0.033 seconds
[0m07:06:46.805370 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:06:46.809343 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:06:46.811369 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m07:06:46.815562 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m07:06:46.832561 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.015 seconds
[0m07:06:46.834146 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.013 seconds
[0m07:06:46.843382 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m07:06:46.846607 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m07:06:46.848759 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m07:06:46.852490 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m07:06:46.915479 [debug] [MainThread]: Using postgres connection "master"
[0m07:06:46.921693 [debug] [MainThread]: On master: BEGIN
[0m07:06:46.930326 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:06:46.963459 [debug] [MainThread]: SQL status: BEGIN in 0.032 seconds
[0m07:06:46.966715 [debug] [MainThread]: Using postgres connection "master"
[0m07:06:46.968577 [debug] [MainThread]: Using postgres connection "master"
[0m07:06:46.971348 [debug] [MainThread]: On master: BEGIN
[0m07:06:46.973900 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:06:46.975818 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:06:46.994044 [debug] [MainThread]: SQL status: SELECT 0 in 0.014 seconds
[0m07:06:46.999600 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m07:06:47.004403 [debug] [MainThread]: Using postgres connection "master"
[0m07:06:47.006494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2098d7be-4d95-4eff-a34b-eb9f522e9f77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc05d9dba10>]}
[0m07:06:47.009473 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:06:47.011548 [debug] [MainThread]: On master: ROLLBACK
[0m07:06:47.017361 [debug] [MainThread]: Using postgres connection "master"
[0m07:06:47.021297 [debug] [MainThread]: On master: BEGIN
[0m07:06:47.027377 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m07:06:47.028879 [debug] [MainThread]: SQL status: SELECT 0 in 0.014 seconds
[0m07:06:47.032394 [debug] [MainThread]: On master: COMMIT
[0m07:06:47.037196 [debug] [MainThread]: Using postgres connection "master"
[0m07:06:47.041293 [debug] [MainThread]: On master: COMMIT
[0m07:06:47.040985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90d3c004-85ef-4124-8b90-74fe7e68abd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52a44fc1d0>]}
[0m07:06:47.047415 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m07:06:47.049590 [debug] [MainThread]: On master: ROLLBACK
[0m07:06:47.052235 [debug] [MainThread]: On master: Close
[0m07:06:47.055249 [debug] [MainThread]: Using postgres connection "master"
[0m07:06:47.057891 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:06:47.060576 [debug] [MainThread]: On master: BEGIN
[0m07:06:47.062734 [info ] [MainThread]: 
[0m07:06:47.068597 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m07:06:47.074487 [debug] [MainThread]: On master: COMMIT
[0m07:06:47.079605 [debug] [MainThread]: Using postgres connection "master"
[0m07:06:47.084184 [debug] [MainThread]: On master: COMMIT
[0m07:06:47.089311 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m07:06:47.094915 [debug] [MainThread]: On master: Close
[0m07:06:47.101475 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:06:47.106855 [info ] [MainThread]: 
[0m07:06:47.131394 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_adress
[0m07:06:47.137584 [info ] [Thread-1 (]: 1 of 5 START sql table model lead_staging.dim_address .......................... [RUN]
[0m07:06:47.142703 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now model.dbt_lead_data.staging_dim_adress)
[0m07:06:47.147118 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_adress
[0m07:06:47.167549 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_adress
[0m07:06:47.172596 [info ] [Thread-1 (]: 1 of 5 START sql table model lead_staging.dim_address .......................... [RUN]
[0m07:06:47.177590 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now model.dbt_lead_data.staging_dim_adress)
[0m07:06:47.181575 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_adress
[0m07:06:47.195541 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_adress"
[0m07:06:47.211791 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_adress
[0m07:06:47.228704 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_adress"
[0m07:06:47.238761 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_adress
[0m07:06:47.448651 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_adress"
[0m07:06:47.465173 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:06:47.469104 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: BEGIN
[0m07:06:47.471513 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_adress"
[0m07:06:47.473691 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:06:47.487242 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:06:47.492202 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: BEGIN
[0m07:06:47.498462 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:06:47.504574 [debug] [Thread-1 (]: SQL status: BEGIN in 0.030 seconds
[0m07:06:47.510506 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:06:47.514991 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */

  
    

  create  table "airflow"."lead_staging"."dim_address__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        address,
        mac_address,
        ip_address
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:06:47.526308 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m07:06:47.530436 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:06:47.534734 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */

  
    

  create  table "airflow"."lead_staging"."dim_address__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        address,
        mac_address,
        ip_address
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:21:49.926883 [debug] [Thread-1 (]: SQL status: SELECT 808210 in 902.468 seconds
[0m07:21:49.936381 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:21:49.937694 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
alter table "airflow"."lead_staging"."dim_address" rename to "dim_address__dbt_backup"
[0m07:21:49.939278 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:21:49.943992 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:21:49.945063 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
alter table "airflow"."lead_staging"."dim_address__dbt_tmp" rename to "dim_address"
[0m07:21:49.946526 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:21:49.973626 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m07:21:49.974627 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:21:49.975484 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m07:21:49.977123 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:21:49.986842 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_address__dbt_backup"
[0m07:21:49.996764 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:21:49.998375 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
drop table if exists "airflow"."lead_staging"."dim_address__dbt_backup" cascade
[0m07:21:50.007819 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.008 seconds
[0m07:21:50.011543 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: Close
[0m07:21:50.014580 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2098d7be-4d95-4eff-a34b-eb9f522e9f77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc05fdbf020>]}
[0m07:21:50.015880 [info ] [Thread-1 (]: 1 of 5 OK created sql table model lead_staging.dim_address ..................... [[32mSELECT 808210[0m in 902.87s]
[0m07:21:50.017382 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_adress
[0m07:21:50.018555 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_date
[0m07:21:50.019719 [info ] [Thread-1 (]: 2 of 5 START sql table model lead_staging.dim_date ............................. [RUN]
[0m07:21:50.020834 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_adress, now model.dbt_lead_data.staging_dim_date)
[0m07:21:50.021978 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_date
[0m07:21:50.026368 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_date"
[0m07:21:50.030262 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_date
[0m07:21:50.035760 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_date"
[0m07:21:50.039446 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m07:21:50.041765 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: BEGIN
[0m07:21:50.043146 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:21:50.048380 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m07:21:50.050068 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m07:21:50.051429 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */

  
    

  create  table "airflow"."lead_staging"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        accessed_at
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:21:51.720332 [debug] [Thread-1 (]: SQL status: SELECT 808210 in 1.667 seconds
[0m07:21:51.726532 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m07:21:51.727523 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
alter table "airflow"."lead_staging"."dim_date" rename to "dim_date__dbt_backup"
[0m07:21:51.728960 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:21:51.734991 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m07:21:51.736975 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
alter table "airflow"."lead_staging"."dim_date__dbt_tmp" rename to "dim_date"
[0m07:21:51.738692 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:21:51.742904 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: COMMIT
[0m07:21:51.744180 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m07:21:51.745088 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: COMMIT
[0m07:21:51.762477 [debug] [Thread-1 (]: SQL status: COMMIT in 0.016 seconds
[0m07:21:51.766739 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_date__dbt_backup"
[0m07:21:51.768423 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m07:21:51.769538 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
drop table if exists "airflow"."lead_staging"."dim_date__dbt_backup" cascade
[0m07:21:51.774805 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m07:21:51.777395 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: Close
[0m07:21:51.778602 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2098d7be-4d95-4eff-a34b-eb9f522e9f77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc05c51e900>]}
[0m07:21:51.780225 [info ] [Thread-1 (]: 2 of 5 OK created sql table model lead_staging.dim_date ........................ [[32mSELECT 808210[0m in 1.76s]
[0m07:21:51.782032 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_date
[0m07:21:51.783498 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_finance
[0m07:21:51.785584 [info ] [Thread-1 (]: 3 of 5 START sql table model lead_staging.dim_finance .......................... [RUN]
[0m07:21:51.787023 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_date, now model.dbt_lead_data.staging_dim_finance)
[0m07:21:51.790226 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_finance
[0m07:21:51.799818 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_finance"
[0m07:21:51.809384 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_finance
[0m07:21:51.819581 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_finance"
[0m07:21:51.827410 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m07:21:51.828797 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: BEGIN
[0m07:21:51.830472 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:21:51.838373 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m07:21:51.839521 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m07:21:51.840501 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */

  
    

  create  table "airflow"."lead_staging"."dim_finance__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        iban
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:21:52.087172 [debug] [Thread-1 (]: SQL status: SELECT 808210 in 904.609 seconds
[0m07:21:52.099888 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:21:52.101276 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
alter table "airflow"."lead_staging"."dim_address" rename to "dim_address__dbt_backup"
[0m07:21:52.102847 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:21:52.107648 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:21:52.108659 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
alter table "airflow"."lead_staging"."dim_address__dbt_tmp" rename to "dim_address"
[0m07:21:52.110389 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:21:52.143244 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m07:21:52.144343 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:21:52.145322 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m07:21:52.156210 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m07:21:52.166489 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_address__dbt_backup"
[0m07:21:52.177765 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:21:52.179131 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
drop table if exists "airflow"."lead_staging"."dim_address__dbt_backup" cascade
[0m07:21:52.199253 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.019 seconds
[0m07:21:52.203147 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: Close
[0m07:21:52.206909 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90d3c004-85ef-4124-8b90-74fe7e68abd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52a6042de0>]}
[0m07:21:52.208236 [info ] [Thread-1 (]: 1 of 5 OK created sql table model lead_staging.dim_address ..................... [[32mSELECT 808210[0m in 905.03s]
[0m07:21:52.209911 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_adress
[0m07:21:52.211435 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_date
[0m07:21:52.212943 [info ] [Thread-1 (]: 2 of 5 START sql table model lead_staging.dim_date ............................. [RUN]
[0m07:21:52.214091 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_adress, now model.dbt_lead_data.staging_dim_date)
[0m07:21:52.215047 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_date
[0m07:21:52.221446 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_date"
[0m07:21:52.224279 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_date
[0m07:21:52.229588 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_date"
[0m07:21:52.232364 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m07:21:52.233332 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: BEGIN
[0m07:21:52.234491 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:21:52.240959 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m07:21:52.242492 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m07:21:52.243450 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */

  
    

  create  table "airflow"."lead_staging"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        accessed_at
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:21:53.312786 [debug] [Thread-1 (]: SQL status: SELECT 808210 in 1.471 seconds
[0m07:21:53.317599 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m07:21:53.318767 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
alter table "airflow"."lead_staging"."dim_finance" rename to "dim_finance__dbt_backup"
[0m07:21:53.320485 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:21:53.327736 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m07:21:53.328861 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
alter table "airflow"."lead_staging"."dim_finance__dbt_tmp" rename to "dim_finance"
[0m07:21:53.336702 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m07:21:53.340540 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: COMMIT
[0m07:21:53.341563 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m07:21:53.342630 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: COMMIT
[0m07:21:53.345581 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m07:21:53.349182 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_finance__dbt_backup"
[0m07:21:53.351050 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m07:21:53.352071 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
drop table if exists "airflow"."lead_staging"."dim_finance__dbt_backup" cascade
[0m07:21:53.357292 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m07:21:53.359611 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: Close
[0m07:21:53.361467 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2098d7be-4d95-4eff-a34b-eb9f522e9f77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc05c1972f0>]}
[0m07:21:53.362588 [info ] [Thread-1 (]: 3 of 5 OK created sql table model lead_staging.dim_finance ..................... [[32mSELECT 808210[0m in 1.57s]
[0m07:21:53.364061 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_finance
[0m07:21:53.365446 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_person
[0m07:21:53.366745 [info ] [Thread-1 (]: 4 of 5 START sql table model lead_staging.dim_person ........................... [RUN]
[0m07:21:53.367747 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_finance, now model.dbt_lead_data.staging_dim_person)
[0m07:21:53.368619 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_person
[0m07:21:53.372940 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_person"
[0m07:21:53.376713 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_person
[0m07:21:53.382789 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_person"
[0m07:21:53.386118 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m07:21:53.387384 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: BEGIN
[0m07:21:53.388403 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:21:53.393931 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m07:21:53.394884 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m07:21:53.395795 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */

  
    

  create  table "airflow"."lead_staging"."dim_person__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        person_name,
        user_name,
        email,
        phone,
        birth_date,
        personal_number
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:21:53.468420 [debug] [Thread-1 (]: SQL status: SELECT 808210 in 1.224 seconds
[0m07:21:53.476020 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m07:21:53.477337 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
alter table "airflow"."lead_staging"."dim_date" rename to "dim_date__dbt_backup"
[0m07:21:53.478904 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:21:53.483436 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m07:21:53.484410 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
alter table "airflow"."lead_staging"."dim_date__dbt_tmp" rename to "dim_date"
[0m07:21:53.485844 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:21:53.488976 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: COMMIT
[0m07:21:53.489759 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m07:21:53.490766 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: COMMIT
[0m07:21:53.502226 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m07:21:53.506541 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_date__dbt_backup"
[0m07:21:53.508503 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m07:21:53.509982 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
drop table if exists "airflow"."lead_staging"."dim_date__dbt_backup" cascade
[0m07:21:53.526355 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.015 seconds
[0m07:21:53.529465 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: Close
[0m07:21:53.530886 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90d3c004-85ef-4124-8b90-74fe7e68abd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52a2512c90>]}
[0m07:21:53.532861 [info ] [Thread-1 (]: 2 of 5 OK created sql table model lead_staging.dim_date ........................ [[32mSELECT 808210[0m in 1.32s]
[0m07:21:53.534618 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_date
[0m07:21:53.535648 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_finance
[0m07:21:53.536938 [info ] [Thread-1 (]: 3 of 5 START sql table model lead_staging.dim_finance .......................... [RUN]
[0m07:21:53.538102 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_date, now model.dbt_lead_data.staging_dim_finance)
[0m07:21:53.539264 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_finance
[0m07:21:53.545006 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_finance"
[0m07:21:53.548539 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_finance
[0m07:21:53.555260 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_finance"
[0m07:21:53.558546 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m07:21:53.560023 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: BEGIN
[0m07:21:53.561276 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:21:53.567252 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m07:21:53.568338 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m07:21:53.569554 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */

  
    

  create  table "airflow"."lead_staging"."dim_finance__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        iban
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:21:54.844431 [debug] [Thread-1 (]: SQL status: SELECT 808210 in 1.274 seconds
[0m07:21:54.848339 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m07:21:54.849174 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
alter table "airflow"."lead_staging"."dim_finance" rename to "dim_finance__dbt_backup"
[0m07:21:54.850556 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:21:54.855758 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m07:21:54.856625 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
alter table "airflow"."lead_staging"."dim_finance__dbt_tmp" rename to "dim_finance"
[0m07:21:54.866588 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.009 seconds
[0m07:21:54.869460 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: COMMIT
[0m07:21:54.870283 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m07:21:54.871364 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: COMMIT
[0m07:21:54.874659 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m07:21:54.879007 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_finance__dbt_backup"
[0m07:21:54.880762 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m07:21:54.881607 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
drop table if exists "airflow"."lead_staging"."dim_finance__dbt_backup" cascade
[0m07:21:54.899924 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.017 seconds
[0m07:21:54.902782 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: Close
[0m07:21:54.904634 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90d3c004-85ef-4124-8b90-74fe7e68abd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52a1997da0>]}
[0m07:21:54.905820 [info ] [Thread-1 (]: 3 of 5 OK created sql table model lead_staging.dim_finance ..................... [[32mSELECT 808210[0m in 1.37s]
[0m07:21:54.907656 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_finance
[0m07:21:54.908687 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_person
[0m07:21:54.909830 [info ] [Thread-1 (]: 4 of 5 START sql table model lead_staging.dim_person ........................... [RUN]
[0m07:21:54.910997 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_finance, now model.dbt_lead_data.staging_dim_person)
[0m07:21:54.912181 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_person
[0m07:21:54.916771 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_person"
[0m07:21:54.920121 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_person
[0m07:21:54.926286 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_person"
[0m07:21:54.929641 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m07:21:54.930410 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: BEGIN
[0m07:21:54.931106 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:21:54.935592 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m07:21:54.936457 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m07:21:54.937252 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */

  
    

  create  table "airflow"."lead_staging"."dim_person__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        person_name,
        user_name,
        email,
        phone,
        birth_date,
        personal_number
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:21:55.021317 [debug] [Thread-1 (]: SQL status: SELECT 808210 in 1.625 seconds
[0m07:21:55.025270 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m07:21:55.026219 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
alter table "airflow"."lead_staging"."dim_person" rename to "dim_person__dbt_backup"
[0m07:21:55.027493 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:21:55.031145 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m07:21:55.032238 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
alter table "airflow"."lead_staging"."dim_person__dbt_tmp" rename to "dim_person"
[0m07:21:55.033637 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:21:55.036297 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: COMMIT
[0m07:21:55.037155 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m07:21:55.037940 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: COMMIT
[0m07:21:55.039425 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:21:55.042290 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_person__dbt_backup"
[0m07:21:55.043616 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m07:21:55.044362 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
drop table if exists "airflow"."lead_staging"."dim_person__dbt_backup" cascade
[0m07:21:55.047805 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m07:21:55.049672 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: Close
[0m07:21:55.050769 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2098d7be-4d95-4eff-a34b-eb9f522e9f77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc05c51ed80>]}
[0m07:21:55.051769 [info ] [Thread-1 (]: 4 of 5 OK created sql table model lead_staging.dim_person ...................... [[32mSELECT 808210[0m in 1.68s]
[0m07:21:55.052913 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_person
[0m07:21:55.053934 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_fact_network_usage
[0m07:21:55.055077 [info ] [Thread-1 (]: 5 of 5 START sql table model lead_staging.fact_network_usage ................... [RUN]
[0m07:21:55.056038 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_person, now model.dbt_lead_data.staging_fact_network_usage)
[0m07:21:55.056946 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_fact_network_usage
[0m07:21:55.060987 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_fact_network_usage"
[0m07:21:55.063934 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_fact_network_usage
[0m07:21:55.068502 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_fact_network_usage"
[0m07:21:55.070949 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m07:21:55.071821 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: BEGIN
[0m07:21:55.072573 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:21:55.077525 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m07:21:55.078414 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m07:21:55.079252 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */

  
    

  create  table "airflow"."lead_staging"."fact_network_usage__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        session_duration,
        download_speed,
        upload_speed,
        consumed_traffic
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:21:56.855674 [debug] [Thread-1 (]: SQL status: SELECT 808210 in 1.776 seconds
[0m07:21:56.859836 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m07:21:56.860772 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
alter table "airflow"."lead_staging"."fact_network_usage" rename to "fact_network_usage__dbt_backup"
[0m07:21:56.864892 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m07:21:56.868475 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m07:21:56.869216 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
alter table "airflow"."lead_staging"."fact_network_usage__dbt_tmp" rename to "fact_network_usage"
[0m07:21:56.870309 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:21:56.872637 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: COMMIT
[0m07:21:56.873546 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m07:21:56.874174 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: COMMIT
[0m07:21:56.879490 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m07:21:56.883954 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."fact_network_usage__dbt_backup"
[0m07:21:56.885365 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m07:21:56.886208 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
drop table if exists "airflow"."lead_staging"."fact_network_usage__dbt_backup" cascade
[0m07:21:56.890720 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m07:21:56.892782 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: Close
[0m07:21:56.893813 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2098d7be-4d95-4eff-a34b-eb9f522e9f77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc05c1c4b00>]}
[0m07:21:56.895460 [info ] [Thread-1 (]: 5 of 5 OK created sql table model lead_staging.fact_network_usage .............. [[32mSELECT 808210[0m in 1.84s]
[0m07:21:56.897102 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_fact_network_usage
[0m07:21:56.900378 [debug] [MainThread]: Using postgres connection "master"
[0m07:21:56.900993 [debug] [MainThread]: On master: BEGIN
[0m07:21:56.901932 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:21:56.908029 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m07:21:56.909349 [debug] [MainThread]: On master: COMMIT
[0m07:21:56.910314 [debug] [MainThread]: Using postgres connection "master"
[0m07:21:56.911216 [debug] [MainThread]: On master: COMMIT
[0m07:21:56.912186 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:21:56.912922 [debug] [MainThread]: On master: Close
[0m07:21:56.914071 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:21:56.914816 [debug] [MainThread]: Connection 'model.dbt_lead_data.staging_fact_network_usage' was properly closed.
[0m07:21:56.915642 [info ] [MainThread]: 
[0m07:21:56.916592 [info ] [MainThread]: Finished running 5 table models in 0 hours 15 minutes and 10.70 seconds (910.70s).
[0m07:21:56.918557 [debug] [MainThread]: Command end result
[0m07:21:56.980856 [info ] [MainThread]: 
[0m07:21:56.982258 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:21:56.983369 [info ] [MainThread]: 
[0m07:21:56.984351 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m07:21:56.986141 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 916.92413, "process_user_time": 13.092278, "process_kernel_time": 1.092318, "process_mem_max_rss": "122084", "process_in_blocks": "18624", "process_out_blocks": "4056"}
[0m07:21:56.987827 [debug] [MainThread]: Command `dbt run` succeeded at 07:21:56.987618 after 916.93 seconds
[0m07:21:56.988824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc05f0f6330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc05fd45250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc05ef0ab10>]}
[0m07:21:56.989848 [debug] [MainThread]: Flushing usage events
[0m07:21:57.384713 [debug] [Thread-1 (]: SQL status: SELECT 808210 in 2.447 seconds
[0m07:21:57.388505 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m07:21:57.389381 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
alter table "airflow"."lead_staging"."dim_person" rename to "dim_person__dbt_backup"
[0m07:21:57.390512 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:21:57.393490 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m07:21:57.394170 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
alter table "airflow"."lead_staging"."dim_person__dbt_tmp" rename to "dim_person"
[0m07:21:57.395254 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:21:57.397355 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: COMMIT
[0m07:21:57.398208 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m07:21:57.398830 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: COMMIT
[0m07:21:57.406064 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m07:21:57.409043 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_person__dbt_backup"
[0m07:21:57.410246 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m07:21:57.411004 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
drop table if exists "airflow"."lead_staging"."dim_person__dbt_backup" cascade
[0m07:21:57.427289 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.015 seconds
[0m07:21:57.429790 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: Close
[0m07:21:57.431040 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90d3c004-85ef-4124-8b90-74fe7e68abd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52a196e840>]}
[0m07:21:57.432198 [info ] [Thread-1 (]: 4 of 5 OK created sql table model lead_staging.dim_person ...................... [[32mSELECT 808210[0m in 2.52s]
[0m07:21:57.433345 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_person
[0m07:21:57.434225 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_fact_network_usage
[0m07:21:57.435279 [info ] [Thread-1 (]: 5 of 5 START sql table model lead_staging.fact_network_usage ................... [RUN]
[0m07:21:57.436246 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_person, now model.dbt_lead_data.staging_fact_network_usage)
[0m07:21:57.436891 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_fact_network_usage
[0m07:21:57.440712 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_fact_network_usage"
[0m07:21:57.443559 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_fact_network_usage
[0m07:21:57.447693 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_fact_network_usage"
[0m07:21:57.450250 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m07:21:57.450872 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: BEGIN
[0m07:21:57.451594 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:21:57.457483 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m07:21:57.458341 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m07:21:57.459330 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */

  
    

  create  table "airflow"."lead_staging"."fact_network_usage__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        session_duration,
        download_speed,
        upload_speed,
        consumed_traffic
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:21:58.237797 [debug] [Thread-1 (]: SQL status: SELECT 808210 in 0.778 seconds
[0m07:21:58.241344 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m07:21:58.242012 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
alter table "airflow"."lead_staging"."fact_network_usage" rename to "fact_network_usage__dbt_backup"
[0m07:21:58.243273 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:21:58.246157 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m07:21:58.247533 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
alter table "airflow"."lead_staging"."fact_network_usage__dbt_tmp" rename to "fact_network_usage"
[0m07:21:58.249307 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:21:58.251826 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: COMMIT
[0m07:21:58.252445 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m07:21:58.252965 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: COMMIT
[0m07:21:58.261257 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m07:21:58.264924 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."fact_network_usage__dbt_backup"
[0m07:21:58.265947 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m07:21:58.266564 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
drop table if exists "airflow"."lead_staging"."fact_network_usage__dbt_backup" cascade
[0m07:21:58.274210 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m07:21:58.275734 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: Close
[0m07:21:58.276521 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90d3c004-85ef-4124-8b90-74fe7e68abd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52a19c4b60>]}
[0m07:21:58.277349 [info ] [Thread-1 (]: 5 of 5 OK created sql table model lead_staging.fact_network_usage .............. [[32mSELECT 808210[0m in 0.84s]
[0m07:21:58.278411 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_fact_network_usage
[0m07:21:58.280794 [debug] [MainThread]: Using postgres connection "master"
[0m07:21:58.281435 [debug] [MainThread]: On master: BEGIN
[0m07:21:58.281982 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:21:58.286006 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m07:21:58.286878 [debug] [MainThread]: On master: COMMIT
[0m07:21:58.287611 [debug] [MainThread]: Using postgres connection "master"
[0m07:21:58.288328 [debug] [MainThread]: On master: COMMIT
[0m07:21:58.289001 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:21:58.289732 [debug] [MainThread]: On master: Close
[0m07:21:58.290597 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:21:58.291290 [debug] [MainThread]: Connection 'model.dbt_lead_data.staging_fact_network_usage' was properly closed.
[0m07:21:58.291961 [info ] [MainThread]: 
[0m07:21:58.292676 [info ] [MainThread]: Finished running 5 table models in 0 hours 15 minutes and 12.07 seconds (912.07s).
[0m07:21:58.294673 [debug] [MainThread]: Command end result
[0m07:21:58.446378 [info ] [MainThread]: 
[0m07:21:58.452432 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:21:58.462000 [info ] [MainThread]: 
[0m07:21:58.476963 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m07:21:58.487049 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 918.42444, "process_user_time": 13.218323, "process_kernel_time": 1.08274, "process_mem_max_rss": "121540", "process_in_blocks": "20304", "process_out_blocks": "4056"}
[0m07:21:58.495591 [debug] [MainThread]: Command `dbt run` succeeded at 07:21:58.493950 after 918.43 seconds
[0m07:21:58.501119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52a7009490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52a5eda3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52a35a05c0>]}
[0m07:21:58.507467 [debug] [MainThread]: Flushing usage events
[0m07:37:16.051689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c84ee89e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c8365cef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c83b8d850>]}


============================== 07:37:16.061720 | ba20aeba-308b-41be-bfa4-15f942652bbc ==============================
[0m07:37:16.061720 [info ] [MainThread]: Running with dbt=1.8.0
[0m07:37:16.063084 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select tag:trusted', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:37:16.057771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb30c30a960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb30c56e0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb30cb36840>]}
[0m07:37:16.058478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1db9cb1520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1db98487a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1db9cb2180>]}


============================== 07:37:16.068571 | 6472844f-075b-4025-8080-7876c4665b5f ==============================
[0m07:37:16.068571 [info ] [MainThread]: Running with dbt=1.8.0


============================== 07:37:16.069348 | 392feef2-f9b1-4226-b8db-36766c881b19 ==============================
[0m07:37:16.069348 [info ] [MainThread]: Running with dbt=1.8.0
[0m07:37:16.070165 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select tag:staging', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:37:16.070924 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select tag:staging', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:37:16.429822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6472844f-075b-4025-8080-7876c4665b5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb30d8033e0>]}
[0m07:37:16.432851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ba20aeba-308b-41be-bfa4-15f942652bbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c83321e20>]}
[0m07:37:16.434280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '392feef2-f9b1-4226-b8db-36766c881b19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1db936b470>]}
[0m07:37:16.531082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ba20aeba-308b-41be-bfa4-15f942652bbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c83367020>]}
[0m07:37:16.532800 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:37:16.534033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6472844f-075b-4025-8080-7876c4665b5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb30c30a960>]}
[0m07:37:16.534890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '392feef2-f9b1-4226-b8db-36766c881b19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1db9f31c70>]}
[0m07:37:16.535999 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:37:16.536900 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:37:16.588098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d4b23fe30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d490fb4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d48f6bc20>]}


============================== 07:37:16.599165 | f92a7eb2-6b1a-4de6-a2ea-94ac9dbc7449 ==============================
[0m07:37:16.599165 [info ] [MainThread]: Running with dbt=1.8.0
[0m07:37:16.601136 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select tag:trusted', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:37:16.692465 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m07:37:16.698137 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m07:37:16.701823 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m07:37:16.942258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f92a7eb2-6b1a-4de6-a2ea-94ac9dbc7449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d48f17f80>]}
[0m07:37:16.953103 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:37:16.953586 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:37:16.953814 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:37:16.954552 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:37:16.955068 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:37:16.955637 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:37:17.030931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ba20aeba-308b-41be-bfa4-15f942652bbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c82314440>]}
[0m07:37:17.040211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6472844f-075b-4025-8080-7876c4665b5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb30b93d640>]}
[0m07:37:17.043714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '392feef2-f9b1-4226-b8db-36766c881b19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1db8b6c3b0>]}
[0m07:37:17.087928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f92a7eb2-6b1a-4de6-a2ea-94ac9dbc7449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d4970e5d0>]}
[0m07:37:17.089352 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:37:17.217686 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m07:37:17.285202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ba20aeba-308b-41be-bfa4-15f942652bbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c81f494f0>]}
[0m07:37:17.286562 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m07:37:17.288343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba20aeba-308b-41be-bfa4-15f942652bbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c82f53ad0>]}
[0m07:37:17.292044 [info ] [MainThread]: 
[0m07:37:17.293765 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:37:17.294694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '392feef2-f9b1-4226-b8db-36766c881b19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1db87916a0>]}
[0m07:37:17.295857 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m07:37:17.296901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '392feef2-f9b1-4226-b8db-36766c881b19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1db9405910>]}
[0m07:37:17.300252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6472844f-075b-4025-8080-7876c4665b5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb30b5a18e0>]}
[0m07:37:17.300354 [info ] [MainThread]: 
[0m07:37:17.301711 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m07:37:17.301416 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m07:37:17.302175 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:37:17.303586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6472844f-075b-4025-8080-7876c4665b5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb30ad3fec0>]}
[0m07:37:17.307144 [info ] [MainThread]: 
[0m07:37:17.308911 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:37:17.310227 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m07:37:17.316227 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m07:37:17.356372 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m07:37:17.356438 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m07:37:17.357320 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m07:37:17.357947 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m07:37:17.358316 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:37:17.359073 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:37:17.360843 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m07:37:17.361733 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m07:37:17.362836 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:37:17.365307 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.007 seconds
[0m07:37:17.365842 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.007 seconds
[0m07:37:17.368257 [debug] [ThreadPool]: On list_airflow: Close
[0m07:37:17.368336 [debug] [ThreadPool]: On list_airflow: Close
[0m07:37:17.369280 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.007 seconds
[0m07:37:17.372024 [debug] [ThreadPool]: On list_airflow: Close
[0m07:37:17.372135 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_trusted)
[0m07:37:17.372832 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_staging)
[0m07:37:17.375421 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_trusted)
[0m07:37:17.380971 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:37:17.381236 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:37:17.381966 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m07:37:17.382516 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m07:37:17.382968 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:37:17.383511 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:37:17.383480 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:37:17.384496 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m07:37:17.385403 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:37:17.388565 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:37:17.389247 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m07:37:17.389661 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:37:17.390317 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:37:17.390588 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:37:17.390882 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m07:37:17.391228 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m07:37:17.391479 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:37:17.392750 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m07:37:17.394780 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m07:37:17.394773 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m07:37:17.394718 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:37:17.395868 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m07:37:17.396366 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:37:17.396885 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m07:37:17.397229 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m07:37:17.398024 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m07:37:17.398255 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m07:37:17.398358 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m07:37:17.399226 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now list_airflow_lead_trusted)
[0m07:37:17.399576 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m07:37:17.400117 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now list_airflow_lead_staging)
[0m07:37:17.401152 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now list_airflow_lead_staging)
[0m07:37:17.403408 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:37:17.403948 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:37:17.404263 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m07:37:17.404787 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m07:37:17.405140 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:37:17.405171 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:37:17.405686 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:37:17.406282 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m07:37:17.407144 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:37:17.410121 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:37:17.411068 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:37:17.411251 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:37:17.412198 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:37:17.412432 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:37:17.412937 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m07:37:17.413701 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:37:17.414112 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m07:37:17.415158 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m07:37:17.417630 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m07:37:17.417913 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m07:37:17.418933 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.003 seconds
[0m07:37:17.420046 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m07:37:17.420234 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m07:37:17.421086 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m07:37:17.421294 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m07:37:17.422008 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m07:37:17.422649 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m07:37:17.430060 [debug] [MainThread]: Using postgres connection "master"
[0m07:37:17.431009 [debug] [MainThread]: On master: BEGIN
[0m07:37:17.430978 [debug] [MainThread]: Using postgres connection "master"
[0m07:37:17.432044 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:37:17.432030 [debug] [MainThread]: Using postgres connection "master"
[0m07:37:17.432606 [debug] [MainThread]: On master: BEGIN
[0m07:37:17.433716 [debug] [MainThread]: On master: BEGIN
[0m07:37:17.434239 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:37:17.434651 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:37:17.437910 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m07:37:17.439210 [debug] [MainThread]: Using postgres connection "master"
[0m07:37:17.440555 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m07:37:17.440716 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:37:17.440823 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m07:37:17.441612 [debug] [MainThread]: Using postgres connection "master"
[0m07:37:17.443183 [debug] [MainThread]: Using postgres connection "master"
[0m07:37:17.443710 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:37:17.444268 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:37:17.446317 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m07:37:17.448279 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m07:37:17.448867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '392feef2-f9b1-4226-b8db-36766c881b19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dba074260>]}
[0m07:37:17.449396 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m07:37:17.449916 [debug] [MainThread]: On master: ROLLBACK
[0m07:37:17.451030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba20aeba-308b-41be-bfa4-15f942652bbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c81fa00b0>]}
[0m07:37:17.451283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f92a7eb2-6b1a-4de6-a2ea-94ac9dbc7449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d48a71070>]}
[0m07:37:17.451481 [debug] [MainThread]: Using postgres connection "master"
[0m07:37:17.452511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6472844f-075b-4025-8080-7876c4665b5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb30b9081d0>]}
[0m07:37:17.452415 [debug] [MainThread]: On master: ROLLBACK
[0m07:37:17.453364 [debug] [MainThread]: On master: BEGIN
[0m07:37:17.453981 [debug] [MainThread]: On master: ROLLBACK
[0m07:37:17.454787 [debug] [MainThread]: Using postgres connection "master"
[0m07:37:17.455549 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m07:37:17.456018 [debug] [MainThread]: Using postgres connection "master"
[0m07:37:17.456805 [debug] [MainThread]: On master: COMMIT
[0m07:37:17.456094 [debug] [MainThread]: On master: BEGIN
[0m07:37:17.457807 [debug] [MainThread]: Using postgres connection "master"
[0m07:37:17.457328 [debug] [MainThread]: On master: BEGIN
[0m07:37:17.459014 [debug] [MainThread]: On master: COMMIT
[0m07:37:17.459274 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m07:37:17.460396 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m07:37:17.460968 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:37:17.460967 [debug] [MainThread]: On master: COMMIT
[0m07:37:17.462544 [debug] [MainThread]: On master: Close
[0m07:37:17.461973 [debug] [MainThread]: On master: COMMIT
[0m07:37:17.463145 [debug] [MainThread]: Using postgres connection "master"
[0m07:37:17.464137 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:37:17.464312 [debug] [MainThread]: Using postgres connection "master"
[0m07:37:17.464874 [debug] [MainThread]: On master: COMMIT
[0m07:37:17.465914 [debug] [MainThread]: On master: COMMIT
[0m07:37:17.465227 [info ] [MainThread]: 
[0m07:37:17.467109 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m07:37:17.467484 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:37:17.468722 [debug] [MainThread]: On master: Close
[0m07:37:17.469000 [debug] [MainThread]: On master: Close
[0m07:37:17.470118 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:37:17.470645 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:37:17.470995 [info ] [MainThread]: 
[0m07:37:17.471875 [info ] [MainThread]: 
[0m07:37:17.480669 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_adress
[0m07:37:17.482598 [info ] [Thread-1 (]: 1 of 5 START sql table model lead_staging.dim_address .......................... [RUN]
[0m07:37:17.483876 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now model.dbt_lead_data.staging_dim_adress)
[0m07:37:17.484754 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_non_pii_data
[0m07:37:17.485020 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_adress
[0m07:37:17.485080 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_adress
[0m07:37:17.486111 [info ] [Thread-1 (]: 1 of 4 START sql table model lead_trusted.non_pii_data ......................... [RUN]
[0m07:37:17.486739 [info ] [Thread-1 (]: 1 of 5 START sql table model lead_staging.dim_address .......................... [RUN]
[0m07:37:17.487726 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now model.dbt_lead_data.trusted_non_pii_data)
[0m07:37:17.488034 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now model.dbt_lead_data.staging_dim_adress)
[0m07:37:17.488592 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_non_pii_data
[0m07:37:17.489035 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_adress
[0m07:37:17.495768 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_adress"
[0m07:37:17.499751 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_adress"
[0m07:37:17.499843 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_adress
[0m07:37:17.500539 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_non_pii_data"
[0m07:37:17.502772 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_adress
[0m07:37:17.503734 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_non_pii_data
[0m07:37:17.555104 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_adress"
[0m07:37:17.555951 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_adress"
[0m07:37:17.558121 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_non_pii_data"
[0m07:37:17.559818 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:37:17.560326 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:37:17.560730 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: BEGIN
[0m07:37:17.561510 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: BEGIN
[0m07:37:17.561641 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m07:37:17.561930 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:37:17.562521 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:37:17.562943 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: BEGIN
[0m07:37:17.564211 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:37:17.567924 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m07:37:17.568261 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m07:37:17.569230 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:37:17.569811 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m07:37:17.569948 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:37:17.570425 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */

  
    

  create  table "airflow"."lead_staging"."dim_address__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        address,
        mac_address,
        ip_address
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:37:17.571080 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m07:37:17.571570 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */

  
    

  create  table "airflow"."lead_staging"."dim_address__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        address,
        mac_address,
        ip_address
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:37:17.572672 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */

  
    

  create  table "airflow"."lead_trusted"."non_pii_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        '***MASKED***' AS person_name,
        SUBSTRING(dp.user_name, 1, 5) || '*****'  user_name,
        SUBSTRING(dp.email, 1, 5) || '*****' AS email,
        '***MASKED***'  AS personal_number, 
        '***MASKED***' AS birth_date, 
        '***MASKED***' AS address,
        '***MASKED***'  AS phone, 
        SUBSTRING(da.mac_address, 1, 5) || '*****' AS mac_address,
        SUBSTRING(da.ip_address, 1, 5) || '*****' AS ip_address,
        SUBSTRING(df.iban, 1, 5) || '*****' AS iban,
        dd.accessed_at,
        fnu.session_duration,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.consumed_traffic,
        fnu.unique_id
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    INNER JOIN
        "airflow"."lead_staging"."dim_address" da ON fnu.unique_id = da.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_date" dd ON da.unique_id = dd.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_finance" df ON dd.unique_id = df.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_person" dp ON df.unique_id = dp.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:37:17.622832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f92a7eb2-6b1a-4de6-a2ea-94ac9dbc7449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d47974a10>]}
[0m07:37:17.623892 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m07:37:17.625120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f92a7eb2-6b1a-4de6-a2ea-94ac9dbc7449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d481ba3c0>]}
[0m07:37:17.628038 [info ] [MainThread]: 
[0m07:37:17.629620 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:37:17.636944 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m07:37:17.679930 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m07:37:17.680804 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m07:37:17.681785 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:37:17.688327 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.006 seconds
[0m07:37:17.690314 [debug] [ThreadPool]: On list_airflow: Close
[0m07:37:17.693158 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_staging)
[0m07:37:17.701682 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:37:17.702624 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m07:37:17.703451 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:37:17.708316 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:37:17.709183 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:37:17.710072 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m07:37:17.713265 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m07:37:17.715917 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m07:37:17.717160 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m07:37:17.718802 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now list_airflow_lead_trusted)
[0m07:37:17.724205 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:37:17.725318 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m07:37:17.726205 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:37:17.732427 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m07:37:17.733952 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:37:17.735249 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m07:37:17.738667 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m07:37:17.741151 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m07:37:17.742797 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m07:37:17.752967 [debug] [MainThread]: Using postgres connection "master"
[0m07:37:17.753835 [debug] [MainThread]: On master: BEGIN
[0m07:37:17.754744 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:37:17.759665 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:37:17.760695 [debug] [MainThread]: Using postgres connection "master"
[0m07:37:17.761698 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:37:17.765702 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m07:37:17.767859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f92a7eb2-6b1a-4de6-a2ea-94ac9dbc7449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d4855ca10>]}
[0m07:37:17.768898 [debug] [MainThread]: On master: ROLLBACK
[0m07:37:17.769983 [debug] [MainThread]: Using postgres connection "master"
[0m07:37:17.770812 [debug] [MainThread]: On master: BEGIN
[0m07:37:17.772146 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:37:17.773025 [debug] [MainThread]: On master: COMMIT
[0m07:37:17.773974 [debug] [MainThread]: Using postgres connection "master"
[0m07:37:17.774697 [debug] [MainThread]: On master: COMMIT
[0m07:37:17.775803 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:37:17.776708 [debug] [MainThread]: On master: Close
[0m07:37:17.777887 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:37:17.778962 [info ] [MainThread]: 
[0m07:37:17.791780 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_non_pii_data
[0m07:37:17.792877 [info ] [Thread-1 (]: 1 of 4 START sql table model lead_trusted.non_pii_data ......................... [RUN]
[0m07:37:17.793895 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now model.dbt_lead_data.trusted_non_pii_data)
[0m07:37:17.794712 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_non_pii_data
[0m07:37:17.805856 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_non_pii_data"
[0m07:37:17.808071 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_non_pii_data
[0m07:37:17.860065 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_non_pii_data"
[0m07:37:17.862655 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m07:37:17.863573 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: BEGIN
[0m07:37:17.864325 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:37:17.869307 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m07:37:17.870316 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m07:37:17.871219 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */

  
    

  create  table "airflow"."lead_trusted"."non_pii_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        '***MASKED***' AS person_name,
        SUBSTRING(dp.user_name, 1, 5) || '*****'  user_name,
        SUBSTRING(dp.email, 1, 5) || '*****' AS email,
        '***MASKED***'  AS personal_number, 
        '***MASKED***' AS birth_date, 
        '***MASKED***' AS address,
        '***MASKED***'  AS phone, 
        SUBSTRING(da.mac_address, 1, 5) || '*****' AS mac_address,
        SUBSTRING(da.ip_address, 1, 5) || '*****' AS ip_address,
        SUBSTRING(df.iban, 1, 5) || '*****' AS iban,
        dd.accessed_at,
        fnu.session_duration,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.consumed_traffic,
        fnu.unique_id
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    INNER JOIN
        "airflow"."lead_staging"."dim_address" da ON fnu.unique_id = da.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_date" dd ON da.unique_id = dd.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_finance" df ON dd.unique_id = df.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_person" dp ON df.unique_id = dp.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:37:19.073379 [debug] [Thread-1 (]: SQL status: SELECT 1214294 in 1.501 seconds
[0m07:37:19.080639 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:37:19.081544 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
alter table "airflow"."lead_staging"."dim_address" rename to "dim_address__dbt_backup"
[0m07:37:22.369085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9c9209610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9c9208bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9c920b6b0>]}


============================== 07:37:22.376563 | 440be5e3-d3c6-4da1-ab0a-b0e74eb206fd ==============================
[0m07:37:22.376563 [info ] [MainThread]: Running with dbt=1.8.0
[0m07:37:22.377517 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select tag:staging', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:37:22.578212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '440be5e3-d3c6-4da1-ab0a-b0e74eb206fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9c9931460>]}
[0m07:37:22.646018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '440be5e3-d3c6-4da1-ab0a-b0e74eb206fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9c93bc440>]}
[0m07:37:22.647266 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:37:22.727137 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m07:37:22.841411 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:37:22.842140 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:37:22.876243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '440be5e3-d3c6-4da1-ab0a-b0e74eb206fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9c7d7fec0>]}
[0m07:37:22.996563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '440be5e3-d3c6-4da1-ab0a-b0e74eb206fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9c7180ad0>]}
[0m07:37:22.997234 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m07:37:22.997963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '440be5e3-d3c6-4da1-ab0a-b0e74eb206fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9c79c1c40>]}
[0m07:37:22.999956 [info ] [MainThread]: 
[0m07:37:23.000786 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:37:23.006277 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m07:37:23.043550 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m07:37:23.044274 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m07:37:23.044949 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:37:23.050182 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.005 seconds
[0m07:37:23.052036 [debug] [ThreadPool]: On list_airflow: Close
[0m07:37:23.054640 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_staging)
[0m07:37:23.061086 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:37:23.061851 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m07:37:23.062620 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:37:23.066843 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m07:37:23.067781 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:37:23.068419 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m07:37:23.071292 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m07:37:23.073397 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m07:37:23.074214 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m07:37:23.075164 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now list_airflow_lead_trusted)
[0m07:37:23.078384 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:37:23.079198 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m07:37:23.079919 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:37:23.084188 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m07:37:23.085018 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:37:23.085808 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m07:37:23.088993 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m07:37:23.091099 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m07:37:23.092013 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m07:37:23.099467 [debug] [MainThread]: Using postgres connection "master"
[0m07:37:23.100561 [debug] [MainThread]: On master: BEGIN
[0m07:37:23.101310 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:37:23.105576 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m07:37:23.106670 [debug] [MainThread]: Using postgres connection "master"
[0m07:37:23.107466 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:37:23.111132 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m07:37:23.113313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '440be5e3-d3c6-4da1-ab0a-b0e74eb206fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9c65f51c0>]}
[0m07:37:23.114229 [debug] [MainThread]: On master: ROLLBACK
[0m07:37:23.115171 [debug] [MainThread]: Using postgres connection "master"
[0m07:37:23.115824 [debug] [MainThread]: On master: BEGIN
[0m07:37:23.116873 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:37:23.117590 [debug] [MainThread]: On master: COMMIT
[0m07:37:23.118273 [debug] [MainThread]: Using postgres connection "master"
[0m07:37:23.118984 [debug] [MainThread]: On master: COMMIT
[0m07:37:23.119799 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:37:23.120525 [debug] [MainThread]: On master: Close
[0m07:37:23.121375 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:37:23.122253 [info ] [MainThread]: 
[0m07:37:23.133396 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_adress
[0m07:37:23.134594 [info ] [Thread-1 (]: 1 of 5 START sql table model lead_staging.dim_address .......................... [RUN]
[0m07:37:23.135511 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now model.dbt_lead_data.staging_dim_adress)
[0m07:37:23.136218 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_adress
[0m07:37:23.145615 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_adress"
[0m07:37:23.148385 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_adress
[0m07:37:23.192171 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_adress"
[0m07:37:23.194940 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:37:23.195701 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: BEGIN
[0m07:37:23.196376 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:37:23.200753 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m07:37:23.201487 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:37:23.202091 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */

  
    

  create  table "airflow"."lead_staging"."dim_address__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        address,
        mac_address,
        ip_address
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:37:36.284848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e97aa2e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e97b61130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e977bbe00>]}


============================== 07:37:36.336302 | 4be254de-39c3-47d9-b193-d02a992c87e8 ==============================
[0m07:37:36.336302 [info ] [MainThread]: Running with dbt=1.8.0
[0m07:37:36.348303 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select tag:staging', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:37:37.599280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4be254de-39c3-47d9-b193-d02a992c87e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e97a42c30>]}
[0m07:37:37.987869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4be254de-39c3-47d9-b193-d02a992c87e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e986fb260>]}
[0m07:37:37.994178 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:37:38.608805 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m07:53:06.178191 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:53:06.181791 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:53:06.263401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4be254de-39c3-47d9-b193-d02a992c87e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e96b8d3a0>]}
[0m07:53:06.472287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4be254de-39c3-47d9-b193-d02a992c87e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e96b9c7d0>]}
[0m07:53:06.473404 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m07:53:06.474600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4be254de-39c3-47d9-b193-d02a992c87e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e96b8c620>]}
[0m07:53:06.478403 [info ] [MainThread]: 
[0m07:53:06.480664 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:53:06.490595 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m07:53:06.563312 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m07:53:06.564641 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m07:53:06.566197 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:53:06.572809 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.007 seconds
[0m07:53:06.575494 [debug] [ThreadPool]: On list_airflow: Close
[0m07:53:06.579462 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_staging)
[0m07:53:06.590350 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:53:06.592086 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m07:53:06.593273 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:53:06.600188 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m07:53:06.601431 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:53:06.602724 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m07:53:06.608479 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.004 seconds
[0m07:53:06.611652 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m07:53:06.613194 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m07:53:06.614459 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now list_airflow_lead_trusted)
[0m07:53:06.619736 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:53:06.621041 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m07:53:06.622178 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:53:06.628715 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m07:53:06.630002 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:53:06.631245 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m07:53:06.636675 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m07:53:06.639795 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m07:53:06.641270 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m07:53:06.650288 [debug] [MainThread]: Using postgres connection "master"
[0m07:53:06.651463 [debug] [MainThread]: On master: BEGIN
[0m07:53:06.652380 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:53:06.658282 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m07:53:06.659496 [debug] [MainThread]: Using postgres connection "master"
[0m07:53:06.660694 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:53:06.666477 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m07:53:06.670002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4be254de-39c3-47d9-b193-d02a992c87e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e98ce4890>]}
[0m07:53:06.671543 [debug] [MainThread]: On master: ROLLBACK
[0m07:53:06.672891 [debug] [MainThread]: Using postgres connection "master"
[0m07:53:06.674134 [debug] [MainThread]: On master: BEGIN
[0m07:53:06.676075 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m07:53:06.677224 [debug] [MainThread]: On master: COMMIT
[0m07:53:06.678532 [debug] [MainThread]: Using postgres connection "master"
[0m07:53:06.679972 [debug] [MainThread]: On master: COMMIT
[0m07:53:06.681285 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:53:06.683062 [debug] [MainThread]: On master: Close
[0m07:53:06.684675 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:53:06.686103 [info ] [MainThread]: 
[0m07:53:06.699561 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_adress
[0m07:53:06.700778 [info ] [Thread-1 (]: 1 of 5 START sql table model lead_staging.dim_address .......................... [RUN]
[0m07:53:06.702006 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now model.dbt_lead_data.staging_dim_adress)
[0m07:53:06.702816 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_adress
[0m07:53:06.717725 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_adress"
[0m07:53:06.722670 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_adress
[0m07:53:06.794116 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_adress"
[0m07:53:06.798508 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:53:06.799546 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: BEGIN
[0m07:53:06.800544 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:53:06.806495 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m07:53:06.808046 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:53:06.809306 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */

  
    

  create  table "airflow"."lead_staging"."dim_address__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        address,
        mac_address,
        ip_address
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:53:25.205402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe93b549ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe93d46d190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe93b2618e0>]}


============================== 07:53:25.244015 | 18c691e4-c1f6-4649-be2f-fbc27ca262cc ==============================
[0m07:53:25.244015 [info ] [MainThread]: Running with dbt=1.8.0
[0m07:53:25.250449 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select tag:staging', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:53:27.156829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '18c691e4-c1f6-4649-be2f-fbc27ca262cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe93c0af080>]}
[0m07:53:27.661433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '18c691e4-c1f6-4649-be2f-fbc27ca262cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe93c376c60>]}
[0m07:53:27.669200 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:53:28.321505 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m07:53:29.347656 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:53:29.353229 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:53:29.650308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '18c691e4-c1f6-4649-be2f-fbc27ca262cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe93a13fb60>]}
[0m07:53:30.652879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '18c691e4-c1f6-4649-be2f-fbc27ca262cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe939544530>]}
[0m07:53:30.661242 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m07:53:30.669428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18c691e4-c1f6-4649-be2f-fbc27ca262cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe93a5b6720>]}
[0m07:53:30.685519 [info ] [MainThread]: 
[0m07:53:30.691345 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:53:30.721418 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m07:53:31.052186 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m07:53:31.056503 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m07:53:31.060890 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:53:31.100935 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.040 seconds
[0m07:53:31.114982 [debug] [ThreadPool]: On list_airflow: Close
[0m07:53:31.133013 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_trusted)
[0m07:53:31.185335 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:53:31.190588 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m07:53:31.194852 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:53:31.218445 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m07:53:31.224345 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:53:31.230684 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m07:53:31.267378 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.023 seconds
[0m07:53:31.281111 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m07:53:31.286576 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m07:53:31.293236 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now list_airflow_lead_staging)
[0m07:53:31.318679 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:53:31.324491 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m07:53:31.329240 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:53:31.362592 [debug] [ThreadPool]: SQL status: BEGIN in 0.033 seconds
[0m07:53:31.370568 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:53:31.379482 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m07:53:31.401159 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.017 seconds
[0m07:53:31.411529 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m07:53:31.417287 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m07:53:31.461596 [debug] [MainThread]: Using postgres connection "master"
[0m07:53:31.466454 [debug] [MainThread]: On master: BEGIN
[0m07:53:31.470479 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:53:31.497718 [debug] [MainThread]: SQL status: BEGIN in 0.027 seconds
[0m07:53:31.503431 [debug] [MainThread]: Using postgres connection "master"
[0m07:53:31.508427 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:53:31.529500 [debug] [MainThread]: SQL status: SELECT 0 in 0.015 seconds
[0m07:53:31.542558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18c691e4-c1f6-4649-be2f-fbc27ca262cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe93a17c1d0>]}
[0m07:53:31.550579 [debug] [MainThread]: On master: ROLLBACK
[0m07:53:31.556429 [debug] [MainThread]: Using postgres connection "master"
[0m07:53:31.561157 [debug] [MainThread]: On master: BEGIN
[0m07:53:31.568599 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m07:53:31.572459 [debug] [MainThread]: On master: COMMIT
[0m07:53:31.577282 [debug] [MainThread]: Using postgres connection "master"
[0m07:53:31.581371 [debug] [MainThread]: On master: COMMIT
[0m07:53:31.586734 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m07:53:31.591335 [debug] [MainThread]: On master: Close
[0m07:53:31.596468 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:53:31.602198 [info ] [MainThread]: 
[0m07:53:31.661797 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_adress
[0m07:53:31.667864 [info ] [Thread-1 (]: 1 of 5 START sql table model lead_staging.dim_address .......................... [RUN]
[0m07:53:31.674293 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now model.dbt_lead_data.staging_dim_adress)
[0m07:53:31.678425 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_adress
[0m07:53:31.726178 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_adress"
[0m07:53:31.740542 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_adress
[0m07:53:32.086576 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_adress"
[0m07:53:32.111718 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:53:32.124929 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: BEGIN
[0m07:53:32.139558 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:53:32.177321 [debug] [Thread-1 (]: SQL status: BEGIN in 0.037 seconds
[0m07:53:32.182659 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:53:32.188147 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */

  
    

  create  table "airflow"."lead_staging"."dim_address__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        address,
        mac_address,
        ip_address
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:53:33.195786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a92c49850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a92804830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a927045f0>]}


============================== 07:53:33.237733 | 358fe6b1-1a07-470c-bb26-5d085e983b3b ==============================
[0m07:53:33.237733 [info ] [MainThread]: Running with dbt=1.8.0
[0m07:53:33.244133 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select tag:staging', 'send_anonymous_usage_stats': 'True'}
[0m07:53:34.639008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '358fe6b1-1a07-470c-bb26-5d085e983b3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a93325940>]}
[0m07:53:35.018689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '358fe6b1-1a07-470c-bb26-5d085e983b3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a91af8560>]}
[0m07:53:35.024821 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:53:35.622044 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m07:53:36.649491 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:53:36.653805 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:53:36.944942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '358fe6b1-1a07-470c-bb26-5d085e983b3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a92426db0>]}
[0m07:53:38.134073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '358fe6b1-1a07-470c-bb26-5d085e983b3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a90b24500>]}
[0m07:53:38.140254 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m07:53:38.150158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '358fe6b1-1a07-470c-bb26-5d085e983b3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a923de750>]}
[0m07:53:38.168856 [info ] [MainThread]: 
[0m07:53:38.174267 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:53:38.206279 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m07:53:38.552128 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m07:53:38.556164 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m07:53:38.559893 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:53:38.587947 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.028 seconds
[0m07:53:38.598071 [debug] [ThreadPool]: On list_airflow: Close
[0m07:53:38.613615 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_trusted)
[0m07:53:38.655157 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:53:38.659720 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m07:53:38.663695 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:53:38.684600 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m07:53:38.688754 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:53:38.692844 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m07:53:38.713517 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.016 seconds
[0m07:53:38.725224 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m07:53:38.730255 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m07:53:38.735795 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now list_airflow_lead_staging)
[0m07:53:38.752979 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:53:38.757103 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m07:53:38.760879 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:53:38.783902 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m07:53:38.788926 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:53:38.794240 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m07:53:38.814214 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.015 seconds
[0m07:53:38.824141 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m07:53:38.829120 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m07:53:38.874150 [debug] [MainThread]: Using postgres connection "master"
[0m07:53:38.878736 [debug] [MainThread]: On master: BEGIN
[0m07:53:38.882735 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:53:38.905285 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m07:53:38.909951 [debug] [MainThread]: Using postgres connection "master"
[0m07:53:38.914517 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:53:38.933855 [debug] [MainThread]: SQL status: SELECT 0 in 0.014 seconds
[0m07:53:38.944834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '358fe6b1-1a07-470c-bb26-5d085e983b3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a90379f10>]}
[0m07:53:38.949255 [debug] [MainThread]: On master: ROLLBACK
[0m07:53:38.954980 [debug] [MainThread]: Using postgres connection "master"
[0m07:53:38.959001 [debug] [MainThread]: On master: BEGIN
[0m07:53:38.965738 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m07:53:38.969849 [debug] [MainThread]: On master: COMMIT
[0m07:53:38.973664 [debug] [MainThread]: Using postgres connection "master"
[0m07:53:38.977896 [debug] [MainThread]: On master: COMMIT
[0m07:53:38.982927 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m07:53:38.987074 [debug] [MainThread]: On master: Close
[0m07:53:38.992696 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:53:38.997372 [info ] [MainThread]: 
[0m07:53:39.081359 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_adress
[0m07:53:39.087868 [info ] [Thread-1 (]: 1 of 5 START sql table model lead_staging.dim_address .......................... [RUN]
[0m07:53:39.093283 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now model.dbt_lead_data.staging_dim_adress)
[0m07:53:39.098325 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_adress
[0m07:53:39.160059 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_adress"
[0m07:53:39.174253 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_adress
[0m07:53:39.469405 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_adress"
[0m07:53:39.484608 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:53:39.488710 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: BEGIN
[0m07:53:39.501634 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:53:39.536160 [debug] [Thread-1 (]: SQL status: BEGIN in 0.037 seconds
[0m07:53:39.545161 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:53:39.552134 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */

  
    

  create  table "airflow"."lead_staging"."dim_address__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        address,
        mac_address,
        ip_address
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m08:07:30.542837 [debug] [Thread-1 (]: SQL status: SELECT 6879790 in 1812.965 seconds
[0m08:07:30.550844 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m08:07:30.551768 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
alter table "airflow"."lead_trusted"."non_pii_data" rename to "non_pii_data__dbt_backup"
[0m08:07:30.553099 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:07:30.556915 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m08:07:30.557799 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
alter table "airflow"."lead_trusted"."non_pii_data__dbt_tmp" rename to "non_pii_data"
[0m08:07:30.558952 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:07:30.580772 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: COMMIT
[0m08:07:30.581571 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m08:07:30.582304 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: COMMIT
[0m08:07:30.583938 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:07:30.592625 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."non_pii_data__dbt_backup"
[0m08:07:30.599622 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m08:07:30.600614 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
drop table if exists "airflow"."lead_trusted"."non_pii_data__dbt_backup" cascade
[0m08:07:30.605365 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m08:07:30.609358 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: Close
[0m08:07:30.611664 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba20aeba-308b-41be-bfa4-15f942652bbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c84855e80>]}
[0m08:07:30.612888 [info ] [Thread-1 (]: 1 of 4 OK created sql table model lead_trusted.non_pii_data .................... [[32mSELECT 6879790[0m in 1813.12s]
[0m08:07:30.614272 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_non_pii_data
[0m08:07:30.615477 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_payment_data
[0m08:07:30.616610 [info ] [Thread-1 (]: 2 of 4 START sql table model lead_trusted.payment_data ......................... [RUN]
[0m08:07:30.617715 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_non_pii_data, now model.dbt_lead_data.trusted_payment_data)
[0m08:07:30.618969 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_payment_data
[0m08:07:30.623910 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_payment_data"
[0m08:07:30.627066 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_payment_data
[0m08:07:30.632081 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_payment_data"
[0m08:07:30.634806 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m08:07:30.635698 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: BEGIN
[0m08:07:30.636324 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:07:30.640821 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m08:07:30.641583 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m08:07:30.642224 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */

  
    

  create  table "airflow"."lead_trusted"."payment_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        fnu.unique_id,
        df.iban,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.session_duration,
        fnu.consumed_traffic,
        ((fnu.download_speed + fnu.upload_speed + 1)/2) + (fnu.consumed_traffic / (fnu.session_duration + 1)) AS payment_amount
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    JOIN
        "airflow"."lead_staging"."dim_finance" df
    ON
	    fnu.unique_id = df.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m08:07:33.023958 [debug] [Thread-1 (]: SQL status: SELECT 1212982 in 2.381 seconds
[0m08:07:33.027716 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m08:07:33.028523 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
alter table "airflow"."lead_trusted"."payment_data" rename to "payment_data__dbt_backup"
[0m08:07:33.029752 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:07:33.033241 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m08:07:33.034121 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
alter table "airflow"."lead_trusted"."payment_data__dbt_tmp" rename to "payment_data"
[0m08:07:33.035211 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:07:33.037796 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: COMMIT
[0m08:07:33.038595 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m08:07:33.039554 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: COMMIT
[0m08:07:33.050914 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m08:07:33.054219 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."payment_data__dbt_backup"
[0m08:07:33.055568 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m08:07:33.056316 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
drop table if exists "airflow"."lead_trusted"."payment_data__dbt_backup" cascade
[0m08:07:33.059919 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m08:07:33.062088 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: Close
[0m08:07:33.063232 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba20aeba-308b-41be-bfa4-15f942652bbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c8028fc20>]}
[0m08:07:33.064306 [info ] [Thread-1 (]: 2 of 4 OK created sql table model lead_trusted.payment_data .................... [[32mSELECT 1212982[0m in 2.45s]
[0m08:07:33.065520 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_payment_data
[0m08:07:33.066379 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_pii_data
[0m08:07:33.067405 [info ] [Thread-1 (]: 3 of 4 START sql table model lead_trusted.pii_data ............................. [RUN]
[0m08:07:33.068282 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_payment_data, now model.dbt_lead_data.trusted_pii_data)
[0m08:07:33.069060 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_pii_data
[0m08:07:33.074039 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_pii_data"
[0m08:07:33.077259 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_pii_data
[0m08:07:33.083139 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_pii_data"
[0m08:07:33.086460 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m08:07:33.087360 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: BEGIN
[0m08:07:33.088422 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:07:33.094294 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m08:07:33.095353 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m08:07:33.096662 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */

  
    

  create  table "airflow"."lead_trusted"."pii_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        dp.person_name,
        dp.user_name,
        dp.email,
        dp.personal_number, 
        dp.birth_date, 
        da.address,
        dp.phone, 
        da.mac_address,
        da.ip_address,
        df.iban,
        dd.accessed_at,
        fnu.session_duration,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.consumed_traffic,
        fnu.unique_id
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    INNER JOIN
        "airflow"."lead_staging"."dim_address" da ON fnu.unique_id = da.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_date" dd ON da.unique_id = dd.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_finance" df ON dd.unique_id = df.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_person" dp ON df.unique_id = dp.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m08:07:43.344859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44edc4d0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44edf88ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44edc4e780>]}


============================== 08:07:43.381006 | 858b9c1b-d9ba-4fd1-90d7-6758927c7f65 ==============================
[0m08:07:43.381006 [info ] [MainThread]: Running with dbt=1.8.0
[0m08:07:43.386922 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select tag:staging', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:07:43.399257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f726432ea50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7264b9ecf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7266ae3bf0>]}


============================== 08:07:43.437407 | 98b27b92-abdf-402b-b3de-015296a5e739 ==============================
[0m08:07:43.437407 [info ] [MainThread]: Running with dbt=1.8.0
[0m08:07:43.442940 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select tag:staging', 'send_anonymous_usage_stats': 'True'}
[0m08:07:44.711789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '858b9c1b-d9ba-4fd1-90d7-6758927c7f65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44ecd136b0>]}
[0m08:07:44.765658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '98b27b92-abdf-402b-b3de-015296a5e739', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7265277110>]}
[0m08:07:45.211478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '858b9c1b-d9ba-4fd1-90d7-6758927c7f65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44ecd5c350>]}
[0m08:07:45.217696 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:07:45.264286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '98b27b92-abdf-402b-b3de-015296a5e739', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7263ecf260>]}
[0m08:07:45.270803 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:07:46.189277 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m08:07:46.272246 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m08:07:47.072178 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:07:47.076339 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:07:47.135895 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:07:47.141115 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:07:47.359742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '858b9c1b-d9ba-4fd1-90d7-6758927c7f65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44ecd45280>]}
[0m08:07:47.414184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '98b27b92-abdf-402b-b3de-015296a5e739', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f726394c440>]}
[0m08:07:48.242858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '858b9c1b-d9ba-4fd1-90d7-6758927c7f65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44ebd28a10>]}
[0m08:07:48.253584 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m08:07:48.267198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '858b9c1b-d9ba-4fd1-90d7-6758927c7f65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44eef89dc0>]}
[0m08:07:48.287692 [info ] [MainThread]: 
[0m08:07:48.293462 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:07:48.319131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '98b27b92-abdf-402b-b3de-015296a5e739', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7262d80d10>]}
[0m08:07:48.327985 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m08:07:48.337151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98b27b92-abdf-402b-b3de-015296a5e739', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7263e79850>]}
[0m08:07:48.342118 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m08:07:48.361064 [info ] [MainThread]: 
[0m08:07:48.367137 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:07:48.398869 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m08:07:48.584951 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m08:07:48.589050 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m08:07:48.592993 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:07:48.622955 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.030 seconds
[0m08:07:48.632097 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m08:07:48.633697 [debug] [ThreadPool]: On list_airflow: Close
[0m08:07:48.636921 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m08:07:48.641816 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:07:48.652743 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_staging)
[0m08:07:48.673885 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.032 seconds
[0m08:07:48.685481 [debug] [ThreadPool]: On list_airflow: Close
[0m08:07:48.699210 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m08:07:48.703539 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_trusted)
[0m08:07:48.704229 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m08:07:48.710696 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:07:48.734390 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m08:07:48.739107 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m08:07:48.743194 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m08:07:48.747150 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m08:07:48.751275 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m08:07:48.755626 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:07:48.761887 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.014 seconds
[0m08:07:48.774021 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m08:07:48.779287 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m08:07:48.780099 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m08:07:48.784061 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m08:07:48.788208 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m08:07:48.788663 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now list_airflow_lead_trusted)
[0m08:07:48.805593 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.013 seconds
[0m08:07:48.807218 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m08:07:48.811119 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m08:07:48.815262 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:07:48.816016 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m08:07:48.824235 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m08:07:48.830971 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now list_airflow_lead_staging)
[0m08:07:48.842009 [debug] [ThreadPool]: SQL status: BEGIN in 0.025 seconds
[0m08:07:48.846766 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m08:07:48.851294 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m08:07:48.852887 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m08:07:48.857808 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m08:07:48.861662 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:07:48.868803 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.013 seconds
[0m08:07:48.879758 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m08:07:48.884243 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m08:07:48.885675 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m08:07:48.888965 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m08:07:48.893847 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m08:07:48.912483 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.013 seconds
[0m08:07:48.922832 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m08:07:48.926788 [debug] [MainThread]: Using postgres connection "master"
[0m08:07:48.928212 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m08:07:48.930929 [debug] [MainThread]: On master: BEGIN
[0m08:07:48.935365 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:07:48.959177 [debug] [MainThread]: SQL status: BEGIN in 0.024 seconds
[0m08:07:48.964498 [debug] [MainThread]: Using postgres connection "master"
[0m08:07:48.969883 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:07:48.975111 [debug] [MainThread]: Using postgres connection "master"
[0m08:07:48.979759 [debug] [MainThread]: On master: BEGIN
[0m08:07:48.983672 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:07:48.989566 [debug] [MainThread]: SQL status: SELECT 0 in 0.014 seconds
[0m08:07:49.000424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '858b9c1b-d9ba-4fd1-90d7-6758927c7f65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44ec5b9c70>]}
[0m08:07:49.005567 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m08:07:49.005935 [debug] [MainThread]: On master: ROLLBACK
[0m08:07:49.010603 [debug] [MainThread]: Using postgres connection "master"
[0m08:07:49.013802 [debug] [MainThread]: Using postgres connection "master"
[0m08:07:49.015709 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:07:49.017759 [debug] [MainThread]: On master: BEGIN
[0m08:07:49.025936 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m08:07:49.030041 [debug] [MainThread]: On master: COMMIT
[0m08:07:49.034314 [debug] [MainThread]: Using postgres connection "master"
[0m08:07:49.035800 [debug] [MainThread]: SQL status: SELECT 0 in 0.015 seconds
[0m08:07:49.038966 [debug] [MainThread]: On master: COMMIT
[0m08:07:49.045213 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m08:07:49.049801 [debug] [MainThread]: On master: Close
[0m08:07:49.049801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98b27b92-abdf-402b-b3de-015296a5e739', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7263e99100>]}
[0m08:07:49.055345 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:07:49.056342 [debug] [MainThread]: On master: ROLLBACK
[0m08:07:49.060253 [info ] [MainThread]: 
[0m08:07:49.063679 [debug] [MainThread]: Using postgres connection "master"
[0m08:07:49.068226 [debug] [MainThread]: On master: BEGIN
[0m08:07:49.076824 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m08:07:49.081297 [debug] [MainThread]: On master: COMMIT
[0m08:07:49.085806 [debug] [MainThread]: Using postgres connection "master"
[0m08:07:49.089911 [debug] [MainThread]: On master: COMMIT
[0m08:07:49.094780 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m08:07:49.098798 [debug] [MainThread]: On master: Close
[0m08:07:49.104087 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:07:49.108997 [info ] [MainThread]: 
[0m08:07:49.120301 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_adress
[0m08:07:49.126252 [info ] [Thread-1 (]: 1 of 5 START sql table model lead_staging.dim_address .......................... [RUN]
[0m08:07:49.132492 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now model.dbt_lead_data.staging_dim_adress)
[0m08:07:49.138121 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_adress
[0m08:07:49.175304 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_adress
[0m08:07:49.185073 [info ] [Thread-1 (]: 1 of 5 START sql table model lead_staging.dim_address .......................... [RUN]
[0m08:07:49.193770 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now model.dbt_lead_data.staging_dim_adress)
[0m08:07:49.198099 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_adress"
[0m08:07:49.198525 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_adress
[0m08:07:49.212965 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_adress
[0m08:07:49.253003 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_adress"
[0m08:07:49.263117 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_adress
[0m08:07:49.495252 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_adress"
[0m08:07:49.510869 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m08:07:49.514833 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: BEGIN
[0m08:07:49.519182 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:07:49.546922 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_adress"
[0m08:07:49.550854 [debug] [Thread-1 (]: SQL status: BEGIN in 0.031 seconds
[0m08:07:49.556777 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m08:07:49.558914 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m08:07:49.561214 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */

  
    

  create  table "airflow"."lead_staging"."dim_address__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        address,
        mac_address,
        ip_address
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m08:07:49.563792 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: BEGIN
[0m08:07:49.571211 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:07:49.597735 [debug] [Thread-1 (]: SQL status: BEGIN in 0.027 seconds
[0m08:07:49.602083 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m08:07:49.606337 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */

  
    

  create  table "airflow"."lead_staging"."dim_address__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        address,
        mac_address,
        ip_address
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m08:38:43.728922 [debug] [Thread-1 (]: SQL status: SELECT 6879790 in 3685.892 seconds
[0m08:38:43.738358 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m08:38:43.739271 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
alter table "airflow"."lead_trusted"."non_pii_data" rename to "non_pii_data__dbt_backup"
[0m08:38:44.742190 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 1.002 seconds
[0m08:38:44.748169 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m08:38:44.749484 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
alter table "airflow"."lead_trusted"."non_pii_data__dbt_tmp" rename to "non_pii_data"
[0m08:38:44.750905 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:38:44.775656 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: COMMIT
[0m08:38:44.776448 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m08:38:44.777203 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: COMMIT
[0m08:38:44.778910 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:38:44.785663 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."non_pii_data__dbt_backup"
[0m08:38:44.792494 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m08:38:44.793274 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
drop table if exists "airflow"."lead_trusted"."non_pii_data__dbt_backup" cascade
[0m08:38:44.807882 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 3685.762 seconds
[0m08:38:44.812176 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m08:38:44.812989 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
alter table "airflow"."lead_staging"."dim_address__dbt_tmp" rename to "dim_address"
[0m08:38:44.815394 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m08:38:44.828324 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.034 seconds
[0m08:38:44.831544 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: Close
[0m08:38:44.833453 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f92a7eb2-6b1a-4de6-a2ea-94ac9dbc7449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d4a411af0>]}
[0m08:38:44.834491 [info ] [Thread-1 (]: 1 of 4 OK created sql table model lead_trusted.non_pii_data .................... [[32mSELECT 6879790[0m in 3687.04s]
[0m08:38:44.835553 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_non_pii_data
[0m08:38:44.836668 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_payment_data
[0m08:38:44.837475 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m08:38:44.837566 [info ] [Thread-1 (]: 2 of 4 START sql table model lead_trusted.payment_data ......................... [RUN]
[0m08:38:44.838382 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m08:38:44.838851 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_non_pii_data, now model.dbt_lead_data.trusted_payment_data)
[0m08:38:44.839217 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m08:38:44.839590 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_payment_data
[0m08:38:44.842377 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m08:38:44.843883 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_payment_data"
[0m08:38:44.847312 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_payment_data
[0m08:38:44.850292 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_address__dbt_backup"
[0m08:38:44.851987 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_payment_data"
[0m08:38:44.854374 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m08:38:44.855143 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: BEGIN
[0m08:38:44.855846 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:38:44.857402 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m08:38:44.858152 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
drop table if exists "airflow"."lead_staging"."dim_address__dbt_backup" cascade
[0m08:38:44.860358 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m08:38:44.861086 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m08:38:44.861932 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */

  
    

  create  table "airflow"."lead_trusted"."payment_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        fnu.unique_id,
        df.iban,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.session_duration,
        fnu.consumed_traffic,
        ((fnu.download_speed + fnu.upload_speed + 1)/2) + (fnu.consumed_traffic / (fnu.session_duration + 1)) AS payment_amount
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    JOIN
        "airflow"."lead_staging"."dim_finance" df
    ON
	    fnu.unique_id = df.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m08:38:44.876476 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.017 seconds
[0m08:38:44.879790 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: Close
[0m08:38:44.881918 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '392feef2-f9b1-4226-b8db-36766c881b19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dbad3dd60>]}
[0m08:38:44.883041 [info ] [Thread-1 (]: 1 of 5 OK created sql table model lead_staging.dim_address ..................... [[32mSELECT 1214294[0m in 3687.40s]
[0m08:38:44.884281 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_adress
[0m08:38:44.885248 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_date
[0m08:38:44.886122 [info ] [Thread-1 (]: 2 of 5 START sql table model lead_staging.dim_date ............................. [RUN]
[0m08:38:44.887095 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_adress, now model.dbt_lead_data.staging_dim_date)
[0m08:38:44.887899 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_date
[0m08:38:44.891682 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_date"
[0m08:38:44.894058 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_date
[0m08:38:44.898583 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_date"
[0m08:38:44.900609 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m08:38:44.901381 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: BEGIN
[0m08:38:44.902123 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:38:44.907731 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m08:38:44.908907 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m08:38:44.909868 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */

  
    

  create  table "airflow"."lead_staging"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        accessed_at
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m08:54:30.460282 [debug] [Thread-1 (]: SQL status: SELECT 1212982 in 945.444 seconds
[0m08:54:30.465591 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m08:54:30.466700 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
alter table "airflow"."lead_trusted"."payment_data" rename to "payment_data__dbt_backup"
[0m08:54:30.475076 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m08:54:30.479018 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m08:54:30.480007 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
alter table "airflow"."lead_trusted"."payment_data__dbt_tmp" rename to "payment_data"
[0m08:54:30.481530 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:54:30.485010 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: COMMIT
[0m08:54:30.486235 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m08:54:30.487482 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: COMMIT
[0m08:54:30.496170 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m08:54:30.499642 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."payment_data__dbt_backup"
[0m08:54:30.501392 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m08:54:30.502434 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
drop table if exists "airflow"."lead_trusted"."payment_data__dbt_backup" cascade
[0m08:54:30.528277 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.025 seconds
[0m08:54:30.531325 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: Close
[0m08:54:30.532722 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f92a7eb2-6b1a-4de6-a2ea-94ac9dbc7449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d469fcbf0>]}
[0m08:54:30.537469 [info ] [Thread-1 (]: 2 of 4 OK created sql table model lead_trusted.payment_data .................... [[32mSELECT 1212982[0m in 945.69s]
[0m08:54:30.544793 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_payment_data
[0m08:54:30.547511 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_pii_data
[0m08:54:30.549322 [info ] [Thread-1 (]: 3 of 4 START sql table model lead_trusted.pii_data ............................. [RUN]
[0m08:54:30.551303 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_payment_data, now model.dbt_lead_data.trusted_pii_data)
[0m08:54:30.553080 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_pii_data
[0m08:54:30.563658 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_pii_data"
[0m08:54:30.571109 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_pii_data
[0m08:54:30.583341 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_pii_data"
[0m08:54:30.589128 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m08:54:30.591138 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: BEGIN
[0m08:54:30.592737 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:54:30.601426 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m08:54:30.603422 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m08:54:30.605497 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */

  
    

  create  table "airflow"."lead_trusted"."pii_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        dp.person_name,
        dp.user_name,
        dp.email,
        dp.personal_number, 
        dp.birth_date, 
        da.address,
        dp.phone, 
        da.mac_address,
        da.ip_address,
        df.iban,
        dd.accessed_at,
        fnu.session_duration,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.consumed_traffic,
        fnu.unique_id
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    INNER JOIN
        "airflow"."lead_staging"."dim_address" da ON fnu.unique_id = da.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_date" dd ON da.unique_id = dd.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_finance" df ON dd.unique_id = df.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_person" dp ON df.unique_id = dp.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m08:54:32.918917 [debug] [Thread-1 (]: SQL status: SELECT 2274886 in 947.854 seconds
[0m08:54:32.923026 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m08:54:32.923823 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
alter table "airflow"."lead_staging"."dim_date" rename to "dim_date__dbt_backup"
[0m08:54:32.981572 [debug] [Thread-1 (]: SQL status: SELECT 2274886 in 2803.302 seconds
[0m08:54:32.989794 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m08:54:32.990809 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
alter table "airflow"."lead_staging"."dim_address" rename to "dim_address__dbt_backup"
[0m08:54:47.431286 [debug] [Thread-1 (]: SQL status: SELECT 6879790 in 2834.219 seconds
[0m08:54:47.456558 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m08:54:47.461774 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */
alter table "airflow"."lead_trusted"."pii_data" rename to "pii_data__dbt_backup"
[0m08:54:47.469716 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m08:54:47.493295 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m08:54:47.497721 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */
alter table "airflow"."lead_trusted"."pii_data__dbt_tmp" rename to "pii_data"
[0m08:54:47.507406 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m08:54:47.523539 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: COMMIT
[0m08:54:47.527638 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m08:54:47.532670 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: COMMIT
[0m08:54:47.539845 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m08:54:47.556736 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."pii_data__dbt_backup"
[0m08:54:47.563873 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m08:54:47.568775 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */
drop table if exists "airflow"."lead_trusted"."pii_data__dbt_backup" cascade
[0m08:54:47.606453 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.032 seconds
[0m08:54:47.618380 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: Close
[0m08:54:47.625620 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba20aeba-308b-41be-bfa4-15f942652bbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c802e1130>]}
[0m08:54:47.632779 [info ] [Thread-1 (]: 3 of 4 OK created sql table model lead_trusted.pii_data ........................ [[32mSELECT 6879790[0m in 2834.56s]
[0m08:54:47.642820 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_pii_data
[0m08:54:47.650768 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_technical_data
[0m08:54:47.657815 [info ] [Thread-1 (]: 4 of 4 START sql table model lead_trusted.technical_data ....................... [RUN]
[0m08:54:47.664717 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_pii_data, now model.dbt_lead_data.trusted_technical_data)
[0m08:54:47.668851 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_technical_data
[0m08:54:47.702289 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_technical_data"
[0m08:54:47.722397 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_technical_data
[0m08:54:47.763717 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_technical_data"
[0m08:54:47.798934 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m08:54:47.808601 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: BEGIN
[0m08:54:47.817569 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:54:47.849862 [debug] [Thread-1 (]: SQL status: BEGIN in 0.033 seconds
[0m08:54:47.856407 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m08:54:47.860833 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */

  
    

  create  table "airflow"."lead_trusted"."technical_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        fnu.unique_id,
        da.address,
        da.mac_address,
        da.ip_address,
        fnu.download_speed,
        fnu.upload_speed,
        ROUND((fnu.session_duration/60), 1) as min_session_duration,
        CASE 
            WHEN fnu.download_speed < 50 OR fnu.upload_speed < 30 OR fnu.session_duration/60 < 1 THEN true
            ELSE false
        END AS technical_issue
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    JOIN
        "airflow"."lead_staging"."dim_address" da
    ON
	    fnu.unique_id = da.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m09:08:35.694099 [debug] [Thread-1 (]: SQL status: SELECT 6879790 in 845.101 seconds
[0m09:08:35.698163 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m09:08:35.698914 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */
alter table "airflow"."lead_trusted"."pii_data" rename to "pii_data__dbt_backup"
[0m09:08:36.701266 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 1.001 seconds
[0m09:08:36.704692 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m09:08:36.705512 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */
alter table "airflow"."lead_trusted"."pii_data__dbt_tmp" rename to "pii_data"
[0m09:08:36.706493 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:08:36.708593 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: COMMIT
[0m09:08:36.709141 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m09:08:36.709763 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: COMMIT
[0m09:08:36.711605 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:08:36.712044 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 843.801 seconds
[0m09:08:36.712157 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 843.735 seconds
[0m09:08:36.714640 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."pii_data__dbt_backup"
[0m09:08:36.716203 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m09:08:36.716736 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m09:08:36.717034 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */
drop table if exists "airflow"."lead_trusted"."pii_data__dbt_backup" cascade
[0m09:08:36.717053 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m09:08:36.717601 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
alter table "airflow"."lead_staging"."dim_date__dbt_tmp" rename to "dim_date"
[0m09:08:36.718309 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
alter table "airflow"."lead_staging"."dim_address__dbt_tmp" rename to "dim_address"
[0m09:08:36.719373 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:08:36.719611 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:08:36.722156 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: COMMIT
[0m09:08:36.722940 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m09:08:36.723824 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: COMMIT
[0m09:08:36.725908 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:08:36.746047 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_date__dbt_backup"
[0m09:08:36.753374 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m09:08:36.757497 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
drop table if exists "airflow"."lead_staging"."dim_date__dbt_backup" cascade
[0m09:08:36.792073 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.030 seconds
[0m09:08:36.804145 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: Close
[0m09:08:36.814256 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '392feef2-f9b1-4226-b8db-36766c881b19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1db73d1e80>]}
[0m09:08:36.823402 [info ] [Thread-1 (]: 2 of 5 OK created sql table model lead_staging.dim_date ........................ [[32mSELECT 2274886[0m in 1791.93s]
[0m09:08:36.834313 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_date
[0m09:08:36.845412 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_finance
[0m09:08:36.857267 [info ] [Thread-1 (]: 3 of 5 START sql table model lead_staging.dim_finance .......................... [RUN]
[0m09:08:36.867989 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_date, now model.dbt_lead_data.staging_dim_finance)
[0m09:08:36.875399 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m09:08:36.877235 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_finance
[0m09:08:36.881422 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m09:08:36.892172 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m09:08:36.912583 [debug] [Thread-1 (]: SQL status: COMMIT in 0.013 seconds
[0m09:08:36.937178 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_finance"
[0m09:08:36.983788 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_finance
[0m09:08:37.027337 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_address__dbt_backup"
[0m09:08:37.060461 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.340 seconds
[0m09:08:37.062942 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_finance"
[0m09:08:37.079360 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: Close
[0m09:08:37.089713 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m09:08:37.088440 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f92a7eb2-6b1a-4de6-a2ea-94ac9dbc7449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d44525520>]}
[0m09:08:37.103181 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m09:08:37.101329 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: BEGIN
[0m09:08:37.120552 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
drop table if exists "airflow"."lead_staging"."dim_address__dbt_backup" cascade
[0m09:08:37.114666 [info ] [Thread-1 (]: 3 of 4 OK created sql table model lead_trusted.pii_data ........................ [[32mSELECT 6879790[0m in 846.54s]
[0m09:08:37.129094 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:08:37.154795 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_pii_data
[0m09:08:37.174243 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_technical_data
[0m09:08:37.192743 [info ] [Thread-1 (]: 4 of 4 START sql table model lead_trusted.technical_data ....................... [RUN]
[0m09:08:37.198250 [debug] [Thread-1 (]: SQL status: BEGIN in 0.072 seconds
[0m09:08:37.209205 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_pii_data, now model.dbt_lead_data.trusted_technical_data)
[0m09:08:37.211374 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.077 seconds
[0m09:08:37.212462 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m09:08:37.217021 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_technical_data
[0m09:08:37.223456 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */

  
    

  create  table "airflow"."lead_staging"."dim_finance__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        iban
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m09:08:37.257249 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: Close
[0m09:08:37.274129 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_technical_data"
[0m09:08:37.288370 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '858b9c1b-d9ba-4fd1-90d7-6758927c7f65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44ef181a00>]}
[0m09:08:37.314408 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_technical_data
[0m09:08:37.320616 [info ] [Thread-1 (]: 1 of 5 OK created sql table model lead_staging.dim_address ..................... [[32mSELECT 2274886[0m in 3648.14s]
[0m09:08:37.361403 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_adress
[0m09:08:37.371446 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_date
[0m09:08:37.385839 [info ] [Thread-1 (]: 2 of 5 START sql table model lead_staging.dim_date ............................. [RUN]
[0m09:08:37.399017 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_adress, now model.dbt_lead_data.staging_dim_date)
[0m09:08:37.409045 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_date
[0m09:08:37.396833 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_technical_data"
[0m09:08:37.447187 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m09:08:37.467370 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: BEGIN
[0m09:08:37.486218 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:08:37.491379 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_date"
[0m09:08:37.520457 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_date
[0m09:08:37.548420 [debug] [Thread-1 (]: SQL status: BEGIN in 0.058 seconds
[0m09:08:37.562014 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m09:08:37.573288 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */

  
    

  create  table "airflow"."lead_trusted"."technical_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        fnu.unique_id,
        da.address,
        da.mac_address,
        da.ip_address,
        fnu.download_speed,
        fnu.upload_speed,
        ROUND((fnu.session_duration/60), 1) as min_session_duration,
        CASE 
            WHEN fnu.download_speed < 50 OR fnu.upload_speed < 30 OR fnu.session_duration/60 < 1 THEN true
            ELSE false
        END AS technical_issue
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    JOIN
        "airflow"."lead_staging"."dim_address" da
    ON
	    fnu.unique_id = da.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m09:08:37.594474 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_date"
[0m09:08:37.614313 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m09:08:37.626781 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: BEGIN
[0m09:08:37.640601 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:08:37.683175 [debug] [Thread-1 (]: SQL status: BEGIN in 0.042 seconds
[0m09:08:37.693452 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m09:08:37.702312 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */

  
    

  create  table "airflow"."lead_staging"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        accessed_at
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m09:09:02.596140 [debug] [Thread-1 (]: SQL status: SELECT 1212982 in 854.756 seconds
[0m09:09:02.621447 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m09:09:02.626556 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
alter table "airflow"."lead_trusted"."technical_data" rename to "technical_data__dbt_backup"
[0m09:09:02.639453 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m09:09:02.663337 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m09:09:02.668937 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
alter table "airflow"."lead_trusted"."technical_data__dbt_tmp" rename to "technical_data"
[0m09:09:02.676525 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:09:02.693396 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: COMMIT
[0m09:09:02.698884 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m09:09:02.703631 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: COMMIT
[0m09:09:02.740221 [debug] [Thread-1 (]: SQL status: COMMIT in 0.029 seconds
[0m09:09:02.774316 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."technical_data__dbt_backup"
[0m09:09:02.791701 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m09:09:02.801502 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
drop table if exists "airflow"."lead_trusted"."technical_data__dbt_backup" cascade
[0m09:09:02.852609 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.039 seconds
[0m09:09:02.887676 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: Close
[0m09:09:02.900325 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba20aeba-308b-41be-bfa4-15f942652bbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c802e2390>]}
[0m09:09:02.912693 [info ] [Thread-1 (]: 4 of 4 OK created sql table model lead_trusted.technical_data .................. [[32mSELECT 1212982[0m in 855.24s]
[0m09:09:02.926869 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_technical_data
[0m09:09:02.965808 [debug] [MainThread]: Using postgres connection "master"
[0m09:09:02.977449 [debug] [MainThread]: On master: BEGIN
[0m09:09:02.988018 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:09:03.033819 [debug] [MainThread]: SQL status: BEGIN in 0.045 seconds
[0m09:09:03.045247 [debug] [MainThread]: On master: COMMIT
[0m09:09:03.053534 [debug] [MainThread]: Using postgres connection "master"
[0m09:09:03.060403 [debug] [MainThread]: On master: COMMIT
[0m09:09:03.072230 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m09:09:03.080828 [debug] [MainThread]: On master: Close
[0m09:09:03.091567 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:09:03.102158 [debug] [MainThread]: Connection 'model.dbt_lead_data.trusted_technical_data' was properly closed.
[0m09:09:03.112237 [info ] [MainThread]: 
[0m09:09:03.120894 [info ] [MainThread]: Finished running 4 table models in 1 hours 31 minutes and 45.82 seconds (5505.82s).
[0m09:09:03.151554 [debug] [MainThread]: Command end result
[0m09:09:04.012718 [info ] [MainThread]: 
[0m09:09:04.030258 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:09:04.039257 [info ] [MainThread]: 
[0m09:09:04.052287 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m09:09:04.064939 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5508.001, "process_user_time": 870.2267, "process_kernel_time": 43.38989, "process_mem_max_rss": "122308", "process_in_blocks": "1096", "process_out_blocks": "0"}
[0m09:09:04.075270 [debug] [MainThread]: Command `dbt run` succeeded at 09:09:04.073334 after 5508.01 seconds
[0m09:09:04.084112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c85b27800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c83af45c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c80238050>]}
[0m09:09:04.092599 [debug] [MainThread]: Flushing usage events
[0m09:24:42.582497 [debug] [Thread-1 (]: SQL status: SELECT 2274886 in 965.053 seconds
[0m09:24:42.588115 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m09:24:42.589126 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
alter table "airflow"."lead_staging"."dim_date" rename to "dim_date__dbt_backup"
[0m09:24:42.714424 [debug] [Thread-1 (]: SQL status: SELECT 2274886 in 965.657 seconds
[0m09:24:42.720339 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m09:24:42.721430 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
alter table "airflow"."lead_staging"."dim_finance" rename to "dim_finance__dbt_backup"
[0m09:24:42.723923 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:24:42.728254 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m09:24:42.729354 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
alter table "airflow"."lead_staging"."dim_finance__dbt_tmp" rename to "dim_finance"
[0m09:24:42.730833 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:24:42.733994 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: COMMIT
[0m09:24:42.734989 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m09:24:42.736184 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: COMMIT
[0m09:24:42.744904 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m09:24:42.748777 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_finance__dbt_backup"
[0m09:24:42.750469 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m09:24:42.758244 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
drop table if exists "airflow"."lead_staging"."dim_finance__dbt_backup" cascade
[0m09:24:42.770497 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.011 seconds
[0m09:24:42.772830 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: Close
[0m09:24:42.774231 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '392feef2-f9b1-4226-b8db-36766c881b19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1db4e021e0>]}
[0m09:24:42.775875 [info ] [Thread-1 (]: 3 of 5 OK created sql table model lead_staging.dim_finance ..................... [[32mSELECT 2274886[0m in 965.91s]
[0m09:24:42.777716 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_finance
[0m09:24:42.779035 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_person
[0m09:24:42.780078 [info ] [Thread-1 (]: 4 of 5 START sql table model lead_staging.dim_person ........................... [RUN]
[0m09:24:42.781190 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_finance, now model.dbt_lead_data.staging_dim_person)
[0m09:24:42.782458 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_person
[0m09:24:42.787169 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_person"
[0m09:24:42.791279 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_person
[0m09:24:42.796705 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_person"
[0m09:24:42.800049 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m09:24:42.801296 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: BEGIN
[0m09:24:42.802849 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:24:42.809042 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m09:24:42.809988 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m09:24:42.810892 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */

  
    

  create  table "airflow"."lead_staging"."dim_person__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        person_name,
        user_name,
        email,
        phone,
        birth_date,
        personal_number
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m09:24:43.592797 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 1.002 seconds
[0m09:24:43.598376 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m09:24:43.599791 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
alter table "airflow"."lead_staging"."dim_date__dbt_tmp" rename to "dim_date"
[0m09:24:43.613701 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.012 seconds
[0m09:24:43.618821 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: COMMIT
[0m09:24:43.620249 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m09:24:43.621678 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: COMMIT
[0m09:24:43.630992 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m09:24:43.637135 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_date__dbt_backup"
[0m09:24:43.639577 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m09:24:43.641302 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
drop table if exists "airflow"."lead_staging"."dim_date__dbt_backup" cascade
[0m09:24:43.718036 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.075 seconds
[0m09:24:43.721383 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: Close
[0m09:24:43.723279 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '858b9c1b-d9ba-4fd1-90d7-6758927c7f65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44eab403b0>]}
[0m09:24:43.725275 [info ] [Thread-1 (]: 2 of 5 OK created sql table model lead_staging.dim_date ........................ [[32mSELECT 2274886[0m in 966.33s]
[0m09:24:43.727655 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_date
[0m09:24:43.730071 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_finance
[0m09:24:43.737669 [info ] [Thread-1 (]: 3 of 5 START sql table model lead_staging.dim_finance .......................... [RUN]
[0m09:24:43.739214 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_date, now model.dbt_lead_data.staging_dim_finance)
[0m09:24:43.740953 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_finance
[0m09:24:43.747390 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_finance"
[0m09:24:43.750908 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_finance
[0m09:24:43.759846 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_finance"
[0m09:24:43.764475 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m09:24:43.765892 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: BEGIN
[0m09:24:43.767218 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:24:43.774929 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m09:24:43.776476 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m09:24:43.777981 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */

  
    

  create  table "airflow"."lead_staging"."dim_finance__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        iban
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m09:24:44.635063 [debug] [Thread-1 (]: SQL status: SELECT 1212982 in 967.233 seconds
[0m09:24:44.639135 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m09:24:44.639936 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
alter table "airflow"."lead_trusted"."technical_data" rename to "technical_data__dbt_backup"
[0m09:24:44.641242 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:24:44.645330 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m09:24:44.646229 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
alter table "airflow"."lead_trusted"."technical_data__dbt_tmp" rename to "technical_data"
[0m09:24:44.647541 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:24:44.650365 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: COMMIT
[0m09:24:44.651223 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m09:24:44.652111 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: COMMIT
[0m09:24:44.657913 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m09:24:44.661086 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."technical_data__dbt_backup"
[0m09:24:44.662376 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m09:24:44.663269 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
drop table if exists "airflow"."lead_trusted"."technical_data__dbt_backup" cascade
[0m09:24:44.671928 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.008 seconds
[0m09:24:44.674042 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: Close
[0m09:24:44.675064 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f92a7eb2-6b1a-4de6-a2ea-94ac9dbc7449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d46d59670>]}
[0m09:24:44.676116 [info ] [Thread-1 (]: 4 of 4 OK created sql table model lead_trusted.technical_data .................. [[32mSELECT 1212982[0m in 967.47s]
[0m09:24:44.677522 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_technical_data
[0m09:24:44.681484 [debug] [MainThread]: Using postgres connection "master"
[0m09:24:44.682313 [debug] [MainThread]: On master: BEGIN
[0m09:24:44.683208 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:24:44.688191 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m09:24:44.689150 [debug] [MainThread]: On master: COMMIT
[0m09:24:44.689951 [debug] [MainThread]: Using postgres connection "master"
[0m09:24:44.690716 [debug] [MainThread]: On master: COMMIT
[0m09:24:44.691705 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:24:44.692388 [debug] [MainThread]: On master: Close
[0m09:24:44.693341 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:24:44.694074 [debug] [MainThread]: Connection 'model.dbt_lead_data.trusted_technical_data' was properly closed.
[0m09:24:44.694952 [info ] [MainThread]: 
[0m09:24:44.695791 [info ] [MainThread]: Finished running 4 table models in 1 hours 47 minutes and 27.07 seconds (6447.07s).
[0m09:24:44.697774 [debug] [MainThread]: Command end result
[0m09:24:44.764398 [info ] [MainThread]: 
[0m09:24:44.765770 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:24:44.766747 [info ] [MainThread]: 
[0m09:24:44.768457 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m09:24:44.770403 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6448.347, "process_user_time": 869.0282, "process_kernel_time": 41.281822, "process_mem_max_rss": "120276", "process_in_blocks": "1472", "process_out_blocks": "0"}
[0m09:24:44.771455 [debug] [MainThread]: Command `dbt run` succeeded at 09:24:44.771299 after 6448.35 seconds
[0m09:24:44.772339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d4b23fe30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d48f6da00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d48b56990>]}
[0m09:24:44.773217 [debug] [MainThread]: Flushing usage events
[0m09:24:45.661830 [debug] [Thread-1 (]: SQL status: SELECT 1452960 in 6442.536 seconds
[0m09:24:45.670423 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m09:24:45.671255 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
alter table "airflow"."lead_staging"."dim_address" rename to "dim_address__dbt_backup"
[0m09:24:45.678369 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m09:24:45.682255 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m09:24:45.683086 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
alter table "airflow"."lead_staging"."dim_address__dbt_tmp" rename to "dim_address"
[0m09:24:45.684205 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:24:45.707464 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m09:24:45.708416 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m09:24:45.709234 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m09:24:45.713548 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m09:24:45.721197 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_address__dbt_backup"
[0m09:24:45.728113 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m09:24:45.728906 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
drop table if exists "airflow"."lead_staging"."dim_address__dbt_backup" cascade
[0m09:24:45.759193 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.029 seconds
[0m09:24:45.762813 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: Close
[0m09:24:45.764908 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '440be5e3-d3c6-4da1-ab0a-b0e74eb206fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9c9ed5ee0>]}
[0m09:24:45.766078 [info ] [Thread-1 (]: 1 of 5 OK created sql table model lead_staging.dim_address ..................... [[32mSELECT 1452960[0m in 6442.63s]
[0m09:24:45.767307 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_adress
[0m09:24:45.768202 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_date
[0m09:24:45.769080 [info ] [Thread-1 (]: 2 of 5 START sql table model lead_staging.dim_date ............................. [RUN]
[0m09:24:45.769983 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_adress, now model.dbt_lead_data.staging_dim_date)
[0m09:24:45.770680 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_date
[0m09:24:45.774718 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_date"
[0m09:24:45.777855 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_date
[0m09:24:45.782688 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_date"
[0m09:24:45.785259 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m09:24:45.786129 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: BEGIN
[0m09:24:45.786906 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:24:45.792356 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m09:24:45.793446 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m09:24:45.794292 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */

  
    

  create  table "airflow"."lead_staging"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        accessed_at
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m09:24:51.254178 [debug] [Thread-1 (]: SQL status: SELECT 2274886 in 7.474 seconds
[0m09:24:51.278190 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m09:24:51.282693 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
alter table "airflow"."lead_staging"."dim_finance" rename to "dim_finance__dbt_backup"
[0m09:24:51.290457 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:24:51.311410 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m09:24:51.316465 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
alter table "airflow"."lead_staging"."dim_finance__dbt_tmp" rename to "dim_finance"
[0m09:24:51.323101 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:24:51.338283 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: COMMIT
[0m09:24:51.343548 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m09:24:51.348417 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: COMMIT
[0m09:24:51.377681 [debug] [Thread-1 (]: SQL status: COMMIT in 0.023 seconds
[0m09:24:51.411158 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_finance__dbt_backup"
[0m09:24:51.423193 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m09:24:51.430749 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
drop table if exists "airflow"."lead_staging"."dim_finance__dbt_backup" cascade
[0m09:24:51.537607 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.098 seconds
[0m09:24:51.562352 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: Close
[0m09:24:51.573498 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '858b9c1b-d9ba-4fd1-90d7-6758927c7f65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44eabe55b0>]}
[0m09:24:51.594331 [info ] [Thread-1 (]: 3 of 5 OK created sql table model lead_staging.dim_finance ..................... [[32mSELECT 2274886[0m in 7.83s]
[0m09:24:51.618484 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_finance
[0m09:24:51.629075 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_person
[0m09:24:51.642068 [info ] [Thread-1 (]: 4 of 5 START sql table model lead_staging.dim_person ........................... [RUN]
[0m09:24:51.655698 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_finance, now model.dbt_lead_data.staging_dim_person)
[0m09:24:51.667675 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_person
[0m09:24:51.710555 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_person"
[0m09:24:51.719538 [debug] [Thread-1 (]: SQL status: SELECT 1452960 in 5505.118 seconds
[0m09:24:51.728653 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_person
[0m09:24:51.764017 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_person"
[0m09:24:51.781039 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m09:24:51.781771 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m09:24:51.787132 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: BEGIN
[0m09:24:51.791790 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
alter table "airflow"."lead_staging"."dim_address" rename to "dim_address__dbt_backup"
[0m09:24:51.798266 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:24:51.806154 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:24:51.830415 [debug] [Thread-1 (]: SQL status: BEGIN in 0.036 seconds
[0m09:24:51.835321 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m09:24:51.835637 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m09:24:51.841516 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
alter table "airflow"."lead_staging"."dim_address__dbt_tmp" rename to "dim_address"
[0m09:24:51.843636 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */

  
    

  create  table "airflow"."lead_staging"."dim_person__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        person_name,
        user_name,
        email,
        phone,
        birth_date,
        personal_number
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m09:24:51.849645 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:24:52.066388 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m09:24:52.071221 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m09:24:52.075410 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m09:24:52.093410 [debug] [Thread-1 (]: SQL status: COMMIT in 0.014 seconds
[0m09:24:52.139439 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_address__dbt_backup"
[0m09:24:52.182566 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m09:24:52.188165 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
drop table if exists "airflow"."lead_staging"."dim_address__dbt_backup" cascade
[0m09:24:52.322393 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.130 seconds
[0m09:24:52.344221 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: Close
[0m09:24:52.356144 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4be254de-39c3-47d9-b193-d02a992c87e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e98d31b50>]}
[0m09:24:52.362376 [info ] [Thread-1 (]: 1 of 5 OK created sql table model lead_staging.dim_address ..................... [[32mSELECT 1452960[0m in 5505.65s]
[0m09:24:52.369146 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_adress
[0m09:24:52.374658 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_date
[0m09:24:52.380425 [info ] [Thread-1 (]: 2 of 5 START sql table model lead_staging.dim_date ............................. [RUN]
[0m09:24:52.386225 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_adress, now model.dbt_lead_data.staging_dim_date)
[0m09:24:52.390913 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_date
[0m09:24:52.412121 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_date"
[0m09:24:52.423323 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_date
[0m09:24:52.455986 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_date"
[0m09:24:52.467226 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m09:24:52.472152 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: BEGIN
[0m09:24:52.478150 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:24:52.508526 [debug] [Thread-1 (]: SQL status: BEGIN in 0.031 seconds
[0m09:24:52.513484 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m09:24:52.518036 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */

  
    

  create  table "airflow"."lead_staging"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        accessed_at
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m09:24:57.340200 [debug] [Thread-1 (]: SQL status: SELECT 2274886 in 14.527 seconds
[0m09:24:57.367434 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m09:24:57.373428 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
alter table "airflow"."lead_staging"."dim_person" rename to "dim_person__dbt_backup"
[0m09:24:57.385928 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:24:57.414003 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m09:24:57.419108 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
alter table "airflow"."lead_staging"."dim_person__dbt_tmp" rename to "dim_person"
[0m09:24:57.432522 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m09:24:57.451241 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: COMMIT
[0m09:24:57.456241 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m09:24:57.461279 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: COMMIT
[0m09:24:57.489135 [debug] [Thread-1 (]: SQL status: COMMIT in 0.021 seconds
[0m09:24:57.520253 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_person__dbt_backup"
[0m09:24:57.535376 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m09:24:57.546356 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
drop table if exists "airflow"."lead_staging"."dim_person__dbt_backup" cascade
[0m09:24:57.624611 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.061 seconds
[0m09:24:57.641324 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: Close
[0m09:24:57.648437 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '392feef2-f9b1-4226-b8db-36766c881b19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1db73d6720>]}
[0m09:24:57.658510 [info ] [Thread-1 (]: 4 of 5 OK created sql table model lead_staging.dim_person ...................... [[32mSELECT 2274886[0m in 14.87s]
[0m09:24:57.670300 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_person
[0m09:24:57.678549 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_fact_network_usage
[0m09:24:57.688660 [info ] [Thread-1 (]: 5 of 5 START sql table model lead_staging.fact_network_usage ................... [RUN]
[0m09:24:57.696361 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_person, now model.dbt_lead_data.staging_fact_network_usage)
[0m09:24:57.702614 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_fact_network_usage
[0m09:24:57.730363 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_fact_network_usage"
[0m09:24:57.765513 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_fact_network_usage
[0m09:24:57.812416 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_fact_network_usage"
[0m09:24:57.838310 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m09:24:57.847980 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: BEGIN
[0m09:24:57.857920 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:24:57.899245 [debug] [Thread-1 (]: SQL status: BEGIN in 0.041 seconds
[0m09:24:57.905384 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m09:24:57.911631 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */

  
    

  create  table "airflow"."lead_staging"."fact_network_usage__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        session_duration,
        download_speed,
        upload_speed,
        consumed_traffic
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m09:24:58.856400 [debug] [Thread-1 (]: SQL status: SELECT 2274886 in 13.060 seconds
[0m09:24:58.881331 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m09:24:58.886239 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
alter table "airflow"."lead_staging"."dim_date" rename to "dim_date__dbt_backup"
[0m09:24:58.893080 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:24:58.915911 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m09:24:58.921157 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
alter table "airflow"."lead_staging"."dim_date__dbt_tmp" rename to "dim_date"
[0m09:24:58.929894 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:24:58.944181 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: COMMIT
[0m09:24:58.949277 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m09:24:58.953826 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: COMMIT
[0m09:24:58.976270 [debug] [Thread-1 (]: SQL status: COMMIT in 0.016 seconds
[0m09:24:58.998316 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_date__dbt_backup"
[0m09:24:59.007678 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m09:24:59.012373 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
drop table if exists "airflow"."lead_staging"."dim_date__dbt_backup" cascade
[0m09:24:59.058366 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.039 seconds
[0m09:24:59.071624 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: Close
[0m09:24:59.079371 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '440be5e3-d3c6-4da1-ab0a-b0e74eb206fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9c65e5fd0>]}
[0m09:24:59.086856 [info ] [Thread-1 (]: 2 of 5 OK created sql table model lead_staging.dim_date ........................ [[32mSELECT 2274886[0m in 13.31s]
[0m09:24:59.095215 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_date
[0m09:24:59.101171 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_finance
[0m09:24:59.107641 [info ] [Thread-1 (]: 3 of 5 START sql table model lead_staging.dim_finance .......................... [RUN]
[0m09:24:59.113695 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_date, now model.dbt_lead_data.staging_dim_finance)
[0m09:24:59.122916 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_finance
[0m09:24:59.148195 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_finance"
[0m09:24:59.169334 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_finance
[0m09:24:59.222386 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_finance"
[0m09:24:59.240169 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m09:24:59.243887 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: BEGIN
[0m09:24:59.249360 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:24:59.284686 [debug] [Thread-1 (]: SQL status: BEGIN in 0.036 seconds
[0m09:24:59.291397 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m09:24:59.297470 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */

  
    

  create  table "airflow"."lead_staging"."dim_finance__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        iban
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m09:40:34.789017 [debug] [Thread-1 (]: SQL status: SELECT 2274886 in 5565.138 seconds
[0m09:40:34.805940 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m09:40:34.807331 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
alter table "airflow"."lead_staging"."dim_address" rename to "dim_address__dbt_backup"
[0m09:40:34.809652 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:40:34.815167 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m09:40:34.816362 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
alter table "airflow"."lead_staging"."dim_address__dbt_tmp" rename to "dim_address"
[0m09:40:34.820479 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:40:34.849380 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m09:40:34.850384 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m09:40:34.851183 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m09:40:34.860298 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m09:40:34.869195 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_address__dbt_backup"
[0m09:40:34.876778 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m09:40:34.877720 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
drop table if exists "airflow"."lead_staging"."dim_address__dbt_backup" cascade
[0m09:40:34.890002 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.011 seconds
[0m09:40:34.893811 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: Close
[0m09:40:34.896902 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98b27b92-abdf-402b-b3de-015296a5e739', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7262dfce90>]}
[0m09:40:34.898871 [info ] [Thread-1 (]: 1 of 5 OK created sql table model lead_staging.dim_address ..................... [[32mSELECT 2274886[0m in 5565.70s]
[0m09:40:34.900768 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_adress
[0m09:40:34.902488 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_date
[0m09:40:34.904032 [info ] [Thread-1 (]: 2 of 5 START sql table model lead_staging.dim_date ............................. [RUN]
[0m09:40:34.905559 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_adress, now model.dbt_lead_data.staging_dim_date)
[0m09:40:34.906950 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_date
[0m09:40:34.911594 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_date"
[0m09:40:34.916290 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_date
[0m09:40:34.923195 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_date"
[0m09:40:34.927840 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m09:40:34.929783 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: BEGIN
[0m09:40:34.931133 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:40:34.938006 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m09:40:34.939490 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m09:40:34.940534 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */

  
    

  create  table "airflow"."lead_staging"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        accessed_at
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m09:40:35.263877 [debug] [Thread-1 (]: SQL status: SELECT 2274886 in 942.621 seconds
[0m09:40:35.268418 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m09:40:35.269437 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
alter table "airflow"."lead_staging"."dim_date" rename to "dim_date__dbt_backup"
[0m09:40:35.271460 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:40:35.275971 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m09:40:35.277006 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
alter table "airflow"."lead_staging"."dim_date__dbt_tmp" rename to "dim_date"
[0m09:40:35.278528 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:40:35.281284 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: COMMIT
[0m09:40:35.282278 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m09:40:35.283294 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: COMMIT
[0m09:40:35.302645 [debug] [Thread-1 (]: SQL status: COMMIT in 0.018 seconds
[0m09:40:35.308967 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_date__dbt_backup"
[0m09:40:35.311508 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m09:40:35.312855 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
drop table if exists "airflow"."lead_staging"."dim_date__dbt_backup" cascade
[0m09:40:35.335087 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.021 seconds
[0m09:40:35.337880 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: Close
[0m09:40:35.339543 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4be254de-39c3-47d9-b193-d02a992c87e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e94604230>]}
[0m09:40:35.341296 [info ] [Thread-1 (]: 2 of 5 OK created sql table model lead_staging.dim_date ........................ [[32mSELECT 2274886[0m in 942.95s]
[0m09:40:35.343230 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_date
[0m09:40:35.344459 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_finance
[0m09:40:35.345719 [info ] [Thread-1 (]: 3 of 5 START sql table model lead_staging.dim_finance .......................... [RUN]
[0m09:40:35.347048 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_date, now model.dbt_lead_data.staging_dim_finance)
[0m09:40:35.348242 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_finance
[0m09:40:35.352672 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_finance"
[0m09:40:35.355728 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_finance
[0m09:40:35.362307 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_finance"
[0m09:40:35.365727 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m09:40:35.367267 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: BEGIN
[0m09:40:35.368699 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:40:35.375992 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m09:40:35.377844 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m09:40:35.379359 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */

  
    

  create  table "airflow"."lead_staging"."dim_finance__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        iban
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m09:40:35.847445 [debug] [Thread-1 (]: SQL status: SELECT 2274886 in 937.808 seconds
[0m09:40:35.853523 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m09:40:35.854524 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
alter table "airflow"."lead_staging"."fact_network_usage" rename to "fact_network_usage__dbt_backup"
[0m09:40:35.856399 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:40:35.860454 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m09:40:35.861477 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
alter table "airflow"."lead_staging"."fact_network_usage__dbt_tmp" rename to "fact_network_usage"
[0m09:40:35.862791 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:40:35.865296 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: COMMIT
[0m09:40:35.866043 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m09:40:35.866787 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: COMMIT
[0m09:40:35.876138 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m09:40:35.879877 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."fact_network_usage__dbt_backup"
[0m09:40:35.881635 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m09:40:35.882583 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
drop table if exists "airflow"."lead_staging"."fact_network_usage__dbt_backup" cascade
[0m09:40:35.887244 [debug] [Thread-1 (]: SQL status: SELECT 2274886 in 936.462 seconds
[0m09:40:35.891919 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m09:40:35.892961 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
alter table "airflow"."lead_staging"."dim_finance" rename to "dim_finance__dbt_backup"
[0m09:40:35.893810 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.010 seconds
[0m09:40:35.894833 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:40:35.896457 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: Close
[0m09:40:35.898037 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '392feef2-f9b1-4226-b8db-36766c881b19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1db67cfda0>]}
[0m09:40:35.899602 [info ] [Thread-1 (]: 5 of 5 OK created sql table model lead_staging.fact_network_usage .............. [[32mSELECT 2274886[0m in 938.20s]
[0m09:40:35.899878 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m09:40:35.901425 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_fact_network_usage
[0m09:40:35.901475 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
alter table "airflow"."lead_staging"."dim_finance__dbt_tmp" rename to "dim_finance"
[0m09:40:35.903450 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:40:35.905770 [debug] [MainThread]: Using postgres connection "master"
[0m09:40:35.906962 [debug] [MainThread]: On master: BEGIN
[0m09:40:35.907033 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: COMMIT
[0m09:40:35.908172 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:40:35.908695 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m09:40:35.909935 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: COMMIT
[0m09:40:35.914112 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m09:40:35.915363 [debug] [MainThread]: On master: COMMIT
[0m09:40:35.916373 [debug] [MainThread]: Using postgres connection "master"
[0m09:40:35.917329 [debug] [MainThread]: On master: COMMIT
[0m09:40:35.918625 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:40:35.919513 [debug] [MainThread]: On master: Close
[0m09:40:35.920600 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:40:35.921434 [debug] [MainThread]: Connection 'model.dbt_lead_data.staging_fact_network_usage' was properly closed.
[0m09:40:35.921619 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m09:40:35.922689 [info ] [MainThread]: 
[0m09:40:35.923926 [info ] [MainThread]: Finished running 5 table models in 2 hours 3 minutes and 18.62 seconds (7398.62s).
[0m09:40:35.925937 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_finance__dbt_backup"
[0m09:40:35.927517 [debug] [MainThread]: Command end result
[0m09:40:35.928186 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m09:40:35.929592 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
drop table if exists "airflow"."lead_staging"."dim_finance__dbt_backup" cascade
[0m09:40:35.941251 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.010 seconds
[0m09:40:35.943839 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: Close
[0m09:40:35.945799 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '440be5e3-d3c6-4da1-ab0a-b0e74eb206fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9c58141d0>]}
[0m09:40:35.947461 [info ] [Thread-1 (]: 3 of 5 OK created sql table model lead_staging.dim_finance ..................... [[32mSELECT 2274886[0m in 936.83s]
[0m09:40:35.949148 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_finance
[0m09:40:35.950358 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_person
[0m09:40:35.951586 [info ] [Thread-1 (]: 4 of 5 START sql table model lead_staging.dim_person ........................... [RUN]
[0m09:40:35.952889 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_finance, now model.dbt_lead_data.staging_dim_person)
[0m09:40:35.954359 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_person
[0m09:40:35.959709 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_person"
[0m09:40:35.963683 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_person
[0m09:40:35.969268 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_person"
[0m09:40:35.972832 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m09:40:35.974610 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: BEGIN
[0m09:40:35.975785 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:40:35.982004 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m09:40:35.983315 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m09:40:35.984968 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */

  
    

  create  table "airflow"."lead_staging"."dim_person__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        person_name,
        user_name,
        email,
        phone,
        birth_date,
        personal_number
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m09:40:36.014646 [info ] [MainThread]: 
[0m09:40:36.016479 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:40:36.017422 [info ] [MainThread]: 
[0m09:40:36.018467 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m09:40:36.020387 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7400.0107, "process_user_time": 868.72595, "process_kernel_time": 44.39403, "process_mem_max_rss": "120156", "process_in_blocks": "280", "process_out_blocks": "0"}
[0m09:40:36.021508 [debug] [MainThread]: Command `dbt run` succeeded at 09:40:36.021358 after 7400.01 seconds
[0m09:40:36.022628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1db9b89100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1db9898230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1db7f3eab0>]}
[0m09:40:36.024229 [debug] [MainThread]: Flushing usage events
[0m09:40:37.791424 [debug] [Thread-1 (]: SQL status: SELECT 2274886 in 945.820 seconds
[0m09:40:37.794935 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m09:40:37.795812 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
alter table "airflow"."lead_staging"."dim_person" rename to "dim_person__dbt_backup"
[0m09:40:37.797410 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:40:37.800666 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m09:40:37.801399 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
alter table "airflow"."lead_staging"."dim_person__dbt_tmp" rename to "dim_person"
[0m09:40:37.802695 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:40:37.805043 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: COMMIT
[0m09:40:37.805920 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m09:40:37.806860 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: COMMIT
[0m09:40:37.814571 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m09:40:37.818668 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_person__dbt_backup"
[0m09:40:37.820238 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m09:40:37.821002 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
drop table if exists "airflow"."lead_staging"."dim_person__dbt_backup" cascade
[0m09:40:37.832134 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.010 seconds
[0m09:40:37.834248 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: Close
[0m09:40:37.835288 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '858b9c1b-d9ba-4fd1-90d7-6758927c7f65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44eabde0c0>]}
[0m09:40:37.836405 [info ] [Thread-1 (]: 4 of 5 OK created sql table model lead_staging.dim_person ...................... [[32mSELECT 2274886[0m in 946.18s]
[0m09:40:37.837402 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_person
[0m09:40:37.838199 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_fact_network_usage
[0m09:40:37.839039 [info ] [Thread-1 (]: 5 of 5 START sql table model lead_staging.fact_network_usage ................... [RUN]
[0m09:40:37.839892 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_person, now model.dbt_lead_data.staging_fact_network_usage)
[0m09:40:37.840884 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_fact_network_usage
[0m09:40:37.844701 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_fact_network_usage"
[0m09:40:37.847070 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_fact_network_usage
[0m09:40:37.851756 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_fact_network_usage"
[0m09:40:37.854052 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m09:40:37.854685 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: BEGIN
[0m09:40:37.855394 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:40:37.860479 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m09:40:37.861386 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m09:40:37.862213 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */

  
    

  create  table "airflow"."lead_staging"."fact_network_usage__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        session_duration,
        download_speed,
        upload_speed,
        consumed_traffic
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m09:40:43.571523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be8cda270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be82d6270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be8af8dd0>]}


============================== 09:40:43.616849 | 11fc619e-77ee-44b9-bb5f-5e5da235936b ==============================
[0m09:40:43.616849 [info ] [MainThread]: Running with dbt=1.8.0
[0m09:40:43.623653 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select tag:trusted', 'send_anonymous_usage_stats': 'True'}
[0m09:40:45.525009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '11fc619e-77ee-44b9-bb5f-5e5da235936b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be7e7a270>]}
[0m09:40:46.002585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '11fc619e-77ee-44b9-bb5f-5e5da235936b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be859c320>]}
[0m09:40:46.011693 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m09:40:46.378622 [debug] [Thread-1 (]: SQL status: SELECT 1863250 in 6434.274 seconds
[0m09:40:46.424016 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m09:40:46.430577 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
alter table "airflow"."lead_staging"."dim_address" rename to "dim_address__dbt_backup"
[0m09:40:46.440050 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:40:46.467601 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m09:40:46.475051 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
alter table "airflow"."lead_staging"."dim_address__dbt_tmp" rename to "dim_address"
[0m09:40:46.485725 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:40:46.659870 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m09:40:46.665765 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m09:40:46.670855 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m09:40:46.698522 [debug] [Thread-1 (]: SQL status: COMMIT in 0.022 seconds
[0m09:40:46.754863 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_address__dbt_backup"
[0m09:40:46.790514 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m09:40:46.801996 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m09:40:46.807859 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
drop table if exists "airflow"."lead_staging"."dim_address__dbt_backup" cascade
[0m09:40:46.933116 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.119 seconds
[0m09:40:46.954330 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: Close
[0m09:40:46.972276 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18c691e4-c1f6-4649-be2f-fbc27ca262cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe93c659d60>]}
[0m09:40:46.982810 [info ] [Thread-1 (]: 1 of 5 OK created sql table model lead_staging.dim_address ..................... [[32mSELECT 1863250[0m in 6435.29s]
[0m09:40:46.993744 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_adress
[0m09:40:47.000857 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_date
[0m09:40:47.008023 [info ] [Thread-1 (]: 2 of 5 START sql table model lead_staging.dim_date ............................. [RUN]
[0m09:40:47.015970 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_adress, now model.dbt_lead_data.staging_dim_date)
[0m09:40:47.020951 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_date
[0m09:40:47.045822 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_date"
[0m09:40:47.061834 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_date
[0m09:40:47.103930 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_date"
[0m09:40:47.119401 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m09:40:47.125785 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: BEGIN
[0m09:40:47.134799 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:40:47.168890 [debug] [Thread-1 (]: SQL status: BEGIN in 0.034 seconds
[0m09:40:47.175074 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m09:40:47.181747 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */

  
    

  create  table "airflow"."lead_staging"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        accessed_at
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m09:40:48.229705 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:40:48.234544 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:40:48.523814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '11fc619e-77ee-44b9-bb5f-5e5da235936b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be7911b20>]}
[0m09:40:49.712068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '11fc619e-77ee-44b9-bb5f-5e5da235936b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be75a5700>]}
[0m09:40:49.728390 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m09:40:49.742050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11fc619e-77ee-44b9-bb5f-5e5da235936b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be786c710>]}
[0m09:40:49.765801 [info ] [MainThread]: 
[0m09:40:49.776429 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:40:49.827834 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m09:40:50.199724 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m09:40:50.205125 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m09:40:50.209588 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:40:50.250629 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.041 seconds
[0m09:40:50.265797 [debug] [ThreadPool]: On list_airflow: Close
[0m09:40:50.296950 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_trusted)
[0m09:40:50.350932 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m09:40:50.356071 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m09:40:50.360629 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:40:50.388139 [debug] [ThreadPool]: SQL status: BEGIN in 0.027 seconds
[0m09:40:50.392842 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m09:40:50.397742 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m09:40:50.433740 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.030 seconds
[0m09:40:50.447093 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m09:40:50.454315 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m09:40:50.463883 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now list_airflow_lead_staging)
[0m09:40:50.493636 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m09:40:50.500008 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m09:40:50.505843 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:40:50.536041 [debug] [ThreadPool]: SQL status: BEGIN in 0.031 seconds
[0m09:40:50.544122 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m09:40:50.551287 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m09:40:50.572692 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.016 seconds
[0m09:40:50.585104 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m09:40:50.592712 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m09:40:50.663825 [debug] [MainThread]: Using postgres connection "master"
[0m09:40:50.670647 [debug] [MainThread]: On master: BEGIN
[0m09:40:50.677990 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:40:50.713419 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m09:40:50.720788 [debug] [MainThread]: Using postgres connection "master"
[0m09:40:50.728895 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:40:50.787046 [debug] [MainThread]: SQL status: SELECT 0 in 0.030 seconds
[0m09:40:50.810890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11fc619e-77ee-44b9-bb5f-5e5da235936b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be7911c70>]}
[0m09:40:50.819896 [debug] [MainThread]: On master: ROLLBACK
[0m09:40:50.835851 [debug] [MainThread]: Using postgres connection "master"
[0m09:40:50.850659 [debug] [MainThread]: On master: BEGIN
[0m09:40:50.903097 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m09:40:50.923087 [debug] [MainThread]: On master: COMMIT
[0m09:40:50.931119 [debug] [MainThread]: Using postgres connection "master"
[0m09:40:50.950842 [debug] [MainThread]: On master: COMMIT
[0m09:40:50.976082 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m09:40:50.995512 [debug] [MainThread]: On master: Close
[0m09:40:51.006273 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:40:51.016761 [info ] [MainThread]: 
[0m09:40:51.147032 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_non_pii_data
[0m09:40:51.158791 [info ] [Thread-1 (]: 1 of 4 START sql table model lead_trusted.non_pii_data ......................... [RUN]
[0m09:40:51.169089 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now model.dbt_lead_data.trusted_non_pii_data)
[0m09:40:51.184997 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_non_pii_data
[0m09:40:51.282844 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_non_pii_data"
[0m09:40:51.305744 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_non_pii_data
[0m09:40:51.959750 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_non_pii_data"
[0m09:40:51.999747 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m09:40:52.014972 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: BEGIN
[0m09:40:52.026611 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:40:52.070240 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m09:40:52.077053 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m09:40:52.084810 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */

  
    

  create  table "airflow"."lead_trusted"."non_pii_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        '***MASKED***' AS person_name,
        SUBSTRING(dp.user_name, 1, 5) || '*****'  user_name,
        SUBSTRING(dp.email, 1, 5) || '*****' AS email,
        '***MASKED***'  AS personal_number, 
        '***MASKED***' AS birth_date, 
        '***MASKED***' AS address,
        '***MASKED***'  AS phone, 
        SUBSTRING(da.mac_address, 1, 5) || '*****' AS mac_address,
        SUBSTRING(da.ip_address, 1, 5) || '*****' AS ip_address,
        SUBSTRING(df.iban, 1, 5) || '*****' AS iban,
        dd.accessed_at,
        fnu.session_duration,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.consumed_traffic,
        fnu.unique_id
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    INNER JOIN
        "airflow"."lead_staging"."dim_address" da ON fnu.unique_id = da.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_date" dd ON da.unique_id = dd.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_finance" df ON dd.unique_id = df.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_person" dp ON df.unique_id = dp.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m09:40:53.713778 [debug] [Thread-1 (]: SQL status: SELECT 2274886 in 18.771 seconds
[0m09:40:53.747486 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m09:40:53.751721 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
alter table "airflow"."lead_staging"."dim_date" rename to "dim_date__dbt_backup"
[0m09:40:56.403164 [debug] [Thread-1 (]: SQL status: SELECT 2274886 in 21.022 seconds
[0m09:40:56.431203 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m09:40:56.436782 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
alter table "airflow"."lead_staging"."dim_finance" rename to "dim_finance__dbt_backup"
[0m09:56:25.417314 [debug] [Thread-1 (]: SQL status: SELECT 2274886 in 947.569 seconds
[0m09:56:25.422890 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m09:56:25.423802 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
alter table "airflow"."lead_staging"."fact_network_usage" rename to "fact_network_usage__dbt_backup"
[0m09:56:26.521527 [debug] [Thread-1 (]: SQL status: SELECT 2274886 in 950.549 seconds
[0m09:56:26.525703 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m09:56:26.526612 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
alter table "airflow"."lead_staging"."dim_person" rename to "dim_person__dbt_backup"
[0m09:56:26.908394 [debug] [Thread-1 (]: SQL status: SELECT 1863250 in 7367.453 seconds
[0m09:56:26.919005 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m09:56:26.920176 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
alter table "airflow"."lead_staging"."dim_address" rename to "dim_address__dbt_backup"
[0m11:10:38.855405 [debug] [Thread-1 (]: SQL status: SELECT 21225910 in 5386.688 seconds
[0m11:10:38.863716 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m11:10:38.864533 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
alter table "airflow"."lead_trusted"."non_pii_data" rename to "non_pii_data__dbt_backup"
[0m11:10:38.867495 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m11:10:38.871448 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m11:10:38.872223 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
alter table "airflow"."lead_trusted"."non_pii_data__dbt_tmp" rename to "non_pii_data"
[0m11:10:38.873355 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:10:38.894877 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: COMMIT
[0m11:10:38.895690 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m11:10:38.896505 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: COMMIT
[0m11:10:38.901690 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m11:10:38.902271 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 5382.390 seconds
[0m11:10:38.902049 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 4452.288 seconds
[0m11:10:38.902141 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 4453.391 seconds
[0m11:10:38.902345 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 5385.075 seconds
[0m11:10:38.902412 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 4451.895 seconds
[0m11:10:38.906279 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m11:10:38.906578 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m11:10:38.907070 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m11:10:38.907115 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
alter table "airflow"."lead_staging"."dim_finance__dbt_tmp" rename to "dim_finance"
[0m11:10:38.907422 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
alter table "airflow"."lead_staging"."dim_person__dbt_tmp" rename to "dim_person"
[0m11:10:38.907511 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m11:10:38.908012 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
alter table "airflow"."lead_staging"."fact_network_usage__dbt_tmp" rename to "fact_network_usage"
[0m11:10:38.908030 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m11:10:38.908639 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:10:38.909064 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:10:38.909058 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
alter table "airflow"."lead_staging"."dim_date__dbt_tmp" rename to "dim_date"
[0m11:10:38.909722 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:10:38.909622 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
alter table "airflow"."lead_staging"."dim_address__dbt_tmp" rename to "dim_address"
[0m11:10:38.909797 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."non_pii_data__dbt_backup"
[0m11:10:38.911142 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:10:38.911925 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:10:38.911977 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: COMMIT
[0m11:10:38.912064 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: COMMIT
[0m11:10:38.912856 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: COMMIT
[0m11:10:38.912947 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m11:10:38.913217 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m11:10:38.913554 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m11:10:38.913923 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: COMMIT
[0m11:10:38.914109 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: COMMIT
[0m11:10:38.914133 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: COMMIT
[0m11:10:38.914399 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: COMMIT
[0m11:10:38.915310 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m11:10:38.915589 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m11:10:38.916079 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: COMMIT
[0m11:10:38.917016 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m11:10:38.917284 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m11:10:38.917789 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m11:10:38.918344 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m11:10:38.918397 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_finance__dbt_backup"
[0m11:10:38.918804 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
drop table if exists "airflow"."lead_trusted"."non_pii_data__dbt_backup" cascade
[0m11:10:38.920132 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m11:10:38.920414 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_person__dbt_backup"
[0m11:10:38.920580 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."fact_network_usage__dbt_backup"
[0m11:10:38.920868 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
drop table if exists "airflow"."lead_staging"."dim_finance__dbt_backup" cascade
[0m11:10:38.921739 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m11:10:38.922407 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m11:10:38.922066 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_date__dbt_backup"
[0m11:10:38.922919 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
drop table if exists "airflow"."lead_staging"."dim_person__dbt_backup" cascade
[0m11:10:38.923366 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
drop table if exists "airflow"."lead_staging"."fact_network_usage__dbt_backup" cascade
[0m11:10:38.924329 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m11:10:38.925206 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
drop table if exists "airflow"."lead_staging"."dim_date__dbt_backup" cascade
[0m11:10:38.928299 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m11:10:38.929420 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m11:10:38.930342 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: Close
[0m11:10:38.931022 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m11:10:38.931445 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4be254de-39c3-47d9-b193-d02a992c87e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e94628ad0>]}
[0m11:10:38.931561 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: Close
[0m11:10:38.932493 [info ] [Thread-1 (]: 3 of 5 OK created sql table model lead_staging.dim_finance ..................... [[32mSELECT 2274886[0m in 5403.58s]
[0m11:10:38.932979 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '858b9c1b-d9ba-4fd1-90d7-6758927c7f65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44eab7d4f0>]}
[0m11:10:38.933337 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: Close
[0m11:10:38.933667 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_finance
[0m11:10:38.934215 [info ] [Thread-1 (]: 5 of 5 OK created sql table model lead_staging.fact_network_usage .............. [[32mSELECT 2274886[0m in 5401.09s]
[0m11:10:38.934541 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98b27b92-abdf-402b-b3de-015296a5e739', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72611083b0>]}
[0m11:10:38.934982 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_person
[0m11:10:38.935357 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_fact_network_usage
[0m11:10:38.935741 [info ] [Thread-1 (]: 2 of 5 OK created sql table model lead_staging.dim_date ........................ [[32mSELECT 2274886[0m in 5404.03s]
[0m11:10:38.936137 [info ] [Thread-1 (]: 4 of 5 START sql table model lead_staging.dim_person ........................... [RUN]
[0m11:10:38.936518 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.012 seconds
[0m11:10:38.937157 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m11:10:38.937320 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_date
[0m11:10:38.937596 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_finance, now model.dbt_lead_data.staging_dim_person)
[0m11:10:38.938290 [debug] [MainThread]: Using postgres connection "master"
[0m11:10:38.938393 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m11:10:38.938844 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_finance
[0m11:10:38.939138 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_person
[0m11:10:38.939363 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: Close
[0m11:10:38.939379 [debug] [MainThread]: On master: BEGIN
[0m11:10:38.939835 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m11:10:38.940402 [info ] [Thread-1 (]: 3 of 5 START sql table model lead_staging.dim_finance .......................... [RUN]
[0m11:10:38.941501 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:10:38.941275 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '440be5e3-d3c6-4da1-ab0a-b0e74eb206fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9c65d1910>]}
[0m11:10:38.942379 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_date, now model.dbt_lead_data.staging_dim_finance)
[0m11:10:38.943229 [info ] [Thread-1 (]: 4 of 5 OK created sql table model lead_staging.dim_person ...................... [[32mSELECT 2274886[0m in 5402.99s]
[0m11:10:38.943416 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_finance
[0m11:10:38.944179 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_person"
[0m11:10:38.943356 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m11:10:38.944686 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_person
[0m11:10:38.945856 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_fact_network_usage
[0m11:10:38.946887 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m11:10:38.947004 [info ] [Thread-1 (]: 5 of 5 START sql table model lead_staging.fact_network_usage ................... [RUN]
[0m11:10:38.947833 [debug] [MainThread]: On master: COMMIT
[0m11:10:38.947696 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_person
[0m11:10:38.948316 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_person, now model.dbt_lead_data.staging_fact_network_usage)
[0m11:10:38.948576 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_finance"
[0m11:10:38.948613 [debug] [MainThread]: Using postgres connection "master"
[0m11:10:38.949296 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_fact_network_usage
[0m11:10:38.949900 [debug] [MainThread]: On master: COMMIT
[0m11:10:38.950850 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:10:38.951313 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_finance
[0m11:10:38.951783 [debug] [MainThread]: On master: Close
[0m11:10:38.953051 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_address__dbt_backup"
[0m11:10:38.953055 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:10:38.954188 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_fact_network_usage"
[0m11:10:38.954414 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_person"
[0m11:10:38.954350 [debug] [MainThread]: Connection 'model.dbt_lead_data.staging_fact_network_usage' was properly closed.
[0m11:10:38.954461 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.035 seconds
[0m11:10:38.956241 [info ] [MainThread]: 
[0m11:10:38.957302 [info ] [MainThread]: Finished running 5 table models in 3 hours 2 minutes and 50.66 seconds (10970.66s).
[0m11:10:38.957210 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_fact_network_usage
[0m11:10:38.958357 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m11:10:38.959208 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: BEGIN
[0m11:10:38.959195 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_finance"
[0m11:10:38.959892 [debug] [MainThread]: Command end result
[0m11:10:38.960024 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: Close
[0m11:10:38.960682 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m11:10:38.960121 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:10:38.961726 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
drop table if exists "airflow"."lead_staging"."dim_address__dbt_backup" cascade
[0m11:10:38.962165 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m11:10:38.962677 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11fc619e-77ee-44b9-bb5f-5e5da235936b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be97d5b80>]}
[0m11:10:38.962662 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_fact_network_usage"
[0m11:10:38.963167 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: BEGIN
[0m11:10:38.964023 [info ] [Thread-1 (]: 1 of 4 OK created sql table model lead_trusted.non_pii_data .................... [[32mSELECT 21225910[0m in 5387.80s]
[0m11:10:38.964387 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:10:38.965486 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_non_pii_data
[0m11:10:38.966001 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m11:10:38.966639 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m11:10:38.966805 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_payment_data
[0m11:10:38.968116 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m11:10:38.967168 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: BEGIN
[0m11:10:38.969476 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */

  
    

  create  table "airflow"."lead_staging"."dim_person__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        person_name,
        user_name,
        email,
        phone,
        birth_date,
        personal_number
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m11:10:38.969249 [info ] [Thread-1 (]: 2 of 4 START sql table model lead_trusted.payment_data ......................... [RUN]
[0m11:10:38.970142 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:10:38.970976 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m11:10:38.971236 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_non_pii_data, now model.dbt_lead_data.trusted_payment_data)
[0m11:10:38.971991 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m11:10:38.972873 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_payment_data
[0m11:10:38.973275 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */

  
    

  create  table "airflow"."lead_staging"."dim_finance__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        iban
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m11:10:38.974754 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.012 seconds
[0m11:10:38.976221 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m11:10:38.977277 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m11:10:38.978171 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_payment_data"
[0m11:10:38.978586 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */

  
    

  create  table "airflow"."lead_staging"."fact_network_usage__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        session_duration,
        download_speed,
        upload_speed,
        consumed_traffic
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m11:10:38.978654 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: Close
[0m11:10:38.982042 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_payment_data
[0m11:10:38.982138 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '358fe6b1-1a07-470c-bb26-5d085e983b3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a93911760>]}
[0m11:10:38.983676 [info ] [Thread-1 (]: 1 of 5 OK created sql table model lead_staging.dim_address ..................... [[32mSELECT 1863250[0m in 11819.89s]
[0m11:10:38.985323 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_adress
[0m11:10:38.986374 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_date
[0m11:10:38.987026 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_payment_data"
[0m11:10:38.987415 [info ] [Thread-1 (]: 2 of 5 START sql table model lead_staging.dim_date ............................. [RUN]
[0m11:10:38.989217 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_adress, now model.dbt_lead_data.staging_dim_date)
[0m11:10:38.990150 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_date
[0m11:10:38.990917 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m11:10:38.991649 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: BEGIN
[0m11:10:38.992609 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:10:38.994972 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_date"
[0m11:10:38.997321 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_date
[0m11:10:38.997986 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m11:10:38.998949 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m11:10:39.000311 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */

  
    

  create  table "airflow"."lead_trusted"."payment_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        fnu.unique_id,
        df.iban,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.session_duration,
        fnu.consumed_traffic,
        ((fnu.download_speed + fnu.upload_speed + 1)/2) + (fnu.consumed_traffic / (fnu.session_duration + 1)) AS payment_amount
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    JOIN
        "airflow"."lead_staging"."dim_finance" df
    ON
	    fnu.unique_id = df.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m11:10:39.003529 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_date"
[0m11:10:39.006914 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m11:10:39.008090 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: BEGIN
[0m11:10:39.009044 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:10:39.014537 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m11:10:39.015427 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m11:10:39.016399 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */

  
    

  create  table "airflow"."lead_staging"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        accessed_at
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m11:10:39.037232 [info ] [MainThread]: 
[0m11:10:39.038928 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:10:39.040593 [info ] [MainThread]: 
[0m11:10:39.042091 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m11:10:39.044346 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10975.911, "process_user_time": 15.242701, "process_kernel_time": 0.93521, "process_mem_max_rss": "120672", "process_in_blocks": "3288", "process_out_blocks": "0"}
[0m11:10:39.046322 [debug] [MainThread]: Command `dbt run` succeeded at 11:10:39.046011 after 10975.91 seconds
[0m11:10:39.048072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44edde3350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44ee420ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44edf182f0>]}
[0m11:10:39.049280 [debug] [MainThread]: Flushing usage events
[0m11:26:23.561079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb268416270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb26a556d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb269e747a0>]}


============================== 11:26:23.570546 | c1a5d2df-7e2c-4e6d-bc53-ff639c4ad670 ==============================
[0m11:26:23.570546 [info ] [MainThread]: Running with dbt=1.8.0
[0m11:26:23.571830 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select tag:trusted', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:26:23.935400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c1a5d2df-7e2c-4e6d-bc53-ff639c4ad670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2691f2f30>]}
[0m11:26:24.019039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c1a5d2df-7e2c-4e6d-bc53-ff639c4ad670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb267741af0>]}
[0m11:26:24.021752 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:26:24.151405 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m11:26:24.381758 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:26:24.382604 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:26:24.426301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1a5d2df-7e2c-4e6d-bc53-ff639c4ad670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2677411f0>]}
[0m11:26:24.647465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c1a5d2df-7e2c-4e6d-bc53-ff639c4ad670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2673159a0>]}
[0m11:26:24.649794 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m11:26:24.654837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1a5d2df-7e2c-4e6d-bc53-ff639c4ad670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb266b318e0>]}
[0m11:26:24.659920 [info ] [MainThread]: 
[0m11:26:24.664712 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:26:24.674351 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m11:26:24.743916 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m11:26:24.745340 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m11:26:24.747084 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:26:24.755639 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.009 seconds
[0m11:26:24.757814 [debug] [ThreadPool]: On list_airflow: Close
[0m11:26:24.761193 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_trusted)
[0m11:26:24.768789 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m11:26:24.769802 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m11:26:24.770709 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:26:24.776173 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m11:26:24.777206 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m11:26:24.778240 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m11:26:24.783744 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m11:26:24.787269 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m11:26:24.788707 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m11:26:24.790544 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now list_airflow_lead_staging)
[0m11:26:24.795451 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m11:26:24.796402 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m11:26:24.797276 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:26:24.803736 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m11:26:24.805202 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m11:26:24.806171 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m11:26:24.810329 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.003 seconds
[0m11:26:24.812879 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m11:26:24.814462 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m11:26:24.824866 [debug] [MainThread]: Using postgres connection "master"
[0m11:26:24.825956 [debug] [MainThread]: On master: BEGIN
[0m11:26:24.827277 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:26:24.833441 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m11:26:24.834658 [debug] [MainThread]: Using postgres connection "master"
[0m11:26:24.835820 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:26:24.842140 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m11:26:24.845180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1a5d2df-7e2c-4e6d-bc53-ff639c4ad670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb26539cda0>]}
[0m11:26:24.846336 [debug] [MainThread]: On master: ROLLBACK
[0m11:26:24.847592 [debug] [MainThread]: Using postgres connection "master"
[0m11:26:24.848668 [debug] [MainThread]: On master: BEGIN
[0m11:26:24.850303 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m11:26:24.851301 [debug] [MainThread]: On master: COMMIT
[0m11:26:24.852090 [debug] [MainThread]: Using postgres connection "master"
[0m11:26:24.853057 [debug] [MainThread]: On master: COMMIT
[0m11:26:24.854291 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:26:24.855253 [debug] [MainThread]: On master: Close
[0m11:26:24.856385 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:26:24.857430 [info ] [MainThread]: 
[0m11:26:24.871326 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_non_pii_data
[0m11:26:24.872543 [info ] [Thread-1 (]: 1 of 4 START sql table model lead_trusted.non_pii_data ......................... [RUN]
[0m11:26:24.874105 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now model.dbt_lead_data.trusted_non_pii_data)
[0m11:26:24.875055 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_non_pii_data
[0m11:26:24.889095 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_non_pii_data"
[0m11:26:24.893640 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_non_pii_data
[0m11:26:24.959175 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_non_pii_data"
[0m11:26:24.963723 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m11:26:24.965099 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: BEGIN
[0m11:26:24.965986 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:26:24.972739 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m11:26:24.974608 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m11:26:24.976304 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */

  
    

  create  table "airflow"."lead_trusted"."non_pii_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        '***MASKED***' AS person_name,
        SUBSTRING(dp.user_name, 1, 5) || '*****'  user_name,
        SUBSTRING(dp.email, 1, 5) || '*****' AS email,
        '***MASKED***'  AS personal_number, 
        '***MASKED***' AS birth_date, 
        '***MASKED***' AS address,
        '***MASKED***'  AS phone, 
        SUBSTRING(da.mac_address, 1, 5) || '*****' AS mac_address,
        SUBSTRING(da.ip_address, 1, 5) || '*****' AS ip_address,
        SUBSTRING(df.iban, 1, 5) || '*****' AS iban,
        dd.accessed_at,
        fnu.session_duration,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.consumed_traffic,
        fnu.unique_id
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    INNER JOIN
        "airflow"."lead_staging"."dim_address" da ON fnu.unique_id = da.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_date" dd ON da.unique_id = dd.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_finance" df ON dd.unique_id = df.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_person" dp ON df.unique_id = dp.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m11:26:25.376331 [debug] [Thread-1 (]: SQL status: SELECT 2274886 in 6338.088 seconds
[0m11:26:25.380798 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m11:26:25.381765 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
alter table "airflow"."lead_staging"."dim_date" rename to "dim_date__dbt_backup"
[0m11:26:25.613866 [debug] [Thread-1 (]: SQL status: SELECT 2274886 in 946.611 seconds
[0m11:26:25.615297 [debug] [Thread-1 (]: SQL status: SELECT 2274886 in 946.607 seconds
[0m11:26:25.622958 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m11:26:25.624762 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
alter table "airflow"."lead_staging"."dim_finance" rename to "dim_finance__dbt_backup"
[0m11:26:25.627192 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m11:26:25.628438 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
alter table "airflow"."lead_staging"."fact_network_usage" rename to "fact_network_usage__dbt_backup"
[0m11:26:26.402954 [debug] [Thread-1 (]: SQL status: SELECT 2274886 in 947.404 seconds
[0m11:26:26.406715 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m11:26:26.407546 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
alter table "airflow"."lead_staging"."dim_person" rename to "dim_person__dbt_backup"
[0m11:42:33.439249 [debug] [Thread-1 (]: SQL status: SELECT 3977366 in 1914.421 seconds
[0m11:42:33.445046 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m11:42:33.445980 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
alter table "airflow"."lead_trusted"."payment_data" rename to "payment_data__dbt_backup"
[0m11:42:33.448279 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:42:33.452768 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m11:42:33.453729 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
alter table "airflow"."lead_trusted"."payment_data__dbt_tmp" rename to "payment_data"
[0m11:42:33.455240 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:42:33.458447 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: COMMIT
[0m11:42:33.459383 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m11:42:33.460245 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: COMMIT
[0m11:42:33.468872 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m11:42:33.473357 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."payment_data__dbt_backup"
[0m11:42:33.475298 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m11:42:33.476524 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
drop table if exists "airflow"."lead_trusted"."payment_data__dbt_backup" cascade
[0m11:42:33.487469 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.010 seconds
[0m11:42:33.490396 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: Close
[0m11:42:33.491616 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11fc619e-77ee-44b9-bb5f-5e5da235936b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be6d727b0>]}
[0m11:42:33.492822 [info ] [Thread-1 (]: 2 of 4 OK created sql table model lead_trusted.payment_data .................... [[32mSELECT 3977366[0m in 1914.52s]
[0m11:42:33.494333 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_payment_data
[0m11:42:33.495356 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_pii_data
[0m11:42:33.496730 [info ] [Thread-1 (]: 3 of 4 START sql table model lead_trusted.pii_data ............................. [RUN]
[0m11:42:33.497977 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_payment_data, now model.dbt_lead_data.trusted_pii_data)
[0m11:42:33.499067 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_pii_data
[0m11:42:33.504902 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_pii_data"
[0m11:42:33.509009 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_pii_data
[0m11:42:33.515598 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_pii_data"
[0m11:42:33.519073 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m11:42:33.520014 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: BEGIN
[0m11:42:33.520895 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:42:33.525847 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m11:42:33.526951 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m11:42:33.528573 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */

  
    

  create  table "airflow"."lead_trusted"."pii_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        dp.person_name,
        dp.user_name,
        dp.email,
        dp.personal_number, 
        dp.birth_date, 
        da.address,
        dp.phone, 
        da.mac_address,
        da.ip_address,
        df.iban,
        dd.accessed_at,
        fnu.session_duration,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.consumed_traffic,
        fnu.unique_id
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    INNER JOIN
        "airflow"."lead_staging"."dim_address" da ON fnu.unique_id = da.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_date" dd ON da.unique_id = dd.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_finance" df ON dd.unique_id = df.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_person" dp ON df.unique_id = dp.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m12:44:01.950030 [debug] [Thread-1 (]: SQL status: SELECT 21225910 in 4656.966 seconds
[0m12:44:01.960039 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m12:44:01.960937 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
alter table "airflow"."lead_trusted"."non_pii_data" rename to "non_pii_data__dbt_backup"
[0m12:44:02.963819 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 1.002 seconds
[0m12:44:02.968614 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m12:44:02.969648 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
alter table "airflow"."lead_trusted"."non_pii_data__dbt_tmp" rename to "non_pii_data"
[0m12:44:02.971031 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:44:02.993843 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: COMMIT
[0m12:44:02.994733 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m12:44:02.995642 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: COMMIT
[0m12:44:02.997714 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:44:02.998033 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 4656.584 seconds
[0m12:44:02.998081 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 4657.363 seconds
[0m12:44:02.998163 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 4657.367 seconds
[0m12:44:02.998123 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 4657.610 seconds
[0m12:44:03.002185 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m12:44:03.002670 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m12:44:03.002951 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m12:44:03.003225 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
alter table "airflow"."lead_staging"."dim_person__dbt_tmp" rename to "dim_person"
[0m12:44:03.003241 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m12:44:03.003607 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
alter table "airflow"."lead_staging"."fact_network_usage__dbt_tmp" rename to "fact_network_usage"
[0m12:44:03.003941 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
alter table "airflow"."lead_staging"."dim_finance__dbt_tmp" rename to "dim_finance"
[0m12:44:03.004736 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
alter table "airflow"."lead_staging"."dim_date__dbt_tmp" rename to "dim_date"
[0m12:44:03.005159 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."non_pii_data__dbt_backup"
[0m12:44:03.005156 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:44:03.005956 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:44:03.005939 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:44:03.006785 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:44:03.008618 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: COMMIT
[0m12:44:03.009117 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: COMMIT
[0m12:44:03.009359 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: COMMIT
[0m12:44:03.009526 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m12:44:03.010082 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m12:44:03.009738 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: COMMIT
[0m12:44:03.010458 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m12:44:03.010680 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: COMMIT
[0m12:44:03.010983 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: COMMIT
[0m12:44:03.011419 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m12:44:03.011642 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: COMMIT
[0m12:44:03.012719 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: COMMIT
[0m12:44:03.012759 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:44:03.012798 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m12:44:03.013163 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:44:03.013697 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:44:03.014256 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:44:03.014249 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
drop table if exists "airflow"."lead_trusted"."non_pii_data__dbt_backup" cascade
[0m12:44:03.016693 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_person__dbt_backup"
[0m12:44:03.016934 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_finance__dbt_backup"
[0m12:44:03.017689 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."fact_network_usage__dbt_backup"
[0m12:44:03.018160 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_date__dbt_backup"
[0m12:44:03.018451 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m12:44:03.019436 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m12:44:03.019631 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
drop table if exists "airflow"."lead_staging"."dim_person__dbt_backup" cascade
[0m12:44:03.019661 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m12:44:03.019693 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m12:44:03.020406 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
drop table if exists "airflow"."lead_staging"."dim_finance__dbt_backup" cascade
[0m12:44:03.021156 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
drop table if exists "airflow"."lead_staging"."dim_date__dbt_backup" cascade
[0m12:44:03.021588 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
drop table if exists "airflow"."lead_staging"."fact_network_usage__dbt_backup" cascade
[0m12:44:03.028121 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m12:44:03.028396 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m12:44:03.028407 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m12:44:03.029389 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.008 seconds
[0m12:44:03.030577 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: Close
[0m12:44:03.030804 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: Close
[0m12:44:03.031118 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: Close
[0m12:44:03.031676 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '440be5e3-d3c6-4da1-ab0a-b0e74eb206fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9c5812e10>]}
[0m12:44:03.032029 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18c691e4-c1f6-4649-be2f-fbc27ca262cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe933f6b380>]}
[0m12:44:03.032395 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: Close
[0m12:44:03.032489 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98b27b92-abdf-402b-b3de-015296a5e739', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7261131040>]}
[0m12:44:03.032929 [info ] [Thread-1 (]: 5 of 5 OK created sql table model lead_staging.fact_network_usage .............. [[32mSELECT 2274886[0m in 5604.08s]
[0m12:44:03.033262 [info ] [Thread-1 (]: 2 of 5 OK created sql table model lead_staging.dim_date ........................ [[32mSELECT 2274886[0m in 10996.02s]
[0m12:44:03.033962 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4be254de-39c3-47d9-b193-d02a992c87e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e9462bfe0>]}
[0m12:44:03.034173 [info ] [Thread-1 (]: 3 of 5 OK created sql table model lead_staging.dim_finance ..................... [[32mSELECT 2274886[0m in 5604.09s]
[0m12:44:03.034863 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_fact_network_usage
[0m12:44:03.035040 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_date
[0m12:44:03.035913 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_finance
[0m12:44:03.035506 [info ] [Thread-1 (]: 4 of 5 OK created sql table model lead_staging.dim_person ...................... [[32mSELECT 2274886[0m in 5604.10s]
[0m12:44:03.036851 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_finance
[0m12:44:03.037163 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_person
[0m12:44:03.037823 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_person
[0m12:44:03.038043 [info ] [Thread-1 (]: 3 of 5 START sql table model lead_staging.dim_finance .......................... [RUN]
[0m12:44:03.038534 [info ] [Thread-1 (]: 4 of 5 START sql table model lead_staging.dim_person ........................... [RUN]
[0m12:44:03.039359 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_fact_network_usage
[0m12:44:03.039466 [debug] [MainThread]: Using postgres connection "master"
[0m12:44:03.039667 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_date, now model.dbt_lead_data.staging_dim_finance)
[0m12:44:03.040002 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_finance, now model.dbt_lead_data.staging_dim_person)
[0m12:44:03.040571 [debug] [MainThread]: On master: BEGIN
[0m12:44:03.040554 [info ] [Thread-1 (]: 5 of 5 START sql table model lead_staging.fact_network_usage ................... [RUN]
[0m12:44:03.040983 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_finance
[0m12:44:03.041376 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_person
[0m12:44:03.042166 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_person, now model.dbt_lead_data.staging_fact_network_usage)
[0m12:44:03.041671 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:44:03.043178 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_fact_network_usage
[0m12:44:03.046371 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_finance"
[0m12:44:03.046871 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_person"
[0m12:44:03.048432 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m12:44:03.049242 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_fact_network_usage"
[0m12:44:03.049713 [debug] [MainThread]: On master: COMMIT
[0m12:44:03.050774 [debug] [MainThread]: Using postgres connection "master"
[0m12:44:03.050835 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_finance
[0m12:44:03.050961 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_person
[0m12:44:03.051658 [debug] [MainThread]: On master: COMMIT
[0m12:44:03.052419 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_fact_network_usage
[0m12:44:03.052975 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:44:03.053939 [debug] [MainThread]: On master: Close
[0m12:44:03.055173 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:44:03.056088 [debug] [MainThread]: Connection 'model.dbt_lead_data.staging_fact_network_usage' was properly closed.
[0m12:44:03.056851 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_person"
[0m12:44:03.057264 [info ] [MainThread]: 
[0m12:44:03.057789 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_fact_network_usage"
[0m12:44:03.058177 [info ] [MainThread]: Finished running 5 table models in 5 hours 6 minutes and 40.06 seconds (18400.06s).
[0m12:44:03.058793 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_finance"
[0m12:44:03.060719 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m12:44:03.061247 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m12:44:03.061609 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: BEGIN
[0m12:44:03.061850 [debug] [MainThread]: Command end result
[0m12:44:03.062123 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m12:44:03.062326 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: BEGIN
[0m12:44:03.062757 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:44:03.063485 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: BEGIN
[0m12:44:03.063806 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:44:03.064689 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:44:03.069015 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m12:44:03.069778 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m12:44:03.070192 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m12:44:03.070627 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m12:44:03.070957 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m12:44:03.071836 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m12:44:03.072474 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */

  
    

  create  table "airflow"."lead_staging"."dim_person__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        person_name,
        user_name,
        email,
        phone,
        birth_date,
        personal_number
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m12:44:03.072967 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */

  
    

  create  table "airflow"."lead_staging"."fact_network_usage__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        session_duration,
        download_speed,
        upload_speed,
        consumed_traffic
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m12:44:03.073599 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */

  
    

  create  table "airflow"."lead_staging"."dim_finance__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        iban
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m12:44:03.130588 [info ] [MainThread]: 
[0m12:44:03.131820 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:44:03.132756 [info ] [MainThread]: 
[0m12:44:03.133655 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m12:44:03.135321 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 18400.678, "process_user_time": 3.240848, "process_kernel_time": 0.200841, "process_mem_max_rss": "124788", "process_in_blocks": "6744", "process_out_blocks": "0"}
[0m12:44:03.136234 [debug] [MainThread]: Command `dbt run` succeeded at 12:44:03.136071 after 18400.68 seconds
[0m12:44:03.137034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9c89d54c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9c8dd11f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9c7d054c0>]}
[0m12:44:03.137808 [debug] [MainThread]: Flushing usage events
[0m12:44:03.272652 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.257 seconds
[0m12:44:03.276239 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: Close
[0m12:44:03.278793 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1a5d2df-7e2c-4e6d-bc53-ff639c4ad670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2697e1ca0>]}
[0m12:44:03.279988 [info ] [Thread-1 (]: 1 of 4 OK created sql table model lead_trusted.non_pii_data .................... [[32mSELECT 21225910[0m in 4658.40s]
[0m12:44:03.281738 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_non_pii_data
[0m12:44:03.282635 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_payment_data
[0m12:44:03.283901 [info ] [Thread-1 (]: 2 of 4 START sql table model lead_trusted.payment_data ......................... [RUN]
[0m12:44:03.285364 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_non_pii_data, now model.dbt_lead_data.trusted_payment_data)
[0m12:44:03.286457 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_payment_data
[0m12:44:03.292174 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_payment_data"
[0m12:44:03.327843 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_payment_data
[0m12:44:03.335602 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_payment_data"
[0m12:44:03.339572 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m12:44:03.341226 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: BEGIN
[0m12:44:03.342441 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:44:03.349995 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m12:44:03.351415 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m12:44:03.352432 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */

  
    

  create  table "airflow"."lead_trusted"."payment_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        fnu.unique_id,
        df.iban,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.session_duration,
        fnu.consumed_traffic,
        ((fnu.download_speed + fnu.upload_speed + 1)/2) + (fnu.consumed_traffic / (fnu.session_duration + 1)) AS payment_amount
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    JOIN
        "airflow"."lead_staging"."dim_finance" df
    ON
	    fnu.unique_id = df.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m12:59:50.322798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc58a3a8c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc58a53d7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc58a41e630>]}


============================== 12:59:50.335861 | 045c55b2-09cf-46bd-ad93-0c3e28a682fd ==============================
[0m12:59:50.335861 [info ] [MainThread]: Running with dbt=1.8.0
[0m12:59:50.338218 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select tag:trusted', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:59:50.863794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '045c55b2-09cf-46bd-ad93-0c3e28a682fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5896ec470>]}
[0m12:59:50.976176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '045c55b2-09cf-46bd-ad93-0c3e28a682fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc58a269fa0>]}
[0m12:59:50.982546 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:59:51.176116 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m12:59:51.509716 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:59:51.511221 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:59:51.571470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '045c55b2-09cf-46bd-ad93-0c3e28a682fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc588b67aa0>]}
[0m12:59:51.823689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '045c55b2-09cf-46bd-ad93-0c3e28a682fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc587f74c80>]}
[0m12:59:51.825137 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m12:59:51.826385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '045c55b2-09cf-46bd-ad93-0c3e28a682fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc588b662d0>]}
[0m12:59:51.830589 [info ] [MainThread]: 
[0m12:59:51.832584 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:59:51.843202 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m12:59:51.920299 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m12:59:51.921615 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m12:59:51.922717 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:59:51.931281 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.008 seconds
[0m12:59:51.934235 [debug] [ThreadPool]: On list_airflow: Close
[0m12:59:51.939290 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_lead_staging'
[0m12:59:51.950731 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m12:59:51.951986 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m12:59:51.952806 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:59:51.959090 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m12:59:51.960342 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m12:59:51.961357 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m12:59:51.967065 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.004 seconds
[0m12:59:51.970443 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m12:59:51.972207 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m12:59:51.974472 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now list_airflow_lead_trusted)
[0m12:59:51.982094 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m12:59:51.984179 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m12:59:51.985512 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:59:51.993438 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m12:59:51.995138 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m12:59:51.996660 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m12:59:52.003185 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m12:59:52.007104 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m12:59:52.008851 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m12:59:52.028426 [debug] [MainThread]: Using postgres connection "master"
[0m12:59:52.030138 [debug] [MainThread]: On master: BEGIN
[0m12:59:52.031853 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:59:52.039458 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m12:59:52.040957 [debug] [MainThread]: Using postgres connection "master"
[0m12:59:52.042523 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:59:52.053672 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m12:59:52.057748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '045c55b2-09cf-46bd-ad93-0c3e28a682fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc58af58aa0>]}
[0m12:59:52.059694 [debug] [MainThread]: On master: ROLLBACK
[0m12:59:52.061592 [debug] [MainThread]: Using postgres connection "master"
[0m12:59:52.062627 [debug] [MainThread]: On master: BEGIN
[0m12:59:52.064215 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:59:52.065405 [debug] [MainThread]: On master: COMMIT
[0m12:59:52.066476 [debug] [MainThread]: Using postgres connection "master"
[0m12:59:52.067401 [debug] [MainThread]: On master: COMMIT
[0m12:59:52.068646 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:59:52.070035 [debug] [MainThread]: On master: Close
[0m12:59:52.071280 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:59:52.072257 [info ] [MainThread]: 
[0m12:59:52.087227 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_non_pii_data
[0m12:59:52.088566 [info ] [Thread-1 (]: 1 of 4 START sql table model lead_trusted.non_pii_data ......................... [RUN]
[0m12:59:52.090169 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now model.dbt_lead_data.trusted_non_pii_data)
[0m12:59:52.091209 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_non_pii_data
[0m12:59:52.105421 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_non_pii_data"
[0m12:59:52.109214 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_non_pii_data
[0m12:59:52.165852 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_non_pii_data"
[0m12:59:52.169400 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m12:59:52.170443 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: BEGIN
[0m12:59:52.171323 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:59:52.176986 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m12:59:52.177909 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m12:59:52.179308 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */

  
    

  create  table "airflow"."lead_trusted"."non_pii_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        '***MASKED***' AS person_name,
        SUBSTRING(dp.user_name, 1, 5) || '*****'  user_name,
        SUBSTRING(dp.email, 1, 5) || '*****' AS email,
        '***MASKED***'  AS personal_number, 
        '***MASKED***' AS birth_date, 
        '***MASKED***' AS address,
        '***MASKED***'  AS phone, 
        SUBSTRING(da.mac_address, 1, 5) || '*****' AS mac_address,
        SUBSTRING(da.ip_address, 1, 5) || '*****' AS ip_address,
        SUBSTRING(df.iban, 1, 5) || '*****' AS iban,
        dd.accessed_at,
        fnu.session_duration,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.consumed_traffic,
        fnu.unique_id
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    INNER JOIN
        "airflow"."lead_staging"."dim_address" da ON fnu.unique_id = da.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_date" dd ON da.unique_id = dd.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_finance" df ON dd.unique_id = df.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_person" dp ON df.unique_id = dp.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m12:59:52.360597 [debug] [Thread-1 (]: SQL status: SELECT 2274886 in 6553.312 seconds
[0m12:59:52.366278 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m12:59:52.367634 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
alter table "airflow"."lead_staging"."dim_date" rename to "dim_date__dbt_backup"
[0m12:59:52.525318 [debug] [Thread-1 (]: SQL status: SELECT 2274886 in 949.453 seconds
[0m12:59:52.528106 [debug] [Thread-1 (]: SQL status: SELECT 2274886 in 949.456 seconds
[0m12:59:52.531318 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m12:59:52.532551 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
alter table "airflow"."lead_staging"."dim_finance" rename to "dim_finance__dbt_backup"
[0m12:59:52.536110 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m12:59:52.537259 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
alter table "airflow"."lead_staging"."fact_network_usage" rename to "fact_network_usage__dbt_backup"
[0m12:59:53.661355 [debug] [Thread-1 (]: SQL status: SELECT 2274886 in 950.590 seconds
[0m12:59:53.668225 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m12:59:53.670074 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
alter table "airflow"."lead_staging"."dim_person" rename to "dim_person__dbt_backup"
[0m13:28:30.843192 [debug] [Thread-1 (]: SQL status: SELECT 3977366 in 2667.414 seconds
[0m13:28:30.847614 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m13:28:30.848393 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
alter table "airflow"."lead_trusted"."payment_data" rename to "payment_data__dbt_backup"
[0m13:28:30.849967 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:28:30.853614 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m13:28:30.854330 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
alter table "airflow"."lead_trusted"."payment_data__dbt_tmp" rename to "payment_data"
[0m13:28:30.855363 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:28:30.857734 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: COMMIT
[0m13:28:30.858453 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m13:28:30.859362 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: COMMIT
[0m13:28:30.869404 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m13:28:30.872404 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."payment_data__dbt_backup"
[0m13:28:30.873605 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m13:28:30.874341 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
drop table if exists "airflow"."lead_trusted"."payment_data__dbt_backup" cascade
[0m13:28:30.889021 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.014 seconds
[0m13:28:30.891227 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: Close
[0m13:28:30.892431 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1a5d2df-7e2c-4e6d-bc53-ff639c4ad670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2667a15b0>]}
[0m13:28:30.893364 [info ] [Thread-1 (]: 2 of 4 OK created sql table model lead_trusted.payment_data .................... [[32mSELECT 3977366[0m in 2667.61s]
[0m13:28:30.894585 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_payment_data
[0m13:28:30.895445 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_pii_data
[0m13:28:30.896354 [info ] [Thread-1 (]: 3 of 4 START sql table model lead_trusted.pii_data ............................. [RUN]
[0m13:28:30.897238 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_payment_data, now model.dbt_lead_data.trusted_pii_data)
[0m13:28:30.897929 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_pii_data
[0m13:28:30.902996 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_pii_data"
[0m13:28:30.906116 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_pii_data
[0m13:28:30.912573 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_pii_data"
[0m13:28:30.915410 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m13:28:30.916175 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: BEGIN
[0m13:28:30.917019 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:28:30.921820 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m13:28:30.922657 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m13:28:30.923424 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */

  
    

  create  table "airflow"."lead_trusted"."pii_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        dp.person_name,
        dp.user_name,
        dp.email,
        dp.personal_number, 
        dp.birth_date, 
        da.address,
        dp.phone, 
        da.mac_address,
        da.ip_address,
        df.iban,
        dd.accessed_at,
        fnu.session_duration,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.consumed_traffic,
        fnu.unique_id
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    INNER JOIN
        "airflow"."lead_staging"."dim_address" da ON fnu.unique_id = da.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_date" dd ON da.unique_id = dd.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_finance" df ON dd.unique_id = df.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_person" dp ON df.unique_id = dp.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m15:14:48.287787 [debug] [Thread-1 (]: SQL status: SELECT 21225910 in 12734.694 seconds
[0m15:14:48.314833 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m15:14:48.331042 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */
alter table "airflow"."lead_trusted"."pii_data" rename to "pii_data__dbt_backup"
[0m15:14:48.343609 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m15:14:48.368402 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m15:14:48.373148 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */
alter table "airflow"."lead_trusted"."pii_data__dbt_tmp" rename to "pii_data"
[0m15:14:48.379846 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:14:48.394020 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: COMMIT
[0m15:14:48.397873 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m15:14:48.402438 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: COMMIT
[0m15:14:48.419469 [debug] [Thread-1 (]: SQL status: COMMIT in 0.013 seconds
[0m15:14:48.434551 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."pii_data__dbt_backup"
[0m15:14:48.440591 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m15:14:48.444691 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */
drop table if exists "airflow"."lead_trusted"."pii_data__dbt_backup" cascade
[0m15:14:48.489632 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.041 seconds
[0m15:14:48.499844 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: Close
[0m15:14:48.505102 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11fc619e-77ee-44b9-bb5f-5e5da235936b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be5116630>]}
[0m15:14:48.510298 [info ] [Thread-1 (]: 3 of 4 OK created sql table model lead_trusted.pii_data ........................ [[32mSELECT 21225910[0m in 12735.01s]
[0m15:14:48.515955 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_pii_data
[0m15:14:48.521355 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_technical_data
[0m15:14:48.526550 [info ] [Thread-1 (]: 4 of 4 START sql table model lead_trusted.technical_data ....................... [RUN]
[0m15:14:48.531561 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_pii_data, now model.dbt_lead_data.trusted_technical_data)
[0m15:14:48.536022 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_technical_data
[0m15:14:48.556318 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_technical_data"
[0m15:14:48.571835 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_technical_data
[0m15:14:48.608547 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_technical_data"
[0m15:14:48.641702 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m15:14:48.651615 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: BEGIN
[0m15:14:48.664703 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:14:48.690685 [debug] [Thread-1 (]: SQL status: BEGIN in 0.026 seconds
[0m15:14:48.695714 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m15:14:48.699924 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */

  
    

  create  table "airflow"."lead_trusted"."technical_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        fnu.unique_id,
        da.address,
        da.mac_address,
        da.ip_address,
        fnu.download_speed,
        fnu.upload_speed,
        ROUND((fnu.session_duration/60), 1) as min_session_duration,
        CASE 
            WHEN fnu.download_speed < 50 OR fnu.upload_speed < 30 OR fnu.session_duration/60 < 1 THEN true
            ELSE false
        END AS technical_issue
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    JOIN
        "airflow"."lead_staging"."dim_address" da
    ON
	    fnu.unique_id = da.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m15:15:09.883313 [debug] [Thread-1 (]: SQL status: SELECT 21225910 in 8117.665 seconds
[0m15:15:09.923837 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m15:15:09.928486 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
alter table "airflow"."lead_trusted"."non_pii_data" rename to "non_pii_data__dbt_backup"
[0m15:15:10.937561 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 1.005 seconds
[0m15:15:10.958172 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m15:15:10.962327 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
alter table "airflow"."lead_trusted"."non_pii_data__dbt_tmp" rename to "non_pii_data"
[0m15:15:10.968602 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:15:11.125516 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: COMMIT
[0m15:15:11.130237 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m15:15:11.134967 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: COMMIT
[0m15:15:11.145645 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m15:15:11.148556 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 8118.571 seconds
[0m15:15:11.149522 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 8118.577 seconds
[0m15:15:11.149179 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 8118.742 seconds
[0m15:15:11.149565 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 8117.439 seconds
[0m15:15:11.180127 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m15:15:11.180766 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m15:15:11.182323 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m15:15:11.184746 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m15:15:11.186248 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
alter table "airflow"."lead_staging"."dim_finance__dbt_tmp" rename to "dim_finance"
[0m15:15:11.188334 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
alter table "airflow"."lead_staging"."fact_network_usage__dbt_tmp" rename to "fact_network_usage"
[0m15:15:11.189815 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
alter table "airflow"."lead_staging"."dim_date__dbt_tmp" rename to "dim_date"
[0m15:15:11.192518 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
alter table "airflow"."lead_staging"."dim_person__dbt_tmp" rename to "dim_person"
[0m15:15:11.197612 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m15:15:11.198733 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m15:15:11.202342 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m15:15:11.204303 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:15:11.217929 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."non_pii_data__dbt_backup"
[0m15:15:11.224124 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: COMMIT
[0m15:15:11.224091 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: COMMIT
[0m15:15:11.224891 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: COMMIT
[0m15:15:11.229087 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m15:15:11.229078 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: COMMIT
[0m15:15:11.233636 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m15:15:11.237247 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m15:15:11.240475 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: COMMIT
[0m15:15:11.247395 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m15:15:11.253418 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: COMMIT
[0m15:15:11.248776 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: COMMIT
[0m15:15:11.258857 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: COMMIT
[0m15:15:11.262510 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m15:15:11.268235 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m15:15:11.272380 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m15:15:11.275284 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m15:15:11.301091 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_date__dbt_backup"
[0m15:15:11.302374 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m15:15:11.302544 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."fact_network_usage__dbt_backup"
[0m15:15:11.310543 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_finance__dbt_backup"
[0m15:15:11.318605 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
drop table if exists "airflow"."lead_trusted"."non_pii_data__dbt_backup" cascade
[0m15:15:11.319778 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_person__dbt_backup"
[0m15:15:11.322873 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m15:15:11.329428 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m15:15:11.332207 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m15:15:11.333703 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
drop table if exists "airflow"."lead_staging"."dim_date__dbt_backup" cascade
[0m15:15:11.337519 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m15:15:11.337983 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
drop table if exists "airflow"."lead_staging"."fact_network_usage__dbt_backup" cascade
[0m15:15:11.342883 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
drop table if exists "airflow"."lead_staging"."dim_finance__dbt_backup" cascade
[0m15:15:11.347433 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
drop table if exists "airflow"."lead_staging"."dim_person__dbt_backup" cascade
[0m15:15:11.448269 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.103 seconds
[0m15:15:11.455961 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.105 seconds
[0m15:15:11.458120 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.108 seconds
[0m15:15:11.469769 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: Close
[0m15:15:11.478386 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: Close
[0m15:15:11.479781 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.078 seconds
[0m15:15:11.484825 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '358fe6b1-1a07-470c-bb26-5d085e983b3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a8f38b8c0>]}
[0m15:15:11.485118 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: Close
[0m15:15:11.491623 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18c691e4-c1f6-4649-be2f-fbc27ca262cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe933fe4470>]}
[0m15:15:11.500431 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4be254de-39c3-47d9-b193-d02a992c87e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e9460e900>]}
[0m15:15:11.499820 [info ] [Thread-1 (]: 2 of 5 OK created sql table model lead_staging.dim_date ........................ [[32mSELECT 2274886[0m in 14672.49s]
[0m15:15:11.509198 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: Close
[0m15:15:11.505932 [info ] [Thread-1 (]: 3 of 5 OK created sql table model lead_staging.dim_finance ..................... [[32mSELECT 2274886[0m in 9068.45s]
[0m15:15:11.520478 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_date
[0m15:15:11.516115 [info ] [Thread-1 (]: 5 of 5 OK created sql table model lead_staging.fact_network_usage .............. [[32mSELECT 2274886[0m in 9068.46s]
[0m15:15:11.525407 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98b27b92-abdf-402b-b3de-015296a5e739', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7261d15100>]}
[0m15:15:11.529844 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_finance
[0m15:15:11.533611 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_finance
[0m15:15:11.538429 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_fact_network_usage
[0m15:15:11.542560 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_person
[0m15:15:11.545847 [info ] [Thread-1 (]: 3 of 5 START sql table model lead_staging.dim_finance .......................... [RUN]
[0m15:15:11.543662 [info ] [Thread-1 (]: 4 of 5 OK created sql table model lead_staging.dim_person ...................... [[32mSELECT 2274886[0m in 9068.48s]
[0m15:15:11.559376 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_date, now model.dbt_lead_data.staging_dim_finance)
[0m15:15:11.557690 [info ] [Thread-1 (]: 4 of 5 START sql table model lead_staging.dim_person ........................... [RUN]
[0m15:15:11.566638 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_finance
[0m15:15:11.566651 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_person
[0m15:15:11.570457 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_finance, now model.dbt_lead_data.staging_dim_person)
[0m15:15:11.573730 [debug] [MainThread]: Using postgres connection "master"
[0m15:15:11.579742 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_fact_network_usage
[0m15:15:11.581893 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_person
[0m15:15:11.583790 [debug] [MainThread]: On master: BEGIN
[0m15:15:11.586929 [info ] [Thread-1 (]: 5 of 5 START sql table model lead_staging.fact_network_usage ................... [RUN]
[0m15:15:11.589813 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:15:11.593757 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_person, now model.dbt_lead_data.staging_fact_network_usage)
[0m15:15:11.606505 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_fact_network_usage
[0m15:15:11.607406 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_finance"
[0m15:15:11.630960 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_person"
[0m15:15:11.632755 [debug] [MainThread]: SQL status: BEGIN in 0.043 seconds
[0m15:15:11.634863 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_finance
[0m15:15:11.638396 [debug] [MainThread]: On master: COMMIT
[0m15:15:11.645774 [debug] [MainThread]: Using postgres connection "master"
[0m15:15:11.652770 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_person
[0m15:15:11.653317 [debug] [MainThread]: On master: COMMIT
[0m15:15:11.653950 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_fact_network_usage"
[0m15:15:11.661857 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:15:11.672758 [debug] [MainThread]: On master: Close
[0m15:15:11.680310 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_fact_network_usage
[0m15:15:11.681767 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:15:11.687797 [debug] [MainThread]: Connection 'model.dbt_lead_data.staging_fact_network_usage' was properly closed.
[0m15:15:11.698179 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_finance"
[0m15:15:11.703204 [info ] [MainThread]: 
[0m15:15:11.705520 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_person"
[0m15:15:11.712714 [info ] [MainThread]: Finished running 5 table models in 7 hours 22 minutes and 5.22 seconds (26525.22s).
[0m15:15:11.727269 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m15:15:11.738286 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m15:15:11.742005 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_fact_network_usage"
[0m15:15:11.741536 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: BEGIN
[0m15:15:11.750534 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: BEGIN
[0m15:15:11.760150 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:15:11.760667 [debug] [MainThread]: Command end result
[0m15:15:11.762848 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:15:11.773583 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m15:15:11.783841 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: BEGIN
[0m15:15:11.796038 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:15:11.807322 [debug] [Thread-1 (]: SQL status: BEGIN in 0.049 seconds
[0m15:15:11.835694 [debug] [Thread-1 (]: SQL status: BEGIN in 0.072 seconds
[0m15:15:11.841395 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m15:15:11.843173 [debug] [Thread-1 (]: SQL status: BEGIN in 0.047 seconds
[0m15:15:11.844762 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m15:15:11.854169 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m15:15:11.855560 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */

  
    

  create  table "airflow"."lead_staging"."dim_finance__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        iban
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m15:15:11.857582 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */

  
    

  create  table "airflow"."lead_staging"."dim_person__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        person_name,
        user_name,
        email,
        phone,
        birth_date,
        personal_number
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m15:15:11.865891 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */

  
    

  create  table "airflow"."lead_staging"."fact_network_usage__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        session_duration,
        download_speed,
        upload_speed,
        consumed_traffic
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m15:15:12.490593 [info ] [MainThread]: 
[0m15:15:12.501930 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:15:12.530678 [info ] [MainThread]: 
[0m15:15:12.541360 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m15:15:12.558183 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 27456.389, "process_user_time": 891.31305, "process_kernel_time": 52.68696, "process_mem_max_rss": "122356", "process_in_blocks": "160", "process_out_blocks": "0"}
[0m15:15:12.570401 [debug] [MainThread]: Command `dbt run` succeeded at 15:15:12.568907 after 27456.40 seconds
[0m15:15:12.582309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e98027680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e977bbe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e957c8710>]}
[0m15:15:12.590542 [debug] [MainThread]: Flushing usage events
[0m15:15:12.970094 [debug] [Thread-1 (]: SQL status: DROP TABLE in 1.641 seconds
[0m15:15:13.011468 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: Close
[0m15:15:13.038446 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '045c55b2-09cf-46bd-ad93-0c3e28a682fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc58b089a00>]}
[0m15:15:13.050324 [info ] [Thread-1 (]: 1 of 4 OK created sql table model lead_trusted.non_pii_data .................... [[32mSELECT 21225910[0m in 8120.93s]
[0m15:15:13.071588 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_non_pii_data
[0m15:15:13.082116 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_payment_data
[0m15:15:13.092426 [info ] [Thread-1 (]: 2 of 4 START sql table model lead_trusted.payment_data ......................... [RUN]
[0m15:15:13.106366 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_non_pii_data, now model.dbt_lead_data.trusted_payment_data)
[0m15:15:13.113224 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_payment_data
[0m15:15:13.201330 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_payment_data"
[0m15:15:13.238536 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_payment_data
[0m15:15:13.292906 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_payment_data"
[0m15:15:13.331745 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m15:15:13.360385 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: BEGIN
[0m15:15:13.368035 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:15:13.410321 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m15:15:13.419647 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m15:15:13.428656 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */

  
    

  create  table "airflow"."lead_trusted"."payment_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        fnu.unique_id,
        df.iban,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.session_duration,
        fnu.consumed_traffic,
        ((fnu.download_speed + fnu.upload_speed + 1)/2) + (fnu.consumed_traffic / (fnu.session_duration + 1)) AS payment_amount
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    JOIN
        "airflow"."lead_staging"."dim_finance" df
    ON
	    fnu.unique_id = df.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m15:46:18.983346 [debug] [Thread-1 (]: SQL status: SELECT 2274886 in 1867.115 seconds
[0m15:46:18.983455 [debug] [Thread-1 (]: SQL status: SELECT 2274886 in 1867.106 seconds
[0m15:46:18.989447 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m15:46:18.990539 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
alter table "airflow"."lead_staging"."dim_finance" rename to "dim_finance__dbt_backup"
[0m15:46:18.990766 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m15:46:18.992065 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
alter table "airflow"."lead_staging"."fact_network_usage" rename to "fact_network_usage__dbt_backup"
[0m15:46:19.609778 [debug] [Thread-1 (]: SQL status: SELECT 2274886 in 1867.740 seconds
[0m15:46:19.614234 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m15:46:19.615135 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
alter table "airflow"."lead_staging"."dim_person" rename to "dim_person__dbt_backup"
[0m15:46:40.779748 [debug] [Thread-1 (]: SQL status: SELECT 3154094 in 1912.079 seconds
[0m15:46:40.806473 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m15:46:40.811602 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
alter table "airflow"."lead_trusted"."technical_data" rename to "technical_data__dbt_backup"
[0m15:46:40.821853 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m15:46:40.842823 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m15:46:40.847298 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
alter table "airflow"."lead_trusted"."technical_data__dbt_tmp" rename to "technical_data"
[0m15:46:40.861845 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m15:46:40.875945 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: COMMIT
[0m15:46:40.880658 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m15:46:40.885240 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: COMMIT
[0m15:46:40.902928 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m15:46:40.921552 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."technical_data__dbt_backup"
[0m15:46:40.929704 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m15:46:40.934751 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
drop table if exists "airflow"."lead_trusted"."technical_data__dbt_backup" cascade
[0m15:46:40.968498 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.029 seconds
[0m15:46:40.979629 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: Close
[0m15:46:40.986251 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11fc619e-77ee-44b9-bb5f-5e5da235936b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be5da0680>]}
[0m15:46:40.993884 [info ] [Thread-1 (]: 4 of 4 OK created sql table model lead_trusted.technical_data .................. [[32mSELECT 3154094[0m in 1912.45s]
[0m15:46:41.001431 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_technical_data
[0m15:46:41.020631 [debug] [MainThread]: Using postgres connection "master"
[0m15:46:41.025135 [debug] [MainThread]: On master: BEGIN
[0m15:46:41.029829 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:46:41.062844 [debug] [MainThread]: SQL status: BEGIN in 0.032 seconds
[0m15:46:41.068433 [debug] [MainThread]: On master: COMMIT
[0m15:46:41.073176 [debug] [MainThread]: Using postgres connection "master"
[0m15:46:41.077339 [debug] [MainThread]: On master: COMMIT
[0m15:46:41.082745 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:46:41.087067 [debug] [MainThread]: On master: Close
[0m15:46:41.093661 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:46:41.097800 [debug] [MainThread]: Connection 'model.dbt_lead_data.trusted_technical_data' was properly closed.
[0m15:46:41.104560 [info ] [MainThread]: 
[0m15:46:41.111818 [info ] [MainThread]: Finished running 4 table models in 6 hours 5 minutes and 51.33 seconds (21951.33s).
[0m15:46:41.128683 [debug] [MainThread]: Command end result
[0m15:46:41.525369 [info ] [MainThread]: 
[0m15:46:41.530775 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:46:41.541593 [info ] [MainThread]: 
[0m15:46:41.550712 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m15:46:41.561661 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 21958.223, "process_user_time": 11.008775, "process_kernel_time": 0.878873, "process_mem_max_rss": "121784", "process_in_blocks": "36672", "process_out_blocks": "0"}
[0m15:46:41.567888 [debug] [MainThread]: Command `dbt run` succeeded at 15:46:41.566821 after 21958.23 seconds
[0m15:46:41.572242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be8485340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be6d525a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7be5d8d940>]}
[0m15:46:41.576107 [debug] [MainThread]: Flushing usage events
[0m15:50:35.414848 [debug] [Thread-1 (]: SQL status: SELECT 3977366 in 2121.969 seconds
[0m15:50:35.419034 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m15:50:35.419766 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
alter table "airflow"."lead_trusted"."payment_data" rename to "payment_data__dbt_backup"
[0m15:50:35.421181 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:50:35.424801 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m15:50:35.425558 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
alter table "airflow"."lead_trusted"."payment_data__dbt_tmp" rename to "payment_data"
[0m15:50:35.426697 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:50:35.429083 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: COMMIT
[0m15:50:35.429870 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m15:50:35.430573 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: COMMIT
[0m15:50:35.436439 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m15:50:35.439564 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."payment_data__dbt_backup"
[0m15:50:35.440794 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m15:50:35.441508 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
drop table if exists "airflow"."lead_trusted"."payment_data__dbt_backup" cascade
[0m15:50:35.460142 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.018 seconds
[0m15:50:35.462197 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: Close
[0m15:50:35.463153 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '045c55b2-09cf-46bd-ad93-0c3e28a682fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc586bc9a90>]}
[0m15:50:35.464133 [info ] [Thread-1 (]: 2 of 4 OK created sql table model lead_trusted.payment_data .................... [[32mSELECT 3977366[0m in 2122.36s]
[0m15:50:35.465191 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_payment_data
[0m15:50:35.466037 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_pii_data
[0m15:50:35.466906 [info ] [Thread-1 (]: 3 of 4 START sql table model lead_trusted.pii_data ............................. [RUN]
[0m15:50:35.467777 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_payment_data, now model.dbt_lead_data.trusted_pii_data)
[0m15:50:35.468552 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_pii_data
[0m15:50:35.473489 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_pii_data"
[0m15:50:35.476556 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_pii_data
[0m15:50:35.482463 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_pii_data"
[0m15:50:35.485253 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m15:50:35.486086 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: BEGIN
[0m15:50:35.486822 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:50:35.491069 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m15:50:35.491856 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m15:50:35.492576 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */

  
    

  create  table "airflow"."lead_trusted"."pii_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        dp.person_name,
        dp.user_name,
        dp.email,
        dp.personal_number, 
        dp.birth_date, 
        da.address,
        dp.phone, 
        da.mac_address,
        da.ip_address,
        df.iban,
        dd.accessed_at,
        fnu.session_duration,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.consumed_traffic,
        fnu.unique_id
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    INNER JOIN
        "airflow"."lead_staging"."dim_address" da ON fnu.unique_id = da.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_date" dd ON da.unique_id = dd.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_finance" df ON dd.unique_id = df.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_person" dp ON df.unique_id = dp.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m16:31:17.797943 [debug] [Thread-1 (]: SQL status: SELECT 21225910 in 10966.851 seconds
[0m16:31:17.801736 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m16:31:17.802322 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */
alter table "airflow"."lead_trusted"."pii_data" rename to "pii_data__dbt_backup"
[0m16:31:18.805155 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 1.002 seconds
[0m16:31:18.810364 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m16:31:18.811393 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */
alter table "airflow"."lead_trusted"."pii_data__dbt_tmp" rename to "pii_data"
[0m16:31:18.812971 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:31:18.816173 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: COMMIT
[0m16:31:18.817163 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m16:31:18.818184 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: COMMIT
[0m16:31:18.820134 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:31:18.820537 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 2699.767 seconds
[0m16:31:18.820572 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 2699.766 seconds
[0m16:31:18.820543 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 2699.143 seconds
[0m16:31:18.823719 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."pii_data__dbt_backup"
[0m16:31:18.825166 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m16:31:18.825209 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m16:31:18.825573 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m16:31:18.825987 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */
drop table if exists "airflow"."lead_trusted"."pii_data__dbt_backup" cascade
[0m16:31:18.825974 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m16:31:18.826409 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
alter table "airflow"."lead_staging"."dim_finance__dbt_tmp" rename to "dim_finance"
[0m16:31:18.826812 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
alter table "airflow"."lead_staging"."fact_network_usage__dbt_tmp" rename to "fact_network_usage"
[0m16:31:18.827470 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
alter table "airflow"."lead_staging"."dim_person__dbt_tmp" rename to "dim_person"
[0m16:31:18.828420 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:31:18.828944 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:31:18.829186 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:31:18.831307 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: COMMIT
[0m16:31:18.831433 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: COMMIT
[0m16:31:18.831619 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: COMMIT
[0m16:31:18.832083 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m16:31:18.832441 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m16:31:18.832815 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m16:31:18.833103 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: COMMIT
[0m16:31:18.833453 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: COMMIT
[0m16:31:18.833723 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: COMMIT
[0m16:31:18.834882 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:31:18.835307 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:31:18.835803 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:31:18.838078 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_finance__dbt_backup"
[0m16:31:18.839445 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_person__dbt_backup"
[0m16:31:18.839433 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."fact_network_usage__dbt_backup"
[0m16:31:18.839654 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m16:31:18.841057 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m16:31:18.841461 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
drop table if exists "airflow"."lead_staging"."dim_finance__dbt_backup" cascade
[0m16:31:18.842022 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m16:31:18.842249 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
drop table if exists "airflow"."lead_staging"."dim_person__dbt_backup" cascade
[0m16:31:18.843182 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
drop table if exists "airflow"."lead_staging"."fact_network_usage__dbt_backup" cascade
[0m16:31:18.851443 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.009 seconds
[0m16:31:18.853875 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.010 seconds
[0m16:31:18.854124 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: Close
[0m16:31:18.856103 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '358fe6b1-1a07-470c-bb26-5d085e983b3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a8f3b29c0>]}
[0m16:31:18.856959 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: Close
[0m16:31:18.857666 [info ] [Thread-1 (]: 3 of 5 OK created sql table model lead_staging.dim_finance ..................... [[32mSELECT 2274886[0m in 4567.30s]
[0m16:31:18.858186 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18c691e4-c1f6-4649-be2f-fbc27ca262cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe93a17c500>]}
[0m16:31:18.859011 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_finance
[0m16:31:18.859488 [info ] [Thread-1 (]: 4 of 5 OK created sql table model lead_staging.dim_person ...................... [[32mSELECT 2274886[0m in 4567.29s]
[0m16:31:18.860083 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_person
[0m16:31:18.860814 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_person
[0m16:31:18.861224 [info ] [Thread-1 (]: 4 of 5 START sql table model lead_staging.dim_person ........................... [RUN]
[0m16:31:18.861876 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_fact_network_usage
[0m16:31:18.862381 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_finance, now model.dbt_lead_data.staging_dim_person)
[0m16:31:18.862876 [info ] [Thread-1 (]: 5 of 5 START sql table model lead_staging.fact_network_usage ................... [RUN]
[0m16:31:18.863256 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_person
[0m16:31:18.863857 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_person, now model.dbt_lead_data.staging_fact_network_usage)
[0m16:31:18.864692 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_fact_network_usage
[0m16:31:18.867293 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_person"
[0m16:31:18.869119 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_fact_network_usage"
[0m16:31:18.871472 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_person
[0m16:31:18.872279 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_fact_network_usage
[0m16:31:18.876691 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_person"
[0m16:31:18.877243 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_fact_network_usage"
[0m16:31:18.879789 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m16:31:18.880045 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m16:31:18.880737 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: BEGIN
[0m16:31:18.881017 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: BEGIN
[0m16:31:18.881433 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:31:18.881873 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:31:18.886214 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m16:31:18.886671 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m16:31:18.887158 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m16:31:18.887449 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m16:31:18.887982 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */

  
    

  create  table "airflow"."lead_staging"."dim_person__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        person_name,
        user_name,
        email,
        phone,
        birth_date,
        personal_number
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m16:31:18.888201 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */

  
    

  create  table "airflow"."lead_staging"."fact_network_usage__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        session_duration,
        download_speed,
        upload_speed,
        consumed_traffic
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m16:31:18.986491 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.159 seconds
[0m16:31:18.988682 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: Close
[0m16:31:18.989925 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1a5d2df-7e2c-4e6d-bc53-ff639c4ad670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2652dcaa0>]}
[0m16:31:18.990910 [info ] [Thread-1 (]: 3 of 4 OK created sql table model lead_trusted.pii_data ........................ [[32mSELECT 21225910[0m in 10968.09s]
[0m16:31:18.991988 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_pii_data
[0m16:31:18.992859 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_technical_data
[0m16:31:18.993805 [info ] [Thread-1 (]: 4 of 4 START sql table model lead_trusted.technical_data ....................... [RUN]
[0m16:31:18.994789 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_pii_data, now model.dbt_lead_data.trusted_technical_data)
[0m16:31:18.995502 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_technical_data
[0m16:31:18.999756 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_technical_data"
[0m16:31:19.001854 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_technical_data
[0m16:31:19.006423 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_technical_data"
[0m16:31:19.008718 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m16:31:19.009443 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: BEGIN
[0m16:31:19.010207 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:31:19.016076 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m16:31:19.016962 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m16:31:19.017820 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */

  
    

  create  table "airflow"."lead_trusted"."technical_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        fnu.unique_id,
        da.address,
        da.mac_address,
        da.ip_address,
        fnu.download_speed,
        fnu.upload_speed,
        ROUND((fnu.session_duration/60), 1) as min_session_duration,
        CASE 
            WHEN fnu.download_speed < 50 OR fnu.upload_speed < 30 OR fnu.session_duration/60 < 1 THEN true
            ELSE false
        END AS technical_issue
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    JOIN
        "airflow"."lead_staging"."dim_address" da
    ON
	    fnu.unique_id = da.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m16:31:19.871007 [debug] [Thread-1 (]: SQL status: DROP TABLE in 1.027 seconds
[0m16:31:19.874437 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: Close
[0m16:31:19.876151 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98b27b92-abdf-402b-b3de-015296a5e739', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7261d15040>]}
[0m16:31:19.877951 [info ] [Thread-1 (]: 5 of 5 OK created sql table model lead_staging.fact_network_usage .............. [[32mSELECT 2274886[0m in 4568.28s]
[0m16:31:19.880019 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_fact_network_usage
[0m16:31:19.884239 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:19.885401 [debug] [MainThread]: On master: BEGIN
[0m16:31:19.933817 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:31:19.940079 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m16:31:19.941127 [debug] [MainThread]: On master: COMMIT
[0m16:31:19.943805 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:19.944394 [debug] [MainThread]: On master: COMMIT
[0m16:31:19.945677 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:31:19.946431 [debug] [MainThread]: On master: Close
[0m16:31:19.947429 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:31:19.948183 [debug] [MainThread]: Connection 'model.dbt_lead_data.staging_fact_network_usage' was properly closed.
[0m16:31:19.949124 [info ] [MainThread]: 
[0m16:31:19.951174 [info ] [MainThread]: Finished running 5 table models in 8 hours 23 minutes and 31.58 seconds (30211.58s).
[0m16:31:19.953638 [debug] [MainThread]: Command end result
[0m16:31:20.083037 [info ] [MainThread]: 
[0m16:31:20.084911 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:31:20.086752 [info ] [MainThread]: 
[0m16:31:20.121162 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m16:31:20.137332 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 30216.803, "process_user_time": 14.781357, "process_kernel_time": 1.007308, "process_mem_max_rss": "122632", "process_in_blocks": "1072", "process_out_blocks": "0"}
[0m16:31:20.138923 [debug] [MainThread]: Command `dbt run` succeeded at 16:31:20.138631 after 30216.80 seconds
[0m16:31:20.140383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7264503b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7262d47200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72645b2780>]}
[0m16:31:20.142338 [debug] [MainThread]: Flushing usage events
[0m16:31:50.362386 [debug] [Thread-1 (]: SQL status: SELECT 2274886 in 31.558 seconds
[0m16:31:50.452026 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m16:31:50.463668 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
alter table "airflow"."lead_staging"."fact_network_usage" rename to "fact_network_usage__dbt_backup"
[0m16:31:53.292208 [debug] [Thread-1 (]: SQL status: SELECT 2274886 in 34.487 seconds
[0m16:31:53.339032 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m16:31:53.346696 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
alter table "airflow"."lead_staging"."dim_person" rename to "dim_person__dbt_backup"
[0m16:31:58.310198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a4d74e1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a4db3bfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a4d0fd8e0>]}


============================== 16:31:58.373692 | 4a3db2e6-cc6c-4ab2-bae5-50b136d09fec ==============================
[0m16:31:58.373692 [info ] [MainThread]: Running with dbt=1.8.0
[0m16:31:58.382732 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select tag:trusted', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:32:03.177655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a3db2e6-cc6c-4ab2-bae5-50b136d09fec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a4dd4b170>]}
[0m16:32:03.290320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4a3db2e6-cc6c-4ab2-bae5-50b136d09fec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a4bf3d460>]}
[0m16:32:03.293056 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m16:32:03.454708 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m16:32:03.793128 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:32:03.794775 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:32:03.867939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4a3db2e6-cc6c-4ab2-bae5-50b136d09fec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a4ce4ee70>]}
[0m16:32:04.089985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4a3db2e6-cc6c-4ab2-bae5-50b136d09fec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a4af24dd0>]}
[0m16:32:04.091535 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m16:32:04.093390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a3db2e6-cc6c-4ab2-bae5-50b136d09fec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a4bb399a0>]}
[0m16:32:04.099094 [info ] [MainThread]: 
[0m16:32:04.101346 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:32:04.111298 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m16:32:04.498433 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m16:32:04.499480 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m16:32:04.500524 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:32:04.512538 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.012 seconds
[0m16:32:04.515321 [debug] [ThreadPool]: On list_airflow: Close
[0m16:32:04.519131 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_trusted)
[0m16:32:04.527355 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m16:32:04.528280 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m16:32:04.529181 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:32:04.535009 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m16:32:04.536030 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m16:32:04.536748 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m16:32:04.546625 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.009 seconds
[0m16:32:04.549240 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m16:32:04.550433 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m16:32:04.552085 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now list_airflow_lead_staging)
[0m16:32:04.556081 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m16:32:04.556878 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m16:32:04.558112 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:32:04.564378 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m16:32:04.565416 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m16:32:04.566881 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m16:32:04.571939 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.004 seconds
[0m16:32:04.574536 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m16:32:04.576045 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m16:32:04.584335 [debug] [MainThread]: Using postgres connection "master"
[0m16:32:04.585344 [debug] [MainThread]: On master: BEGIN
[0m16:32:04.586314 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:32:04.592229 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m16:32:04.593143 [debug] [MainThread]: Using postgres connection "master"
[0m16:32:04.594363 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:32:04.601301 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m16:32:04.604031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a3db2e6-cc6c-4ab2-bae5-50b136d09fec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a4bf5cad0>]}
[0m16:32:04.605228 [debug] [MainThread]: On master: ROLLBACK
[0m16:32:04.607015 [debug] [MainThread]: Using postgres connection "master"
[0m16:32:04.608071 [debug] [MainThread]: On master: BEGIN
[0m16:32:04.609715 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:32:04.610809 [debug] [MainThread]: On master: COMMIT
[0m16:32:04.611596 [debug] [MainThread]: Using postgres connection "master"
[0m16:32:04.612650 [debug] [MainThread]: On master: COMMIT
[0m16:32:04.613828 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:32:04.615121 [debug] [MainThread]: On master: Close
[0m16:32:04.616391 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:32:04.617700 [info ] [MainThread]: 
[0m16:32:04.634523 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_non_pii_data
[0m16:32:04.636125 [info ] [Thread-1 (]: 1 of 4 START sql table model lead_trusted.non_pii_data ......................... [RUN]
[0m16:32:04.637411 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now model.dbt_lead_data.trusted_non_pii_data)
[0m16:32:04.638538 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_non_pii_data
[0m16:32:04.652212 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_non_pii_data"
[0m16:32:04.655996 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_non_pii_data
[0m16:32:04.717113 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_non_pii_data"
[0m16:32:04.721765 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m16:32:04.722955 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: BEGIN
[0m16:32:04.724020 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:04.729583 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m16:32:04.731089 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m16:32:04.732413 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */

  
    

  create  table "airflow"."lead_trusted"."non_pii_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        '***MASKED***' AS person_name,
        SUBSTRING(dp.user_name, 1, 5) || '*****'  user_name,
        SUBSTRING(dp.email, 1, 5) || '*****' AS email,
        '***MASKED***'  AS personal_number, 
        '***MASKED***' AS birth_date, 
        '***MASKED***' AS address,
        '***MASKED***'  AS phone, 
        SUBSTRING(da.mac_address, 1, 5) || '*****' AS mac_address,
        SUBSTRING(da.ip_address, 1, 5) || '*****' AS ip_address,
        SUBSTRING(df.iban, 1, 5) || '*****' AS iban,
        dd.accessed_at,
        fnu.session_duration,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.consumed_traffic,
        fnu.unique_id
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    INNER JOIN
        "airflow"."lead_staging"."dim_address" da ON fnu.unique_id = da.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_date" dd ON da.unique_id = dd.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_finance" df ON dd.unique_id = df.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_person" dp ON df.unique_id = dp.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m16:32:10.428929 [debug] [Thread-1 (]: SQL status: SELECT 3154094 in 440.498 seconds
[0m16:32:10.433297 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m16:32:10.434219 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
alter table "airflow"."lead_trusted"."technical_data" rename to "technical_data__dbt_backup"
[0m16:32:10.435491 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:32:10.439574 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m16:32:10.440421 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
alter table "airflow"."lead_trusted"."technical_data__dbt_tmp" rename to "technical_data"
[0m16:32:10.441514 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:32:10.444089 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: COMMIT
[0m16:32:10.444850 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m16:32:10.445507 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: COMMIT
[0m16:32:10.448651 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m16:32:10.452011 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."technical_data__dbt_backup"
[0m16:32:10.453266 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m16:32:10.454026 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
drop table if exists "airflow"."lead_trusted"."technical_data__dbt_backup" cascade
[0m16:32:10.469933 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.015 seconds
[0m16:32:10.472040 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: Close
[0m16:32:10.473041 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1a5d2df-7e2c-4e6d-bc53-ff639c4ad670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb265399790>]}
[0m16:32:10.474142 [info ] [Thread-1 (]: 4 of 4 OK created sql table model lead_trusted.technical_data .................. [[32mSELECT 3154094[0m in 51.48s]
[0m16:32:10.475183 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_technical_data
[0m16:32:10.478111 [debug] [MainThread]: Using postgres connection "master"
[0m16:32:10.478770 [debug] [MainThread]: On master: BEGIN
[0m16:32:10.479436 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:32:10.484014 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m16:32:10.484880 [debug] [MainThread]: On master: COMMIT
[0m16:32:10.485561 [debug] [MainThread]: Using postgres connection "master"
[0m16:32:10.486326 [debug] [MainThread]: On master: COMMIT
[0m16:32:10.487263 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:32:10.487918 [debug] [MainThread]: On master: Close
[0m16:32:10.488960 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:32:10.489582 [debug] [MainThread]: Connection 'model.dbt_lead_data.trusted_technical_data' was properly closed.
[0m16:32:10.490435 [info ] [MainThread]: 
[0m16:32:10.491376 [info ] [MainThread]: Finished running 4 table models in 5 hours 5 minutes and 45.83 seconds (18345.83s).
[0m16:32:10.493553 [debug] [MainThread]: Command end result
[0m16:32:10.552712 [info ] [MainThread]: 
[0m16:32:10.554247 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:32:10.555340 [info ] [MainThread]: 
[0m16:32:10.556267 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m16:32:10.558283 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 18736.057, "process_user_time": 881.7415, "process_kernel_time": 53.142063, "process_mem_max_rss": "123880", "process_in_blocks": "35464", "process_out_blocks": "0"}
[0m16:32:10.559245 [debug] [MainThread]: Command `dbt run` succeeded at 16:32:10.559098 after 18736.06 seconds
[0m16:32:10.560098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb268b19910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb267354fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb265239970>]}
[0m16:32:10.560968 [debug] [MainThread]: Flushing usage events
[0m18:57:36.101454 [debug] [Thread-1 (]: SQL status: SELECT 21225910 in 3118.766 seconds
[0m18:57:36.277151 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m18:57:36.278594 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */
alter table "airflow"."lead_trusted"."pii_data" rename to "pii_data__dbt_backup"
[0m18:57:37.292514 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 1.013 seconds
[0m18:57:37.298916 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m18:57:37.299608 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */
alter table "airflow"."lead_trusted"."pii_data__dbt_tmp" rename to "pii_data"
[0m18:57:37.300884 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:57:37.307612 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: COMMIT
[0m18:57:37.308582 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m18:57:37.309138 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: COMMIT
[0m18:57:37.310891 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:57:37.315327 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."pii_data__dbt_backup"
[0m18:57:37.317264 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m18:57:37.318004 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */
drop table if exists "airflow"."lead_trusted"."pii_data__dbt_backup" cascade
[0m18:57:37.340307 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 642.141 seconds
[0m18:57:37.348060 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 645.028 seconds
[0m18:57:37.418612 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m18:57:37.419600 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
alter table "airflow"."lead_staging"."dim_person__dbt_tmp" rename to "dim_person"
[0m18:57:37.421454 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:57:37.426480 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: COMMIT
[0m18:57:37.427339 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m18:57:37.428223 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: COMMIT
[0m18:57:37.429289 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m18:57:37.430061 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:57:37.430297 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
alter table "airflow"."lead_staging"."fact_network_usage__dbt_tmp" rename to "fact_network_usage"
[0m18:57:37.432179 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:57:37.435467 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_person__dbt_backup"
[0m18:57:37.437143 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m18:57:37.438027 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
drop table if exists "airflow"."lead_staging"."dim_person__dbt_backup" cascade
[0m18:57:37.440399 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: COMMIT
[0m18:57:37.441137 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m18:57:37.441964 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: COMMIT
[0m18:57:37.444610 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:57:37.451439 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."fact_network_usage__dbt_backup"
[0m18:57:37.454386 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m18:57:37.455018 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
drop table if exists "airflow"."lead_staging"."fact_network_usage__dbt_backup" cascade
[0m18:57:37.458971 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.020 seconds
[0m18:57:37.465049 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: Close
[0m18:57:37.466302 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.011 seconds
[0m18:57:37.470938 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '358fe6b1-1a07-470c-bb26-5d085e983b3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a8ff79490>]}
[0m18:57:37.473625 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: Close
[0m18:57:37.476876 [info ] [Thread-1 (]: 4 of 5 OK created sql table model lead_staging.dim_person ...................... [[32mSELECT 2274886[0m in 8778.61s]
[0m18:57:37.479322 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_person
[0m18:57:37.480589 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18c691e4-c1f6-4649-be2f-fbc27ca262cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe932607ad0>]}
[0m18:57:37.481014 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_fact_network_usage
[0m18:57:37.483380 [info ] [Thread-1 (]: 5 of 5 START sql table model lead_staging.fact_network_usage ................... [RUN]
[0m18:57:37.484812 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_person, now model.dbt_lead_data.staging_fact_network_usage)
[0m18:57:37.484512 [info ] [Thread-1 (]: 5 of 5 OK created sql table model lead_staging.fact_network_usage .............. [[32mSELECT 2274886[0m in 8778.61s]
[0m18:57:37.485691 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_fact_network_usage
[0m18:57:37.487414 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_fact_network_usage
[0m18:57:37.507976 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:37.509046 [debug] [MainThread]: On master: BEGIN
[0m18:57:37.509106 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_fact_network_usage"
[0m18:57:37.510141 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:57:37.515920 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_fact_network_usage
[0m18:57:37.524983 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_fact_network_usage"
[0m18:57:37.527981 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m18:57:37.528088 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m18:57:37.529059 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: BEGIN
[0m18:57:37.529553 [debug] [MainThread]: On master: COMMIT
[0m18:57:37.530203 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:57:37.530452 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:37.531244 [debug] [MainThread]: On master: COMMIT
[0m18:57:37.532165 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:57:37.533169 [debug] [MainThread]: On master: Close
[0m18:57:37.534227 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:57:37.535102 [debug] [MainThread]: Connection 'model.dbt_lead_data.staging_fact_network_usage' was properly closed.
[0m18:57:37.538152 [info ] [MainThread]: 
[0m18:57:37.539152 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m18:57:37.539799 [info ] [MainThread]: Finished running 5 table models in 11 hours 4 minutes and 6.85 seconds (39846.85s).
[0m18:57:37.540258 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m18:57:37.541458 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */

  
    

  create  table "airflow"."lead_staging"."fact_network_usage__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        session_duration,
        download_speed,
        upload_speed,
        consumed_traffic
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m18:57:37.544142 [debug] [MainThread]: Command end result
[0m18:57:37.563146 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.244 seconds
[0m18:57:37.566751 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: Close
[0m18:57:37.572868 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '045c55b2-09cf-46bd-ad93-0c3e28a682fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc58612f350>]}
[0m18:57:37.579148 [info ] [Thread-1 (]: 3 of 4 OK created sql table model lead_trusted.pii_data ........................ [[32mSELECT 21225910[0m in 11222.10s]
[0m18:57:37.582158 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_pii_data
[0m18:57:37.584140 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_technical_data
[0m18:57:37.586860 [info ] [Thread-1 (]: 4 of 4 START sql table model lead_trusted.technical_data ....................... [RUN]
[0m18:57:37.588143 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_pii_data, now model.dbt_lead_data.trusted_technical_data)
[0m18:57:37.589215 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_technical_data
[0m18:57:37.603244 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_technical_data"
[0m18:57:37.606211 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_technical_data
[0m18:57:37.612615 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_technical_data"
[0m18:57:37.614692 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m18:57:37.615545 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: BEGIN
[0m18:57:37.616436 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:57:37.621752 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m18:57:37.622501 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m18:57:37.623241 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */

  
    

  create  table "airflow"."lead_trusted"."technical_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        fnu.unique_id,
        da.address,
        da.mac_address,
        da.ip_address,
        fnu.download_speed,
        fnu.upload_speed,
        ROUND((fnu.session_duration/60), 1) as min_session_duration,
        CASE 
            WHEN fnu.download_speed < 50 OR fnu.upload_speed < 30 OR fnu.session_duration/60 < 1 THEN true
            ELSE false
        END AS technical_issue
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    JOIN
        "airflow"."lead_staging"."dim_address" da
    ON
	    fnu.unique_id = da.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m18:57:37.644128 [info ] [MainThread]: 
[0m18:57:37.645208 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:57:37.645981 [info ] [MainThread]: 
[0m18:57:37.647118 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m18:57:37.655500 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 31750.936, "process_user_time": 15.786723, "process_kernel_time": 1.129104, "process_mem_max_rss": "120168", "process_in_blocks": "22312", "process_out_blocks": "0"}
[0m18:57:37.657975 [debug] [MainThread]: Command `dbt run` succeeded at 18:57:37.657761 after 31750.94 seconds
[0m18:57:37.660389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe93b2e7290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe939542540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe93ba15dc0>]}
[0m18:57:37.661245 [debug] [MainThread]: Flushing usage events
[0m00:00:14.500252 [debug] [Thread-1 (]: SQL status: SELECT 2274886 in 8.922 seconds
[0m00:00:14.507909 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m00:00:14.508865 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
alter table "airflow"."lead_staging"."fact_network_usage" rename to "fact_network_usage__dbt_backup"
[0m00:00:14.672191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8db442960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8db4429c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8db54cad0>]}


============================== 00:00:14.680299 | d422f5f3-e72c-437d-a30c-ceefb7ae129b ==============================
[0m00:00:14.680299 [info ] [MainThread]: Running with dbt=1.8.0
[0m00:00:14.681328 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select tag:trusted', 'send_anonymous_usage_stats': 'True'}
[0m00:00:14.991368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd422f5f3-e72c-437d-a30c-ceefb7ae129b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8df0ab110>]}
[0m00:00:15.072243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd422f5f3-e72c-437d-a30c-ceefb7ae129b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8db8cc2c0>]}
[0m00:00:15.074791 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:00:15.200218 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m00:00:15.473907 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:00:15.474814 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:00:15.517170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd422f5f3-e72c-437d-a30c-ceefb7ae129b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8db867b60>]}
[0m00:00:15.760942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd422f5f3-e72c-437d-a30c-ceefb7ae129b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8d9524c20>]}
[0m00:00:15.761796 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m00:00:15.762636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd422f5f3-e72c-437d-a30c-ceefb7ae129b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8db111f10>]}
[0m00:00:15.765194 [info ] [MainThread]: 
[0m00:00:15.766329 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:00:15.772637 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m00:00:15.816575 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m00:00:15.817362 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m00:00:15.818163 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:00:15.824765 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.007 seconds
[0m00:00:15.826664 [debug] [ThreadPool]: On list_airflow: Close
[0m00:00:15.829720 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_trusted)
[0m00:00:15.836531 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m00:00:15.837278 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m00:00:15.837948 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:00:15.842783 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m00:00:15.843592 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m00:00:15.844252 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m00:00:15.848348 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m00:00:15.850751 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m00:00:15.851748 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m00:00:15.852799 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now list_airflow_lead_staging)
[0m00:00:15.856045 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m00:00:15.856787 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m00:00:15.857523 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:00:15.862019 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m00:00:15.862880 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m00:00:15.863614 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m00:00:15.866902 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.003 seconds
[0m00:00:15.868895 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m00:00:15.869849 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m00:00:15.878760 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:15.879727 [debug] [MainThread]: On master: BEGIN
[0m00:00:15.880491 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:00:15.885092 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m00:00:15.885950 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:15.886772 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:00:15.890729 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m00:00:15.892924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd422f5f3-e72c-437d-a30c-ceefb7ae129b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8d951a4e0>]}
[0m00:00:15.913918 [debug] [MainThread]: On master: ROLLBACK
[0m00:00:15.915543 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:15.916626 [debug] [MainThread]: On master: BEGIN
[0m00:00:15.919021 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m00:00:15.921057 [debug] [MainThread]: On master: COMMIT
[0m00:00:15.922622 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:15.925555 [debug] [MainThread]: On master: COMMIT
[0m00:00:15.928451 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:00:15.932555 [debug] [MainThread]: On master: Close
[0m00:00:15.934673 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:00:15.938758 [info ] [MainThread]: 
[0m00:00:15.961020 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_non_pii_data
[0m00:00:15.962152 [info ] [Thread-1 (]: 1 of 4 START sql table model lead_trusted.non_pii_data ......................... [RUN]
[0m00:00:15.963269 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now model.dbt_lead_data.trusted_non_pii_data)
[0m00:00:15.964229 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_non_pii_data
[0m00:00:15.976290 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_non_pii_data"
[0m00:00:15.979597 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_non_pii_data
[0m00:00:16.041095 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_non_pii_data"
[0m00:00:16.043708 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m00:00:16.044434 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: BEGIN
[0m00:00:16.045287 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:00:16.051613 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m00:00:16.053349 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m00:00:16.055151 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */

  
    

  create  table "airflow"."lead_trusted"."non_pii_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        '***MASKED***' AS person_name,
        SUBSTRING(dp.user_name, 1, 5) || '*****'  user_name,
        SUBSTRING(dp.email, 1, 5) || '*****' AS email,
        '***MASKED***'  AS personal_number, 
        '***MASKED***' AS birth_date, 
        '***MASKED***' AS address,
        '***MASKED***'  AS phone, 
        SUBSTRING(da.mac_address, 1, 5) || '*****' AS mac_address,
        SUBSTRING(da.ip_address, 1, 5) || '*****' AS ip_address,
        SUBSTRING(df.iban, 1, 5) || '*****' AS iban,
        dd.accessed_at,
        fnu.session_duration,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.consumed_traffic,
        fnu.unique_id
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    INNER JOIN
        "airflow"."lead_staging"."dim_address" da ON fnu.unique_id = da.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_date" dd ON da.unique_id = dd.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_finance" df ON dd.unique_id = df.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_person" dp ON df.unique_id = dp.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m00:00:21.709175 [debug] [Thread-1 (]: SQL status: SELECT 3154094 in 16.049 seconds
[0m00:00:21.715066 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m00:00:21.716314 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
alter table "airflow"."lead_trusted"."technical_data" rename to "technical_data__dbt_backup"
[0m00:00:21.720876 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m00:00:21.727926 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m00:00:21.729107 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
alter table "airflow"."lead_trusted"."technical_data__dbt_tmp" rename to "technical_data"
[0m00:00:21.731358 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m00:00:21.735869 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: COMMIT
[0m00:00:21.736757 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m00:00:21.737573 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: COMMIT
[0m00:00:21.752426 [debug] [Thread-1 (]: SQL status: COMMIT in 0.014 seconds
[0m00:00:21.756647 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."technical_data__dbt_backup"
[0m00:00:21.758092 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m00:00:21.758960 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
drop table if exists "airflow"."lead_trusted"."technical_data__dbt_backup" cascade
[0m00:00:21.775794 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.016 seconds
[0m00:00:21.779061 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: Close
[0m00:00:21.780479 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '045c55b2-09cf-46bd-ad93-0c3e28a682fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc586b4d4c0>]}
[0m00:00:21.782411 [info ] [Thread-1 (]: 4 of 4 OK created sql table model lead_trusted.technical_data .................. [[32mSELECT 3154094[0m in 18164.19s]
[0m00:00:21.784306 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_technical_data
[0m00:00:21.793956 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:21.797870 [debug] [MainThread]: On master: BEGIN
[0m00:00:21.799265 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:00:21.806520 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m00:00:21.807774 [debug] [MainThread]: On master: COMMIT
[0m00:00:21.808927 [debug] [MainThread]: Using postgres connection "master"
[0m00:00:21.809824 [debug] [MainThread]: On master: COMMIT
[0m00:00:21.810988 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:00:21.811895 [debug] [MainThread]: On master: Close
[0m00:00:21.813187 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:00:21.814248 [debug] [MainThread]: Connection 'list_airflow' was properly closed.
[0m00:00:21.815328 [debug] [MainThread]: Connection 'model.dbt_lead_data.trusted_technical_data' was properly closed.
[0m00:00:21.817514 [info ] [MainThread]: 
[0m00:00:21.818899 [info ] [MainThread]: Finished running 4 table models in 11 hours 0 minutes and 29.98 seconds (39629.98s).
[0m00:00:21.821737 [debug] [MainThread]: Command end result
[0m00:00:21.921286 [info ] [MainThread]: 
[0m00:00:21.922662 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:00:21.923773 [info ] [MainThread]: 
[0m00:00:21.930101 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m00:00:21.939915 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 13381.857, "process_user_time": 20.377487, "process_kernel_time": 1.392543, "process_mem_max_rss": "120160", "process_in_blocks": "53432", "process_out_blocks": "0"}
[0m00:00:21.942460 [debug] [MainThread]: Command `dbt run` succeeded at 00:00:21.942244 after 13381.86 seconds
[0m00:00:21.944408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc58a9f66f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc58b0181a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc58613f7d0>]}
[0m00:00:21.945329 [debug] [MainThread]: Flushing usage events
[0m12:00:38.510340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21c605cbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21c605cdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21c605cda0>]}


============================== 12:00:38.523155 | e29b2161-3ce5-4caa-b4f3-1689eb4af6a7 ==============================
[0m12:00:38.523155 [info ] [MainThread]: Running with dbt=1.8.0
[0m12:00:38.524174 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select tag:staging', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:00:38.770273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e29b2161-3ce5-4caa-b4f3-1689eb4af6a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21c676ad80>]}
[0m12:00:38.844627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e29b2161-3ce5-4caa-b4f3-1689eb4af6a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21c493d490>]}
[0m12:00:38.846254 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:00:38.952088 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m12:00:39.151384 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:00:39.152219 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:00:39.195441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e29b2161-3ce5-4caa-b4f3-1689eb4af6a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21c4526e40>]}
[0m12:00:39.345538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e29b2161-3ce5-4caa-b4f3-1689eb4af6a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21c3924b00>]}
[0m12:00:39.346602 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m12:00:39.347422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e29b2161-3ce5-4caa-b4f3-1689eb4af6a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21c3d313a0>]}
[0m12:00:39.350026 [info ] [MainThread]: 
[0m12:00:39.351230 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:00:39.357458 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m12:00:39.413565 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m12:00:39.414480 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m12:00:39.415240 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:00:39.422872 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.008 seconds
[0m12:00:39.425056 [debug] [ThreadPool]: On list_airflow: Close
[0m12:00:39.428125 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_staging)
[0m12:00:39.435320 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m12:00:39.436165 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m12:00:39.436871 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:00:39.441882 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m12:00:39.442837 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m12:00:39.443669 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m12:00:39.450698 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.006 seconds
[0m12:00:39.452914 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m12:00:39.453830 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m12:00:39.455115 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now list_airflow_lead_trusted)
[0m12:00:39.458489 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m12:00:39.459171 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m12:00:39.459781 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:00:39.464211 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m12:00:39.464950 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m12:00:39.465748 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m12:00:39.469206 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m12:00:39.471334 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m12:00:39.472527 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m12:00:39.480545 [debug] [MainThread]: Using postgres connection "master"
[0m12:00:39.481496 [debug] [MainThread]: On master: BEGIN
[0m12:00:39.482279 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:00:39.486859 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m12:00:39.487760 [debug] [MainThread]: Using postgres connection "master"
[0m12:00:39.488663 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:00:39.504227 [debug] [MainThread]: SQL status: SELECT 0 in 0.014 seconds
[0m12:00:39.506515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e29b2161-3ce5-4caa-b4f3-1689eb4af6a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21c69b5c10>]}
[0m12:00:39.507474 [debug] [MainThread]: On master: ROLLBACK
[0m12:00:39.508469 [debug] [MainThread]: Using postgres connection "master"
[0m12:00:39.509238 [debug] [MainThread]: On master: BEGIN
[0m12:00:39.510415 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:00:39.511222 [debug] [MainThread]: On master: COMMIT
[0m12:00:39.512014 [debug] [MainThread]: Using postgres connection "master"
[0m12:00:39.512723 [debug] [MainThread]: On master: COMMIT
[0m12:00:39.513652 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:00:39.514445 [debug] [MainThread]: On master: Close
[0m12:00:39.515530 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:00:39.516326 [info ] [MainThread]: 
[0m12:00:39.529894 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_adress
[0m12:00:39.532615 [info ] [Thread-1 (]: 1 of 5 START sql table model lead_staging.dim_address .......................... [RUN]
[0m12:00:39.533619 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now model.dbt_lead_data.staging_dim_adress)
[0m12:00:39.534422 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_adress
[0m12:00:39.543484 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_adress"
[0m12:00:39.546899 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_adress
[0m12:00:39.594948 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_adress"
[0m12:00:39.597781 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m12:00:39.598539 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: BEGIN
[0m12:00:39.599218 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:00:39.606082 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m12:00:39.607146 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m12:00:39.608676 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */

  
    

  create  table "airflow"."lead_staging"."dim_address__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        address,
        mac_address,
        ip_address
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m12:00:45.812197 [debug] [Thread-1 (]: SQL status: SELECT 2482253 in 6.202 seconds
[0m12:00:45.819915 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m12:00:45.821001 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
alter table "airflow"."lead_staging"."dim_address" rename to "dim_address__dbt_backup"
[0m12:00:50.404382 [debug] [Thread-1 (]: SQL status: SELECT 21225910 in 365.619 seconds
[0m12:00:50.469547 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m12:00:50.471264 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
alter table "airflow"."lead_trusted"."non_pii_data" rename to "non_pii_data__dbt_backup"
[0m12:00:51.475665 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 1.003 seconds
[0m12:00:51.481387 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m12:00:51.482315 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
alter table "airflow"."lead_trusted"."non_pii_data__dbt_tmp" rename to "non_pii_data"
[0m12:00:51.483824 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:00:51.518679 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: COMMIT
[0m12:00:51.519782 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m12:00:51.520675 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: COMMIT
[0m12:00:51.522755 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:00:51.522940 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 5.701 seconds
[0m12:00:51.528339 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m12:00:51.529436 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
alter table "airflow"."lead_staging"."dim_address__dbt_tmp" rename to "dim_address"
[0m12:00:51.531150 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:00:51.534108 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."non_pii_data__dbt_backup"
[0m12:00:51.533527 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 115.842 seconds
[0m12:00:51.543281 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m12:00:51.544432 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
drop table if exists "airflow"."lead_trusted"."non_pii_data__dbt_backup" cascade
[0m12:00:51.559682 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m12:00:51.560753 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m12:00:51.561721 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m12:00:51.563340 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:00:51.570919 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m12:00:51.571992 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
alter table "airflow"."lead_staging"."fact_network_usage__dbt_tmp" rename to "fact_network_usage"
[0m12:00:51.572021 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_address__dbt_backup"
[0m12:00:51.573899 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:00:51.578687 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: COMMIT
[0m12:00:51.579717 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m12:00:51.580721 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: COMMIT
[0m12:00:51.581156 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m12:00:51.582114 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
drop table if exists "airflow"."lead_staging"."dim_address__dbt_backup" cascade
[0m12:00:51.582860 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:00:51.588230 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."fact_network_usage__dbt_backup"
[0m12:00:51.590439 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m12:00:51.591500 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
drop table if exists "airflow"."lead_staging"."fact_network_usage__dbt_backup" cascade
[0m12:00:51.600452 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.017 seconds
[0m12:00:51.604113 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: Close
[0m12:00:51.606326 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e29b2161-3ce5-4caa-b4f3-1689eb4af6a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21c49ac6e0>]}
[0m12:00:51.607787 [info ] [Thread-1 (]: 1 of 5 OK created sql table model lead_staging.dim_address ..................... [[32mSELECT 2482253[0m in 12.07s]
[0m12:00:51.609034 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.016 seconds
[0m12:00:51.609506 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_adress
[0m12:00:51.610854 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_date
[0m12:00:51.612054 [info ] [Thread-1 (]: 2 of 5 START sql table model lead_staging.dim_date ............................. [RUN]
[0m12:00:51.613753 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_adress, now model.dbt_lead_data.staging_dim_date)
[0m12:00:51.614220 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: Close
[0m12:00:51.614846 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_date
[0m12:00:51.618926 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '358fe6b1-1a07-470c-bb26-5d085e983b3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a8f3771a0>]}
[0m12:00:51.619940 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_date"
[0m12:00:51.623404 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_date
[0m12:00:51.623155 [info ] [Thread-1 (]: 5 of 5 OK created sql table model lead_staging.fact_network_usage .............. [[32mSELECT 2274886[0m in 61394.13s]
[0m12:00:51.626553 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_fact_network_usage
[0m12:00:51.629795 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_date"
[0m12:00:51.633916 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m12:00:51.635098 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: BEGIN
[0m12:00:51.636523 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:00:51.639595 [debug] [MainThread]: Using postgres connection "master"
[0m12:00:51.640851 [debug] [MainThread]: On master: BEGIN
[0m12:00:51.641990 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:00:51.646319 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m12:00:51.647765 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m12:00:51.648825 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */

  
    

  create  table "airflow"."lead_staging"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        accessed_at
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m12:00:51.654656 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m12:00:51.656426 [debug] [MainThread]: On master: COMMIT
[0m12:00:51.657447 [debug] [MainThread]: Using postgres connection "master"
[0m12:00:51.658532 [debug] [MainThread]: On master: COMMIT
[0m12:00:51.660459 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:00:51.661696 [debug] [MainThread]: On master: Close
[0m12:00:51.663488 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:00:51.664663 [debug] [MainThread]: Connection 'model.dbt_lead_data.staging_fact_network_usage' was properly closed.
[0m12:00:51.667339 [info ] [MainThread]: 
[0m12:00:51.669494 [info ] [MainThread]: Finished running 5 table models in 28 hours 7 minutes and 13.49 seconds (101233.49s).
[0m12:00:51.674193 [debug] [MainThread]: Command end result
[0m12:00:51.799762 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.254 seconds
[0m12:00:51.811306 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: Close
[0m12:00:51.821311 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a3db2e6-cc6c-4ab2-bae5-50b136d09fec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a4e349e50>]}
[0m12:00:51.826151 [info ] [Thread-1 (]: 1 of 4 OK created sql table model lead_trusted.non_pii_data .................... [[32mSELECT 21225910[0m in 70127.18s]
[0m12:00:51.830740 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_non_pii_data
[0m12:00:51.834788 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_payment_data
[0m12:00:51.837916 [info ] [Thread-1 (]: 2 of 4 START sql table model lead_trusted.payment_data ......................... [RUN]
[0m12:00:51.839582 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_non_pii_data, now model.dbt_lead_data.trusted_payment_data)
[0m12:00:51.840742 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_payment_data
[0m12:00:51.848973 [info ] [MainThread]: 
[0m12:00:51.850069 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_payment_data"
[0m12:00:51.850680 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:00:51.852176 [info ] [MainThread]: 
[0m12:00:51.853952 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m12:00:51.854410 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_payment_data
[0m12:00:51.861803 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 31867.98, "process_user_time": 20.044056, "process_kernel_time": 1.13136, "process_mem_max_rss": "120292", "process_in_blocks": "16", "process_out_blocks": "0"}
[0m12:00:51.864849 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_payment_data"
[0m12:00:51.864991 [debug] [MainThread]: Command `dbt run` succeeded at 12:00:51.864496 after 31867.98 seconds
[0m12:00:51.868733 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m12:00:51.868639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a9604b110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a8f3c0e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a9286d790>]}
[0m12:00:51.869810 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: BEGIN
[0m12:00:51.870473 [debug] [MainThread]: Flushing usage events
[0m12:00:51.871066 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:00:51.882750 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m12:00:51.884375 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m12:00:51.885837 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */

  
    

  create  table "airflow"."lead_trusted"."payment_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        fnu.unique_id,
        df.iban,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.session_duration,
        fnu.consumed_traffic,
        ((fnu.download_speed + fnu.upload_speed + 1)/2) + (fnu.consumed_traffic / (fnu.session_duration + 1)) AS payment_amount
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    JOIN
        "airflow"."lead_staging"."dim_finance" df
    ON
	    fnu.unique_id = df.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m12:00:57.011773 [debug] [Thread-1 (]: SQL status: SELECT 2482253 in 5.361 seconds
[0m12:00:57.020751 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m12:00:57.022408 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
alter table "airflow"."lead_staging"."dim_date" rename to "dim_date__dbt_backup"
[0m12:00:59.179342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5deb5853a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5deabd7140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5deb2a86b0>]}


============================== 12:00:59.188035 | a7359267-e2ad-4356-af6f-645b63560a9a ==============================
[0m12:00:59.188035 [info ] [MainThread]: Running with dbt=1.8.0
[0m12:00:59.189099 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select tag:trusted', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:00:59.425806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a7359267-e2ad-4356-af6f-645b63560a9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dea519640>]}
[0m12:00:59.527872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a7359267-e2ad-4356-af6f-645b63560a9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dea9c4710>]}
[0m12:00:59.529436 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:00:59.626995 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m12:00:59.789220 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:00:59.844733 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:00:59.893444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a7359267-e2ad-4356-af6f-645b63560a9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5de996fec0>]}
[0m12:01:00.052934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a7359267-e2ad-4356-af6f-645b63560a9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5de9599520>]}
[0m12:01:00.054017 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m12:01:00.054913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7359267-e2ad-4356-af6f-645b63560a9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5debe008f0>]}
[0m12:01:00.057624 [info ] [MainThread]: 
[0m12:01:00.058798 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:01:00.065699 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m12:01:00.114427 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m12:01:00.115402 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m12:01:00.116192 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:01:00.122542 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.006 seconds
[0m12:01:00.124844 [debug] [ThreadPool]: On list_airflow: Close
[0m12:01:00.128054 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_trusted)
[0m12:01:00.136133 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m12:01:00.137271 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m12:01:00.138258 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:01:00.143601 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m12:01:00.144682 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m12:01:00.145446 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m12:01:00.149430 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m12:01:00.151958 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m12:01:00.153000 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m12:01:00.154077 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now list_airflow_lead_staging)
[0m12:01:00.157508 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m12:01:00.158432 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m12:01:00.159198 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:01:00.164324 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m12:01:00.165337 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m12:01:00.166185 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m12:01:00.170031 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.003 seconds
[0m12:01:00.172462 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m12:01:00.173832 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m12:01:00.182064 [debug] [MainThread]: Using postgres connection "master"
[0m12:01:00.183023 [debug] [MainThread]: On master: BEGIN
[0m12:01:00.183892 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:01:00.188957 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m12:01:00.190084 [debug] [MainThread]: Using postgres connection "master"
[0m12:01:00.191041 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:01:00.195562 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m12:01:00.197973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7359267-e2ad-4356-af6f-645b63560a9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dea49e030>]}
[0m12:01:00.199073 [debug] [MainThread]: On master: ROLLBACK
[0m12:01:00.200347 [debug] [MainThread]: Using postgres connection "master"
[0m12:01:00.201403 [debug] [MainThread]: On master: BEGIN
[0m12:01:00.203026 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:01:00.204126 [debug] [MainThread]: On master: COMMIT
[0m12:01:00.204982 [debug] [MainThread]: Using postgres connection "master"
[0m12:01:00.205790 [debug] [MainThread]: On master: COMMIT
[0m12:01:00.206950 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:01:00.207751 [debug] [MainThread]: On master: Close
[0m12:01:00.208833 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:01:00.209794 [info ] [MainThread]: 
[0m12:01:00.222431 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_non_pii_data
[0m12:01:00.223728 [info ] [Thread-1 (]: 1 of 4 START sql table model lead_trusted.non_pii_data ......................... [RUN]
[0m12:01:00.224970 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now model.dbt_lead_data.trusted_non_pii_data)
[0m12:01:00.225905 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_non_pii_data
[0m12:01:00.238199 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_non_pii_data"
[0m12:01:00.242036 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_non_pii_data
[0m12:01:00.296690 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_non_pii_data"
[0m12:01:00.300243 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m12:01:00.301270 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: BEGIN
[0m12:01:00.302401 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:01:00.307594 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m12:01:00.308674 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m12:01:00.309528 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */

  
    

  create  table "airflow"."lead_trusted"."non_pii_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        '***MASKED***' AS person_name,
        SUBSTRING(dp.user_name, 1, 5) || '*****'  user_name,
        SUBSTRING(dp.email, 1, 5) || '*****' AS email,
        '***MASKED***'  AS personal_number, 
        '***MASKED***' AS birth_date, 
        '***MASKED***' AS address,
        '***MASKED***'  AS phone, 
        SUBSTRING(da.mac_address, 1, 5) || '*****' AS mac_address,
        SUBSTRING(da.ip_address, 1, 5) || '*****' AS ip_address,
        SUBSTRING(df.iban, 1, 5) || '*****' AS iban,
        dd.accessed_at,
        fnu.session_duration,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.consumed_traffic,
        fnu.unique_id
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    INNER JOIN
        "airflow"."lead_staging"."dim_address" da ON fnu.unique_id = da.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_date" dd ON da.unique_id = dd.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_finance" df ON dd.unique_id = df.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_person" dp ON df.unique_id = dp.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m12:01:03.817025 [debug] [Thread-1 (]: SQL status: SELECT 3977366 in 11.930 seconds
[0m12:01:03.821719 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m12:01:03.822688 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
alter table "airflow"."lead_trusted"."payment_data" rename to "payment_data__dbt_backup"
[0m12:01:03.824850 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:01:03.828973 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m12:01:03.829872 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
alter table "airflow"."lead_trusted"."payment_data__dbt_tmp" rename to "payment_data"
[0m12:01:03.831115 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:01:03.833822 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: COMMIT
[0m12:01:03.834738 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m12:01:03.835645 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: COMMIT
[0m12:01:03.842931 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m12:01:03.846244 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."payment_data__dbt_backup"
[0m12:01:03.847522 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m12:01:03.848457 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
drop table if exists "airflow"."lead_trusted"."payment_data__dbt_backup" cascade
[0m12:01:03.863096 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.014 seconds
[0m12:01:03.865645 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: Close
[0m12:01:03.866807 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a3db2e6-cc6c-4ab2-bae5-50b136d09fec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a49dd1d30>]}
[0m12:01:03.867862 [info ] [Thread-1 (]: 2 of 4 OK created sql table model lead_trusted.payment_data .................... [[32mSELECT 3977366[0m in 12.03s]
[0m12:01:03.869051 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_payment_data
[0m12:01:03.870140 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_pii_data
[0m12:01:03.871256 [info ] [Thread-1 (]: 3 of 4 START sql table model lead_trusted.pii_data ............................. [RUN]
[0m12:01:03.872279 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_payment_data, now model.dbt_lead_data.trusted_pii_data)
[0m12:01:03.873050 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_pii_data
[0m12:01:03.879231 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_pii_data"
[0m12:01:03.882796 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_pii_data
[0m12:01:03.889323 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_pii_data"
[0m12:01:03.892228 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m12:01:03.893330 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: BEGIN
[0m12:01:03.894666 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:01:03.900084 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m12:01:03.901137 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m12:01:03.902131 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */

  
    

  create  table "airflow"."lead_trusted"."pii_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        dp.person_name,
        dp.user_name,
        dp.email,
        dp.personal_number, 
        dp.birth_date, 
        da.address,
        dp.phone, 
        da.mac_address,
        da.ip_address,
        df.iban,
        dd.accessed_at,
        fnu.session_duration,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.consumed_traffic,
        fnu.unique_id
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    INNER JOIN
        "airflow"."lead_staging"."dim_address" da ON fnu.unique_id = da.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_date" dd ON da.unique_id = dd.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_finance" df ON dd.unique_id = df.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_person" dp ON df.unique_id = dp.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m12:02:30.836121 [debug] [Thread-1 (]: SQL status: SELECT 27812086 in 213.599 seconds
[0m12:02:30.881759 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m12:02:30.882865 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
alter table "airflow"."lead_trusted"."non_pii_data" rename to "non_pii_data__dbt_backup"
[0m12:02:31.886156 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 1.002 seconds
[0m12:02:31.891977 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m12:02:31.892823 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
alter table "airflow"."lead_trusted"."non_pii_data__dbt_tmp" rename to "non_pii_data"
[0m12:02:31.894104 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:02:31.925456 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: COMMIT
[0m12:02:31.926216 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m12:02:31.927211 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: COMMIT
[0m12:02:31.929078 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:02:31.929619 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 94.907 seconds
[0m12:02:31.934179 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m12:02:31.934950 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
alter table "airflow"."lead_staging"."dim_date__dbt_tmp" rename to "dim_date"
[0m12:02:31.936298 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:02:31.938838 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: COMMIT
[0m12:02:31.939120 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."non_pii_data__dbt_backup"
[0m12:02:31.939682 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m12:02:31.940381 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: COMMIT
[0m12:02:31.942182 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:02:31.947222 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_date__dbt_backup"
[0m12:02:31.948828 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m12:02:31.949738 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
drop table if exists "airflow"."lead_staging"."dim_date__dbt_backup" cascade
[0m12:02:31.949719 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m12:02:31.950776 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
drop table if exists "airflow"."lead_trusted"."non_pii_data__dbt_backup" cascade
[0m12:02:31.960270 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.010 seconds
[0m12:02:31.962649 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: Close
[0m12:02:31.963824 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e29b2161-3ce5-4caa-b4f3-1689eb4af6a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21c2979ee0>]}
[0m12:02:31.964818 [info ] [Thread-1 (]: 2 of 5 OK created sql table model lead_staging.dim_date ........................ [[32mSELECT 2482253[0m in 100.35s]
[0m12:02:31.965823 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_date
[0m12:02:31.966754 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_finance
[0m12:02:31.967668 [info ] [Thread-1 (]: 3 of 5 START sql table model lead_staging.dim_finance .......................... [RUN]
[0m12:02:31.968626 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_date, now model.dbt_lead_data.staging_dim_finance)
[0m12:02:31.969439 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_finance
[0m12:02:31.973824 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_finance"
[0m12:02:31.976782 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_finance
[0m12:02:31.983464 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_finance"
[0m12:02:31.986460 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m12:02:31.987457 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: BEGIN
[0m12:02:31.988266 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:02:31.993230 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m12:02:31.994141 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m12:02:31.994907 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */

  
    

  create  table "airflow"."lead_staging"."dim_finance__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        iban
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m12:02:32.065957 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.115 seconds
[0m12:02:32.073585 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: Close
[0m12:02:32.078231 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd422f5f3-e72c-437d-a30c-ceefb7ae129b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8dc97daf0>]}
[0m12:02:32.080551 [info ] [Thread-1 (]: 1 of 4 OK created sql table model lead_trusted.non_pii_data .................... [[32mSELECT 27812086[0m in 43336.11s]
[0m12:02:32.082749 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_non_pii_data
[0m12:02:32.084291 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_payment_data
[0m12:02:32.086188 [info ] [Thread-1 (]: 2 of 4 START sql table model lead_trusted.payment_data ......................... [RUN]
[0m12:02:32.087357 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_non_pii_data, now model.dbt_lead_data.trusted_payment_data)
[0m12:02:32.088170 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_payment_data
[0m12:02:32.094992 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_payment_data"
[0m12:02:32.097290 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_payment_data
[0m12:02:32.103019 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_payment_data"
[0m12:02:32.104973 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m12:02:32.105718 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: BEGIN
[0m12:02:32.106637 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:02:32.112159 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m12:02:32.112994 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m12:02:32.113783 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */

  
    

  create  table "airflow"."lead_trusted"."payment_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        fnu.unique_id,
        df.iban,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.session_duration,
        fnu.consumed_traffic,
        ((fnu.download_speed + fnu.upload_speed + 1)/2) + (fnu.consumed_traffic / (fnu.session_duration + 1)) AS payment_amount
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    JOIN
        "airflow"."lead_staging"."dim_finance" df
    ON
	    fnu.unique_id = df.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m12:02:38.319312 [debug] [Thread-1 (]: SQL status: SELECT 2482253 in 6.323 seconds
[0m12:02:38.323614 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m12:02:38.324538 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
alter table "airflow"."lead_staging"."dim_finance" rename to "dim_finance__dbt_backup"
[0m12:02:42.986640 [debug] [Thread-1 (]: SQL status: SELECT 3977366 in 10.872 seconds
[0m12:02:42.991521 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m12:02:42.992721 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
alter table "airflow"."lead_trusted"."payment_data" rename to "payment_data__dbt_backup"
[0m12:02:42.994135 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:02:42.998605 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m12:02:42.999610 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
alter table "airflow"."lead_trusted"."payment_data__dbt_tmp" rename to "payment_data"
[0m12:02:43.001006 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:02:43.003781 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: COMMIT
[0m12:02:43.004865 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m12:02:43.005837 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: COMMIT
[0m12:02:43.012185 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m12:02:43.015989 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."payment_data__dbt_backup"
[0m12:02:43.017346 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m12:02:43.018230 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
drop table if exists "airflow"."lead_trusted"."payment_data__dbt_backup" cascade
[0m12:02:43.030544 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.011 seconds
[0m12:02:43.032796 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: Close
[0m12:02:43.033946 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd422f5f3-e72c-437d-a30c-ceefb7ae129b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8d83b4b00>]}
[0m12:02:43.034988 [info ] [Thread-1 (]: 2 of 4 OK created sql table model lead_trusted.payment_data .................... [[32mSELECT 3977366[0m in 10.95s]
[0m12:02:43.036537 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_payment_data
[0m12:02:43.037665 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_pii_data
[0m12:02:43.038710 [info ] [Thread-1 (]: 3 of 4 START sql table model lead_trusted.pii_data ............................. [RUN]
[0m12:02:43.039904 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_payment_data, now model.dbt_lead_data.trusted_pii_data)
[0m12:02:43.040759 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_pii_data
[0m12:02:43.047068 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_pii_data"
[0m12:02:43.050149 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_pii_data
[0m12:02:43.056863 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_pii_data"
[0m12:02:43.059783 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m12:02:43.060980 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: BEGIN
[0m12:02:43.062518 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:02:43.067592 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m12:02:43.068680 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m12:02:43.069623 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */

  
    

  create  table "airflow"."lead_trusted"."pii_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        dp.person_name,
        dp.user_name,
        dp.email,
        dp.personal_number, 
        dp.birth_date, 
        da.address,
        dp.phone, 
        da.mac_address,
        da.ip_address,
        df.iban,
        dd.accessed_at,
        fnu.session_duration,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.consumed_traffic,
        fnu.unique_id
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    INNER JOIN
        "airflow"."lead_staging"."dim_address" da ON fnu.unique_id = da.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_date" dd ON da.unique_id = dd.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_finance" df ON dd.unique_id = df.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_person" dp ON df.unique_id = dp.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m12:04:44.149479 [debug] [Thread-1 (]: SQL status: SELECT 27812086 in 220.247 seconds
[0m12:04:44.153986 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m12:04:44.154834 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */
alter table "airflow"."lead_trusted"."pii_data" rename to "pii_data__dbt_backup"
[0m12:04:45.157435 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 1.002 seconds
[0m12:04:45.161453 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m12:04:45.162221 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */
alter table "airflow"."lead_trusted"."pii_data__dbt_tmp" rename to "pii_data"
[0m12:04:45.163392 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:04:45.166123 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: COMMIT
[0m12:04:45.166895 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m12:04:45.167694 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: COMMIT
[0m12:04:45.250478 [debug] [Thread-1 (]: SQL status: COMMIT in 0.082 seconds
[0m12:04:45.254201 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."pii_data__dbt_backup"
[0m12:04:45.255642 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m12:04:45.256471 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */
drop table if exists "airflow"."lead_trusted"."pii_data__dbt_backup" cascade
[0m12:04:45.467399 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.210 seconds
[0m12:04:45.469520 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: Close
[0m12:04:45.470540 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a3db2e6-cc6c-4ab2-bae5-50b136d09fec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a49dde510>]}
[0m12:04:45.471485 [info ] [Thread-1 (]: 3 of 4 OK created sql table model lead_trusted.pii_data ........................ [[32mSELECT 27812086[0m in 221.60s]
[0m12:04:45.472531 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_pii_data
[0m12:04:45.473569 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_technical_data
[0m12:04:45.474402 [info ] [Thread-1 (]: 4 of 4 START sql table model lead_trusted.technical_data ....................... [RUN]
[0m12:04:45.475244 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_pii_data, now model.dbt_lead_data.trusted_technical_data)
[0m12:04:45.475874 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_technical_data
[0m12:04:45.480401 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_technical_data"
[0m12:04:45.484585 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_technical_data
[0m12:04:45.489569 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_technical_data"
[0m12:04:45.491763 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m12:04:45.492531 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: BEGIN
[0m12:04:45.493254 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:04:45.497624 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:04:45.498421 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m12:04:45.499143 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */

  
    

  create  table "airflow"."lead_trusted"."technical_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        fnu.unique_id,
        da.address,
        da.mac_address,
        da.ip_address,
        fnu.download_speed,
        fnu.upload_speed,
        ROUND((fnu.session_duration/60), 1) as min_session_duration,
        CASE 
            WHEN fnu.download_speed < 50 OR fnu.upload_speed < 30 OR fnu.session_duration/60 < 1 THEN true
            ELSE false
        END AS technical_issue
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    JOIN
        "airflow"."lead_staging"."dim_address" da
    ON
	    fnu.unique_id = da.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m12:04:58.757664 [debug] [Thread-1 (]: SQL status: SELECT 3977366 in 13.258 seconds
[0m12:04:58.761695 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m12:04:58.762450 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
alter table "airflow"."lead_trusted"."technical_data" rename to "technical_data__dbt_backup"
[0m12:04:58.763659 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:04:58.767664 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m12:04:58.768483 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
alter table "airflow"."lead_trusted"."technical_data__dbt_tmp" rename to "technical_data"
[0m12:04:58.769716 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:04:58.772163 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: COMMIT
[0m12:04:58.772924 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m12:04:58.773611 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: COMMIT
[0m12:04:58.780992 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m12:04:58.784398 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."technical_data__dbt_backup"
[0m12:04:58.785713 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m12:04:58.786478 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
drop table if exists "airflow"."lead_trusted"."technical_data__dbt_backup" cascade
[0m12:04:58.801701 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.014 seconds
[0m12:04:58.803976 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: Close
[0m12:04:58.805073 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a3db2e6-cc6c-4ab2-bae5-50b136d09fec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a49de0980>]}
[0m12:04:58.806029 [info ] [Thread-1 (]: 4 of 4 OK created sql table model lead_trusted.technical_data .................. [[32mSELECT 3977366[0m in 13.33s]
[0m12:04:58.807111 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_technical_data
[0m12:04:58.813900 [debug] [MainThread]: Using postgres connection "master"
[0m12:04:58.815127 [debug] [MainThread]: On master: BEGIN
[0m12:04:58.815964 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:04:58.821605 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m12:04:58.822508 [debug] [MainThread]: On master: COMMIT
[0m12:04:58.823287 [debug] [MainThread]: Using postgres connection "master"
[0m12:04:58.824030 [debug] [MainThread]: On master: COMMIT
[0m12:04:58.824976 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:04:58.825654 [debug] [MainThread]: On master: Close
[0m12:04:58.826707 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:04:58.827539 [debug] [MainThread]: Connection 'model.dbt_lead_data.trusted_technical_data' was properly closed.
[0m12:04:58.829202 [info ] [MainThread]: 
[0m12:04:58.830328 [info ] [MainThread]: Finished running 4 table models in 19 hours 32 minutes and 54.73 seconds (70374.73s).
[0m12:04:58.832603 [debug] [MainThread]: Command end result
[0m12:04:58.910944 [info ] [MainThread]: 
[0m12:04:58.912013 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:04:58.912847 [info ] [MainThread]: 
[0m12:04:58.913898 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m12:04:58.919495 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1010.1432, "process_user_time": 391.5395, "process_kernel_time": 26.603558, "process_mem_max_rss": "118468", "process_in_blocks": "50960", "process_out_blocks": "0"}
[0m12:04:58.922179 [debug] [MainThread]: Command `dbt run` succeeded at 12:04:58.921867 after 1010.15 seconds
[0m12:04:58.924462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a4dc8bb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a4d0ffb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a49d3ea20>]}
[0m12:04:58.925526 [debug] [MainThread]: Flushing usage events
[0m12:05:01.859078 [debug] [Thread-1 (]: SQL status: SELECT 27812086 in 241.551 seconds
[0m12:05:01.866750 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m12:05:01.867708 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
alter table "airflow"."lead_trusted"."non_pii_data" rename to "non_pii_data__dbt_backup"
[0m12:05:02.871044 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 1.002 seconds
[0m12:05:02.876076 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m12:05:02.877059 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
alter table "airflow"."lead_trusted"."non_pii_data__dbt_tmp" rename to "non_pii_data"
[0m12:05:02.878399 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:05:02.902494 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: COMMIT
[0m12:05:02.903338 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m12:05:02.903981 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: COMMIT
[0m12:05:02.905839 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:05:02.906387 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 144.582 seconds
[0m12:05:02.910619 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m12:05:02.911500 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
alter table "airflow"."lead_staging"."dim_finance__dbt_tmp" rename to "dim_finance"
[0m12:05:02.912699 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:05:02.913644 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."non_pii_data__dbt_backup"
[0m12:05:02.915502 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: COMMIT
[0m12:05:02.916337 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m12:05:02.917126 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: COMMIT
[0m12:05:02.918539 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:05:02.920597 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m12:05:02.921450 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
drop table if exists "airflow"."lead_trusted"."non_pii_data__dbt_backup" cascade
[0m12:05:02.921611 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_finance__dbt_backup"
[0m12:05:02.923057 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m12:05:02.923968 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
drop table if exists "airflow"."lead_staging"."dim_finance__dbt_backup" cascade
[0m12:05:02.932271 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m12:05:02.934350 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: Close
[0m12:05:02.935330 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e29b2161-3ce5-4caa-b4f3-1689eb4af6a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21c27c0110>]}
[0m12:05:02.936373 [info ] [Thread-1 (]: 3 of 5 OK created sql table model lead_staging.dim_finance ..................... [[32mSELECT 2482253[0m in 150.97s]
[0m12:05:02.937467 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_finance
[0m12:05:02.938379 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_person
[0m12:05:02.939405 [info ] [Thread-1 (]: 4 of 5 START sql table model lead_staging.dim_person ........................... [RUN]
[0m12:05:02.940342 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_finance, now model.dbt_lead_data.staging_dim_person)
[0m12:05:02.941135 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_person
[0m12:05:02.945027 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_person"
[0m12:05:02.948031 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_person
[0m12:05:02.953129 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_person"
[0m12:05:02.956932 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m12:05:02.994229 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: BEGIN
[0m12:05:02.995142 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:03.000184 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m12:05:03.001270 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m12:05:03.002294 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */

  
    

  create  table "airflow"."lead_staging"."dim_person__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        person_name,
        user_name,
        email,
        phone,
        birth_date,
        personal_number
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m12:05:03.177873 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.256 seconds
[0m12:05:03.181157 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: Close
[0m12:05:03.183390 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7359267-e2ad-4356-af6f-645b63560a9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5debe75fd0>]}
[0m12:05:03.184731 [info ] [Thread-1 (]: 1 of 4 OK created sql table model lead_trusted.non_pii_data .................... [[32mSELECT 27812086[0m in 242.96s]
[0m12:05:03.186195 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_non_pii_data
[0m12:05:03.187251 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_payment_data
[0m12:05:03.188242 [info ] [Thread-1 (]: 2 of 4 START sql table model lead_trusted.payment_data ......................... [RUN]
[0m12:05:03.189317 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_non_pii_data, now model.dbt_lead_data.trusted_payment_data)
[0m12:05:03.190239 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_payment_data
[0m12:05:03.194768 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_payment_data"
[0m12:05:03.197893 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_payment_data
[0m12:05:03.202570 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_payment_data"
[0m12:05:03.205231 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m12:05:03.206093 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: BEGIN
[0m12:05:03.207012 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:03.212588 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m12:05:03.213519 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m12:05:03.214347 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */

  
    

  create  table "airflow"."lead_trusted"."payment_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        fnu.unique_id,
        df.iban,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.session_duration,
        fnu.consumed_traffic,
        ((fnu.download_speed + fnu.upload_speed + 1)/2) + (fnu.consumed_traffic / (fnu.session_duration + 1)) AS payment_amount
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    JOIN
        "airflow"."lead_staging"."dim_finance" df
    ON
	    fnu.unique_id = df.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m12:05:18.567380 [debug] [Thread-1 (]: SQL status: SELECT 3977366 in 15.352 seconds
[0m12:05:18.572392 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m12:05:18.573173 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
alter table "airflow"."lead_trusted"."payment_data" rename to "payment_data__dbt_backup"
[0m12:05:19.119095 [debug] [Thread-1 (]: SQL status: SELECT 2482253 in 16.116 seconds
[0m12:05:19.123216 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m12:05:19.124175 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
alter table "airflow"."lead_staging"."dim_person" rename to "dim_person__dbt_backup"
[0m12:05:19.581873 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 1.008 seconds
[0m12:05:19.586642 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m12:05:19.587695 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
alter table "airflow"."lead_trusted"."payment_data__dbt_tmp" rename to "payment_data"
[0m12:05:19.589216 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:05:19.592250 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: COMMIT
[0m12:05:19.593226 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m12:05:19.594217 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: COMMIT
[0m12:05:19.598467 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:05:19.602642 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."payment_data__dbt_backup"
[0m12:05:19.604103 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m12:05:19.604872 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
drop table if exists "airflow"."lead_trusted"."payment_data__dbt_backup" cascade
[0m12:05:19.641588 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.036 seconds
[0m12:05:19.643953 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: Close
[0m12:05:19.645205 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7359267-e2ad-4356-af6f-645b63560a9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5de79d2990>]}
[0m12:05:19.646200 [info ] [Thread-1 (]: 2 of 4 OK created sql table model lead_trusted.payment_data .................... [[32mSELECT 3977366[0m in 16.46s]
[0m12:05:19.647322 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_payment_data
[0m12:05:19.648302 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_pii_data
[0m12:05:19.650046 [info ] [Thread-1 (]: 3 of 4 START sql table model lead_trusted.pii_data ............................. [RUN]
[0m12:05:19.651172 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_payment_data, now model.dbt_lead_data.trusted_pii_data)
[0m12:05:19.651948 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_pii_data
[0m12:05:19.657870 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_pii_data"
[0m12:05:19.660458 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_pii_data
[0m12:05:19.667188 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_pii_data"
[0m12:05:19.669746 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m12:05:19.670592 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: BEGIN
[0m12:05:19.671474 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:19.676033 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:05:19.676915 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m12:05:19.677693 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */

  
    

  create  table "airflow"."lead_trusted"."pii_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        dp.person_name,
        dp.user_name,
        dp.email,
        dp.personal_number, 
        dp.birth_date, 
        da.address,
        dp.phone, 
        da.mac_address,
        da.ip_address,
        df.iban,
        dd.accessed_at,
        fnu.session_duration,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.consumed_traffic,
        fnu.unique_id
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    INNER JOIN
        "airflow"."lead_staging"."dim_address" da ON fnu.unique_id = da.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_date" dd ON da.unique_id = dd.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_finance" df ON dd.unique_id = df.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_person" dp ON df.unique_id = dp.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m12:06:04.474835 [debug] [Thread-1 (]: SQL status: SELECT 27812086 in 201.406 seconds
[0m12:06:04.479603 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m12:06:04.480463 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */
alter table "airflow"."lead_trusted"."pii_data" rename to "pii_data__dbt_backup"
[0m12:06:05.482784 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 1.001 seconds
[0m12:06:05.488060 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m12:06:05.489025 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */
alter table "airflow"."lead_trusted"."pii_data__dbt_tmp" rename to "pii_data"
[0m12:06:05.490550 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:06:05.493226 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: COMMIT
[0m12:06:05.493934 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m12:06:05.494751 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: COMMIT
[0m12:06:05.496333 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:06:05.496655 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 46.372 seconds
[0m12:06:05.499418 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."pii_data__dbt_backup"
[0m12:06:05.500582 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m12:06:05.500626 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m12:06:05.501412 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
alter table "airflow"."lead_staging"."dim_person__dbt_tmp" rename to "dim_person"
[0m12:06:05.501700 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */
drop table if exists "airflow"."lead_trusted"."pii_data__dbt_backup" cascade
[0m12:06:05.502627 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:06:05.505154 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: COMMIT
[0m12:06:05.505919 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m12:06:05.506626 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: COMMIT
[0m12:06:05.508238 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:06:05.511469 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_person__dbt_backup"
[0m12:06:05.512770 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m12:06:05.513545 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
drop table if exists "airflow"."lead_staging"."dim_person__dbt_backup" cascade
[0m12:06:05.523350 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.009 seconds
[0m12:06:05.525581 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: Close
[0m12:06:05.526631 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e29b2161-3ce5-4caa-b4f3-1689eb4af6a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21c2892660>]}
[0m12:06:05.527654 [info ] [Thread-1 (]: 4 of 5 OK created sql table model lead_staging.dim_person ...................... [[32mSELECT 2482253[0m in 62.59s]
[0m12:06:05.528736 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_person
[0m12:06:05.529651 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_fact_network_usage
[0m12:06:05.530605 [info ] [Thread-1 (]: 5 of 5 START sql table model lead_staging.fact_network_usage ................... [RUN]
[0m12:06:05.531569 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_person, now model.dbt_lead_data.staging_fact_network_usage)
[0m12:06:05.532359 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_fact_network_usage
[0m12:06:05.536492 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_fact_network_usage"
[0m12:06:05.539928 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_fact_network_usage
[0m12:06:05.544532 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_fact_network_usage"
[0m12:06:05.547531 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m12:06:05.548417 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: BEGIN
[0m12:06:05.549251 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:06:05.553817 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m12:06:05.554670 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m12:06:05.555491 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */

  
    

  create  table "airflow"."lead_staging"."fact_network_usage__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        session_duration,
        download_speed,
        upload_speed,
        consumed_traffic
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m12:06:05.669808 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.167 seconds
[0m12:06:05.671747 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: Close
[0m12:06:05.672932 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd422f5f3-e72c-437d-a30c-ceefb7ae129b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8d83e0920>]}
[0m12:06:05.674437 [info ] [Thread-1 (]: 3 of 4 OK created sql table model lead_trusted.pii_data ........................ [[32mSELECT 27812086[0m in 202.63s]
[0m12:06:05.675436 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_pii_data
[0m12:06:05.677296 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_technical_data
[0m12:06:05.678521 [info ] [Thread-1 (]: 4 of 4 START sql table model lead_trusted.technical_data ....................... [RUN]
[0m12:06:05.679800 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_pii_data, now model.dbt_lead_data.trusted_technical_data)
[0m12:06:05.680649 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_technical_data
[0m12:06:05.685804 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_technical_data"
[0m12:06:05.688438 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_technical_data
[0m12:06:05.693150 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_technical_data"
[0m12:06:05.695449 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m12:06:05.696482 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: BEGIN
[0m12:06:05.697268 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:06:05.702702 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m12:06:05.703599 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m12:06:05.704418 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */

  
    

  create  table "airflow"."lead_trusted"."technical_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        fnu.unique_id,
        da.address,
        da.mac_address,
        da.ip_address,
        fnu.download_speed,
        fnu.upload_speed,
        ROUND((fnu.session_duration/60), 1) as min_session_duration,
        CASE 
            WHEN fnu.download_speed < 50 OR fnu.upload_speed < 30 OR fnu.session_duration/60 < 1 THEN true
            ELSE false
        END AS technical_issue
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    JOIN
        "airflow"."lead_staging"."dim_address" da
    ON
	    fnu.unique_id = da.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m12:06:17.666054 [debug] [Thread-1 (]: SQL status: SELECT 2482253 in 12.110 seconds
[0m12:06:17.672991 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m12:06:17.674380 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
alter table "airflow"."lead_staging"."fact_network_usage" rename to "fact_network_usage__dbt_backup"
[0m12:06:26.833133 [debug] [Thread-1 (]: Postgres adapter: Postgres error: could not resize shared memory segment "/PostgreSQL.1451177995" to 33554432 bytes: No space left on device
CONTEXT:  parallel worker

[0m12:06:26.834743 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: ROLLBACK
[0m12:06:26.836350 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: Close
[0m12:06:26.858796 [debug] [Thread-1 (]: Database Error in model trusted_pii_data (models/trusted_pii_data.sql)
  could not resize shared memory segment "/PostgreSQL.1451177995" to 33554432 bytes: No space left on device
  CONTEXT:  parallel worker
  compiled code at target/run/dbt_lead_data/models/trusted_pii_data.sql
[0m12:06:26.859872 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7359267-e2ad-4356-af6f-645b63560a9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5de5f253a0>]}
[0m12:06:26.861064 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model lead_trusted.pii_data .................... [[31mERROR[0m in 67.21s]
[0m12:06:26.862358 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_pii_data
[0m12:06:26.863263 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_technical_data
[0m12:06:26.865089 [info ] [Thread-1 (]: 4 of 4 START sql table model lead_trusted.technical_data ....................... [RUN]
[0m12:06:26.866447 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_pii_data, now model.dbt_lead_data.trusted_technical_data)
[0m12:06:26.867474 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_technical_data
[0m12:06:26.872858 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_technical_data"
[0m12:06:26.875720 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_technical_data
[0m12:06:26.880343 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_technical_data"
[0m12:06:26.882793 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m12:06:26.883542 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: BEGIN
[0m12:06:26.884460 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:06:26.889407 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m12:06:26.894709 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m12:06:26.895539 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */

  
    

  create  table "airflow"."lead_trusted"."technical_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        fnu.unique_id,
        da.address,
        da.mac_address,
        da.ip_address,
        fnu.download_speed,
        fnu.upload_speed,
        ROUND((fnu.session_duration/60), 1) as min_session_duration,
        CASE 
            WHEN fnu.download_speed < 50 OR fnu.upload_speed < 30 OR fnu.session_duration/60 < 1 THEN true
            ELSE false
        END AS technical_issue
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    JOIN
        "airflow"."lead_staging"."dim_address" da
    ON
	    fnu.unique_id = da.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m12:06:30.375670 [debug] [Thread-1 (]: SQL status: SELECT 3977366 in 24.671 seconds
[0m12:06:30.379878 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m12:06:30.380820 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
alter table "airflow"."lead_trusted"."technical_data" rename to "technical_data__dbt_backup"
[0m12:06:30.390955 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.009 seconds
[0m12:06:30.395589 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m12:06:30.396638 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
alter table "airflow"."lead_trusted"."technical_data__dbt_tmp" rename to "technical_data"
[0m12:06:30.398300 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:06:30.401323 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: COMMIT
[0m12:06:30.402231 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m12:06:30.403222 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: COMMIT
[0m12:06:30.414344 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m12:06:30.414612 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 12.740 seconds
[0m12:06:30.418471 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."technical_data__dbt_backup"
[0m12:06:30.419445 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m12:06:30.420159 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m12:06:30.447664 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
alter table "airflow"."lead_staging"."fact_network_usage__dbt_tmp" rename to "fact_network_usage"
[0m12:06:30.448994 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
drop table if exists "airflow"."lead_trusted"."technical_data__dbt_backup" cascade
[0m12:06:30.450477 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:06:30.453869 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: COMMIT
[0m12:06:30.454809 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m12:06:30.455618 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: COMMIT
[0m12:06:30.466139 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m12:06:30.469551 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."fact_network_usage__dbt_backup"
[0m12:06:30.471154 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m12:06:30.472080 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
drop table if exists "airflow"."lead_staging"."fact_network_usage__dbt_backup" cascade
[0m12:06:30.478103 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.028 seconds
[0m12:06:30.480314 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: Close
[0m12:06:30.481352 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd422f5f3-e72c-437d-a30c-ceefb7ae129b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8d8495f40>]}
[0m12:06:30.482393 [info ] [Thread-1 (]: 4 of 4 OK created sql table model lead_trusted.technical_data .................. [[32mSELECT 3977366[0m in 24.80s]
[0m12:06:30.483511 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_technical_data
[0m12:06:30.489241 [debug] [MainThread]: Using postgres connection "master"
[0m12:06:30.490101 [debug] [MainThread]: On master: BEGIN
[0m12:06:30.490719 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:06:30.492297 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.019 seconds
[0m12:06:30.494808 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: Close
[0m12:06:30.496034 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e29b2161-3ce5-4caa-b4f3-1689eb4af6a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21c277d6a0>]}
[0m12:06:30.496379 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m12:06:30.497118 [info ] [Thread-1 (]: 5 of 5 OK created sql table model lead_staging.fact_network_usage .............. [[32mSELECT 2482253[0m in 24.96s]
[0m12:06:30.497387 [debug] [MainThread]: On master: COMMIT
[0m12:06:30.498409 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_fact_network_usage
[0m12:06:30.498484 [debug] [MainThread]: Using postgres connection "master"
[0m12:06:30.499358 [debug] [MainThread]: On master: COMMIT
[0m12:06:30.500313 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:06:30.500970 [debug] [MainThread]: Using postgres connection "master"
[0m12:06:30.501030 [debug] [MainThread]: On master: Close
[0m12:06:30.501668 [debug] [MainThread]: On master: BEGIN
[0m12:06:30.502224 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:06:30.502416 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:06:30.503045 [debug] [MainThread]: Connection 'model.dbt_lead_data.trusted_technical_data' was properly closed.
[0m12:06:30.504506 [info ] [MainThread]: 
[0m12:06:30.505628 [info ] [MainThread]: Finished running 4 table models in 12 hours 6 minutes and 14.74 seconds (43574.74s).
[0m12:06:30.507364 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m12:06:30.507953 [debug] [MainThread]: Command end result
[0m12:06:30.508215 [debug] [MainThread]: On master: COMMIT
[0m12:06:30.509155 [debug] [MainThread]: Using postgres connection "master"
[0m12:06:30.510098 [debug] [MainThread]: On master: COMMIT
[0m12:06:30.511567 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:06:30.512390 [debug] [MainThread]: On master: Close
[0m12:06:30.513418 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:06:30.514171 [debug] [MainThread]: Connection 'model.dbt_lead_data.staging_fact_network_usage' was properly closed.
[0m12:06:30.515075 [info ] [MainThread]: 
[0m12:06:30.516032 [info ] [MainThread]: Finished running 5 table models in 0 hours 5 minutes and 51.16 seconds (351.16s).
[0m12:06:30.518488 [debug] [MainThread]: Command end result
[0m12:06:30.587592 [info ] [MainThread]: 
[0m12:06:30.588597 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:06:30.589547 [info ] [MainThread]: 
[0m12:06:30.590362 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m12:06:30.591282 [info ] [MainThread]: 
[0m12:06:30.592385 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:06:30.593361 [info ] [MainThread]: 
[0m12:06:30.594420 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m12:06:30.596495 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 352.15005, "process_user_time": 3.378843, "process_kernel_time": 0.519507, "process_mem_max_rss": "119552", "process_in_blocks": "37072", "process_out_blocks": "0"}
[0m12:06:30.598129 [debug] [MainThread]: Command `dbt run` succeeded at 12:06:30.597903 after 352.15 seconds
[0m12:06:30.598848 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 454.8249, "process_user_time": 3.925927, "process_kernel_time": 0.410201, "process_mem_max_rss": "121248", "process_in_blocks": "39496", "process_out_blocks": "0"}
[0m12:06:30.599463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21c58185c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21c94b7110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21c6d185c0>]}
[0m12:06:30.600535 [debug] [MainThread]: Flushing usage events
[0m12:06:30.600881 [debug] [MainThread]: Command `dbt run` succeeded at 12:06:30.600578 after 454.83 seconds
[0m12:06:30.602475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8dc1ed070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8da125760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8dbb318e0>]}
[0m12:06:30.603395 [debug] [MainThread]: Flushing usage events
[0m12:06:37.114523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3869e97530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3867443fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38677a2240>]}


============================== 12:06:37.124618 | ed051d34-7ec6-409f-836a-2db8c0d9f84d ==============================
[0m12:06:37.124618 [info ] [MainThread]: Running with dbt=1.8.0
[0m12:06:37.125515 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select tag:trusted', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:06:37.434041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ed051d34-7ec6-409f-836a-2db8c0d9f84d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38685d6f00>]}
[0m12:06:37.506816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ed051d34-7ec6-409f-836a-2db8c0d9f84d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38685d6f90>]}
[0m12:06:37.508558 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:06:37.633859 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m12:06:37.822735 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:06:37.823414 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:06:37.867257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ed051d34-7ec6-409f-836a-2db8c0d9f84d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38676d5fa0>]}
[0m12:06:38.012423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ed051d34-7ec6-409f-836a-2db8c0d9f84d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3865b24920>]}
[0m12:06:38.013250 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m12:06:38.014126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed051d34-7ec6-409f-836a-2db8c0d9f84d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3866716990>]}
[0m12:06:38.017036 [info ] [MainThread]: 
[0m12:06:38.018332 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:06:38.025506 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m12:06:38.074607 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m12:06:38.075467 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m12:06:38.076265 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:06:38.082085 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.006 seconds
[0m12:06:38.084076 [debug] [ThreadPool]: On list_airflow: Close
[0m12:06:38.086763 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_trusted)
[0m12:06:38.093691 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m12:06:38.094444 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m12:06:38.095260 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:06:38.099483 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m12:06:38.100418 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m12:06:38.101214 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m12:06:38.105523 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m12:06:38.107794 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m12:06:38.108791 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m12:06:38.109942 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now list_airflow_lead_staging)
[0m12:06:38.113475 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m12:06:38.114218 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m12:06:38.114947 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:06:38.119362 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m12:06:38.120297 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m12:06:38.121085 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m12:06:38.124518 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.003 seconds
[0m12:06:38.126681 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m12:06:38.127788 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m12:06:38.135595 [debug] [MainThread]: Using postgres connection "master"
[0m12:06:38.136545 [debug] [MainThread]: On master: BEGIN
[0m12:06:38.137343 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:06:38.141534 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m12:06:38.142327 [debug] [MainThread]: Using postgres connection "master"
[0m12:06:38.143054 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:06:38.149523 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m12:06:38.151656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed051d34-7ec6-409f-836a-2db8c0d9f84d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3866bacda0>]}
[0m12:06:38.152531 [debug] [MainThread]: On master: ROLLBACK
[0m12:06:38.153377 [debug] [MainThread]: Using postgres connection "master"
[0m12:06:38.154100 [debug] [MainThread]: On master: BEGIN
[0m12:06:38.155217 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:06:38.155883 [debug] [MainThread]: On master: COMMIT
[0m12:06:38.156493 [debug] [MainThread]: Using postgres connection "master"
[0m12:06:38.157121 [debug] [MainThread]: On master: COMMIT
[0m12:06:38.157979 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:06:38.158220 [debug] [Thread-1 (]: SQL status: SELECT 4184733 in 11.261 seconds
[0m12:06:38.158755 [debug] [MainThread]: On master: Close
[0m12:06:38.159778 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:06:38.160443 [info ] [MainThread]: 
[0m12:06:38.162400 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m12:06:38.163210 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
alter table "airflow"."lead_trusted"."technical_data" rename to "technical_data__dbt_backup"
[0m12:06:38.164375 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:06:38.168192 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m12:06:38.169049 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
alter table "airflow"."lead_trusted"."technical_data__dbt_tmp" rename to "technical_data"
[0m12:06:38.170228 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:06:38.172268 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_non_pii_data
[0m12:06:38.172948 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: COMMIT
[0m12:06:38.173244 [info ] [Thread-1 (]: 1 of 4 START sql table model lead_trusted.non_pii_data ......................... [RUN]
[0m12:06:38.173706 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m12:06:38.174157 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now model.dbt_lead_data.trusted_non_pii_data)
[0m12:06:38.174435 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: COMMIT
[0m12:06:38.174921 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_non_pii_data
[0m12:06:38.177981 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:06:38.181042 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."technical_data__dbt_backup"
[0m12:06:38.182385 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m12:06:38.183163 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
drop table if exists "airflow"."lead_trusted"."technical_data__dbt_backup" cascade
[0m12:06:38.185813 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_non_pii_data"
[0m12:06:38.188639 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_non_pii_data
[0m12:06:38.234840 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_non_pii_data"
[0m12:06:38.237949 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m12:06:38.238765 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: BEGIN
[0m12:06:38.239457 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:06:38.245131 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m12:06:38.245991 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m12:06:38.246787 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */

  
    

  create  table "airflow"."lead_trusted"."non_pii_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        '***MASKED***' AS person_name,
        SUBSTRING(dp.user_name, 1, 5) || '*****'  user_name,
        SUBSTRING(dp.email, 1, 5) || '*****' AS email,
        '***MASKED***'  AS personal_number, 
        '***MASKED***' AS birth_date, 
        '***MASKED***' AS address,
        '***MASKED***'  AS phone, 
        SUBSTRING(da.mac_address, 1, 5) || '*****' AS mac_address,
        SUBSTRING(da.ip_address, 1, 5) || '*****' AS ip_address,
        SUBSTRING(df.iban, 1, 5) || '*****' AS iban,
        dd.accessed_at,
        fnu.session_duration,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.consumed_traffic,
        fnu.unique_id
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    INNER JOIN
        "airflow"."lead_staging"."dim_address" da ON fnu.unique_id = da.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_date" dd ON da.unique_id = dd.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_finance" df ON dd.unique_id = df.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_person" dp ON df.unique_id = dp.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m12:06:38.256936 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.073 seconds
[0m12:06:38.259176 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: Close
[0m12:06:38.260240 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7359267-e2ad-4356-af6f-645b63560a9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5de78d21b0>]}
[0m12:06:38.261269 [info ] [Thread-1 (]: 4 of 4 OK created sql table model lead_trusted.technical_data .................. [[32mSELECT 4184733[0m in 11.39s]
[0m12:06:38.262355 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_technical_data
[0m12:06:38.264952 [debug] [MainThread]: Using postgres connection "master"
[0m12:06:38.265815 [debug] [MainThread]: On master: BEGIN
[0m12:06:38.266508 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:06:38.271233 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m12:06:38.272072 [debug] [MainThread]: On master: COMMIT
[0m12:06:38.272876 [debug] [MainThread]: Using postgres connection "master"
[0m12:06:38.273606 [debug] [MainThread]: On master: COMMIT
[0m12:06:38.274616 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:06:38.275412 [debug] [MainThread]: On master: Close
[0m12:06:38.276582 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:06:38.277381 [debug] [MainThread]: Connection 'model.dbt_lead_data.trusted_technical_data' was properly closed.
[0m12:06:38.278284 [info ] [MainThread]: 
[0m12:06:38.279076 [info ] [MainThread]: Finished running 4 table models in 0 hours 5 minutes and 38.22 seconds (338.22s).
[0m12:06:38.281026 [debug] [MainThread]: Command end result
[0m12:06:38.339612 [info ] [MainThread]: 
[0m12:06:38.340824 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:06:38.341858 [info ] [MainThread]: 
[0m12:06:38.342966 [error] [MainThread]:   Database Error in model trusted_pii_data (models/trusted_pii_data.sql)
  could not resize shared memory segment "/PostgreSQL.1451177995" to 33554432 bytes: No space left on device
  CONTEXT:  parallel worker
  compiled code at target/run/dbt_lead_data/models/trusted_pii_data.sql
[0m12:06:38.343860 [info ] [MainThread]: 
[0m12:06:38.344557 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m12:06:38.346072 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 339.234, "process_user_time": 3.672778, "process_kernel_time": 0.270357, "process_mem_max_rss": "121556", "process_in_blocks": "36528", "command_success": false, "process_out_blocks": "0"}
[0m12:06:38.347076 [debug] [MainThread]: Command `dbt run` failed at 12:06:38.346930 after 339.24 seconds
[0m12:06:38.348001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dead47b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dea96d400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5de8d3c470>]}
[0m12:06:38.348843 [debug] [MainThread]: Flushing usage events
[0m12:07:56.570371 [debug] [Thread-1 (]: SQL status: SELECT 28019453 in 78.320 seconds
[0m12:07:56.578686 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m12:07:56.579655 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
alter table "airflow"."lead_trusted"."non_pii_data" rename to "non_pii_data__dbt_backup"
[0m12:07:57.582328 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 1.002 seconds
[0m12:07:57.586312 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m12:07:57.587112 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
alter table "airflow"."lead_trusted"."non_pii_data__dbt_tmp" rename to "non_pii_data"
[0m12:07:57.588455 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:07:57.611107 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: COMMIT
[0m12:07:57.612157 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m12:07:57.612937 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: COMMIT
[0m12:07:57.614893 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:07:57.621982 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."non_pii_data__dbt_backup"
[0m12:07:57.628581 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m12:07:57.629392 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
drop table if exists "airflow"."lead_trusted"."non_pii_data__dbt_backup" cascade
[0m12:07:57.779561 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.149 seconds
[0m12:07:57.782657 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: Close
[0m12:07:57.784817 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed051d34-7ec6-409f-836a-2db8c0d9f84d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3868bc5df0>]}
[0m12:07:57.785963 [info ] [Thread-1 (]: 1 of 4 OK created sql table model lead_trusted.non_pii_data .................... [[32mSELECT 28019453[0m in 79.61s]
[0m12:07:57.787294 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_non_pii_data
[0m12:07:57.788238 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_payment_data
[0m12:07:57.789172 [info ] [Thread-1 (]: 2 of 4 START sql table model lead_trusted.payment_data ......................... [RUN]
[0m12:07:57.790047 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_non_pii_data, now model.dbt_lead_data.trusted_payment_data)
[0m12:07:57.790801 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_payment_data
[0m12:07:57.795207 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_payment_data"
[0m12:07:57.798471 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_payment_data
[0m12:07:57.803110 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_payment_data"
[0m12:07:57.805817 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m12:07:57.806632 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: BEGIN
[0m12:07:57.807346 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:07:57.811843 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:07:57.812629 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m12:07:57.813422 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */

  
    

  create  table "airflow"."lead_trusted"."payment_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        fnu.unique_id,
        df.iban,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.session_duration,
        fnu.consumed_traffic,
        ((fnu.download_speed + fnu.upload_speed + 1)/2) + (fnu.consumed_traffic / (fnu.session_duration + 1)) AS payment_amount
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    JOIN
        "airflow"."lead_staging"."dim_finance" df
    ON
	    fnu.unique_id = df.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m12:08:04.217776 [debug] [Thread-1 (]: SQL status: SELECT 4184733 in 6.404 seconds
[0m12:08:04.222243 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m12:08:04.223217 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
alter table "airflow"."lead_trusted"."payment_data" rename to "payment_data__dbt_backup"
[0m12:08:04.224485 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:08:04.227975 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m12:08:04.228757 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
alter table "airflow"."lead_trusted"."payment_data__dbt_tmp" rename to "payment_data"
[0m12:08:04.229716 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:08:04.232109 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: COMMIT
[0m12:08:04.232909 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m12:08:04.233746 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: COMMIT
[0m12:08:04.237313 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:08:04.240423 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."payment_data__dbt_backup"
[0m12:08:04.241649 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m12:08:04.242374 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
drop table if exists "airflow"."lead_trusted"."payment_data__dbt_backup" cascade
[0m12:08:04.253419 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.010 seconds
[0m12:08:04.255498 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: Close
[0m12:08:04.256472 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed051d34-7ec6-409f-836a-2db8c0d9f84d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3864792540>]}
[0m12:08:04.257422 [info ] [Thread-1 (]: 2 of 4 OK created sql table model lead_trusted.payment_data .................... [[32mSELECT 4184733[0m in 6.47s]
[0m12:08:04.258425 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_payment_data
[0m12:08:04.259207 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_pii_data
[0m12:08:04.260057 [info ] [Thread-1 (]: 3 of 4 START sql table model lead_trusted.pii_data ............................. [RUN]
[0m12:08:04.260944 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_payment_data, now model.dbt_lead_data.trusted_pii_data)
[0m12:08:04.261688 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_pii_data
[0m12:08:04.266705 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_pii_data"
[0m12:08:04.268985 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_pii_data
[0m12:08:04.274508 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_pii_data"
[0m12:08:04.276704 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m12:08:04.277433 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: BEGIN
[0m12:08:04.278125 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:08:04.283026 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m12:08:04.283783 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m12:08:04.284431 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */

  
    

  create  table "airflow"."lead_trusted"."pii_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        dp.person_name,
        dp.user_name,
        dp.email,
        dp.personal_number, 
        dp.birth_date, 
        da.address,
        dp.phone, 
        da.mac_address,
        da.ip_address,
        df.iban,
        dd.accessed_at,
        fnu.session_duration,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.consumed_traffic,
        fnu.unique_id
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    INNER JOIN
        "airflow"."lead_staging"."dim_address" da ON fnu.unique_id = da.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_date" dd ON da.unique_id = dd.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_finance" df ON dd.unique_id = df.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_person" dp ON df.unique_id = dp.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m12:09:08.910390 [debug] [Thread-1 (]: SQL status: SELECT 28019453 in 64.625 seconds
[0m12:09:08.914548 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m12:09:08.915321 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */
alter table "airflow"."lead_trusted"."pii_data" rename to "pii_data__dbt_backup"
[0m12:09:09.917419 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 1.001 seconds
[0m12:09:09.920998 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m12:09:09.921627 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */
alter table "airflow"."lead_trusted"."pii_data__dbt_tmp" rename to "pii_data"
[0m12:09:09.922579 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m12:09:09.925001 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: COMMIT
[0m12:09:09.925559 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m12:09:09.926165 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: COMMIT
[0m12:09:09.927587 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:09:09.930274 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."pii_data__dbt_backup"
[0m12:09:09.931401 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m12:09:09.932071 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */
drop table if exists "airflow"."lead_trusted"."pii_data__dbt_backup" cascade
[0m12:09:10.083201 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.150 seconds
[0m12:09:10.084949 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: Close
[0m12:09:10.086001 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed051d34-7ec6-409f-836a-2db8c0d9f84d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38646de540>]}
[0m12:09:10.086822 [info ] [Thread-1 (]: 3 of 4 OK created sql table model lead_trusted.pii_data ........................ [[32mSELECT 28019453[0m in 65.83s]
[0m12:09:10.087684 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_pii_data
[0m12:09:10.088518 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_technical_data
[0m12:09:10.089623 [info ] [Thread-1 (]: 4 of 4 START sql table model lead_trusted.technical_data ....................... [RUN]
[0m12:09:10.090835 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_pii_data, now model.dbt_lead_data.trusted_technical_data)
[0m12:09:10.091731 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_technical_data
[0m12:09:10.095810 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_technical_data"
[0m12:09:10.099078 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_technical_data
[0m12:09:10.104229 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_technical_data"
[0m12:09:10.106958 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m12:09:10.107616 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: BEGIN
[0m12:09:10.108370 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:10.112353 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m12:09:10.113030 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m12:09:10.113635 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */

  
    

  create  table "airflow"."lead_trusted"."technical_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        fnu.unique_id,
        da.address,
        da.mac_address,
        da.ip_address,
        fnu.download_speed,
        fnu.upload_speed,
        ROUND((fnu.session_duration/60), 1) as min_session_duration,
        CASE 
            WHEN fnu.download_speed < 50 OR fnu.upload_speed < 30 OR fnu.session_duration/60 < 1 THEN true
            ELSE false
        END AS technical_issue
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    JOIN
        "airflow"."lead_staging"."dim_address" da
    ON
	    fnu.unique_id = da.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m12:09:18.707295 [debug] [Thread-1 (]: SQL status: SELECT 4184733 in 8.593 seconds
[0m12:09:18.727924 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m12:09:18.749768 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
alter table "airflow"."lead_trusted"."technical_data" rename to "technical_data__dbt_backup"
[0m12:09:18.772877 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:09:18.796440 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m12:09:18.797491 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
alter table "airflow"."lead_trusted"."technical_data__dbt_tmp" rename to "technical_data"
[0m12:09:18.799068 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:09:18.802018 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: COMMIT
[0m12:09:18.803028 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m12:09:18.804024 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: COMMIT
[0m12:09:18.813093 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m12:09:18.816522 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."technical_data__dbt_backup"
[0m12:09:18.817741 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m12:09:18.818565 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
drop table if exists "airflow"."lead_trusted"."technical_data__dbt_backup" cascade
[0m12:09:18.860312 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.041 seconds
[0m12:09:18.862436 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: Close
[0m12:09:18.863417 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed051d34-7ec6-409f-836a-2db8c0d9f84d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3864799fd0>]}
[0m12:09:18.864372 [info ] [Thread-1 (]: 4 of 4 OK created sql table model lead_trusted.technical_data .................. [[32mSELECT 4184733[0m in 8.77s]
[0m12:09:18.865459 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_technical_data
[0m12:09:18.867782 [debug] [MainThread]: Using postgres connection "master"
[0m12:09:18.868624 [debug] [MainThread]: On master: BEGIN
[0m12:09:18.869321 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:09:18.873486 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m12:09:18.874149 [debug] [MainThread]: On master: COMMIT
[0m12:09:18.874781 [debug] [MainThread]: Using postgres connection "master"
[0m12:09:18.875377 [debug] [MainThread]: On master: COMMIT
[0m12:09:18.876138 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:09:18.876727 [debug] [MainThread]: On master: Close
[0m12:09:18.877635 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:09:18.878211 [debug] [MainThread]: Connection 'model.dbt_lead_data.trusted_technical_data' was properly closed.
[0m12:09:18.878835 [info ] [MainThread]: 
[0m12:09:18.879518 [info ] [MainThread]: Finished running 4 table models in 0 hours 2 minutes and 40.86 seconds (160.86s).
[0m12:09:18.881486 [debug] [MainThread]: Command end result
[0m12:09:18.931679 [info ] [MainThread]: 
[0m12:09:18.932763 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:09:18.933582 [info ] [MainThread]: 
[0m12:09:18.934916 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m12:09:18.936439 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 161.88235, "process_user_time": 3.438303, "process_kernel_time": 0.293801, "process_mem_max_rss": "121436", "process_in_blocks": "34560", "process_out_blocks": "0"}
[0m12:09:18.937152 [debug] [MainThread]: Command `dbt run` succeeded at 12:09:18.937037 after 161.88 seconds
[0m12:09:18.937711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3869e97530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f386673d100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38646383e0>]}
[0m12:09:18.938324 [debug] [MainThread]: Flushing usage events
[0m07:00:52.674687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd9d456d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd9f887800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd9daf4bf0>]}


============================== 07:00:52.718133 | 54fe6fec-c691-4d3a-b648-a3d68884bb13 ==============================
[0m07:00:52.718133 [info ] [MainThread]: Running with dbt=1.8.0
[0m07:00:52.723370 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select tag:staging', 'send_anonymous_usage_stats': 'True'}
[0m07:00:54.330096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '54fe6fec-c691-4d3a-b648-a3d68884bb13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd9dcc8680>]}
[0m07:00:54.705240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '54fe6fec-c691-4d3a-b648-a3d68884bb13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd9de327b0>]}
[0m07:00:54.711875 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:00:55.330108 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m07:00:56.367606 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:00:56.371676 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:00:56.595819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '54fe6fec-c691-4d3a-b648-a3d68884bb13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd9c1412e0>]}
[0m07:00:57.377168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '54fe6fec-c691-4d3a-b648-a3d68884bb13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd9bd4db50>]}
[0m07:00:57.387003 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m07:00:57.393549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54fe6fec-c691-4d3a-b648-a3d68884bb13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd9db0cda0>]}
[0m07:00:57.408349 [info ] [MainThread]: 
[0m07:00:57.415105 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:00:57.445375 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m07:00:57.689772 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m07:00:57.693774 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m07:00:57.697508 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:00:57.724188 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.027 seconds
[0m07:00:57.733871 [debug] [ThreadPool]: On list_airflow: Close
[0m07:00:57.747046 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_trusted)
[0m07:00:57.783848 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:00:57.788072 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m07:00:57.792484 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:00:57.826667 [debug] [ThreadPool]: SQL status: BEGIN in 0.034 seconds
[0m07:00:57.832655 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:00:57.836708 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m07:00:57.868598 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.028 seconds
[0m07:00:57.877806 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m07:00:57.882520 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m07:00:57.887825 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now list_airflow_lead_staging)
[0m07:00:57.904904 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:00:57.908627 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m07:00:57.912039 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:00:57.932387 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m07:00:57.936841 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:00:57.940806 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m07:00:57.957436 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.012 seconds
[0m07:00:57.966900 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m07:00:57.971581 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m07:00:58.011634 [debug] [MainThread]: Using postgres connection "master"
[0m07:00:58.014992 [debug] [MainThread]: On master: BEGIN
[0m07:00:58.018556 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:00:58.037863 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m07:00:58.041609 [debug] [MainThread]: Using postgres connection "master"
[0m07:00:58.045669 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:00:58.070734 [debug] [MainThread]: SQL status: SELECT 0 in 0.020 seconds
[0m07:00:58.081157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54fe6fec-c691-4d3a-b648-a3d68884bb13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd9e698860>]}
[0m07:00:58.084850 [debug] [MainThread]: On master: ROLLBACK
[0m07:00:58.089589 [debug] [MainThread]: Using postgres connection "master"
[0m07:00:58.094113 [debug] [MainThread]: On master: BEGIN
[0m07:00:58.101000 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m07:00:58.105590 [debug] [MainThread]: On master: COMMIT
[0m07:00:58.109410 [debug] [MainThread]: Using postgres connection "master"
[0m07:00:58.112800 [debug] [MainThread]: On master: COMMIT
[0m07:00:58.117498 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m07:00:58.121528 [debug] [MainThread]: On master: Close
[0m07:00:58.125875 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:00:58.129937 [info ] [MainThread]: 
[0m07:00:58.185454 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_adress
[0m07:00:58.190459 [info ] [Thread-1 (]: 1 of 5 START sql table model lead_staging.dim_address .......................... [RUN]
[0m07:00:58.194992 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now model.dbt_lead_data.staging_dim_adress)
[0m07:00:58.198880 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_adress
[0m07:00:58.242489 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_adress"
[0m07:00:58.259231 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_adress
[0m07:00:58.533529 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_adress"
[0m07:00:58.553955 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:00:58.560707 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: BEGIN
[0m07:00:58.570604 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:00:58.604797 [debug] [Thread-1 (]: SQL status: BEGIN in 0.033 seconds
[0m07:00:58.613959 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:00:58.622917 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */

  
    

  create  table "airflow"."lead_staging"."dim_address__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        address,
        mac_address,
        ip_address
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:01:31.177169 [debug] [Thread-1 (]: SQL status: SELECT 2690465 in 32.549 seconds
[0m07:01:31.220675 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:01:31.225248 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
alter table "airflow"."lead_staging"."dim_address" rename to "dim_address__dbt_backup"
[0m07:01:31.232380 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m07:01:31.253394 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:01:31.257710 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
alter table "airflow"."lead_staging"."dim_address__dbt_tmp" rename to "dim_address"
[0m07:01:31.265173 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m07:01:31.396331 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m07:01:31.401071 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:01:31.405334 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m07:01:31.413091 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m07:01:31.456795 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_address__dbt_backup"
[0m07:01:31.496078 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:01:31.500358 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
drop table if exists "airflow"."lead_staging"."dim_address__dbt_backup" cascade
[0m07:01:31.561398 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.057 seconds
[0m07:01:31.578386 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: Close
[0m07:01:31.589082 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54fe6fec-c691-4d3a-b648-a3d68884bb13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd9e5b5b20>]}
[0m07:01:31.595152 [info ] [Thread-1 (]: 1 of 5 OK created sql table model lead_staging.dim_address ..................... [[32mSELECT 2690465[0m in 33.39s]
[0m07:01:31.601352 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_adress
[0m07:01:31.605628 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_date
[0m07:01:31.611159 [info ] [Thread-1 (]: 2 of 5 START sql table model lead_staging.dim_date ............................. [RUN]
[0m07:01:31.616831 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_adress, now model.dbt_lead_data.staging_dim_date)
[0m07:01:31.623332 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_date
[0m07:01:31.646411 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_date"
[0m07:01:31.662851 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_date
[0m07:01:31.686553 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_date"
[0m07:01:31.702859 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m07:01:31.706737 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: BEGIN
[0m07:01:31.711423 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:01:31.738415 [debug] [Thread-1 (]: SQL status: BEGIN in 0.027 seconds
[0m07:01:31.742762 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m07:01:31.747076 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */

  
    

  create  table "airflow"."lead_staging"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        accessed_at
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:01:50.616345 [debug] [Thread-1 (]: SQL status: SELECT 2690465 in 18.865 seconds
[0m07:01:50.644109 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m07:01:50.649282 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
alter table "airflow"."lead_staging"."dim_date" rename to "dim_date__dbt_backup"
[0m07:01:50.656292 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m07:01:50.677368 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m07:01:50.681954 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
alter table "airflow"."lead_staging"."dim_date__dbt_tmp" rename to "dim_date"
[0m07:01:50.688309 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m07:01:50.702559 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: COMMIT
[0m07:01:50.708135 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m07:01:50.712984 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: COMMIT
[0m07:01:50.721403 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m07:01:50.738465 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_date__dbt_backup"
[0m07:01:50.745313 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m07:01:50.750340 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
drop table if exists "airflow"."lead_staging"."dim_date__dbt_backup" cascade
[0m07:01:50.787244 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.032 seconds
[0m07:01:50.800495 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: Close
[0m07:01:50.806603 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54fe6fec-c691-4d3a-b648-a3d68884bb13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd9a0b00b0>]}
[0m07:01:50.813277 [info ] [Thread-1 (]: 2 of 5 OK created sql table model lead_staging.dim_date ........................ [[32mSELECT 2690465[0m in 19.19s]
[0m07:01:50.820858 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_date
[0m07:01:50.826544 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_finance
[0m07:01:50.832095 [info ] [Thread-1 (]: 3 of 5 START sql table model lead_staging.dim_finance .......................... [RUN]
[0m07:01:50.838281 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_date, now model.dbt_lead_data.staging_dim_finance)
[0m07:01:50.844063 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_finance
[0m07:01:50.867005 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_finance"
[0m07:01:50.882182 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_finance
[0m07:01:50.919352 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_finance"
[0m07:01:50.935016 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m07:01:50.940240 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: BEGIN
[0m07:01:50.945207 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:01:50.971462 [debug] [Thread-1 (]: SQL status: BEGIN in 0.026 seconds
[0m07:01:50.976210 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m07:01:50.980421 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */

  
    

  create  table "airflow"."lead_staging"."dim_finance__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        iban
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:02:07.785937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4efe02d4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4efe447c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4efe3af2f0>]}


============================== 07:02:07.836717 | 96dcec26-8e67-4311-804d-932494aa2b1b ==============================
[0m07:02:07.836717 [info ] [MainThread]: Running with dbt=1.8.0
[0m07:02:07.842786 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select tag:staging', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:02:09.495711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '96dcec26-8e67-4311-804d-932494aa2b1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4efdb2d940>]}
[0m07:02:09.599817 [debug] [Thread-1 (]: SQL status: SELECT 2899539 in 18.614 seconds
[0m07:02:09.620026 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m07:02:09.623929 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
alter table "airflow"."lead_staging"."dim_finance" rename to "dim_finance__dbt_backup"
[0m07:02:09.630032 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m07:02:09.650606 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m07:02:09.654892 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
alter table "airflow"."lead_staging"."dim_finance__dbt_tmp" rename to "dim_finance"
[0m07:02:09.660841 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m07:02:09.677741 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: COMMIT
[0m07:02:09.682154 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m07:02:09.686581 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: COMMIT
[0m07:02:09.693843 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m07:02:09.709221 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_finance__dbt_backup"
[0m07:02:09.717544 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m07:02:09.721689 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
drop table if exists "airflow"."lead_staging"."dim_finance__dbt_backup" cascade
[0m07:02:09.779098 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.052 seconds
[0m07:02:09.791003 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: Close
[0m07:02:09.797159 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54fe6fec-c691-4d3a-b648-a3d68884bb13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd9a0b7dd0>]}
[0m07:02:09.805207 [info ] [Thread-1 (]: 3 of 5 OK created sql table model lead_staging.dim_finance ..................... [[32mSELECT 2899539[0m in 18.96s]
[0m07:02:09.815014 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_finance
[0m07:02:09.822709 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_person
[0m07:02:09.828691 [info ] [Thread-1 (]: 4 of 5 START sql table model lead_staging.dim_person ........................... [RUN]
[0m07:02:09.836927 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_finance, now model.dbt_lead_data.staging_dim_person)
[0m07:02:09.841820 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_person
[0m07:02:09.863156 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_person"
[0m07:02:09.879004 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_person
[0m07:02:09.908004 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_person"
[0m07:02:09.924874 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m07:02:09.930093 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: BEGIN
[0m07:02:09.936051 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:02:09.963235 [debug] [Thread-1 (]: SQL status: BEGIN in 0.027 seconds
[0m07:02:09.968934 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m07:02:09.973800 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */

  
    

  create  table "airflow"."lead_staging"."dim_person__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        person_name,
        user_name,
        email,
        phone,
        birth_date,
        personal_number
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:02:09.983764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '96dcec26-8e67-4311-804d-932494aa2b1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4eff30cc20>]}
[0m07:02:09.991361 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:02:10.630738 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m07:02:11.691374 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:02:11.695814 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:02:11.946498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '96dcec26-8e67-4311-804d-932494aa2b1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4efd378c50>]}
[0m07:02:13.081263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '96dcec26-8e67-4311-804d-932494aa2b1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4efc768c50>]}
[0m07:02:13.097160 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m07:02:13.108031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96dcec26-8e67-4311-804d-932494aa2b1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4efdb993d0>]}
[0m07:02:13.129730 [info ] [MainThread]: 
[0m07:02:13.143019 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:02:13.240874 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m07:02:13.518022 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m07:02:13.522069 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m07:02:13.525955 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:02:13.553834 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.027 seconds
[0m07:02:13.565533 [debug] [ThreadPool]: On list_airflow: Close
[0m07:02:13.580734 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_trusted)
[0m07:02:13.621348 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:02:13.631907 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m07:02:13.638309 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:02:13.679067 [debug] [ThreadPool]: SQL status: BEGIN in 0.040 seconds
[0m07:02:13.686774 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:02:13.693082 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m07:02:13.725709 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.023 seconds
[0m07:02:13.740894 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m07:02:13.748668 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m07:02:13.758048 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now list_airflow_lead_staging)
[0m07:02:13.787708 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:02:13.793107 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m07:02:13.798752 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:02:13.836116 [debug] [ThreadPool]: SQL status: BEGIN in 0.037 seconds
[0m07:02:13.842871 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:02:13.849756 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m07:02:13.893243 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.033 seconds
[0m07:02:13.919765 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m07:02:13.927824 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m07:02:13.981446 [debug] [MainThread]: Using postgres connection "master"
[0m07:02:13.985915 [debug] [MainThread]: On master: BEGIN
[0m07:02:13.990315 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:02:14.015149 [debug] [MainThread]: SQL status: BEGIN in 0.025 seconds
[0m07:02:14.020960 [debug] [MainThread]: Using postgres connection "master"
[0m07:02:14.028033 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:02:14.052257 [debug] [MainThread]: SQL status: SELECT 0 in 0.018 seconds
[0m07:02:14.065754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96dcec26-8e67-4311-804d-932494aa2b1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4efdb99790>]}
[0m07:02:14.071509 [debug] [MainThread]: On master: ROLLBACK
[0m07:02:14.077389 [debug] [MainThread]: Using postgres connection "master"
[0m07:02:14.081554 [debug] [MainThread]: On master: BEGIN
[0m07:02:14.088027 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m07:02:14.092685 [debug] [MainThread]: On master: COMMIT
[0m07:02:14.097851 [debug] [MainThread]: Using postgres connection "master"
[0m07:02:14.102536 [debug] [MainThread]: On master: COMMIT
[0m07:02:14.108208 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m07:02:14.113021 [debug] [MainThread]: On master: Close
[0m07:02:14.121229 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:02:14.128064 [info ] [MainThread]: 
[0m07:02:14.196163 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_adress
[0m07:02:14.203107 [info ] [Thread-1 (]: 1 of 5 START sql table model lead_staging.dim_address .......................... [RUN]
[0m07:02:14.211070 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now model.dbt_lead_data.staging_dim_adress)
[0m07:02:14.218069 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_adress
[0m07:02:14.303308 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_adress"
[0m07:02:14.317089 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_adress
[0m07:02:14.585856 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_adress"
[0m07:02:14.599563 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:02:14.603085 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: BEGIN
[0m07:02:14.607467 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:02:14.638846 [debug] [Thread-1 (]: SQL status: BEGIN in 0.031 seconds
[0m07:02:14.644035 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:02:14.648841 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */

  
    

  create  table "airflow"."lead_staging"."dim_address__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        address,
        mac_address,
        ip_address
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:02:43.052229 [debug] [Thread-1 (]: SQL status: SELECT 2899539 in 33.076 seconds
[0m07:02:43.132418 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m07:02:43.138341 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
alter table "airflow"."lead_staging"."dim_person" rename to "dim_person__dbt_backup"
[0m07:02:43.145335 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m07:02:43.165326 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m07:02:43.169371 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
alter table "airflow"."lead_staging"."dim_person__dbt_tmp" rename to "dim_person"
[0m07:02:43.176063 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m07:02:43.188985 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: COMMIT
[0m07:02:43.193027 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m07:02:43.197349 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: COMMIT
[0m07:02:43.212964 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m07:02:43.229065 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_person__dbt_backup"
[0m07:02:43.236000 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m07:02:43.240321 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
drop table if exists "airflow"."lead_staging"."dim_person__dbt_backup" cascade
[0m07:02:43.312297 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.068 seconds
[0m07:02:43.322239 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: Close
[0m07:02:43.327168 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54fe6fec-c691-4d3a-b648-a3d68884bb13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd9a0b70b0>]}
[0m07:02:43.332275 [info ] [Thread-1 (]: 4 of 5 OK created sql table model lead_staging.dim_person ...................... [[32mSELECT 2899539[0m in 33.49s]
[0m07:02:43.339402 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_person
[0m07:02:43.344939 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_fact_network_usage
[0m07:02:43.349933 [info ] [Thread-1 (]: 5 of 5 START sql table model lead_staging.fact_network_usage ................... [RUN]
[0m07:02:43.355377 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_person, now model.dbt_lead_data.staging_fact_network_usage)
[0m07:02:43.360323 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_fact_network_usage
[0m07:02:43.394161 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_fact_network_usage"
[0m07:02:43.415627 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_fact_network_usage
[0m07:02:43.452568 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_fact_network_usage"
[0m07:02:43.471330 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m07:02:43.477149 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: BEGIN
[0m07:02:43.487925 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:02:43.520858 [debug] [Thread-1 (]: SQL status: BEGIN in 0.033 seconds
[0m07:02:43.525362 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m07:02:43.530252 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */

  
    

  create  table "airflow"."lead_staging"."fact_network_usage__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        session_duration,
        download_speed,
        upload_speed,
        consumed_traffic
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:02:46.056293 [debug] [Thread-1 (]: SQL status: SELECT 2899539 in 31.404 seconds
[0m07:02:46.109377 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:02:46.114543 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
alter table "airflow"."lead_staging"."dim_address" rename to "dim_address__dbt_backup"
[0m07:02:46.121778 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m07:02:46.144865 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:02:46.149107 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
alter table "airflow"."lead_staging"."dim_address__dbt_tmp" rename to "dim_address"
[0m07:02:46.155454 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m07:02:46.306306 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m07:02:46.313497 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:02:46.318814 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m07:02:46.328370 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m07:02:46.377698 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_address__dbt_backup"
[0m07:02:46.442870 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:02:46.448179 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
drop table if exists "airflow"."lead_staging"."dim_address__dbt_backup" cascade
[0m07:02:46.527363 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.073 seconds
[0m07:02:46.545246 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: Close
[0m07:02:46.556533 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96dcec26-8e67-4311-804d-932494aa2b1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4eff4d1e80>]}
[0m07:02:46.562942 [info ] [Thread-1 (]: 1 of 5 OK created sql table model lead_staging.dim_address ..................... [[32mSELECT 2899539[0m in 32.34s]
[0m07:02:46.570485 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_adress
[0m07:02:46.575506 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_date
[0m07:02:46.581419 [info ] [Thread-1 (]: 2 of 5 START sql table model lead_staging.dim_date ............................. [RUN]
[0m07:02:46.587791 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_adress, now model.dbt_lead_data.staging_dim_date)
[0m07:02:46.592127 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_date
[0m07:02:46.614229 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_date"
[0m07:02:46.638305 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_date
[0m07:02:46.678122 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_date"
[0m07:02:46.693172 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m07:02:46.700137 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: BEGIN
[0m07:02:46.709332 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:02:46.744790 [debug] [Thread-1 (]: SQL status: BEGIN in 0.036 seconds
[0m07:02:46.750144 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m07:02:46.755348 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */

  
    

  create  table "airflow"."lead_staging"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        accessed_at
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:09:22.800674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1695ed3e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f169606eea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1695eda780>]}


============================== 07:09:22.808860 | 42fc536f-ecc9-4056-a3e7-0c67189d0ff1 ==============================
[0m07:09:22.808860 [info ] [MainThread]: Running with dbt=1.8.0
[0m07:09:22.809919 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select tag:staging', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:09:23.073144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '42fc536f-ecc9-4056-a3e7-0c67189d0ff1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1696e495b0>]}
[0m07:09:23.156629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '42fc536f-ecc9-4056-a3e7-0c67189d0ff1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16962fe180>]}
[0m07:09:23.158285 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:09:23.269088 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m07:09:23.445278 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:09:23.446196 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:09:23.489449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '42fc536f-ecc9-4056-a3e7-0c67189d0ff1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16954d6f30>]}
[0m07:09:23.678790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '42fc536f-ecc9-4056-a3e7-0c67189d0ff1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16951c13a0>]}
[0m07:09:23.684168 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m07:09:23.689492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42fc536f-ecc9-4056-a3e7-0c67189d0ff1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16954ccd70>]}
[0m07:09:23.697536 [info ] [MainThread]: 
[0m07:09:23.701002 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:09:23.709876 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m07:09:23.751948 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m07:09:23.753093 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m07:09:23.753984 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:09:23.760469 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.006 seconds
[0m07:09:23.763008 [debug] [ThreadPool]: On list_airflow: Close
[0m07:09:23.766495 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_trusted)
[0m07:09:23.775999 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:09:23.776914 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m07:09:23.777666 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:09:23.782686 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:09:23.783604 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:09:23.784355 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m07:09:23.787700 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m07:09:23.789830 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m07:09:23.790839 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m07:09:23.791943 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now list_airflow_lead_staging)
[0m07:09:23.795204 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:09:23.795961 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m07:09:23.796652 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:09:23.801156 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m07:09:23.802042 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:09:23.802978 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m07:09:23.806268 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m07:09:23.808178 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m07:09:23.809069 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m07:09:23.816821 [debug] [MainThread]: Using postgres connection "master"
[0m07:09:23.817659 [debug] [MainThread]: On master: BEGIN
[0m07:09:23.818374 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:09:23.824186 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m07:09:23.825236 [debug] [MainThread]: Using postgres connection "master"
[0m07:09:23.826670 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:09:23.831525 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m07:09:23.833832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42fc536f-ecc9-4056-a3e7-0c67189d0ff1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16951c1820>]}
[0m07:09:23.834798 [debug] [MainThread]: On master: ROLLBACK
[0m07:09:23.835801 [debug] [MainThread]: Using postgres connection "master"
[0m07:09:23.836527 [debug] [MainThread]: On master: BEGIN
[0m07:09:23.837877 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:09:23.838687 [debug] [MainThread]: On master: COMMIT
[0m07:09:23.839435 [debug] [MainThread]: Using postgres connection "master"
[0m07:09:23.840248 [debug] [MainThread]: On master: COMMIT
[0m07:09:23.841206 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:09:23.841966 [debug] [MainThread]: On master: Close
[0m07:09:23.842939 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:09:23.843788 [info ] [MainThread]: 
[0m07:09:23.855083 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_adress
[0m07:09:23.856133 [info ] [Thread-1 (]: 1 of 5 START sql table model lead_staging.dim_address .......................... [RUN]
[0m07:09:23.857108 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now model.dbt_lead_data.staging_dim_adress)
[0m07:09:23.857956 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_adress
[0m07:09:23.867854 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_adress"
[0m07:09:23.870860 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_adress
[0m07:09:23.926388 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_adress"
[0m07:09:23.929451 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:09:23.930195 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: BEGIN
[0m07:09:23.930963 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:09:23.936495 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m07:09:23.937343 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:09:23.938147 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */

  
    

  create  table "airflow"."lead_staging"."dim_address__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        address,
        mac_address,
        ip_address
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:09:25.377120 [debug] [Thread-1 (]: SQL status: SELECT 3108892 in 401.760 seconds
[0m07:09:25.381992 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m07:09:25.382679 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
alter table "airflow"."lead_staging"."fact_network_usage" rename to "fact_network_usage__dbt_backup"
[0m07:09:25.383903 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:09:25.387285 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m07:09:25.388095 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
alter table "airflow"."lead_staging"."fact_network_usage__dbt_tmp" rename to "fact_network_usage"
[0m07:09:25.389277 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:09:25.391796 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: COMMIT
[0m07:09:25.392604 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m07:09:25.393333 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: COMMIT
[0m07:09:25.400802 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m07:09:25.403850 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."fact_network_usage__dbt_backup"
[0m07:09:25.405089 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m07:09:25.405864 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
drop table if exists "airflow"."lead_staging"."fact_network_usage__dbt_backup" cascade
[0m07:09:25.417787 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.011 seconds
[0m07:09:25.419877 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: Close
[0m07:09:25.420882 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54fe6fec-c691-4d3a-b648-a3d68884bb13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd9a0460c0>]}
[0m07:09:25.421946 [info ] [Thread-1 (]: 5 of 5 OK created sql table model lead_staging.fact_network_usage .............. [[32mSELECT 3108892[0m in 402.07s]
[0m07:09:25.423069 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_fact_network_usage
[0m07:09:25.425800 [debug] [MainThread]: Using postgres connection "master"
[0m07:09:25.426815 [debug] [MainThread]: On master: BEGIN
[0m07:09:25.427616 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:09:25.432289 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:09:25.433231 [debug] [MainThread]: On master: COMMIT
[0m07:09:25.434064 [debug] [MainThread]: Using postgres connection "master"
[0m07:09:25.434875 [debug] [MainThread]: On master: COMMIT
[0m07:09:25.435831 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:09:25.436648 [debug] [MainThread]: On master: Close
[0m07:09:25.437641 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:09:25.438425 [debug] [MainThread]: Connection 'model.dbt_lead_data.staging_fact_network_usage' was properly closed.
[0m07:09:25.439500 [info ] [MainThread]: 
[0m07:09:25.440440 [info ] [MainThread]: Finished running 5 table models in 0 hours 8 minutes and 28.03 seconds (508.03s).
[0m07:09:25.442621 [debug] [MainThread]: Command end result
[0m07:09:25.505953 [info ] [MainThread]: 
[0m07:09:25.507108 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:09:25.508217 [info ] [MainThread]: 
[0m07:09:25.509236 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m07:09:25.511263 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 513.07745, "process_user_time": 17.423376, "process_kernel_time": 1.457924, "process_mem_max_rss": "117492", "process_in_blocks": "39160", "process_out_blocks": "0"}
[0m07:09:25.512303 [debug] [MainThread]: Command `dbt run` succeeded at 07:09:25.512156 after 513.08 seconds
[0m07:09:25.513134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbda0cef110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd9da01340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd9b9fa060>]}
[0m07:09:25.513967 [debug] [MainThread]: Flushing usage events
[0m07:09:25.691574 [debug] [Thread-1 (]: SQL status: SELECT 3108892 in 398.848 seconds
[0m07:09:25.695740 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m07:09:25.696514 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
alter table "airflow"."lead_staging"."dim_date" rename to "dim_date__dbt_backup"
[0m07:09:25.697788 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:09:25.701383 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m07:09:25.702212 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
alter table "airflow"."lead_staging"."dim_date__dbt_tmp" rename to "dim_date"
[0m07:09:25.703409 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:09:25.706078 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: COMMIT
[0m07:09:25.706857 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m07:09:25.707675 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: COMMIT
[0m07:09:25.721445 [debug] [Thread-1 (]: SQL status: COMMIT in 0.013 seconds
[0m07:09:25.724740 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_date__dbt_backup"
[0m07:09:25.725941 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m07:09:25.726703 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
drop table if exists "airflow"."lead_staging"."dim_date__dbt_backup" cascade
[0m07:09:25.753241 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.026 seconds
[0m07:09:25.755356 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: Close
[0m07:09:25.756576 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96dcec26-8e67-4311-804d-932494aa2b1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4efbbb0c80>]}
[0m07:09:25.757872 [info ] [Thread-1 (]: 2 of 5 OK created sql table model lead_staging.dim_date ........................ [[32mSELECT 3108892[0m in 399.17s]
[0m07:09:25.759307 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_date
[0m07:09:25.760388 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_finance
[0m07:09:25.761798 [info ] [Thread-1 (]: 3 of 5 START sql table model lead_staging.dim_finance .......................... [RUN]
[0m07:09:25.762962 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_date, now model.dbt_lead_data.staging_dim_finance)
[0m07:09:25.763898 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_finance
[0m07:09:25.769045 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_finance"
[0m07:09:25.773081 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_finance
[0m07:09:25.780895 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_finance"
[0m07:09:25.785054 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m07:09:25.786078 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: BEGIN
[0m07:09:25.787022 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:09:25.792070 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m07:09:25.793252 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m07:09:25.794257 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */

  
    

  create  table "airflow"."lead_staging"."dim_finance__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        iban
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:09:30.288491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4b662f7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4b625a7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4b662fa70>]}


============================== 07:09:30.299120 | c699877a-7b64-4a1a-90d1-52d96e7ddc1d ==============================
[0m07:09:30.299120 [info ] [MainThread]: Running with dbt=1.8.0
[0m07:09:30.303965 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select tag:trusted', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:09:31.024752 [debug] [Thread-1 (]: SQL status: SELECT 3108892 in 7.085 seconds
[0m07:09:31.108329 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:09:31.113616 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
alter table "airflow"."lead_staging"."dim_address" rename to "dim_address__dbt_backup"
[0m07:09:31.123568 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m07:09:31.147651 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:09:31.153386 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
alter table "airflow"."lead_staging"."dim_address__dbt_tmp" rename to "dim_address"
[0m07:09:31.161552 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m07:09:31.334047 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m07:09:31.347491 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:09:31.361559 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m07:09:31.397849 [debug] [Thread-1 (]: SQL status: COMMIT in 0.023 seconds
[0m07:09:31.462191 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_address__dbt_backup"
[0m07:09:31.499523 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:09:31.504431 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
drop table if exists "airflow"."lead_staging"."dim_address__dbt_backup" cascade
[0m07:09:31.563609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c699877a-7b64-4a1a-90d1-52d96e7ddc1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4b71c1730>]}
[0m07:09:31.621129 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.111 seconds
[0m07:09:31.637591 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: Close
[0m07:09:31.649420 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42fc536f-ecc9-4056-a3e7-0c67189d0ff1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16973e1dc0>]}
[0m07:09:31.655178 [info ] [Thread-1 (]: 1 of 5 OK created sql table model lead_staging.dim_address ..................... [[32mSELECT 3108892[0m in 7.79s]
[0m07:09:31.661987 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_adress
[0m07:09:31.666521 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_date
[0m07:09:31.673324 [info ] [Thread-1 (]: 2 of 5 START sql table model lead_staging.dim_date ............................. [RUN]
[0m07:09:31.682393 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_adress, now model.dbt_lead_data.staging_dim_date)
[0m07:09:31.688249 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_date
[0m07:09:31.709414 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_date"
[0m07:09:31.725557 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_date
[0m07:09:31.760660 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_date"
[0m07:09:31.777243 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m07:09:31.782544 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: BEGIN
[0m07:09:31.790489 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:09:31.817993 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m07:09:31.822446 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m07:09:31.827303 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */

  
    

  create  table "airflow"."lead_staging"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        accessed_at
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:09:32.090493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c699877a-7b64-4a1a-90d1-52d96e7ddc1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4b62a9a60>]}
[0m07:09:32.105672 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:09:32.821371 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m07:09:33.956138 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:09:33.960406 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:09:34.229561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c699877a-7b64-4a1a-90d1-52d96e7ddc1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4b5dc5fa0>]}
[0m07:09:35.119963 [debug] [Thread-1 (]: SQL status: SELECT 3108892 in 9.324 seconds
[0m07:09:35.145967 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m07:09:35.150939 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
alter table "airflow"."lead_staging"."dim_finance" rename to "dim_finance__dbt_backup"
[0m07:09:35.172409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c699877a-7b64-4a1a-90d1-52d96e7ddc1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4b49509e0>]}
[0m07:09:35.180401 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m07:09:35.192017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c699877a-7b64-4a1a-90d1-52d96e7ddc1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4b5197ec0>]}
[0m07:09:35.212451 [info ] [MainThread]: 
[0m07:09:35.220450 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:09:35.255666 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m07:09:35.487797 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m07:09:35.492665 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m07:09:35.498009 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:09:35.529515 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.032 seconds
[0m07:09:35.541340 [debug] [ThreadPool]: On list_airflow: Close
[0m07:09:35.556489 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_staging)
[0m07:09:35.599586 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:09:35.604228 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m07:09:35.608984 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:09:35.634670 [debug] [ThreadPool]: SQL status: BEGIN in 0.026 seconds
[0m07:09:35.639322 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:09:35.644418 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m07:09:35.663628 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.014 seconds
[0m07:09:35.675573 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m07:09:35.681535 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m07:09:35.689762 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now list_airflow_lead_trusted)
[0m07:09:35.713521 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:09:35.718375 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m07:09:35.723076 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:09:35.747914 [debug] [ThreadPool]: SQL status: BEGIN in 0.025 seconds
[0m07:09:35.752063 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:09:35.756407 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m07:09:35.776577 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.014 seconds
[0m07:09:35.787961 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m07:09:35.793345 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m07:09:35.843639 [debug] [MainThread]: Using postgres connection "master"
[0m07:09:35.849243 [debug] [MainThread]: On master: BEGIN
[0m07:09:35.853328 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:09:35.878455 [debug] [MainThread]: SQL status: BEGIN in 0.025 seconds
[0m07:09:35.884609 [debug] [MainThread]: Using postgres connection "master"
[0m07:09:35.889835 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:09:35.912030 [debug] [MainThread]: SQL status: SELECT 0 in 0.017 seconds
[0m07:09:35.924447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c699877a-7b64-4a1a-90d1-52d96e7ddc1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4b49cde50>]}
[0m07:09:35.929692 [debug] [MainThread]: On master: ROLLBACK
[0m07:09:35.935264 [debug] [MainThread]: Using postgres connection "master"
[0m07:09:35.939690 [debug] [MainThread]: On master: BEGIN
[0m07:09:35.947426 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m07:09:35.951661 [debug] [MainThread]: On master: COMMIT
[0m07:09:35.955614 [debug] [MainThread]: Using postgres connection "master"
[0m07:09:35.959988 [debug] [MainThread]: On master: COMMIT
[0m07:09:35.965230 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m07:09:35.969323 [debug] [MainThread]: On master: Close
[0m07:09:35.974695 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:09:35.979741 [info ] [MainThread]: 
[0m07:09:36.084358 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_non_pii_data
[0m07:09:36.092414 [info ] [Thread-1 (]: 1 of 4 START sql table model lead_trusted.non_pii_data ......................... [RUN]
[0m07:09:36.100972 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now model.dbt_lead_data.trusted_non_pii_data)
[0m07:09:36.106738 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_non_pii_data
[0m07:09:36.161572 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 1.005 seconds
[0m07:09:36.179365 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_non_pii_data"
[0m07:09:36.184521 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m07:09:36.191421 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
alter table "airflow"."lead_staging"."dim_finance__dbt_tmp" rename to "dim_finance"
[0m07:09:36.196495 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_non_pii_data
[0m07:09:36.197498 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:09:36.234437 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: COMMIT
[0m07:09:36.240317 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m07:09:36.245274 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: COMMIT
[0m07:09:36.256342 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m07:09:36.275895 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_finance__dbt_backup"
[0m07:09:36.287588 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m07:09:36.293618 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
drop table if exists "airflow"."lead_staging"."dim_finance__dbt_backup" cascade
[0m07:09:36.444033 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.145 seconds
[0m07:09:36.457157 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: Close
[0m07:09:36.463360 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96dcec26-8e67-4311-804d-932494aa2b1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ef9621cd0>]}
[0m07:09:36.471574 [info ] [Thread-1 (]: 3 of 5 OK created sql table model lead_staging.dim_finance ..................... [[32mSELECT 3108892[0m in 10.70s]
[0m07:09:36.482364 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_finance
[0m07:09:36.490743 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_person
[0m07:09:36.499356 [info ] [Thread-1 (]: 4 of 5 START sql table model lead_staging.dim_person ........................... [RUN]
[0m07:09:36.504703 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_finance, now model.dbt_lead_data.staging_dim_person)
[0m07:09:36.510605 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_person
[0m07:09:36.537201 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_person"
[0m07:09:36.547316 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_non_pii_data"
[0m07:09:36.553492 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_person
[0m07:09:36.568608 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m07:09:36.578746 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: BEGIN
[0m07:09:36.585579 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:09:36.592598 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_person"
[0m07:09:36.607641 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m07:09:36.614336 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: BEGIN
[0m07:09:36.615550 [debug] [Thread-1 (]: SQL status: BEGIN in 0.030 seconds
[0m07:09:36.625394 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:09:36.628308 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m07:09:36.636123 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */

  
    

  create  table "airflow"."lead_trusted"."non_pii_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        '***MASKED***' AS person_name,
        SUBSTRING(dp.user_name, 1, 5) || '*****'  user_name,
        SUBSTRING(dp.email, 1, 5) || '*****' AS email,
        '***MASKED***'  AS personal_number, 
        '***MASKED***' AS birth_date, 
        '***MASKED***' AS address,
        '***MASKED***'  AS phone, 
        SUBSTRING(da.mac_address, 1, 5) || '*****' AS mac_address,
        SUBSTRING(da.ip_address, 1, 5) || '*****' AS ip_address,
        SUBSTRING(df.iban, 1, 5) || '*****' AS iban,
        dd.accessed_at,
        fnu.session_duration,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.consumed_traffic,
        fnu.unique_id
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    INNER JOIN
        "airflow"."lead_staging"."dim_address" da ON fnu.unique_id = da.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_date" dd ON da.unique_id = dd.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_finance" df ON dd.unique_id = df.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_person" dp ON df.unique_id = dp.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:09:36.658500 [debug] [Thread-1 (]: SQL status: BEGIN in 0.034 seconds
[0m07:09:36.665248 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m07:09:36.670653 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */

  
    

  create  table "airflow"."lead_staging"."dim_person__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        person_name,
        user_name,
        email,
        phone,
        birth_date,
        personal_number
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:16:02.490161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12ad984110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12ad9cb020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12ae027260>]}


============================== 07:16:02.500675 | a2be838f-1092-4bdc-9e66-83a400fa5300 ==============================
[0m07:16:02.500675 [info ] [MainThread]: Running with dbt=1.8.0
[0m07:16:02.502160 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select tag:staging', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:16:02.836701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a2be838f-1092-4bdc-9e66-83a400fa5300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12ad9d4290>]}
[0m07:16:02.934596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a2be838f-1092-4bdc-9e66-83a400fa5300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12aeb981d0>]}
[0m07:16:02.936295 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:16:03.067820 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m07:16:03.283184 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:16:03.284558 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:16:03.348917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a2be838f-1092-4bdc-9e66-83a400fa5300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12ad4d4b60>]}
[0m07:16:03.576870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a2be838f-1092-4bdc-9e66-83a400fa5300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12abd7c620>]}
[0m07:16:03.577687 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m07:16:03.578360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2be838f-1092-4bdc-9e66-83a400fa5300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12abd72e40>]}
[0m07:16:03.581129 [info ] [MainThread]: 
[0m07:16:03.582472 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:16:03.589770 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m07:16:03.633428 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m07:16:03.634278 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m07:16:03.635698 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:16:03.643138 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.007 seconds
[0m07:16:03.645832 [debug] [ThreadPool]: On list_airflow: Close
[0m07:16:03.650118 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_trusted)
[0m07:16:03.662212 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:16:03.663625 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m07:16:03.664841 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:16:03.671474 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m07:16:03.672604 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:16:03.673709 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m07:16:03.678323 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m07:16:03.681740 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m07:16:03.683050 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m07:16:03.684823 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now list_airflow_lead_staging)
[0m07:16:03.690888 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:16:03.692490 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m07:16:03.693641 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:16:03.704493 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m07:16:03.706028 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:16:03.707430 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m07:16:03.713071 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.004 seconds
[0m07:16:03.719223 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m07:16:03.723051 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m07:16:03.739088 [debug] [MainThread]: Using postgres connection "master"
[0m07:16:03.741607 [debug] [MainThread]: On master: BEGIN
[0m07:16:03.742999 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:16:03.755666 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m07:16:03.757323 [debug] [MainThread]: Using postgres connection "master"
[0m07:16:03.759118 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:16:03.767682 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m07:16:03.771495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2be838f-1092-4bdc-9e66-83a400fa5300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12aa9f1490>]}
[0m07:16:03.774617 [debug] [MainThread]: On master: ROLLBACK
[0m07:16:03.776363 [debug] [MainThread]: Using postgres connection "master"
[0m07:16:03.777977 [debug] [MainThread]: On master: BEGIN
[0m07:16:03.781957 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m07:16:03.783505 [debug] [MainThread]: On master: COMMIT
[0m07:16:03.784953 [debug] [MainThread]: Using postgres connection "master"
[0m07:16:03.787426 [debug] [MainThread]: On master: COMMIT
[0m07:16:03.789129 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:16:03.790853 [debug] [MainThread]: On master: Close
[0m07:16:03.792759 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:16:03.795071 [info ] [MainThread]: 
[0m07:16:03.817037 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_adress
[0m07:16:03.819093 [info ] [Thread-1 (]: 1 of 5 START sql table model lead_staging.dim_address .......................... [RUN]
[0m07:16:03.822594 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now model.dbt_lead_data.staging_dim_adress)
[0m07:16:03.824155 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_adress
[0m07:16:03.867193 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_adress"
[0m07:16:03.876688 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_adress
[0m07:16:03.995129 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_adress"
[0m07:16:03.999937 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:16:04.001797 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: BEGIN
[0m07:16:04.003075 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:16:04.010751 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m07:16:04.014333 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:16:04.016479 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */

  
    

  create  table "airflow"."lead_staging"."dim_address__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        address,
        mac_address,
        ip_address
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:16:05.490507 [debug] [Thread-1 (]: SQL status: SELECT 3319244 in 393.719 seconds
[0m07:16:05.495733 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m07:16:05.496987 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
alter table "airflow"."lead_staging"."dim_date" rename to "dim_date__dbt_backup"
[0m07:16:09.351270 [debug] [Thread-1 (]: SQL status: SELECT 3319244 in 392.737 seconds
[0m07:16:09.356053 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m07:16:09.356885 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
alter table "airflow"."lead_staging"."dim_person" rename to "dim_person__dbt_backup"
[0m07:16:12.278813 [debug] [Thread-1 (]: SQL status: SELECT 3319244 in 8.259 seconds
[0m07:16:12.320051 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:16:12.325190 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
alter table "airflow"."lead_staging"."dim_address" rename to "dim_address__dbt_backup"
[0m07:16:32.226249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6970389880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f696ff06780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6970799040>]}


============================== 07:16:32.278183 | 796f5d44-d2ab-47ac-ab33-ab579af7f44a ==============================
[0m07:16:32.278183 [info ] [MainThread]: Running with dbt=1.8.0
[0m07:16:32.285585 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select tag:staging', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:16:32.240303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa172c17860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa171fcc9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa170839340>]}


============================== 07:16:32.305783 | 42fd0596-fecf-4409-9900-4ea38c015530 ==============================
[0m07:16:32.305783 [info ] [MainThread]: Running with dbt=1.8.0
[0m07:16:32.319065 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select tag:staging', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:16:34.225035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '796f5d44-d2ab-47ac-ab33-ab579af7f44a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f696ff55b50>]}
[0m07:16:34.225203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '42fd0596-fecf-4409-9900-4ea38c015530', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa17135aea0>]}
[0m07:16:34.697292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '796f5d44-d2ab-47ac-ab33-ab579af7f44a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f696ff558e0>]}
[0m07:16:34.697662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '42fd0596-fecf-4409-9900-4ea38c015530', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa17007bd40>]}
[0m07:16:34.704214 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:16:34.705541 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:16:35.425757 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m07:16:35.427696 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m07:16:36.270686 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:16:36.272312 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:16:36.275261 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:16:36.277873 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:16:36.522385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '796f5d44-d2ab-47ac-ab33-ab579af7f44a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f696ef167b0>]}
[0m07:16:36.524401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '42fd0596-fecf-4409-9900-4ea38c015530', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa16f701b80>]}
[0m07:16:37.644018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '42fd0596-fecf-4409-9900-4ea38c015530', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa16eb7c9e0>]}
[0m07:16:37.655162 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m07:16:37.670310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42fd0596-fecf-4409-9900-4ea38c015530', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa16f76a5d0>]}
[0m07:16:37.670371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '796f5d44-d2ab-47ac-ab33-ab579af7f44a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f696eb4d190>]}
[0m07:16:37.688502 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m07:16:37.698873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '796f5d44-d2ab-47ac-ab33-ab579af7f44a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f696eb97bc0>]}
[0m07:16:37.700133 [info ] [MainThread]: 
[0m07:16:37.709676 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:16:37.719486 [info ] [MainThread]: 
[0m07:16:37.728951 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:16:37.750382 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m07:16:37.767429 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m07:16:38.033141 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m07:16:38.034909 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m07:16:38.040588 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m07:16:38.061855 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m07:16:38.082025 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:16:38.091249 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:16:38.160031 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.068 seconds
[0m07:16:38.162113 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.080 seconds
[0m07:16:38.179046 [debug] [ThreadPool]: On list_airflow: Close
[0m07:16:38.181218 [debug] [ThreadPool]: On list_airflow: Close
[0m07:16:38.210398 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_staging)
[0m07:16:38.216432 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_staging)
[0m07:16:38.278069 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:16:38.283992 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m07:16:38.290877 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:16:38.293453 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:16:38.301221 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m07:16:38.307130 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:16:38.320091 [debug] [ThreadPool]: SQL status: BEGIN in 0.028 seconds
[0m07:16:38.326035 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:16:38.330877 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m07:16:38.335276 [debug] [ThreadPool]: SQL status: BEGIN in 0.028 seconds
[0m07:16:38.340333 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:16:38.345113 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m07:16:38.351966 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.015 seconds
[0m07:16:38.365084 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.015 seconds
[0m07:16:38.365734 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m07:16:38.372113 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m07:16:38.375805 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m07:16:38.378381 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now list_airflow_lead_trusted)
[0m07:16:38.382941 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m07:16:38.390035 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now list_airflow_lead_trusted)
[0m07:16:38.404392 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:16:38.409609 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m07:16:38.414932 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:16:38.417901 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:16:38.423276 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m07:16:38.427768 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:16:38.440324 [debug] [ThreadPool]: SQL status: BEGIN in 0.025 seconds
[0m07:16:38.445991 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:16:38.451196 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m07:16:38.455892 [debug] [ThreadPool]: SQL status: BEGIN in 0.028 seconds
[0m07:16:38.460173 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:16:38.465024 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m07:16:38.472098 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.016 seconds
[0m07:16:38.485997 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m07:16:38.490969 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.019 seconds
[0m07:16:38.491799 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m07:16:38.509894 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m07:16:38.518817 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m07:16:38.557375 [debug] [MainThread]: Using postgres connection "master"
[0m07:16:38.562328 [debug] [MainThread]: On master: BEGIN
[0m07:16:38.567244 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:16:38.572838 [debug] [MainThread]: Using postgres connection "master"
[0m07:16:38.578022 [debug] [MainThread]: On master: BEGIN
[0m07:16:38.582813 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:16:38.595208 [debug] [MainThread]: SQL status: BEGIN in 0.027 seconds
[0m07:16:38.600941 [debug] [MainThread]: Using postgres connection "master"
[0m07:16:38.606460 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:16:38.608865 [debug] [MainThread]: SQL status: BEGIN in 0.026 seconds
[0m07:16:38.616049 [debug] [MainThread]: Using postgres connection "master"
[0m07:16:38.621115 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:16:38.630593 [debug] [MainThread]: SQL status: SELECT 0 in 0.017 seconds
[0m07:16:38.642374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '796f5d44-d2ab-47ac-ab33-ab579af7f44a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f696fbd5a60>]}
[0m07:16:38.643078 [debug] [MainThread]: SQL status: SELECT 0 in 0.016 seconds
[0m07:16:38.647431 [debug] [MainThread]: On master: ROLLBACK
[0m07:16:38.653539 [debug] [MainThread]: Using postgres connection "master"
[0m07:16:38.657135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42fd0596-fecf-4409-9900-4ea38c015530', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa16eb73770>]}
[0m07:16:38.658757 [debug] [MainThread]: On master: BEGIN
[0m07:16:38.662731 [debug] [MainThread]: On master: ROLLBACK
[0m07:16:38.667019 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m07:16:38.669284 [debug] [MainThread]: Using postgres connection "master"
[0m07:16:38.671934 [debug] [MainThread]: On master: COMMIT
[0m07:16:38.673877 [debug] [MainThread]: On master: BEGIN
[0m07:16:38.676397 [debug] [MainThread]: Using postgres connection "master"
[0m07:16:38.681284 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m07:16:38.682146 [debug] [MainThread]: On master: COMMIT
[0m07:16:38.686763 [debug] [MainThread]: On master: COMMIT
[0m07:16:38.690134 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m07:16:38.691328 [debug] [MainThread]: Using postgres connection "master"
[0m07:16:38.694760 [debug] [MainThread]: On master: Close
[0m07:16:38.696275 [debug] [MainThread]: On master: COMMIT
[0m07:16:38.701230 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:16:38.703257 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m07:16:38.707285 [info ] [MainThread]: 
[0m07:16:38.710158 [debug] [MainThread]: On master: Close
[0m07:16:38.716388 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:16:38.725338 [info ] [MainThread]: 
[0m07:16:38.785282 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_adress
[0m07:16:38.792384 [info ] [Thread-1 (]: 1 of 5 START sql table model lead_staging.dim_address .......................... [RUN]
[0m07:16:38.800310 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now model.dbt_lead_data.staging_dim_adress)
[0m07:16:38.804411 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_adress
[0m07:16:38.805319 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_adress
[0m07:16:38.811384 [info ] [Thread-1 (]: 1 of 5 START sql table model lead_staging.dim_address .......................... [RUN]
[0m07:16:38.817483 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now model.dbt_lead_data.staging_dim_adress)
[0m07:16:38.822459 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_adress
[0m07:16:38.864211 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_adress"
[0m07:16:38.877912 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_adress"
[0m07:16:38.879065 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_adress
[0m07:16:38.891233 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_adress
[0m07:16:39.200250 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_adress"
[0m07:16:39.216940 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:16:39.223359 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: BEGIN
[0m07:16:39.231102 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:16:39.231975 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_adress"
[0m07:16:39.251511 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:16:39.264105 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: BEGIN
[0m07:16:39.273297 [debug] [Thread-1 (]: SQL status: BEGIN in 0.042 seconds
[0m07:16:39.276326 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:16:39.281376 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:16:39.288420 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */

  
    

  create  table "airflow"."lead_staging"."dim_address__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        address,
        mac_address,
        ip_address
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:16:39.310982 [debug] [Thread-1 (]: SQL status: BEGIN in 0.036 seconds
[0m07:16:39.316634 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:16:39.321228 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */

  
    

  create  table "airflow"."lead_staging"."dim_address__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        address,
        mac_address,
        ip_address
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:28:23.743982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dfc68b5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dfc263f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dfc688fb0>]}


============================== 07:28:23.785961 | 2bcf5115-89e0-4ba7-b383-485120352382 ==============================
[0m07:28:23.785961 [info ] [MainThread]: Running with dbt=1.8.0
[0m07:28:23.791700 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select tag:staging', 'send_anonymous_usage_stats': 'True'}
[0m07:28:24.996616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2bcf5115-89e0-4ba7-b383-485120352382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dfd1aefc0>]}
[0m07:28:25.403694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2bcf5115-89e0-4ba7-b383-485120352382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dfc5344a0>]}
[0m07:28:25.410415 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:28:25.972496 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m07:28:26.939350 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:28:26.943975 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:28:27.422532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2bcf5115-89e0-4ba7-b383-485120352382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dfaf3c260>]}
[0m07:28:28.440329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2bcf5115-89e0-4ba7-b383-485120352382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dfa324710>]}
[0m07:28:28.449984 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m07:28:28.460147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2bcf5115-89e0-4ba7-b383-485120352382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dfabca300>]}
[0m07:28:28.478472 [info ] [MainThread]: 
[0m07:28:28.486651 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:28:28.517317 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m07:28:28.756937 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m07:28:28.761298 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m07:28:28.764748 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:28:28.791375 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.026 seconds
[0m07:28:28.803387 [debug] [ThreadPool]: On list_airflow: Close
[0m07:28:28.835986 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_staging)
[0m07:28:28.965208 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:28:28.987860 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m07:28:29.001305 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:28:29.046988 [debug] [ThreadPool]: SQL status: BEGIN in 0.038 seconds
[0m07:28:29.054034 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:28:29.062815 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m07:28:29.088787 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.020 seconds
[0m07:28:29.107489 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m07:28:29.115014 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m07:28:29.124003 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now list_airflow_lead_trusted)
[0m07:28:29.185844 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:28:29.192754 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m07:28:29.198857 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:28:29.238965 [debug] [ThreadPool]: SQL status: BEGIN in 0.038 seconds
[0m07:28:29.246277 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:28:29.253591 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m07:28:29.285608 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.025 seconds
[0m07:28:29.303516 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m07:28:29.311254 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m07:28:29.384355 [debug] [MainThread]: Using postgres connection "master"
[0m07:28:29.389591 [debug] [MainThread]: On master: BEGIN
[0m07:28:29.390858 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:28:29.398432 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m07:28:29.400071 [debug] [MainThread]: Using postgres connection "master"
[0m07:28:29.401843 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:28:29.406507 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m07:28:29.409958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2bcf5115-89e0-4ba7-b383-485120352382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dfabca300>]}
[0m07:28:29.411238 [debug] [MainThread]: On master: ROLLBACK
[0m07:28:29.412425 [debug] [MainThread]: Using postgres connection "master"
[0m07:28:29.413510 [debug] [MainThread]: On master: BEGIN
[0m07:28:29.415874 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m07:28:29.416858 [debug] [MainThread]: On master: COMMIT
[0m07:28:29.417995 [debug] [MainThread]: Using postgres connection "master"
[0m07:28:29.419106 [debug] [MainThread]: On master: COMMIT
[0m07:28:29.420468 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:28:29.422220 [debug] [MainThread]: On master: Close
[0m07:28:29.424582 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:28:29.426336 [info ] [MainThread]: 
[0m07:28:29.444944 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_adress
[0m07:28:29.446478 [info ] [Thread-1 (]: 1 of 5 START sql table model lead_staging.dim_address .......................... [RUN]
[0m07:28:29.448879 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now model.dbt_lead_data.staging_dim_adress)
[0m07:28:29.450535 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_adress
[0m07:28:29.465477 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_adress"
[0m07:28:29.469995 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_adress
[0m07:28:29.551332 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_adress"
[0m07:28:29.554089 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:28:29.554821 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: BEGIN
[0m07:28:29.555613 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:28:29.560437 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m07:28:29.561446 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:28:29.562390 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */

  
    

  create  table "airflow"."lead_staging"."dim_address__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        address,
        mac_address,
        ip_address
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:28:29.963391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c04d08770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c03468170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c03bccbf0>]}


============================== 07:28:29.972260 | 032beaf2-d1f9-468c-bbcf-e8978e4ebd1a ==============================
[0m07:28:29.972260 [info ] [MainThread]: Running with dbt=1.8.0
[0m07:28:29.973672 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select tag:staging', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:28:30.283023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '032beaf2-d1f9-468c-bbcf-e8978e4ebd1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c02e22ae0>]}
[0m07:28:30.352600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '032beaf2-d1f9-468c-bbcf-e8978e4ebd1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c0253d490>]}
[0m07:28:30.353748 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:28:30.522463 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m07:28:30.712455 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:28:30.713326 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:28:30.760088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '032beaf2-d1f9-468c-bbcf-e8978e4ebd1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c035d3b60>]}
[0m07:28:30.908762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '032beaf2-d1f9-468c-bbcf-e8978e4ebd1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c015288c0>]}
[0m07:28:30.909796 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m07:28:30.910618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '032beaf2-d1f9-468c-bbcf-e8978e4ebd1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c0340e8d0>]}
[0m07:28:30.913383 [info ] [MainThread]: 
[0m07:28:30.914443 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:28:30.922015 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m07:28:30.972575 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m07:28:30.973440 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m07:28:30.974308 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:28:30.979484 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.005 seconds
[0m07:28:30.981367 [debug] [ThreadPool]: On list_airflow: Close
[0m07:28:30.984552 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_staging)
[0m07:28:30.993201 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:28:30.994223 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m07:28:30.995124 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:28:31.000479 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:28:31.002138 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:28:31.005744 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m07:28:31.009315 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.003 seconds
[0m07:28:31.012043 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m07:28:31.013272 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m07:28:31.014605 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now list_airflow_lead_trusted)
[0m07:28:31.019009 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:28:31.019903 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m07:28:31.020565 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:28:31.026108 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:28:31.026963 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:28:31.027654 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m07:28:31.031328 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m07:28:31.033374 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m07:28:31.034402 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m07:28:31.042207 [debug] [MainThread]: Using postgres connection "master"
[0m07:28:31.043082 [debug] [MainThread]: On master: BEGIN
[0m07:28:31.043824 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:28:31.048290 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m07:28:31.049151 [debug] [MainThread]: Using postgres connection "master"
[0m07:28:31.050053 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:28:31.054139 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m07:28:31.057184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '032beaf2-d1f9-468c-bbcf-e8978e4ebd1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c0019cec0>]}
[0m07:28:31.058241 [debug] [MainThread]: On master: ROLLBACK
[0m07:28:31.059319 [debug] [MainThread]: Using postgres connection "master"
[0m07:28:31.060104 [debug] [MainThread]: On master: BEGIN
[0m07:28:31.061174 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:28:31.061915 [debug] [MainThread]: On master: COMMIT
[0m07:28:31.062588 [debug] [MainThread]: Using postgres connection "master"
[0m07:28:31.063307 [debug] [MainThread]: On master: COMMIT
[0m07:28:31.064174 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:28:31.064904 [debug] [MainThread]: On master: Close
[0m07:28:31.065898 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:28:31.066773 [info ] [MainThread]: 
[0m07:28:31.077970 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_adress
[0m07:28:31.079063 [info ] [Thread-1 (]: 1 of 5 START sql table model lead_staging.dim_address .......................... [RUN]
[0m07:28:31.080090 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now model.dbt_lead_data.staging_dim_adress)
[0m07:28:31.080929 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_adress
[0m07:28:31.090882 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_adress"
[0m07:28:31.093766 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_adress
[0m07:28:31.140775 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_adress"
[0m07:28:31.143078 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:28:31.143838 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: BEGIN
[0m07:28:31.144510 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:28:31.148862 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m07:28:31.149831 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:28:31.150611 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */

  
    

  create  table "airflow"."lead_staging"."dim_address__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        address,
        mac_address,
        ip_address
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:29:11.585556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9264b8fef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92657a5130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9264787b60>]}


============================== 07:29:11.593091 | d52c55ff-8097-48bf-824a-5319beecff9e ==============================
[0m07:29:11.593091 [info ] [MainThread]: Running with dbt=1.8.0
[0m07:29:11.594021 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select tag:staging', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:29:11.878869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd52c55ff-8097-48bf-824a-5319beecff9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92652795e0>]}
[0m07:29:11.942235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd52c55ff-8097-48bf-824a-5319beecff9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92643b40b0>]}
[0m07:29:11.943936 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:29:12.048263 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m07:29:12.184440 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:29:12.185217 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:29:12.222574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd52c55ff-8097-48bf-824a-5319beecff9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9263f1c860>]}
[0m07:29:12.351944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd52c55ff-8097-48bf-824a-5319beecff9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9262778b30>]}
[0m07:29:12.352854 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m07:29:12.353545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd52c55ff-8097-48bf-824a-5319beecff9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9263364ef0>]}
[0m07:29:12.356094 [info ] [MainThread]: 
[0m07:29:12.357081 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:29:12.362752 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m07:29:12.407213 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m07:29:12.408210 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m07:29:12.408839 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:29:12.414488 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.006 seconds
[0m07:29:12.416684 [debug] [ThreadPool]: On list_airflow: Close
[0m07:29:12.419238 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_trusted)
[0m07:29:12.426200 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:29:12.426941 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m07:29:12.427575 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:29:12.431891 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m07:29:12.432632 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:29:12.433324 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m07:29:12.436629 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m07:29:12.438698 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m07:29:12.439635 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m07:29:12.440647 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now list_airflow_lead_staging)
[0m07:29:12.443914 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:29:12.444567 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m07:29:12.445153 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:29:12.448957 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m07:29:12.449728 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:29:12.450423 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m07:29:12.453481 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m07:29:12.455369 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m07:29:12.456324 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m07:29:12.463997 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:12.464810 [debug] [MainThread]: On master: BEGIN
[0m07:29:12.465714 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:29:12.470392 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:29:12.471207 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:12.471937 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:29:12.475879 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m07:29:12.477665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd52c55ff-8097-48bf-824a-5319beecff9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9263ecc980>]}
[0m07:29:12.478718 [debug] [MainThread]: On master: ROLLBACK
[0m07:29:12.479921 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:12.480429 [debug] [MainThread]: On master: BEGIN
[0m07:29:12.482271 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m07:29:12.482919 [debug] [MainThread]: On master: COMMIT
[0m07:29:12.483507 [debug] [MainThread]: Using postgres connection "master"
[0m07:29:12.484201 [debug] [MainThread]: On master: COMMIT
[0m07:29:12.485649 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m07:29:12.486449 [debug] [MainThread]: On master: Close
[0m07:29:12.487598 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:29:12.488207 [info ] [MainThread]: 
[0m07:29:12.499194 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_adress
[0m07:29:12.500353 [info ] [Thread-1 (]: 1 of 5 START sql table model lead_staging.dim_address .......................... [RUN]
[0m07:29:12.501368 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now model.dbt_lead_data.staging_dim_adress)
[0m07:29:12.502144 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_adress
[0m07:29:12.516622 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_adress"
[0m07:29:12.521902 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_adress
[0m07:29:12.580686 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_adress"
[0m07:29:12.583042 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:29:12.583785 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: BEGIN
[0m07:29:12.584429 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:29:12.588796 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m07:29:12.589669 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:29:12.590460 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */

  
    

  create  table "airflow"."lead_staging"."dim_address__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        address,
        mac_address,
        ip_address
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:30:05.016293 [debug] [Thread-1 (]: SQL status: SELECT 28436739 in 1228.425 seconds
[0m07:30:05.023890 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m07:30:05.024775 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
alter table "airflow"."lead_trusted"."non_pii_data" rename to "non_pii_data__dbt_backup"
[0m07:30:05.027656 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m07:30:05.031307 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m07:30:05.032107 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
alter table "airflow"."lead_trusted"."non_pii_data__dbt_tmp" rename to "non_pii_data"
[0m07:30:05.033190 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:30:05.055147 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: COMMIT
[0m07:30:05.055841 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m07:30:05.056590 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: COMMIT
[0m07:30:05.058170 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:30:05.058705 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 832.721 seconds
[0m07:30:05.058691 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 839.552 seconds
[0m07:30:05.058783 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 835.693 seconds
[0m07:30:05.063009 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:30:05.063277 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m07:30:05.063825 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
alter table "airflow"."lead_staging"."dim_address__dbt_tmp" rename to "dim_address"
[0m07:30:05.063462 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m07:30:05.064222 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
alter table "airflow"."lead_staging"."dim_date__dbt_tmp" rename to "dim_date"
[0m07:30:05.064940 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
alter table "airflow"."lead_staging"."dim_person__dbt_tmp" rename to "dim_person"
[0m07:30:05.065089 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:30:05.065877 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:30:05.065665 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."non_pii_data__dbt_backup"
[0m07:30:05.066435 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:30:05.068358 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: COMMIT
[0m07:30:05.069076 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m07:30:05.069087 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: COMMIT
[0m07:30:05.069812 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: COMMIT
[0m07:30:05.070134 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m07:30:05.070877 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: COMMIT
[0m07:30:05.071353 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:30:05.072116 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:30:05.072996 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m07:30:05.073848 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
drop table if exists "airflow"."lead_trusted"."non_pii_data__dbt_backup" cascade
[0m07:30:05.074366 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_date__dbt_backup"
[0m07:30:05.075291 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_person__dbt_backup"
[0m07:30:05.075798 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m07:30:05.076419 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
drop table if exists "airflow"."lead_staging"."dim_date__dbt_backup" cascade
[0m07:30:05.076662 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m07:30:05.077853 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
drop table if exists "airflow"."lead_staging"."dim_person__dbt_backup" cascade
[0m07:30:05.084307 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m07:30:05.086201 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: Close
[0m07:30:05.087303 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42fc536f-ecc9-4056-a3e7-0c67189d0ff1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16939578f0>]}
[0m07:30:05.088448 [info ] [Thread-1 (]: 2 of 5 OK created sql table model lead_staging.dim_date ........................ [[32mSELECT 3319244[0m in 1233.41s]
[0m07:30:05.090115 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_date
[0m07:30:05.090154 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m07:30:05.091106 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.013 seconds
[0m07:30:05.091635 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_finance
[0m07:30:05.091835 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:30:05.092725 [info ] [Thread-1 (]: 3 of 5 START sql table model lead_staging.dim_finance .......................... [RUN]
[0m07:30:05.092879 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m07:30:05.093425 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: Close
[0m07:30:05.093647 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_date, now model.dbt_lead_data.staging_dim_finance)
[0m07:30:05.094403 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96dcec26-8e67-4311-804d-932494aa2b1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4efaff09b0>]}
[0m07:30:05.094655 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_finance
[0m07:30:05.094682 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:30:05.095514 [info ] [Thread-1 (]: 4 of 5 OK created sql table model lead_staging.dim_person ...................... [[32mSELECT 3319244[0m in 1228.59s]
[0m07:30:05.096709 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_person
[0m07:30:05.097649 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_fact_network_usage
[0m07:30:05.098447 [info ] [Thread-1 (]: 5 of 5 START sql table model lead_staging.fact_network_usage ................... [RUN]
[0m07:30:05.098736 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_finance"
[0m07:30:05.099375 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_person, now model.dbt_lead_data.staging_fact_network_usage)
[0m07:30:05.100146 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_fact_network_usage
[0m07:30:05.101369 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_finance
[0m07:30:05.102887 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_address__dbt_backup"
[0m07:30:05.104129 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_fact_network_usage"
[0m07:30:05.106413 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_fact_network_usage
[0m07:30:05.107415 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_finance"
[0m07:30:05.109993 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:30:05.110299 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m07:30:05.110886 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
drop table if exists "airflow"."lead_staging"."dim_address__dbt_backup" cascade
[0m07:30:05.111172 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: BEGIN
[0m07:30:05.111612 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_fact_network_usage"
[0m07:30:05.111942 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:30:05.113945 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m07:30:05.114773 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: BEGIN
[0m07:30:05.115452 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:30:05.116724 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m07:30:05.117471 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m07:30:05.118246 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */

  
    

  create  table "airflow"."lead_staging"."dim_finance__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        iban
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:30:05.119895 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m07:30:05.120677 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m07:30:05.121677 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */

  
    

  create  table "airflow"."lead_staging"."fact_network_usage__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        session_duration,
        download_speed,
        upload_speed,
        consumed_traffic
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:30:05.122973 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.011 seconds
[0m07:30:05.126633 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: Close
[0m07:30:05.128692 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2be838f-1092-4bdc-9e66-83a400fa5300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12aee79670>]}
[0m07:30:05.129835 [info ] [Thread-1 (]: 1 of 5 OK created sql table model lead_staging.dim_address ..................... [[32mSELECT 3319244[0m in 841.31s]
[0m07:30:05.131155 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_adress
[0m07:30:05.132315 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_date
[0m07:30:05.133767 [info ] [Thread-1 (]: 2 of 5 START sql table model lead_staging.dim_date ............................. [RUN]
[0m07:30:05.134747 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_adress, now model.dbt_lead_data.staging_dim_date)
[0m07:30:05.135597 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_date
[0m07:30:05.139960 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_date"
[0m07:30:05.142284 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_date
[0m07:30:05.146639 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_date"
[0m07:30:05.148672 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m07:30:05.149441 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: BEGIN
[0m07:30:05.150266 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:30:05.155639 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m07:30:05.156433 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m07:30:05.157233 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */

  
    

  create  table "airflow"."lead_staging"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        accessed_at
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:30:05.183318 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.109 seconds
[0m07:30:05.186715 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: Close
[0m07:30:05.189014 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c699877a-7b64-4a1a-90d1-52d96e7ddc1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4b6a99250>]}
[0m07:30:05.190183 [info ] [Thread-1 (]: 1 of 4 OK created sql table model lead_trusted.non_pii_data .................... [[32mSELECT 28436739[0m in 1229.09s]
[0m07:30:05.191458 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_non_pii_data
[0m07:30:05.192428 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_payment_data
[0m07:30:05.193414 [info ] [Thread-1 (]: 2 of 4 START sql table model lead_trusted.payment_data ......................... [RUN]
[0m07:30:05.194415 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_non_pii_data, now model.dbt_lead_data.trusted_payment_data)
[0m07:30:05.195553 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_payment_data
[0m07:30:05.199966 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_payment_data"
[0m07:30:05.202609 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_payment_data
[0m07:30:05.206846 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_payment_data"
[0m07:30:05.208929 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m07:30:05.209658 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: BEGIN
[0m07:30:05.210277 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:30:05.215658 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m07:30:05.216637 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m07:30:05.217411 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */

  
    

  create  table "airflow"."lead_trusted"."payment_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        fnu.unique_id,
        df.iban,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.session_duration,
        fnu.consumed_traffic,
        ((fnu.download_speed + fnu.upload_speed + 1)/2) + (fnu.consumed_traffic / (fnu.session_duration + 1)) AS payment_amount
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    JOIN
        "airflow"."lead_staging"."dim_finance" df
    ON
	    fnu.unique_id = df.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:30:13.096857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72b7078a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72b54d7f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72b54de900>]}


============================== 07:30:13.109887 | 41962149-c943-4a1f-855c-0584bdd77074 ==============================
[0m07:30:13.109887 [info ] [MainThread]: Running with dbt=1.8.0
[0m07:30:13.111302 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select tag:staging', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:30:13.498437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '41962149-c943-4a1f-855c-0584bdd77074', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72b4fdd430>]}
[0m07:30:13.584953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '41962149-c943-4a1f-855c-0584bdd77074', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72b89c9a30>]}
[0m07:30:13.586691 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:30:13.701810 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m07:30:13.902910 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:30:13.904021 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:30:13.950535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '41962149-c943-4a1f-855c-0584bdd77074', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72b509da00>]}
[0m07:30:14.137760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '41962149-c943-4a1f-855c-0584bdd77074', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72b3f50c20>]}
[0m07:30:14.139112 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m07:30:14.140801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41962149-c943-4a1f-855c-0584bdd77074', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72b4ade5d0>]}
[0m07:30:14.144561 [info ] [MainThread]: 
[0m07:30:14.146168 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:30:14.153332 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m07:30:14.204732 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m07:30:14.205600 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m07:30:14.206273 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:30:14.212233 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.006 seconds
[0m07:30:14.214496 [debug] [ThreadPool]: On list_airflow: Close
[0m07:30:14.217668 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_staging)
[0m07:30:14.225146 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:30:14.226023 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m07:30:14.226780 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:30:14.231773 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:30:14.232636 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:30:14.233339 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m07:30:14.239155 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.005 seconds
[0m07:30:14.241276 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m07:30:14.242201 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m07:30:14.243301 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now list_airflow_lead_trusted)
[0m07:30:14.247137 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:30:14.247822 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m07:30:14.248556 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:30:14.253193 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:30:14.254062 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:30:14.254851 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m07:30:14.258122 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m07:30:14.259968 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m07:30:14.260892 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m07:30:14.267979 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:14.268826 [debug] [MainThread]: On master: BEGIN
[0m07:30:14.269624 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:30:14.274350 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:30:14.275260 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:14.276035 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:30:14.279654 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m07:30:14.281759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41962149-c943-4a1f-855c-0584bdd77074', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72b3fcdfd0>]}
[0m07:30:14.282665 [debug] [MainThread]: On master: ROLLBACK
[0m07:30:14.283589 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:14.284236 [debug] [MainThread]: On master: BEGIN
[0m07:30:14.285319 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:30:14.286282 [debug] [MainThread]: On master: COMMIT
[0m07:30:14.287006 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:14.287830 [debug] [MainThread]: On master: COMMIT
[0m07:30:14.288763 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:30:14.289513 [debug] [MainThread]: On master: Close
[0m07:30:14.290549 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:30:14.291358 [info ] [MainThread]: 
[0m07:30:14.301969 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_adress
[0m07:30:14.303040 [info ] [Thread-1 (]: 1 of 5 START sql table model lead_staging.dim_address .......................... [RUN]
[0m07:30:14.304007 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now model.dbt_lead_data.staging_dim_adress)
[0m07:30:14.304751 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_adress
[0m07:30:14.313976 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_adress"
[0m07:30:14.316378 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_adress
[0m07:30:14.362098 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_adress"
[0m07:30:14.364692 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:30:14.365500 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: BEGIN
[0m07:30:14.366190 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:30:14.371017 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m07:30:14.371886 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:30:14.372722 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */

  
    

  create  table "airflow"."lead_staging"."dim_address__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        address,
        mac_address,
        ip_address
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:30:25.725678 [debug] [Thread-1 (]: SQL status: SELECT 4164290 in 114.587 seconds
[0m07:30:25.733753 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:30:25.734610 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
alter table "airflow"."lead_staging"."dim_address" rename to "dim_address__dbt_backup"
[0m07:30:25.736959 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m07:30:25.740898 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:30:25.741862 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
alter table "airflow"."lead_staging"."dim_address__dbt_tmp" rename to "dim_address"
[0m07:30:25.743285 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:30:25.769794 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m07:30:25.770973 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:30:25.772327 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m07:30:25.781229 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m07:30:25.789032 [debug] [Thread-1 (]: SQL status: SELECT 4376994 in 20.631 seconds
[0m07:30:25.789083 [debug] [Thread-1 (]: SQL status: SELECT 4376994 in 20.670 seconds
[0m07:30:25.791713 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_address__dbt_backup"
[0m07:30:25.794433 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m07:30:25.795648 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m07:30:25.795877 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
alter table "airflow"."lead_staging"."dim_date" rename to "dim_date__dbt_backup"
[0m07:30:25.796926 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
alter table "airflow"."lead_staging"."dim_finance" rename to "dim_finance__dbt_backup"
[0m07:30:25.799614 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m07:30:25.801723 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:30:25.802765 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
drop table if exists "airflow"."lead_staging"."dim_address__dbt_backup" cascade
[0m07:30:25.805111 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m07:30:25.806286 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
alter table "airflow"."lead_staging"."dim_date__dbt_tmp" rename to "dim_date"
[0m07:30:25.812089 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m07:30:25.816070 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: COMMIT
[0m07:30:25.817230 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m07:30:25.818624 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: COMMIT
[0m07:30:25.823866 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m07:30:25.826808 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.023 seconds
[0m07:30:25.829150 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_date__dbt_backup"
[0m07:30:25.831192 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m07:30:25.831643 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: Close
[0m07:30:25.832330 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
drop table if exists "airflow"."lead_staging"."dim_date__dbt_backup" cascade
[0m07:30:25.834927 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '032beaf2-d1f9-468c-bbcf-e8978e4ebd1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c04675b50>]}
[0m07:30:25.836829 [info ] [Thread-1 (]: 1 of 5 OK created sql table model lead_staging.dim_address ..................... [[32mSELECT 4164290[0m in 114.75s]
[0m07:30:25.838878 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_adress
[0m07:30:25.840550 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_date
[0m07:30:25.842436 [info ] [Thread-1 (]: 2 of 5 START sql table model lead_staging.dim_date ............................. [RUN]
[0m07:30:25.844386 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_adress, now model.dbt_lead_data.staging_dim_date)
[0m07:30:25.845893 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_date
[0m07:30:25.846586 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.013 seconds
[0m07:30:25.849956 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: Close
[0m07:30:25.851891 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2be838f-1092-4bdc-9e66-83a400fa5300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12aa703320>]}
[0m07:30:25.852195 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_date"
[0m07:30:25.853675 [info ] [Thread-1 (]: 2 of 5 OK created sql table model lead_staging.dim_date ........................ [[32mSELECT 4376994[0m in 20.72s]
[0m07:30:25.855154 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_date
[0m07:30:25.857242 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_finance
[0m07:30:25.858057 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_date
[0m07:30:25.858905 [info ] [Thread-1 (]: 3 of 5 START sql table model lead_staging.dim_finance .......................... [RUN]
[0m07:30:25.860326 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_date, now model.dbt_lead_data.staging_dim_finance)
[0m07:30:25.861658 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_finance
[0m07:30:25.866359 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_date"
[0m07:30:25.868952 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_finance"
[0m07:30:25.872004 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m07:30:25.872948 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_finance
[0m07:30:25.873627 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: BEGIN
[0m07:30:25.875064 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:30:25.883976 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m07:30:25.885047 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_finance"
[0m07:30:25.885394 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m07:30:25.886925 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */

  
    

  create  table "airflow"."lead_staging"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        accessed_at
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:30:25.888638 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m07:30:25.890061 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: BEGIN
[0m07:30:25.891270 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:30:25.898551 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m07:30:25.900191 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m07:30:25.901205 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */

  
    

  create  table "airflow"."lead_staging"."dim_finance__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        iban
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:30:25.910603 [debug] [Thread-1 (]: SQL status: SELECT 4376994 in 20.787 seconds
[0m07:30:25.918913 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m07:30:25.920122 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
alter table "airflow"."lead_staging"."fact_network_usage" rename to "fact_network_usage__dbt_backup"
[0m07:30:32.166156 [debug] [Thread-1 (]: SQL status: SELECT 4811372 in 26.948 seconds
[0m07:30:32.170307 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m07:30:32.171187 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
alter table "airflow"."lead_trusted"."payment_data" rename to "payment_data__dbt_backup"
[0m07:30:32.172967 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:30:32.176796 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m07:30:32.177693 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
alter table "airflow"."lead_trusted"."payment_data__dbt_tmp" rename to "payment_data"
[0m07:30:32.179226 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:30:32.181993 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: COMMIT
[0m07:30:32.182848 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m07:30:32.183601 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: COMMIT
[0m07:30:32.192074 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m07:30:32.192223 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 6.271 seconds
[0m07:30:32.192207 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 6.394 seconds
[0m07:30:32.195679 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."payment_data__dbt_backup"
[0m07:30:32.196471 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m07:30:32.196959 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m07:30:32.196991 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m07:30:32.197334 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
alter table "airflow"."lead_staging"."fact_network_usage__dbt_tmp" rename to "fact_network_usage"
[0m07:30:32.197777 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
alter table "airflow"."lead_staging"."dim_finance__dbt_tmp" rename to "dim_finance"
[0m07:30:32.198082 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
drop table if exists "airflow"."lead_trusted"."payment_data__dbt_backup" cascade
[0m07:30:32.198887 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:30:32.199091 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:30:32.201763 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: COMMIT
[0m07:30:32.202354 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: COMMIT
[0m07:30:32.202589 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m07:30:32.203322 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m07:30:32.203741 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: COMMIT
[0m07:30:32.204173 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: COMMIT
[0m07:30:32.206815 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m07:30:32.208216 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m07:30:32.210575 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."fact_network_usage__dbt_backup"
[0m07:30:32.212070 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m07:30:32.212169 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_finance__dbt_backup"
[0m07:30:32.212961 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
drop table if exists "airflow"."lead_staging"."fact_network_usage__dbt_backup" cascade
[0m07:30:32.213927 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m07:30:32.214731 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
drop table if exists "airflow"."lead_staging"."dim_finance__dbt_backup" cascade
[0m07:30:32.218949 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.020 seconds
[0m07:30:32.221227 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: Close
[0m07:30:32.222866 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c699877a-7b64-4a1a-90d1-52d96e7ddc1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4b3164680>]}
[0m07:30:32.224115 [info ] [Thread-1 (]: 2 of 4 OK created sql table model lead_trusted.payment_data .................... [[32mSELECT 4811372[0m in 27.03s]
[0m07:30:32.224857 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.011 seconds
[0m07:30:32.225531 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_payment_data
[0m07:30:32.226672 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_pii_data
[0m07:30:32.226964 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.011 seconds
[0m07:30:32.227880 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: Close
[0m07:30:32.227927 [info ] [Thread-1 (]: 3 of 4 START sql table model lead_trusted.pii_data ............................. [RUN]
[0m07:30:32.229264 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96dcec26-8e67-4311-804d-932494aa2b1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ef960b650>]}
[0m07:30:32.229845 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: Close
[0m07:30:32.229505 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_payment_data, now model.dbt_lead_data.trusted_pii_data)
[0m07:30:32.230807 [info ] [Thread-1 (]: 5 of 5 OK created sql table model lead_staging.fact_network_usage .............. [[32mSELECT 4376994[0m in 27.13s]
[0m07:30:32.231182 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42fc536f-ecc9-4056-a3e7-0c67189d0ff1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1691509640>]}
[0m07:30:32.231252 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_pii_data
[0m07:30:32.232290 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_fact_network_usage
[0m07:30:32.232780 [info ] [Thread-1 (]: 3 of 5 OK created sql table model lead_staging.dim_finance ..................... [[32mSELECT 4376994[0m in 27.14s]
[0m07:30:32.234248 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_finance
[0m07:30:32.235307 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_person
[0m07:30:32.236091 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:32.236570 [info ] [Thread-1 (]: 4 of 5 START sql table model lead_staging.dim_person ........................... [RUN]
[0m07:30:32.237192 [debug] [MainThread]: On master: BEGIN
[0m07:30:32.237860 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_finance, now model.dbt_lead_data.staging_dim_person)
[0m07:30:32.238110 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:30:32.238395 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_pii_data"
[0m07:30:32.238981 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_person
[0m07:30:32.242649 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_pii_data
[0m07:30:32.243686 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_person"
[0m07:30:32.243938 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m07:30:32.244971 [debug] [MainThread]: On master: COMMIT
[0m07:30:32.245853 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:32.246238 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_person
[0m07:30:32.246717 [debug] [MainThread]: On master: COMMIT
[0m07:30:32.247830 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:30:32.248556 [debug] [MainThread]: On master: Close
[0m07:30:32.249541 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_pii_data"
[0m07:30:32.249706 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:30:32.250835 [debug] [MainThread]: Connection 'model.dbt_lead_data.staging_fact_network_usage' was properly closed.
[0m07:30:32.251432 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_person"
[0m07:30:32.251825 [info ] [MainThread]: 
[0m07:30:32.253106 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m07:30:32.253185 [info ] [MainThread]: Finished running 5 table models in 0 hours 28 minutes and 19.11 seconds (1699.11s).
[0m07:30:32.254867 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: BEGIN
[0m07:30:32.255676 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m07:30:32.255886 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:30:32.256721 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: BEGIN
[0m07:30:32.257215 [debug] [MainThread]: Command end result
[0m07:30:32.257691 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:30:32.261278 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m07:30:32.262344 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m07:30:32.262958 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m07:30:32.263346 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */

  
    

  create  table "airflow"."lead_trusted"."pii_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        dp.person_name,
        dp.user_name,
        dp.email,
        dp.personal_number, 
        dp.birth_date, 
        da.address,
        dp.phone, 
        da.mac_address,
        da.ip_address,
        df.iban,
        dd.accessed_at,
        fnu.session_duration,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.consumed_traffic,
        fnu.unique_id
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    INNER JOIN
        "airflow"."lead_staging"."dim_address" da ON fnu.unique_id = da.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_date" dd ON da.unique_id = dd.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_finance" df ON dd.unique_id = df.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_person" dp ON df.unique_id = dp.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:30:32.264018 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m07:30:32.265341 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */

  
    

  create  table "airflow"."lead_staging"."dim_person__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        person_name,
        user_name,
        email,
        phone,
        birth_date,
        personal_number
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:30:32.344121 [info ] [MainThread]: 
[0m07:30:32.346179 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:30:32.347707 [info ] [MainThread]: 
[0m07:30:32.349017 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m07:30:32.352946 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1705.0137, "process_user_time": 20.7389, "process_kernel_time": 1.783052, "process_mem_max_rss": "117456", "process_in_blocks": "30232", "process_out_blocks": "0"}
[0m07:30:32.354064 [debug] [MainThread]: Command `dbt run` succeeded at 07:30:32.353897 after 1705.01 seconds
[0m07:30:32.355313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4efe02d4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4efc760530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4efea09640>]}
[0m07:30:32.356511 [debug] [MainThread]: Flushing usage events
[0m07:30:38.563763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bf818de50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bfbb45f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bf818ef60>]}


============================== 07:30:38.573850 | d1ec6835-7c52-4692-a11a-d98e7c576a88 ==============================
[0m07:30:38.573850 [info ] [MainThread]: Running with dbt=1.8.0
[0m07:30:38.574953 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select tag:trusted', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:30:38.980070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd1ec6835-7c52-4692-a11a-d98e7c576a88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bf9061b80>]}
[0m07:30:39.091478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd1ec6835-7c52-4692-a11a-d98e7c576a88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bf9647350>]}
[0m07:30:39.093542 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:30:39.249810 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m07:30:39.479193 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:30:39.480069 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:30:39.524015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1ec6835-7c52-4692-a11a-d98e7c576a88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bf7ce5730>]}
[0m07:30:39.686313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd1ec6835-7c52-4692-a11a-d98e7c576a88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bf6578ad0>]}
[0m07:30:39.687290 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m07:30:39.688181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1ec6835-7c52-4692-a11a-d98e7c576a88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bf7d78a10>]}
[0m07:30:39.690861 [info ] [MainThread]: 
[0m07:30:39.692009 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:30:39.698680 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m07:30:39.745852 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m07:30:39.746730 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m07:30:39.747474 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:30:39.764331 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.017 seconds
[0m07:30:39.766588 [debug] [ThreadPool]: On list_airflow: Close
[0m07:30:39.769546 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_trusted)
[0m07:30:39.777154 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:30:39.778007 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m07:30:39.778806 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:30:39.783518 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:30:39.784384 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:30:39.785204 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m07:30:39.789048 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m07:30:39.791016 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m07:30:39.791956 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m07:30:39.793046 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now list_airflow_lead_staging)
[0m07:30:39.796489 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:30:39.797272 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m07:30:39.798050 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:30:39.802763 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:30:39.803599 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:30:39.804578 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m07:30:39.808271 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.003 seconds
[0m07:30:39.810266 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m07:30:39.811213 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m07:30:39.819343 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:39.820411 [debug] [MainThread]: On master: BEGIN
[0m07:30:39.821340 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:30:39.826646 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:30:39.827591 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:39.828473 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:30:39.832517 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m07:30:39.834703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1ec6835-7c52-4692-a11a-d98e7c576a88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bf9520c20>]}
[0m07:30:39.835662 [debug] [MainThread]: On master: ROLLBACK
[0m07:30:39.836676 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:39.837332 [debug] [MainThread]: On master: BEGIN
[0m07:30:39.838710 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m07:30:39.839414 [debug] [MainThread]: On master: COMMIT
[0m07:30:39.840236 [debug] [MainThread]: Using postgres connection "master"
[0m07:30:39.841018 [debug] [MainThread]: On master: COMMIT
[0m07:30:39.842121 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:30:39.842949 [debug] [MainThread]: On master: Close
[0m07:30:39.844168 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:30:39.845094 [info ] [MainThread]: 
[0m07:30:39.856278 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_non_pii_data
[0m07:30:39.857351 [info ] [Thread-1 (]: 1 of 4 START sql table model lead_trusted.non_pii_data ......................... [RUN]
[0m07:30:39.858254 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now model.dbt_lead_data.trusted_non_pii_data)
[0m07:30:39.859146 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_non_pii_data
[0m07:30:39.870465 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_non_pii_data"
[0m07:30:39.873697 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_non_pii_data
[0m07:30:39.921862 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_non_pii_data"
[0m07:30:39.924898 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m07:30:39.925690 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: BEGIN
[0m07:30:39.926413 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:30:39.931900 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m07:30:39.932879 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m07:30:39.933768 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */

  
    

  create  table "airflow"."lead_trusted"."non_pii_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        '***MASKED***' AS person_name,
        SUBSTRING(dp.user_name, 1, 5) || '*****'  user_name,
        SUBSTRING(dp.email, 1, 5) || '*****' AS email,
        '***MASKED***'  AS personal_number, 
        '***MASKED***' AS birth_date, 
        '***MASKED***' AS address,
        '***MASKED***'  AS phone, 
        SUBSTRING(da.mac_address, 1, 5) || '*****' AS mac_address,
        SUBSTRING(da.ip_address, 1, 5) || '*****' AS ip_address,
        SUBSTRING(df.iban, 1, 5) || '*****' AS iban,
        dd.accessed_at,
        fnu.session_duration,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.consumed_traffic,
        fnu.unique_id
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    INNER JOIN
        "airflow"."lead_staging"."dim_address" da ON fnu.unique_id = da.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_date" dd ON da.unique_id = dd.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_finance" df ON dd.unique_id = df.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_person" dp ON df.unique_id = dp.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:30:41.639711 [debug] [Thread-1 (]: SQL status: SELECT 4164290 in 132.089 seconds
[0m07:30:41.647428 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:30:41.648400 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
alter table "airflow"."lead_staging"."dim_address" rename to "dim_address__dbt_backup"
[0m07:30:42.214425 [debug] [Thread-1 (]: SQL status: SELECT 4590259 in 16.326 seconds
[0m07:30:42.218512 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m07:30:42.219271 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
alter table "airflow"."lead_staging"."dim_date" rename to "dim_date__dbt_backup"
[0m07:30:47.256130 [debug] [Thread-1 (]: SQL status: SELECT 4590259 in 21.354 seconds
[0m07:30:47.260665 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m07:30:47.261633 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
alter table "airflow"."lead_staging"."dim_finance" rename to "dim_finance__dbt_backup"
[0m07:30:48.523232 [debug] [Thread-1 (]: SQL status: SELECT 4590259 in 16.256 seconds
[0m07:30:48.529427 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m07:30:48.530611 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
alter table "airflow"."lead_staging"."dim_person" rename to "dim_person__dbt_backup"
[0m07:31:14.235164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1661665ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1661978800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f166062b7d0>]}


============================== 07:31:14.249431 | fd98045c-8973-40f1-bdac-dbce45909382 ==============================
[0m07:31:14.249431 [info ] [MainThread]: Running with dbt=1.8.0
[0m07:31:14.250747 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select tag:staging', 'send_anonymous_usage_stats': 'True'}
[0m07:31:14.667500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd98045c-8973-40f1-bdac-dbce45909382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f165fa7c6b0>]}
[0m07:31:14.741010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fd98045c-8973-40f1-bdac-dbce45909382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16600c8560>]}
[0m07:31:14.742755 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:31:14.847053 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m07:31:15.052600 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:31:15.053483 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:31:15.097071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd98045c-8973-40f1-bdac-dbce45909382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1660564230>]}
[0m07:31:15.251627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd98045c-8973-40f1-bdac-dbce45909382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f165e57cb00>]}
[0m07:31:15.252638 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m07:31:15.253407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd98045c-8973-40f1-bdac-dbce45909382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f165f16ca10>]}
[0m07:31:15.256272 [info ] [MainThread]: 
[0m07:31:15.257590 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:31:15.263948 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m07:31:15.312685 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m07:31:15.313631 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m07:31:15.314514 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:31:15.327431 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.013 seconds
[0m07:31:15.330092 [debug] [ThreadPool]: On list_airflow: Close
[0m07:31:15.333447 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_staging)
[0m07:31:15.340689 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:31:15.341567 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m07:31:15.342378 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:31:15.347911 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:31:15.348915 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:31:15.349775 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m07:31:15.353398 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.003 seconds
[0m07:31:15.355586 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m07:31:15.356708 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m07:31:15.357893 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now list_airflow_lead_trusted)
[0m07:31:15.361728 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:31:15.362589 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m07:31:15.363257 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:31:15.368117 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:31:15.368934 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:31:15.369824 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m07:31:15.373287 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m07:31:15.375407 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m07:31:15.376403 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m07:31:15.384993 [debug] [MainThread]: Using postgres connection "master"
[0m07:31:15.386344 [debug] [MainThread]: On master: BEGIN
[0m07:31:15.387440 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:31:15.393001 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:31:15.394039 [debug] [MainThread]: Using postgres connection "master"
[0m07:31:15.395003 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:31:15.399421 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m07:31:15.401968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd98045c-8973-40f1-bdac-dbce45909382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16611c89e0>]}
[0m07:31:15.403092 [debug] [MainThread]: On master: ROLLBACK
[0m07:31:15.404282 [debug] [MainThread]: Using postgres connection "master"
[0m07:31:15.405193 [debug] [MainThread]: On master: BEGIN
[0m07:31:15.406774 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m07:31:15.407760 [debug] [MainThread]: On master: COMMIT
[0m07:31:15.408551 [debug] [MainThread]: Using postgres connection "master"
[0m07:31:15.409388 [debug] [MainThread]: On master: COMMIT
[0m07:31:15.410536 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:31:15.411339 [debug] [MainThread]: On master: Close
[0m07:31:15.412451 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:31:15.413416 [info ] [MainThread]: 
[0m07:31:15.426097 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_adress
[0m07:31:15.427288 [info ] [Thread-1 (]: 1 of 5 START sql table model lead_staging.dim_address .......................... [RUN]
[0m07:31:15.428623 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now model.dbt_lead_data.staging_dim_adress)
[0m07:31:15.429769 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_adress
[0m07:31:15.439836 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_adress"
[0m07:31:15.442766 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_adress
[0m07:31:15.495197 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_adress"
[0m07:31:15.498669 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:31:15.499686 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: BEGIN
[0m07:31:15.500579 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:31:15.507141 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m07:31:15.508640 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:31:15.510325 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */

  
    

  create  table "airflow"."lead_staging"."dim_address__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        address,
        mac_address,
        ip_address
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:32:18.555713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58e3957c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58e3ae3890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58e5490a10>]}


============================== 07:32:18.564922 | 8757fde5-667e-4616-84fb-133346f80c63 ==============================
[0m07:32:18.564922 [info ] [MainThread]: Running with dbt=1.8.0
[0m07:32:18.566036 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select tag:staging', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:32:18.967620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8757fde5-667e-4616-84fb-133346f80c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58e34a1460>]}
[0m07:32:19.098295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8757fde5-667e-4616-84fb-133346f80c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58e34516d0>]}
[0m07:32:19.100213 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:32:19.227603 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m07:32:19.435070 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:32:19.435876 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:32:19.486247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8757fde5-667e-4616-84fb-133346f80c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58e34c0b00>]}
[0m07:32:19.645827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8757fde5-667e-4616-84fb-133346f80c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58e34c1490>]}
[0m07:32:19.647015 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m07:32:19.647924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8757fde5-667e-4616-84fb-133346f80c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58e3470fb0>]}
[0m07:32:19.650667 [info ] [MainThread]: 
[0m07:32:19.651801 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:32:19.659203 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m07:32:19.706767 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m07:32:19.707649 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m07:32:19.708638 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:32:19.715977 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.007 seconds
[0m07:32:19.718067 [debug] [ThreadPool]: On list_airflow: Close
[0m07:32:19.720989 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_staging)
[0m07:32:19.728475 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:32:19.729481 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m07:32:19.730141 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:32:19.735132 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:32:19.736015 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:32:19.736785 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m07:32:19.740705 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.003 seconds
[0m07:32:19.742854 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m07:32:19.743803 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m07:32:19.745026 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now list_airflow_lead_trusted)
[0m07:32:19.748916 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:32:19.749758 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m07:32:19.750458 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:32:19.755150 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:32:19.756120 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:32:19.756951 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m07:32:19.760660 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m07:32:19.762916 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m07:32:19.764048 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m07:32:19.772262 [debug] [MainThread]: Using postgres connection "master"
[0m07:32:19.773151 [debug] [MainThread]: On master: BEGIN
[0m07:32:19.773836 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:32:19.778279 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m07:32:19.779069 [debug] [MainThread]: Using postgres connection "master"
[0m07:32:19.780063 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:32:19.783910 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m07:32:19.786028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8757fde5-667e-4616-84fb-133346f80c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58e2f3c410>]}
[0m07:32:19.786905 [debug] [MainThread]: On master: ROLLBACK
[0m07:32:19.787709 [debug] [MainThread]: Using postgres connection "master"
[0m07:32:19.788327 [debug] [MainThread]: On master: BEGIN
[0m07:32:19.789612 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m07:32:19.790240 [debug] [MainThread]: On master: COMMIT
[0m07:32:19.790940 [debug] [MainThread]: Using postgres connection "master"
[0m07:32:19.791573 [debug] [MainThread]: On master: COMMIT
[0m07:32:19.792487 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:32:19.793222 [debug] [MainThread]: On master: Close
[0m07:32:19.794144 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:32:19.794899 [info ] [MainThread]: 
[0m07:32:19.806184 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_adress
[0m07:32:19.807249 [info ] [Thread-1 (]: 1 of 5 START sql table model lead_staging.dim_address .......................... [RUN]
[0m07:32:19.808261 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now model.dbt_lead_data.staging_dim_adress)
[0m07:32:19.808981 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_adress
[0m07:32:19.818809 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_adress"
[0m07:32:19.821647 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_adress
[0m07:32:19.871702 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_adress"
[0m07:32:19.874812 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:32:19.875790 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: BEGIN
[0m07:32:19.876684 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:32:19.882258 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m07:32:19.883241 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:32:19.884121 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */

  
    

  create  table "airflow"."lead_staging"."dim_address__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        address,
        mac_address,
        ip_address
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:33:15.716286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57b6830d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57b4cf04d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57b54d3c20>]}


============================== 07:33:15.725067 | 10dbb8ee-ef2c-448a-ab9a-cd86a0d8d864 ==============================
[0m07:33:15.725067 [info ] [MainThread]: Running with dbt=1.8.0
[0m07:33:15.726033 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select tag:staging', 'send_anonymous_usage_stats': 'True'}
[0m07:33:16.090404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '10dbb8ee-ef2c-448a-ab9a-cd86a0d8d864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57b47f0470>]}
[0m07:33:16.163432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '10dbb8ee-ef2c-448a-ab9a-cd86a0d8d864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57b58becc0>]}
[0m07:33:16.165253 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:33:16.327309 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m07:33:16.534469 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:33:16.535445 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:33:16.591931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '10dbb8ee-ef2c-448a-ab9a-cd86a0d8d864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57b3fa40b0>]}
[0m07:33:16.768436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '10dbb8ee-ef2c-448a-ab9a-cd86a0d8d864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57b379da90>]}
[0m07:33:16.769407 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m07:33:16.770271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '10dbb8ee-ef2c-448a-ab9a-cd86a0d8d864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57b3f665d0>]}
[0m07:33:16.772945 [info ] [MainThread]: 
[0m07:33:16.774086 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:33:16.779997 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m07:33:16.828847 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m07:33:16.829790 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m07:33:16.830737 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:33:16.838652 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.008 seconds
[0m07:33:16.843255 [debug] [ThreadPool]: On list_airflow: Close
[0m07:33:16.846162 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_staging)
[0m07:33:16.852972 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:33:16.853867 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m07:33:16.854601 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:33:16.860631 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m07:33:16.861783 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:33:16.862707 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m07:33:16.866488 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.003 seconds
[0m07:33:16.869354 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m07:33:16.870814 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m07:33:16.871878 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now list_airflow_lead_trusted)
[0m07:33:16.875118 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:33:16.875777 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m07:33:16.876351 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:33:16.881225 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:33:16.882121 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:33:16.882949 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m07:33:16.886693 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m07:33:16.888846 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m07:33:16.889769 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m07:33:16.898194 [debug] [MainThread]: Using postgres connection "master"
[0m07:33:16.899026 [debug] [MainThread]: On master: BEGIN
[0m07:33:16.899742 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:33:16.905010 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:33:16.906111 [debug] [MainThread]: Using postgres connection "master"
[0m07:33:16.908022 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:33:16.914413 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m07:33:16.919560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '10dbb8ee-ef2c-448a-ab9a-cd86a0d8d864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57b47c6060>]}
[0m07:33:16.922578 [debug] [MainThread]: On master: ROLLBACK
[0m07:33:16.925508 [debug] [MainThread]: Using postgres connection "master"
[0m07:33:16.928706 [debug] [MainThread]: On master: BEGIN
[0m07:33:16.930991 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m07:33:16.932971 [debug] [MainThread]: On master: COMMIT
[0m07:33:16.934912 [debug] [MainThread]: Using postgres connection "master"
[0m07:33:16.937518 [debug] [MainThread]: On master: COMMIT
[0m07:33:16.941350 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m07:33:16.944314 [debug] [MainThread]: On master: Close
[0m07:33:16.946905 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:33:16.949465 [info ] [MainThread]: 
[0m07:33:16.975100 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_adress
[0m07:33:16.977900 [info ] [Thread-1 (]: 1 of 5 START sql table model lead_staging.dim_address .......................... [RUN]
[0m07:33:16.981823 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now model.dbt_lead_data.staging_dim_adress)
[0m07:33:16.983341 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_adress
[0m07:33:16.999817 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_adress"
[0m07:33:17.006284 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_adress
[0m07:33:17.105574 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_adress"
[0m07:33:17.111090 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:33:17.113071 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: BEGIN
[0m07:33:17.115464 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:33:17.125421 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m07:33:17.127323 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:33:17.129263 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */

  
    

  create  table "airflow"."lead_staging"."dim_address__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        address,
        mac_address,
        ip_address
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:33:20.705298 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 159.056 seconds
[0m07:33:20.705350 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 158.485 seconds
[0m07:33:20.705184 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 152.173 seconds
[0m07:33:20.705439 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 153.443 seconds
[0m07:33:20.710825 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:33:20.711249 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m07:33:20.710899 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m07:33:20.712063 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
alter table "airflow"."lead_staging"."dim_address__dbt_tmp" rename to "dim_address"
[0m07:33:20.712244 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m07:33:20.712668 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
alter table "airflow"."lead_staging"."dim_person__dbt_tmp" rename to "dim_person"
[0m07:33:20.712972 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
alter table "airflow"."lead_staging"."dim_date__dbt_tmp" rename to "dim_date"
[0m07:33:20.713828 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
alter table "airflow"."lead_staging"."dim_finance__dbt_tmp" rename to "dim_finance"
[0m07:33:20.714458 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:33:20.714908 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:33:20.715720 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:33:20.716563 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:33:20.718683 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: COMMIT
[0m07:33:20.719182 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: COMMIT
[0m07:33:20.719928 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m07:33:20.720409 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m07:33:20.720510 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: COMMIT
[0m07:33:20.720985 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: COMMIT
[0m07:33:20.721470 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: COMMIT
[0m07:33:20.722154 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m07:33:20.723445 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: COMMIT
[0m07:33:20.725294 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m07:33:20.725935 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m07:33:20.725852 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:33:20.729768 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_date__dbt_backup"
[0m07:33:20.729906 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_finance__dbt_backup"
[0m07:33:20.729803 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_person__dbt_backup"
[0m07:33:20.731290 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m07:33:20.731948 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m07:33:20.732160 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m07:33:20.735017 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
drop table if exists "airflow"."lead_staging"."dim_date__dbt_backup" cascade
[0m07:33:20.735411 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
drop table if exists "airflow"."lead_staging"."dim_finance__dbt_backup" cascade
[0m07:33:20.735941 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
drop table if exists "airflow"."lead_staging"."dim_person__dbt_backup" cascade
[0m07:33:20.742077 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m07:33:20.743229 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m07:33:20.743880 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m07:33:20.747241 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m07:33:20.748614 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:33:20.749751 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: Close
[0m07:33:20.749789 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: Close
[0m07:33:20.750015 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m07:33:20.750108 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: Close
[0m07:33:20.751283 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '032beaf2-d1f9-468c-bbcf-e8978e4ebd1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bfbfb0050>]}
[0m07:33:20.751882 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42fc536f-ecc9-4056-a3e7-0c67189d0ff1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1693d99580>]}
[0m07:33:20.752887 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2be838f-1092-4bdc-9e66-83a400fa5300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12aa70e8a0>]}
[0m07:33:20.753339 [info ] [Thread-1 (]: 2 of 5 OK created sql table model lead_staging.dim_date ........................ [[32mSELECT 4590259[0m in 174.91s]
[0m07:33:20.753458 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:33:20.753984 [info ] [Thread-1 (]: 4 of 5 OK created sql table model lead_staging.dim_person ...................... [[32mSELECT 4590259[0m in 168.51s]
[0m07:33:20.755290 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_date
[0m07:33:20.754903 [info ] [Thread-1 (]: 3 of 5 OK created sql table model lead_staging.dim_finance ..................... [[32mSELECT 4590259[0m in 174.89s]
[0m07:33:20.756507 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_person
[0m07:33:20.756917 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_finance
[0m07:33:20.758061 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_finance
[0m07:33:20.758316 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_fact_network_usage
[0m07:33:20.758803 [info ] [Thread-1 (]: 3 of 5 START sql table model lead_staging.dim_finance .......................... [RUN]
[0m07:33:20.760214 [info ] [Thread-1 (]: 5 of 5 START sql table model lead_staging.fact_network_usage ................... [RUN]
[0m07:33:20.760088 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_person
[0m07:33:20.760502 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_date, now model.dbt_lead_data.staging_dim_finance)
[0m07:33:20.761787 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_person, now model.dbt_lead_data.staging_fact_network_usage)
[0m07:33:20.762479 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_finance
[0m07:33:20.763015 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_fact_network_usage
[0m07:33:20.762946 [info ] [Thread-1 (]: 4 of 5 START sql table model lead_staging.dim_person ........................... [RUN]
[0m07:33:20.765365 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_finance, now model.dbt_lead_data.staging_dim_person)
[0m07:33:20.766803 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_person
[0m07:33:20.766980 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_address__dbt_backup"
[0m07:33:20.767841 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_finance"
[0m07:33:20.769241 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_fact_network_usage"
[0m07:33:20.772022 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_finance
[0m07:33:20.772377 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_fact_network_usage
[0m07:33:20.776136 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_person"
[0m07:33:20.778944 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:33:20.780312 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
drop table if exists "airflow"."lead_staging"."dim_address__dbt_backup" cascade
[0m07:33:20.780748 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_fact_network_usage"
[0m07:33:20.780250 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_person
[0m07:33:20.782459 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_finance"
[0m07:33:20.785209 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m07:33:20.786390 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m07:33:20.786584 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: BEGIN
[0m07:33:20.787415 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: BEGIN
[0m07:33:20.787529 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_person"
[0m07:33:20.787873 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:33:20.788428 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:33:20.789371 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.008 seconds
[0m07:33:20.791310 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m07:33:20.792897 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: BEGIN
[0m07:33:20.794214 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:33:20.794904 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: Close
[0m07:33:20.795859 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m07:33:20.796867 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m07:33:20.797616 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m07:33:20.798302 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m07:33:20.798676 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2bcf5115-89e0-4ba7-b383-485120352382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dfd7a9820>]}
[0m07:33:20.798798 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */

  
    

  create  table "airflow"."lead_staging"."fact_network_usage__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        session_duration,
        download_speed,
        upload_speed,
        consumed_traffic
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:33:20.799799 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */

  
    

  create  table "airflow"."lead_staging"."dim_finance__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        iban
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:33:20.800458 [info ] [Thread-1 (]: 1 of 5 OK created sql table model lead_staging.dim_address ..................... [[32mSELECT 4164290[0m in 291.35s]
[0m07:33:20.802268 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_adress
[0m07:33:20.802677 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m07:33:20.805083 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_date
[0m07:33:20.805393 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m07:33:20.807021 [info ] [Thread-1 (]: 2 of 5 START sql table model lead_staging.dim_date ............................. [RUN]
[0m07:33:20.807360 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */

  
    

  create  table "airflow"."lead_staging"."dim_person__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        person_name,
        user_name,
        email,
        phone,
        birth_date,
        personal_number
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:33:20.808655 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_adress, now model.dbt_lead_data.staging_dim_date)
[0m07:33:20.809731 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_date
[0m07:33:20.816090 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_date"
[0m07:33:20.819955 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_date
[0m07:33:20.830500 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_date"
[0m07:33:20.833885 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m07:33:20.835089 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: BEGIN
[0m07:33:20.836377 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:33:20.843545 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m07:33:20.845848 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m07:33:20.847172 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */

  
    

  create  table "airflow"."lead_staging"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        accessed_at
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:33:20.896785 [debug] [Thread-1 (]: Postgres adapter: Postgres error: could not extend file "base/16384/17992.4": No space left on device
HINT:  Check free disk space.

[0m07:33:20.897912 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: ROLLBACK
[0m07:33:20.899339 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: Close
[0m07:33:20.938899 [debug] [Thread-1 (]: Postgres adapter: Postgres error: could not extend file "base/16384/17981.5": No space left on device
HINT:  Check free disk space.

[0m07:33:20.946096 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: ROLLBACK
[0m07:33:20.956021 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: Close
[0m07:33:20.969516 [debug] [Thread-1 (]: Database Error in model trusted_pii_data (models/trusted_pii_data.sql)
  could not extend file "base/16384/17981.5": No space left on device
  HINT:  Check free disk space.
  compiled code at target/run/dbt_lead_data/models/trusted_pii_data.sql
[0m07:33:20.969741 [debug] [Thread-1 (]: Database Error in model trusted_non_pii_data (models/trusted_non_pii_data.sql)
  could not extend file "base/16384/17992.4": No space left on device
  HINT:  Check free disk space.
  compiled code at target/run/dbt_lead_data/models/trusted_non_pii_data.sql
[0m07:33:20.972670 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c699877a-7b64-4a1a-90d1-52d96e7ddc1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4b1802600>]}
[0m07:33:20.977266 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1ec6835-7c52-4692-a11a-d98e7c576a88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bf8975460>]}
[0m07:33:20.977435 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model lead_trusted.pii_data .................... [[31mERROR[0m in 168.74s]
[0m07:33:20.980755 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model lead_trusted.non_pii_data ................ [[31mERROR[0m in 161.12s]
[0m07:33:20.982072 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_pii_data
[0m07:33:20.983439 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_non_pii_data
[0m07:33:20.984359 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_technical_data
[0m07:33:20.985925 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_payment_data
[0m07:33:20.987570 [info ] [Thread-1 (]: 4 of 4 START sql table model lead_trusted.technical_data ....................... [RUN]
[0m07:33:20.988214 [info ] [Thread-1 (]: 2 of 4 START sql table model lead_trusted.payment_data ......................... [RUN]
[0m07:33:20.989112 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_pii_data, now model.dbt_lead_data.trusted_technical_data)
[0m07:33:20.990138 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_non_pii_data, now model.dbt_lead_data.trusted_payment_data)
[0m07:33:20.990504 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_technical_data
[0m07:33:20.991589 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_payment_data
[0m07:33:20.999496 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_technical_data"
[0m07:33:21.005728 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_payment_data"
[0m07:33:21.006490 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_technical_data
[0m07:33:21.009266 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_payment_data
[0m07:33:21.016253 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_technical_data"
[0m07:33:21.018730 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_payment_data"
[0m07:33:21.022898 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m07:33:21.023088 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m07:33:21.024469 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: BEGIN
[0m07:33:21.025286 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: BEGIN
[0m07:33:21.026530 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:33:21.027398 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:33:21.034877 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m07:33:21.035956 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m07:33:21.063877 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m07:33:21.064173 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m07:33:21.065400 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */

  
    

  create  table "airflow"."lead_trusted"."payment_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        fnu.unique_id,
        df.iban,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.session_duration,
        fnu.consumed_traffic,
        ((fnu.download_speed + fnu.upload_speed + 1)/2) + (fnu.consumed_traffic / (fnu.session_duration + 1)) AS payment_amount
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    JOIN
        "airflow"."lead_staging"."dim_finance" df
    ON
	    fnu.unique_id = df.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:33:21.065955 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */

  
    

  create  table "airflow"."lead_trusted"."technical_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        fnu.unique_id,
        da.address,
        da.mac_address,
        da.ip_address,
        fnu.download_speed,
        fnu.upload_speed,
        ROUND((fnu.session_duration/60), 1) as min_session_duration,
        CASE 
            WHEN fnu.download_speed < 50 OR fnu.upload_speed < 30 OR fnu.session_duration/60 < 1 THEN true
            ELSE false
        END AS technical_issue
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    JOIN
        "airflow"."lead_staging"."dim_address" da
    ON
	    fnu.unique_id = da.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:34:05.271249 [debug] [Thread-1 (]: SQL status: SELECT 6924520 in 44.204 seconds
[0m07:34:05.281325 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m07:34:05.282344 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
alter table "airflow"."lead_trusted"."payment_data" rename to "payment_data__dbt_backup"
[0m07:34:05.285762 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m07:34:05.290615 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m07:34:05.291856 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
alter table "airflow"."lead_trusted"."payment_data__dbt_tmp" rename to "payment_data"
[0m07:34:05.294061 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:34:05.322059 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: COMMIT
[0m07:34:05.323001 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m07:34:05.323826 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: COMMIT
[0m07:34:05.334199 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m07:34:05.344356 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."payment_data__dbt_backup"
[0m07:34:05.356014 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m07:34:05.357701 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
drop table if exists "airflow"."lead_trusted"."payment_data__dbt_backup" cascade
[0m07:34:05.430679 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.072 seconds
[0m07:34:05.434613 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: Close
[0m07:34:05.435928 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1ec6835-7c52-4692-a11a-d98e7c576a88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bf9645dc0>]}
[0m07:34:05.437200 [info ] [Thread-1 (]: 2 of 4 OK created sql table model lead_trusted.payment_data .................... [[32mSELECT 6924520[0m in 44.45s]
[0m07:34:05.438800 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_payment_data
[0m07:34:05.459231 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_pii_data
[0m07:34:05.460627 [info ] [Thread-1 (]: 3 of 4 START sql table model lead_trusted.pii_data ............................. [RUN]
[0m07:34:05.461760 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_payment_data, now model.dbt_lead_data.trusted_pii_data)
[0m07:34:05.462805 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_pii_data
[0m07:34:05.472909 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_pii_data"
[0m07:34:05.477957 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_pii_data
[0m07:34:05.484484 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_pii_data"
[0m07:34:05.488006 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m07:34:05.489006 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: BEGIN
[0m07:34:05.489912 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:34:05.495267 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m07:34:05.496938 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m07:34:05.498297 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */

  
    

  create  table "airflow"."lead_trusted"."pii_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        dp.person_name,
        dp.user_name,
        dp.email,
        dp.personal_number, 
        dp.birth_date, 
        da.address,
        dp.phone, 
        da.mac_address,
        da.ip_address,
        df.iban,
        dd.accessed_at,
        fnu.session_duration,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.consumed_traffic,
        fnu.unique_id
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    INNER JOIN
        "airflow"."lead_staging"."dim_address" da ON fnu.unique_id = da.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_date" dd ON da.unique_id = dd.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_finance" df ON dd.unique_id = df.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_person" dp ON df.unique_id = dp.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:34:08.251489 [debug] [Thread-1 (]: SQL status: SELECT 5234791 in 47.446 seconds
[0m07:34:08.257157 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m07:34:08.257988 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
alter table "airflow"."lead_staging"."dim_finance" rename to "dim_finance__dbt_backup"
[0m07:34:08.309661 [debug] [Thread-1 (]: SQL status: SELECT 5234791 in 47.505 seconds
[0m07:34:08.319117 [debug] [Thread-1 (]: SQL status: SELECT 5234791 in 47.466 seconds
[0m07:34:08.321381 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m07:34:08.324590 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
alter table "airflow"."lead_staging"."fact_network_usage" rename to "fact_network_usage__dbt_backup"
[0m07:34:08.335093 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m07:34:08.336661 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
alter table "airflow"."lead_staging"."dim_date" rename to "dim_date__dbt_backup"
[0m07:34:09.432028 [debug] [Thread-1 (]: SQL status: SELECT 5018992 in 109.542 seconds
[0m07:34:09.441706 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:34:09.443103 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
alter table "airflow"."lead_staging"."dim_address" rename to "dim_address__dbt_backup"
[0m07:34:09.757151 [debug] [Thread-1 (]: SQL status: SELECT 6711816 in 48.685 seconds
[0m07:34:09.761367 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m07:34:09.762223 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
alter table "airflow"."lead_trusted"."technical_data" rename to "technical_data__dbt_backup"
[0m07:34:09.897702 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.135 seconds
[0m07:34:09.902779 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m07:34:09.903929 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
alter table "airflow"."lead_trusted"."technical_data__dbt_tmp" rename to "technical_data"
[0m07:34:09.908383 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m07:34:09.911694 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: COMMIT
[0m07:34:09.912756 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m07:34:09.913914 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: COMMIT
[0m07:34:09.938877 [debug] [Thread-1 (]: SQL status: COMMIT in 0.024 seconds
[0m07:34:09.946200 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."technical_data__dbt_backup"
[0m07:34:09.949139 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m07:34:09.951219 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
drop table if exists "airflow"."lead_trusted"."technical_data__dbt_backup" cascade
[0m07:34:10.113749 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.161 seconds
[0m07:34:10.115885 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: Close
[0m07:34:10.116995 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c699877a-7b64-4a1a-90d1-52d96e7ddc1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4b3167110>]}
[0m07:34:10.118095 [info ] [Thread-1 (]: 4 of 4 OK created sql table model lead_trusted.technical_data .................. [[32mSELECT 6711816[0m in 49.13s]
[0m07:34:10.119421 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_technical_data
[0m07:34:10.122827 [debug] [MainThread]: Using postgres connection "master"
[0m07:34:10.123774 [debug] [MainThread]: On master: BEGIN
[0m07:34:10.124688 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:34:10.131267 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m07:34:10.132296 [debug] [MainThread]: On master: COMMIT
[0m07:34:10.133213 [debug] [MainThread]: Using postgres connection "master"
[0m07:34:10.134103 [debug] [MainThread]: On master: COMMIT
[0m07:34:10.135388 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:34:10.136343 [debug] [MainThread]: On master: Close
[0m07:34:10.137587 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:34:10.139209 [debug] [MainThread]: Connection 'model.dbt_lead_data.trusted_technical_data' was properly closed.
[0m07:34:10.140492 [info ] [MainThread]: 
[0m07:34:10.141660 [info ] [MainThread]: Finished running 4 table models in 0 hours 24 minutes and 34.92 seconds (1474.92s).
[0m07:34:10.144194 [debug] [MainThread]: Command end result
[0m07:34:10.229323 [info ] [MainThread]: 
[0m07:34:10.231775 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:34:10.234364 [info ] [MainThread]: 
[0m07:34:10.236363 [error] [MainThread]:   Database Error in model trusted_pii_data (models/trusted_pii_data.sql)
  could not extend file "base/16384/17981.5": No space left on device
  HINT:  Check free disk space.
  compiled code at target/run/dbt_lead_data/models/trusted_pii_data.sql
[0m07:34:10.238822 [info ] [MainThread]: 
[0m07:34:10.243402 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m07:34:10.258534 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1480.07, "process_user_time": 7.700282, "process_kernel_time": 0.580999, "process_mem_max_rss": "117996", "process_in_blocks": "21160", "command_success": false, "process_out_blocks": "0"}
[0m07:34:10.260756 [debug] [MainThread]: Command `dbt run` failed at 07:34:10.260394 after 1480.08 seconds
[0m07:34:10.263056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4b6659220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4b64ea450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4b1812e10>]}
[0m07:34:10.265199 [debug] [MainThread]: Flushing usage events
[0m07:34:12.157236 [debug] [Thread-1 (]: SQL status: SELECT 5234791 in 51.344 seconds
[0m07:34:12.162410 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m07:34:12.163475 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
alter table "airflow"."lead_staging"."dim_person" rename to "dim_person__dbt_backup"
[0m07:34:28.014528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0534a159a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0534c07d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f053480f8c0>]}


============================== 07:34:28.023126 | 9c7ce325-b208-4eef-8d89-a8fde1558e0e ==============================
[0m07:34:28.023126 [info ] [MainThread]: Running with dbt=1.8.0
[0m07:34:28.024118 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select tag:staging', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:34:28.518207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c7ce325-b208-4eef-8d89-a8fde1558e0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0534f10ec0>]}
[0m07:34:28.597116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9c7ce325-b208-4eef-8d89-a8fde1558e0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05357e5e80>]}
[0m07:34:28.598737 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:34:28.696039 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m07:34:28.932502 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:34:28.933352 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:34:28.980173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9c7ce325-b208-4eef-8d89-a8fde1558e0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05333279b0>]}
[0m07:34:29.304915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9c7ce325-b208-4eef-8d89-a8fde1558e0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0532724c80>]}
[0m07:34:29.305780 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m07:34:29.306712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c7ce325-b208-4eef-8d89-a8fde1558e0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0533355160>]}
[0m07:34:29.309521 [info ] [MainThread]: 
[0m07:34:29.310814 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:34:29.319946 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m07:34:29.372640 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m07:34:29.373514 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m07:34:29.374203 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:34:29.388642 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.014 seconds
[0m07:34:29.390590 [debug] [ThreadPool]: On list_airflow: Close
[0m07:34:29.393788 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_trusted)
[0m07:34:29.401227 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:34:29.402129 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m07:34:29.402805 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:34:29.407927 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:34:29.409055 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:34:29.409956 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m07:34:29.423896 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.013 seconds
[0m07:34:29.426634 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m07:34:29.427866 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m07:34:29.429161 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now list_airflow_lead_staging)
[0m07:34:29.432801 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:34:29.433599 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m07:34:29.434249 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:34:29.440212 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m07:34:29.441344 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:34:29.442701 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m07:34:29.446638 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.003 seconds
[0m07:34:29.449777 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m07:34:29.451226 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m07:34:29.459137 [debug] [MainThread]: Using postgres connection "master"
[0m07:34:29.460021 [debug] [MainThread]: On master: BEGIN
[0m07:34:29.460641 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:34:29.466652 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m07:34:29.467630 [debug] [MainThread]: Using postgres connection "master"
[0m07:34:29.468582 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:34:29.475537 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m07:34:29.477747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c7ce325-b208-4eef-8d89-a8fde1558e0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05355e4d40>]}
[0m07:34:29.478723 [debug] [MainThread]: On master: ROLLBACK
[0m07:34:29.479753 [debug] [MainThread]: Using postgres connection "master"
[0m07:34:29.480549 [debug] [MainThread]: On master: BEGIN
[0m07:34:29.481910 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:34:29.482705 [debug] [MainThread]: On master: COMMIT
[0m07:34:29.483530 [debug] [MainThread]: Using postgres connection "master"
[0m07:34:29.484387 [debug] [MainThread]: On master: COMMIT
[0m07:34:29.485477 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:34:29.486205 [debug] [MainThread]: On master: Close
[0m07:34:29.487236 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:34:29.488399 [info ] [MainThread]: 
[0m07:34:29.500747 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_adress
[0m07:34:29.502059 [info ] [Thread-1 (]: 1 of 5 START sql table model lead_staging.dim_address .......................... [RUN]
[0m07:34:29.502901 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now model.dbt_lead_data.staging_dim_adress)
[0m07:34:29.503627 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_adress
[0m07:34:29.513676 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_adress"
[0m07:34:29.516280 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_adress
[0m07:34:29.571895 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_adress"
[0m07:34:29.575303 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:34:29.576431 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: BEGIN
[0m07:34:29.577568 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:34:29.583572 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m07:34:29.584728 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:34:29.586063 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */

  
    

  create  table "airflow"."lead_staging"."dim_address__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        address,
        mac_address,
        ip_address
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:34:38.131373 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 28.692 seconds
[0m07:34:38.131495 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 25.973 seconds
[0m07:34:38.131551 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 29.878 seconds
[0m07:34:38.131460 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 29.811 seconds
[0m07:34:38.131403 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 29.798 seconds
[0m07:34:38.137248 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:34:38.137556 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m07:34:38.138304 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
alter table "airflow"."lead_staging"."dim_address__dbt_tmp" rename to "dim_address"
[0m07:34:38.138331 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m07:34:38.138952 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m07:34:38.138780 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m07:34:38.138722 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
alter table "airflow"."lead_staging"."dim_person__dbt_tmp" rename to "dim_person"
[0m07:34:38.139533 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
alter table "airflow"."lead_staging"."dim_finance__dbt_tmp" rename to "dim_finance"
[0m07:34:38.139937 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
alter table "airflow"."lead_staging"."dim_date__dbt_tmp" rename to "dim_date"
[0m07:34:38.140110 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:34:38.140463 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
alter table "airflow"."lead_staging"."fact_network_usage__dbt_tmp" rename to "fact_network_usage"
[0m07:34:38.141716 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:34:38.141753 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:34:38.142709 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:34:38.143432 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:34:38.144847 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: COMMIT
[0m07:34:38.145448 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: COMMIT
[0m07:34:38.145508 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: COMMIT
[0m07:34:38.145715 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m07:34:38.146432 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m07:34:38.146282 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: COMMIT
[0m07:34:38.146717 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m07:34:38.147014 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: COMMIT
[0m07:34:38.147442 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: COMMIT
[0m07:34:38.147765 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m07:34:38.148073 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: COMMIT
[0m07:34:38.149415 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: COMMIT
[0m07:34:38.149559 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:34:38.150066 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:34:38.150571 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:34:38.151058 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:34:38.153284 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_person__dbt_backup"
[0m07:34:38.153535 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_finance__dbt_backup"
[0m07:34:38.153840 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_date__dbt_backup"
[0m07:34:38.154596 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."fact_network_usage__dbt_backup"
[0m07:34:38.154791 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m07:34:38.155258 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m07:34:38.155508 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m07:34:38.155739 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
drop table if exists "airflow"."lead_staging"."dim_person__dbt_backup" cascade
[0m07:34:38.155888 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m07:34:38.156085 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
drop table if exists "airflow"."lead_staging"."dim_finance__dbt_backup" cascade
[0m07:34:38.156488 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
drop table if exists "airflow"."lead_staging"."dim_date__dbt_backup" cascade
[0m07:34:38.157117 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
drop table if exists "airflow"."lead_staging"."fact_network_usage__dbt_backup" cascade
[0m07:34:38.162248 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m07:34:38.164609 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: Close
[0m07:34:38.165626 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2bcf5115-89e0-4ba7-b383-485120352382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4df91b8320>]}
[0m07:34:38.166770 [info ] [Thread-1 (]: 2 of 5 OK created sql table model lead_staging.dim_date ........................ [[32mSELECT 5234791[0m in 77.36s]
[0m07:34:38.166922 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m07:34:38.167930 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_date
[0m07:34:38.168344 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:34:38.168743 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.010 seconds
[0m07:34:38.168845 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_finance
[0m07:34:38.168833 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.011 seconds
[0m07:34:38.169159 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m07:34:38.170093 [info ] [Thread-1 (]: 3 of 5 START sql table model lead_staging.dim_finance .......................... [RUN]
[0m07:34:38.170944 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: Close
[0m07:34:38.171157 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_date, now model.dbt_lead_data.staging_dim_finance)
[0m07:34:38.171746 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: Close
[0m07:34:38.172104 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:34:38.172021 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.015 seconds
[0m07:34:38.172489 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_finance
[0m07:34:38.172476 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42fc536f-ecc9-4056-a3e7-0c67189d0ff1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1691506d20>]}
[0m07:34:38.172974 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '032beaf2-d1f9-468c-bbcf-e8978e4ebd1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bfbfb77d0>]}
[0m07:34:38.174753 [info ] [Thread-1 (]: 5 of 5 OK created sql table model lead_staging.fact_network_usage .............. [[32mSELECT 5234791[0m in 77.41s]
[0m07:34:38.175227 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: Close
[0m07:34:38.175091 [info ] [Thread-1 (]: 3 of 5 OK created sql table model lead_staging.dim_finance ..................... [[32mSELECT 5234791[0m in 77.41s]
[0m07:34:38.176421 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_fact_network_usage
[0m07:34:38.176917 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2be838f-1092-4bdc-9e66-83a400fa5300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12aa9ce3f0>]}
[0m07:34:38.177863 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_finance
[0m07:34:38.177769 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_finance"
[0m07:34:38.179129 [info ] [Thread-1 (]: 4 of 5 OK created sql table model lead_staging.dim_person ...................... [[32mSELECT 5234791[0m in 77.41s]
[0m07:34:38.179669 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_person
[0m07:34:38.180764 [debug] [MainThread]: Using postgres connection "master"
[0m07:34:38.180832 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_person
[0m07:34:38.181676 [info ] [Thread-1 (]: 4 of 5 START sql table model lead_staging.dim_person ........................... [RUN]
[0m07:34:38.181839 [debug] [MainThread]: On master: BEGIN
[0m07:34:38.181805 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_address__dbt_backup"
[0m07:34:38.183111 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_finance
[0m07:34:38.182416 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_fact_network_usage
[0m07:34:38.182893 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_finance, now model.dbt_lead_data.staging_dim_person)
[0m07:34:38.183328 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:34:38.184747 [info ] [Thread-1 (]: 5 of 5 START sql table model lead_staging.fact_network_usage ................... [RUN]
[0m07:34:38.185108 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_person
[0m07:34:38.186099 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_person, now model.dbt_lead_data.staging_fact_network_usage)
[0m07:34:38.187102 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_fact_network_usage
[0m07:34:38.190082 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m07:34:38.190200 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_finance"
[0m07:34:38.190578 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_person"
[0m07:34:38.190862 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:34:38.191133 [debug] [MainThread]: On master: COMMIT
[0m07:34:38.192732 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
drop table if exists "airflow"."lead_staging"."dim_address__dbt_backup" cascade
[0m07:34:38.192198 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_fact_network_usage"
[0m07:34:38.193176 [debug] [MainThread]: Using postgres connection "master"
[0m07:34:38.194151 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_person
[0m07:34:38.194934 [debug] [MainThread]: On master: COMMIT
[0m07:34:38.194598 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m07:34:38.196176 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:34:38.196743 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_fact_network_usage
[0m07:34:38.196668 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: BEGIN
[0m07:34:38.197477 [debug] [MainThread]: On master: Close
[0m07:34:38.198482 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:34:38.199244 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:34:38.200516 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_person"
[0m07:34:38.203478 [debug] [MainThread]: Connection 'model.dbt_lead_data.staging_fact_network_usage' was properly closed.
[0m07:34:38.202091 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_fact_network_usage"
[0m07:34:38.205717 [info ] [MainThread]: 
[0m07:34:38.206678 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m07:34:38.206943 [info ] [MainThread]: Finished running 5 table models in 0 hours 25 minutes and 14.50 seconds (1514.50s).
[0m07:34:38.207736 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m07:34:38.207876 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: BEGIN
[0m07:34:38.208570 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m07:34:38.208960 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: BEGIN
[0m07:34:38.209023 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.015 seconds
[0m07:34:38.209479 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:34:38.209853 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m07:34:38.210083 [debug] [MainThread]: Command end result
[0m07:34:38.210197 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:34:38.211400 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */

  
    

  create  table "airflow"."lead_staging"."dim_finance__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        iban
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:34:38.213092 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: Close
[0m07:34:38.215346 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m07:34:38.215606 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8757fde5-667e-4616-84fb-133346f80c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58e4e01b20>]}
[0m07:34:38.216565 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m07:34:38.216956 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m07:34:38.217745 [info ] [Thread-1 (]: 1 of 5 OK created sql table model lead_staging.dim_address ..................... [[32mSELECT 5018992[0m in 138.41s]
[0m07:34:38.218954 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m07:34:38.219773 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */

  
    

  create  table "airflow"."lead_staging"."dim_person__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        person_name,
        user_name,
        email,
        phone,
        birth_date,
        personal_number
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:34:38.220621 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_adress
[0m07:34:38.221585 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */

  
    

  create  table "airflow"."lead_staging"."fact_network_usage__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        session_duration,
        download_speed,
        upload_speed,
        consumed_traffic
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:34:38.222438 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_date
[0m07:34:38.223886 [info ] [Thread-1 (]: 2 of 5 START sql table model lead_staging.dim_date ............................. [RUN]
[0m07:34:38.224152 [debug] [Thread-1 (]: Postgres adapter: Postgres error: could not write to file "base/pgsql_tmp/pgsql_tmp55875.0.sharedfileset/i70of128.p0.0": No space left on device

[0m07:34:38.225636 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_adress, now model.dbt_lead_data.staging_dim_date)
[0m07:34:38.225682 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: ROLLBACK
[0m07:34:38.226641 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_date
[0m07:34:38.227417 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: Close
[0m07:34:38.231004 [debug] [Thread-1 (]: Database Error in model trusted_pii_data (models/trusted_pii_data.sql)
  could not write to file "base/pgsql_tmp/pgsql_tmp55875.0.sharedfileset/i70of128.p0.0": No space left on device
  compiled code at target/run/dbt_lead_data/models/trusted_pii_data.sql
[0m07:34:38.231903 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1ec6835-7c52-4692-a11a-d98e7c576a88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bf4f79be0>]}
[0m07:34:38.232976 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model lead_trusted.pii_data .................... [[31mERROR[0m in 32.77s]
[0m07:34:38.234122 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_pii_data
[0m07:34:38.233505 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_date"
[0m07:34:38.235712 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_technical_data
[0m07:34:38.237007 [info ] [Thread-1 (]: 4 of 4 START sql table model lead_trusted.technical_data ....................... [RUN]
[0m07:34:38.237858 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_date
[0m07:34:38.238340 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_pii_data, now model.dbt_lead_data.trusted_technical_data)
[0m07:34:38.239148 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_technical_data
[0m07:34:38.243124 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_date"
[0m07:34:38.244003 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_technical_data"
[0m07:34:38.245517 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m07:34:38.246411 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: BEGIN
[0m07:34:38.246381 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_technical_data
[0m07:34:38.247354 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:34:38.253080 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m07:34:38.253763 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_technical_data"
[0m07:34:38.254124 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m07:34:38.254960 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */

  
    

  create  table "airflow"."lead_staging"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        accessed_at
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:34:38.256296 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m07:34:38.257142 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: BEGIN
[0m07:34:38.257993 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:34:38.263511 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m07:34:38.264481 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m07:34:38.265585 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */

  
    

  create  table "airflow"."lead_trusted"."technical_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        fnu.unique_id,
        da.address,
        da.mac_address,
        da.ip_address,
        fnu.download_speed,
        fnu.upload_speed,
        ROUND((fnu.session_duration/60), 1) as min_session_duration,
        CASE 
            WHEN fnu.download_speed < 50 OR fnu.upload_speed < 30 OR fnu.session_duration/60 < 1 THEN true
            ELSE false
        END AS technical_issue
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    JOIN
        "airflow"."lead_staging"."dim_address" da
    ON
	    fnu.unique_id = da.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:34:38.284884 [info ] [MainThread]: 
[0m07:34:38.286082 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:34:38.287024 [info ] [MainThread]: 
[0m07:34:38.288073 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m07:34:38.292689 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1515.6212, "process_user_time": 368.51706, "process_kernel_time": 29.413486, "process_mem_max_rss": "119212", "process_in_blocks": "23936", "process_out_blocks": "0"}
[0m07:34:38.293956 [debug] [MainThread]: Command `dbt run` succeeded at 07:34:38.293774 after 1515.62 seconds
[0m07:34:38.295403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1695b0cb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1695b0cad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1691509670>]}
[0m07:34:38.296560 [debug] [MainThread]: Flushing usage events
[0m07:34:48.132338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b63e94b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b63e94d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b63e97740>]}


============================== 07:34:48.139672 | 35162d67-3cd0-4570-98eb-e0729b3798fc ==============================
[0m07:34:48.139672 [info ] [MainThread]: Running with dbt=1.8.0
[0m07:34:48.140690 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select tag:trusted', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:34:48.421223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '35162d67-3cd0-4570-98eb-e0729b3798fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b64581b50>]}
[0m07:34:48.496810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '35162d67-3cd0-4570-98eb-e0729b3798fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b63ee22a0>]}
[0m07:34:48.498327 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:34:48.595332 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m07:34:48.771576 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:34:48.772469 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:34:48.812657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '35162d67-3cd0-4570-98eb-e0729b3798fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b6298ca10>]}
[0m07:34:48.962340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '35162d67-3cd0-4570-98eb-e0729b3798fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b61d40ef0>]}
[0m07:34:48.963319 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m07:34:48.964265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35162d67-3cd0-4570-98eb-e0729b3798fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b61d35c40>]}
[0m07:34:48.967759 [info ] [MainThread]: 
[0m07:34:48.969011 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:34:48.976116 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m07:34:49.022766 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m07:34:49.024004 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m07:34:49.024995 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:34:49.031681 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.007 seconds
[0m07:34:49.033969 [debug] [ThreadPool]: On list_airflow: Close
[0m07:34:49.037277 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_staging)
[0m07:34:49.044977 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:34:49.045986 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m07:34:49.046804 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:34:49.051826 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:34:49.061649 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:34:49.064382 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m07:34:49.067973 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.003 seconds
[0m07:34:49.070154 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m07:34:49.071468 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m07:34:49.072873 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now list_airflow_lead_trusted)
[0m07:34:49.077706 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:34:49.079486 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m07:34:49.080691 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:34:49.086546 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m07:34:49.087512 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:34:49.088355 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m07:34:49.091954 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m07:34:49.094141 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m07:34:49.095072 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m07:34:49.103802 [debug] [MainThread]: Using postgres connection "master"
[0m07:34:49.104986 [debug] [MainThread]: On master: BEGIN
[0m07:34:49.105882 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:34:49.112577 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m07:34:49.113808 [debug] [MainThread]: Using postgres connection "master"
[0m07:34:49.115336 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:34:49.120202 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m07:34:49.122822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35162d67-3cd0-4570-98eb-e0729b3798fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b64b00830>]}
[0m07:34:49.124021 [debug] [MainThread]: On master: ROLLBACK
[0m07:34:49.125236 [debug] [MainThread]: Using postgres connection "master"
[0m07:34:49.126335 [debug] [MainThread]: On master: BEGIN
[0m07:34:49.127957 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m07:34:49.129059 [debug] [MainThread]: On master: COMMIT
[0m07:34:49.134854 [debug] [MainThread]: Using postgres connection "master"
[0m07:34:49.136424 [debug] [MainThread]: On master: COMMIT
[0m07:34:49.137779 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:34:49.138821 [debug] [MainThread]: On master: Close
[0m07:34:49.140117 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:34:49.141145 [info ] [MainThread]: 
[0m07:34:49.154243 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_non_pii_data
[0m07:34:49.155847 [info ] [Thread-1 (]: 1 of 4 START sql table model lead_trusted.non_pii_data ......................... [RUN]
[0m07:34:49.157478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now model.dbt_lead_data.trusted_non_pii_data)
[0m07:34:49.158795 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_non_pii_data
[0m07:34:49.171793 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_non_pii_data"
[0m07:34:49.174788 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_non_pii_data
[0m07:34:49.223063 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_non_pii_data"
[0m07:34:49.225640 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m07:34:49.226425 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: BEGIN
[0m07:34:49.227204 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:34:49.231812 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m07:34:49.232668 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m07:34:49.233522 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */

  
    

  create  table "airflow"."lead_trusted"."non_pii_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        '***MASKED***' AS person_name,
        SUBSTRING(dp.user_name, 1, 5) || '*****'  user_name,
        SUBSTRING(dp.email, 1, 5) || '*****' AS email,
        '***MASKED***'  AS personal_number, 
        '***MASKED***' AS birth_date, 
        '***MASKED***' AS address,
        '***MASKED***'  AS phone, 
        SUBSTRING(da.mac_address, 1, 5) || '*****' AS mac_address,
        SUBSTRING(da.ip_address, 1, 5) || '*****' AS ip_address,
        SUBSTRING(df.iban, 1, 5) || '*****' AS iban,
        dd.accessed_at,
        fnu.session_duration,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.consumed_traffic,
        fnu.unique_id
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    INNER JOIN
        "airflow"."lead_staging"."dim_address" da ON fnu.unique_id = da.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_date" dd ON da.unique_id = dd.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_finance" df ON dd.unique_id = df.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_person" dp ON df.unique_id = dp.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:35:11.444255 [debug] [Thread-1 (]: SQL status: SELECT 5450795 in 33.185 seconds
[0m07:35:11.444278 [debug] [Thread-1 (]: SQL status: SELECT 5450795 in 33.229 seconds
[0m07:35:11.450912 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m07:35:11.450847 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m07:35:11.452183 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
alter table "airflow"."lead_staging"."dim_finance" rename to "dim_finance__dbt_backup"
[0m07:35:11.452821 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
alter table "airflow"."lead_staging"."dim_date" rename to "dim_date__dbt_backup"
[0m07:35:11.556782 [debug] [Thread-1 (]: SQL status: SELECT 5450795 in 33.333 seconds
[0m07:35:11.563711 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m07:35:11.564751 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
alter table "airflow"."lead_staging"."fact_network_usage" rename to "fact_network_usage__dbt_backup"
[0m07:35:11.756781 [debug] [Thread-1 (]: SQL status: SELECT 5450795 in 42.174 seconds
[0m07:35:11.766325 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:35:11.767478 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
alter table "airflow"."lead_staging"."dim_address" rename to "dim_address__dbt_backup"
[0m07:35:12.944803 [debug] [Thread-1 (]: SQL status: SELECT 5450795 in 34.722 seconds
[0m07:35:12.949281 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m07:35:12.950350 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
alter table "airflow"."lead_staging"."dim_person" rename to "dim_person__dbt_backup"
[0m07:35:16.573570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a592e6870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a5951a090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a596b3b90>]}


============================== 07:35:16.585087 | f50c5cf2-d559-4ce6-b1a1-dd39b3d8dbea ==============================
[0m07:35:16.585087 [info ] [MainThread]: Running with dbt=1.8.0
[0m07:35:16.586098 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select tag:staging', 'send_anonymous_usage_stats': 'True'}
[0m07:35:16.944883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f50c5cf2-d559-4ce6-b1a1-dd39b3d8dbea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a5a1fd460>]}
[0m07:35:17.018445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f50c5cf2-d559-4ce6-b1a1-dd39b3d8dbea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a5a15f680>]}
[0m07:35:17.026898 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:35:17.128233 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m07:35:17.307895 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:35:17.308879 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:35:17.355003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f50c5cf2-d559-4ce6-b1a1-dd39b3d8dbea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a589111f0>]}
[0m07:35:17.504786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f50c5cf2-d559-4ce6-b1a1-dd39b3d8dbea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a589398e0>]}
[0m07:35:17.505610 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m07:35:17.506374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f50c5cf2-d559-4ce6-b1a1-dd39b3d8dbea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a57d3dd90>]}
[0m07:35:17.509062 [info ] [MainThread]: 
[0m07:35:17.510255 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:35:17.517063 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m07:35:17.565279 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m07:35:17.566149 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m07:35:17.566871 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:35:17.572766 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.006 seconds
[0m07:35:17.574752 [debug] [ThreadPool]: On list_airflow: Close
[0m07:35:17.577222 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_staging)
[0m07:35:17.584229 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:35:17.584988 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m07:35:17.585565 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:35:17.589874 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m07:35:17.590527 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:35:17.591241 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m07:35:17.594202 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m07:35:17.595998 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m07:35:17.596917 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m07:35:17.597879 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now list_airflow_lead_trusted)
[0m07:35:17.601242 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:35:17.601907 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m07:35:17.602504 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:35:17.606867 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m07:35:17.607580 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:35:17.608277 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m07:35:17.611810 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m07:35:17.613841 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m07:35:17.614914 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m07:35:17.634302 [debug] [MainThread]: Using postgres connection "master"
[0m07:35:17.635793 [debug] [MainThread]: On master: BEGIN
[0m07:35:17.637438 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:35:17.643859 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m07:35:17.644809 [debug] [MainThread]: Using postgres connection "master"
[0m07:35:17.645836 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:35:17.650570 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m07:35:17.653066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f50c5cf2-d559-4ce6-b1a1-dd39b3d8dbea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a5893b7a0>]}
[0m07:35:17.654088 [debug] [MainThread]: On master: ROLLBACK
[0m07:35:17.655234 [debug] [MainThread]: Using postgres connection "master"
[0m07:35:17.656231 [debug] [MainThread]: On master: BEGIN
[0m07:35:17.657419 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:35:17.658267 [debug] [MainThread]: On master: COMMIT
[0m07:35:17.659139 [debug] [MainThread]: Using postgres connection "master"
[0m07:35:17.659884 [debug] [MainThread]: On master: COMMIT
[0m07:35:17.660865 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:35:17.661688 [debug] [MainThread]: On master: Close
[0m07:35:17.662638 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:35:17.663834 [info ] [MainThread]: 
[0m07:35:17.675213 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_adress
[0m07:35:17.676359 [info ] [Thread-1 (]: 1 of 5 START sql table model lead_staging.dim_address .......................... [RUN]
[0m07:35:17.677483 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now model.dbt_lead_data.staging_dim_adress)
[0m07:35:17.678309 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_adress
[0m07:35:17.690616 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_adress"
[0m07:35:17.694165 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_adress
[0m07:35:17.755083 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_adress"
[0m07:35:17.757904 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:35:17.758720 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: BEGIN
[0m07:35:17.759369 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:35:17.764733 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m07:35:17.765708 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:35:17.766582 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */

  
    

  create  table "airflow"."lead_staging"."dim_address__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        address,
        mac_address,
        ip_address
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:35:40.541180 [debug] [Thread-1 (]: SQL status: SELECT 7566518 in 62.275 seconds
[0m07:35:40.547234 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m07:35:40.548051 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
alter table "airflow"."lead_trusted"."technical_data" rename to "technical_data__dbt_backup"
[0m07:35:41.554859 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 1.006 seconds
[0m07:35:41.559513 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m07:35:41.560385 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
alter table "airflow"."lead_trusted"."technical_data__dbt_tmp" rename to "technical_data"
[0m07:35:41.561727 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:35:41.565215 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: COMMIT
[0m07:35:41.566356 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m07:35:41.567336 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: COMMIT
[0m07:35:41.572720 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m07:35:41.576488 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."technical_data__dbt_backup"
[0m07:35:41.578194 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m07:35:41.579093 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
drop table if exists "airflow"."lead_trusted"."technical_data__dbt_backup" cascade
[0m07:35:41.673744 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.094 seconds
[0m07:35:41.675877 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: Close
[0m07:35:41.677004 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1ec6835-7c52-4692-a11a-d98e7c576a88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bf4f79ac0>]}
[0m07:35:41.678374 [info ] [Thread-1 (]: 4 of 4 OK created sql table model lead_trusted.technical_data .................. [[32mSELECT 7566518[0m in 63.44s]
[0m07:35:41.679930 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_technical_data
[0m07:35:41.682861 [debug] [MainThread]: Using postgres connection "master"
[0m07:35:41.683858 [debug] [MainThread]: On master: BEGIN
[0m07:35:41.684624 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:35:41.689768 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:35:41.690850 [debug] [MainThread]: On master: COMMIT
[0m07:35:41.692068 [debug] [MainThread]: Using postgres connection "master"
[0m07:35:41.693035 [debug] [MainThread]: On master: COMMIT
[0m07:35:41.693977 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:35:41.694825 [debug] [MainThread]: On master: Close
[0m07:35:41.696058 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:35:41.696677 [debug] [MainThread]: Connection 'model.dbt_lead_data.trusted_technical_data' was properly closed.
[0m07:35:41.697497 [info ] [MainThread]: 
[0m07:35:41.698556 [info ] [MainThread]: Finished running 4 table models in 0 hours 5 minutes and 2.01 seconds (302.01s).
[0m07:35:41.700499 [debug] [MainThread]: Command end result
[0m07:35:41.767442 [info ] [MainThread]: 
[0m07:35:41.769156 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m07:35:41.770275 [info ] [MainThread]: 
[0m07:35:41.771428 [error] [MainThread]:   Database Error in model trusted_non_pii_data (models/trusted_non_pii_data.sql)
  could not extend file "base/16384/17992.4": No space left on device
  HINT:  Check free disk space.
  compiled code at target/run/dbt_lead_data/models/trusted_non_pii_data.sql
[0m07:35:41.772423 [info ] [MainThread]: 
[0m07:35:41.773277 [error] [MainThread]:   Database Error in model trusted_pii_data (models/trusted_pii_data.sql)
  could not write to file "base/pgsql_tmp/pgsql_tmp55875.0.sharedfileset/i70of128.p0.0": No space left on device
  compiled code at target/run/dbt_lead_data/models/trusted_pii_data.sql
[0m07:35:41.774067 [info ] [MainThread]: 
[0m07:35:41.774804 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m07:35:41.783663 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 303.29633, "process_user_time": 3.756569, "process_kernel_time": 0.313819, "process_mem_max_rss": "116236", "process_in_blocks": "68376", "command_success": false, "process_out_blocks": "0"}
[0m07:35:41.784803 [debug] [MainThread]: Command `dbt run` failed at 07:35:41.784656 after 303.30 seconds
[0m07:35:41.785809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bf84889b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bf656eea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bf507d520>]}
[0m07:35:41.787503 [debug] [MainThread]: Flushing usage events
[0m07:42:07.882406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3709b75010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f370932e6c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f370932c680>]}


============================== 07:42:07.890756 | 7233c092-9544-4fc6-a716-02091d19ebeb ==============================
[0m07:42:07.890756 [info ] [MainThread]: Running with dbt=1.8.0
[0m07:42:07.891669 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select tag:staging', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:42:08.137677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7233c092-9544-4fc6-a716-02091d19ebeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f370a274530>]}
[0m07:42:08.198662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7233c092-9544-4fc6-a716-02091d19ebeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3709a2a330>]}
[0m07:42:08.200476 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:42:08.306671 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m07:42:08.504487 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:42:08.505388 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:42:08.545905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7233c092-9544-4fc6-a716-02091d19ebeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37087ae0c0>]}
[0m07:42:08.739201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7233c092-9544-4fc6-a716-02091d19ebeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3707724bf0>]}
[0m07:42:08.740122 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m07:42:08.740998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7233c092-9544-4fc6-a716-02091d19ebeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f370a924c20>]}
[0m07:42:08.743633 [info ] [MainThread]: 
[0m07:42:08.744885 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:42:08.751845 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m07:42:08.802386 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m07:42:08.803844 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m07:42:08.804807 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:42:08.810946 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.006 seconds
[0m07:42:08.812943 [debug] [ThreadPool]: On list_airflow: Close
[0m07:42:08.815633 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_trusted)
[0m07:42:08.822511 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:42:08.823365 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m07:42:08.824311 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:42:08.828846 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m07:42:08.829665 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:42:08.830443 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m07:42:08.834998 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m07:42:08.837067 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m07:42:08.838040 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m07:42:08.839091 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now list_airflow_lead_staging)
[0m07:42:08.842284 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:42:08.843076 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m07:42:08.843700 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:42:08.848987 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:42:08.849717 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:42:08.850443 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m07:42:08.853843 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.003 seconds
[0m07:42:08.856097 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m07:42:08.857115 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m07:42:08.864383 [debug] [MainThread]: Using postgres connection "master"
[0m07:42:08.865403 [debug] [MainThread]: On master: BEGIN
[0m07:42:08.866274 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:42:08.871109 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:42:08.872028 [debug] [MainThread]: Using postgres connection "master"
[0m07:42:08.872882 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:42:08.879669 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m07:42:08.881999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7233c092-9544-4fc6-a716-02091d19ebeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37083164e0>]}
[0m07:42:08.883050 [debug] [MainThread]: On master: ROLLBACK
[0m07:42:08.884096 [debug] [MainThread]: Using postgres connection "master"
[0m07:42:08.884947 [debug] [MainThread]: On master: BEGIN
[0m07:42:08.886271 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m07:42:08.887144 [debug] [MainThread]: On master: COMMIT
[0m07:42:08.887984 [debug] [MainThread]: Using postgres connection "master"
[0m07:42:08.888730 [debug] [MainThread]: On master: COMMIT
[0m07:42:08.889643 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:42:08.890460 [debug] [MainThread]: On master: Close
[0m07:42:08.891435 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:42:08.892349 [info ] [MainThread]: 
[0m07:42:08.903372 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_adress
[0m07:42:08.904526 [info ] [Thread-1 (]: 1 of 5 START sql table model lead_staging.dim_address .......................... [RUN]
[0m07:42:08.905663 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now model.dbt_lead_data.staging_dim_adress)
[0m07:42:08.906511 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_adress
[0m07:42:08.916718 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_adress"
[0m07:42:08.920512 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_adress
[0m07:42:08.969065 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_adress"
[0m07:42:08.973641 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:42:08.974632 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: BEGIN
[0m07:42:08.975523 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:42:08.980413 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m07:42:08.981401 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:42:08.982397 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */

  
    

  create  table "airflow"."lead_staging"."dim_address__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        address,
        mac_address,
        ip_address
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:42:10.376434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8552b12810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8554e1bc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8552e07680>]}


============================== 07:42:10.383622 | 394a17a8-97b3-4fe4-881b-8a085f530ed4 ==============================
[0m07:42:10.383622 [info ] [MainThread]: Running with dbt=1.8.0
[0m07:42:10.384667 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select tag:staging', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:42:10.618182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '394a17a8-97b3-4fe4-881b-8a085f530ed4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8553a19ca0>]}
[0m07:42:10.703895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '394a17a8-97b3-4fe4-881b-8a085f530ed4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8552630710>]}
[0m07:42:10.705128 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:42:10.811333 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m07:42:10.983512 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:42:10.984495 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:42:11.039254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '394a17a8-97b3-4fe4-881b-8a085f530ed4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8552144260>]}
[0m07:42:11.184940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '394a17a8-97b3-4fe4-881b-8a085f530ed4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8551da5760>]}
[0m07:42:11.185848 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m07:42:11.186570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '394a17a8-97b3-4fe4-881b-8a085f530ed4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8551956510>]}
[0m07:42:11.189321 [info ] [MainThread]: 
[0m07:42:11.190442 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:42:11.200577 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m07:42:11.241504 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m07:42:11.242401 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m07:42:11.243167 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:42:11.248790 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.006 seconds
[0m07:42:11.250859 [debug] [ThreadPool]: On list_airflow: Close
[0m07:42:11.254456 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_trusted)
[0m07:42:11.261652 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:42:11.262551 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m07:42:11.263251 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:42:11.267849 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m07:42:11.268608 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:42:11.269345 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m07:42:11.272666 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m07:42:11.274659 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m07:42:11.275626 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m07:42:11.276644 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now list_airflow_lead_staging)
[0m07:42:11.280027 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:42:11.280792 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m07:42:11.281462 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:42:11.286004 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:42:11.286834 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:42:11.287524 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m07:42:11.291548 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.003 seconds
[0m07:42:11.293661 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m07:42:11.294884 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m07:42:11.302895 [debug] [MainThread]: Using postgres connection "master"
[0m07:42:11.303940 [debug] [MainThread]: On master: BEGIN
[0m07:42:11.304760 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:42:11.309896 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:42:11.310763 [debug] [MainThread]: Using postgres connection "master"
[0m07:42:11.311654 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:42:11.316170 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m07:42:11.318100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '394a17a8-97b3-4fe4-881b-8a085f530ed4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8551957a70>]}
[0m07:42:11.318967 [debug] [MainThread]: On master: ROLLBACK
[0m07:42:11.319893 [debug] [MainThread]: Using postgres connection "master"
[0m07:42:11.320583 [debug] [MainThread]: On master: BEGIN
[0m07:42:11.321710 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:42:11.322553 [debug] [MainThread]: On master: COMMIT
[0m07:42:11.323392 [debug] [MainThread]: Using postgres connection "master"
[0m07:42:11.324217 [debug] [MainThread]: On master: COMMIT
[0m07:42:11.325171 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:42:11.325960 [debug] [MainThread]: On master: Close
[0m07:42:11.326984 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:42:11.327930 [info ] [MainThread]: 
[0m07:42:11.339067 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_adress
[0m07:42:11.340205 [info ] [Thread-1 (]: 1 of 5 START sql table model lead_staging.dim_address .......................... [RUN]
[0m07:42:11.341192 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now model.dbt_lead_data.staging_dim_adress)
[0m07:42:11.341974 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_adress
[0m07:42:11.351197 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_adress"
[0m07:42:11.353664 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_adress
[0m07:42:11.405195 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_adress"
[0m07:42:11.408380 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:42:11.409148 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: BEGIN
[0m07:42:11.410049 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:42:11.415074 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m07:42:11.416217 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:42:11.417103 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */

  
    

  create  table "airflow"."lead_staging"."dim_address__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        address,
        mac_address,
        ip_address
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:42:18.110666 [debug] [Thread-1 (]: SQL status: SELECT 6103093 in 9.127 seconds
[0m07:42:18.118411 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:42:18.119248 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
alter table "airflow"."lead_staging"."dim_address" rename to "dim_address__dbt_backup"
[0m07:42:18.120734 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:42:18.124466 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:42:18.125275 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
alter table "airflow"."lead_staging"."dim_address__dbt_tmp" rename to "dim_address"
[0m07:42:18.126410 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:42:18.149172 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m07:42:18.150020 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:42:18.150803 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m07:42:18.159997 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m07:42:18.167322 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_address__dbt_backup"
[0m07:42:18.173967 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:42:18.174881 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
drop table if exists "airflow"."lead_staging"."dim_address__dbt_backup" cascade
[0m07:42:18.219520 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.044 seconds
[0m07:42:18.223043 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: Close
[0m07:42:18.225396 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7233c092-9544-4fc6-a716-02091d19ebeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f370a875df0>]}
[0m07:42:18.226843 [info ] [Thread-1 (]: 1 of 5 OK created sql table model lead_staging.dim_address ..................... [[32mSELECT 6103093[0m in 9.32s]
[0m07:42:18.228150 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_adress
[0m07:42:18.229172 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_date
[0m07:42:18.230152 [info ] [Thread-1 (]: 2 of 5 START sql table model lead_staging.dim_date ............................. [RUN]
[0m07:42:18.231361 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_adress, now model.dbt_lead_data.staging_dim_date)
[0m07:42:18.232450 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_date
[0m07:42:18.237410 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_date"
[0m07:42:18.241750 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_date
[0m07:42:18.249025 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_date"
[0m07:42:18.253434 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m07:42:18.255105 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: BEGIN
[0m07:42:18.256086 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:42:18.264884 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m07:42:18.266337 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m07:42:18.267450 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */

  
    

  create  table "airflow"."lead_staging"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        accessed_at
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:42:29.345388 [debug] [Thread-1 (]: SQL status: SELECT 6103093 in 11.077 seconds
[0m07:42:29.349473 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m07:42:29.350229 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
alter table "airflow"."lead_staging"."dim_date" rename to "dim_date__dbt_backup"
[0m07:42:29.351981 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:42:29.355281 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m07:42:29.356005 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
alter table "airflow"."lead_staging"."dim_date__dbt_tmp" rename to "dim_date"
[0m07:42:29.357044 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:42:29.359400 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: COMMIT
[0m07:42:29.360138 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m07:42:29.360910 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: COMMIT
[0m07:42:29.367376 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m07:42:29.370604 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_date__dbt_backup"
[0m07:42:29.371728 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m07:42:29.372480 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
drop table if exists "airflow"."lead_staging"."dim_date__dbt_backup" cascade
[0m07:42:29.376433 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m07:42:29.378388 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: Close
[0m07:42:29.379384 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7233c092-9544-4fc6-a716-02091d19ebeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37063795b0>]}
[0m07:42:29.380360 [info ] [Thread-1 (]: 2 of 5 OK created sql table model lead_staging.dim_date ........................ [[32mSELECT 6103093[0m in 11.15s]
[0m07:42:29.381464 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_date
[0m07:42:29.382299 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_finance
[0m07:42:29.383347 [info ] [Thread-1 (]: 3 of 5 START sql table model lead_staging.dim_finance .......................... [RUN]
[0m07:42:29.384331 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_date, now model.dbt_lead_data.staging_dim_finance)
[0m07:42:29.385036 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_finance
[0m07:42:29.388948 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_finance"
[0m07:42:29.391265 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_finance
[0m07:42:29.396931 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_finance"
[0m07:42:29.400813 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m07:42:29.401649 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: BEGIN
[0m07:42:29.402486 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:42:29.406960 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m07:42:29.407699 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m07:42:29.408413 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */

  
    

  create  table "airflow"."lead_staging"."dim_finance__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        iban
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:42:30.022981 [debug] [Thread-1 (]: SQL status: SELECT 6103093 in 18.605 seconds
[0m07:42:30.032012 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:42:30.032877 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
alter table "airflow"."lead_staging"."dim_address" rename to "dim_address__dbt_backup"
[0m07:42:30.034210 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:42:30.037673 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:42:30.038457 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
alter table "airflow"."lead_staging"."dim_address__dbt_tmp" rename to "dim_address"
[0m07:42:30.039524 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:42:30.061896 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m07:42:30.062831 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:42:30.063561 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m07:42:30.065504 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:42:30.072537 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_address__dbt_backup"
[0m07:42:30.079228 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:42:30.080075 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
drop table if exists "airflow"."lead_staging"."dim_address__dbt_backup" cascade
[0m07:42:30.099257 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.018 seconds
[0m07:42:30.102430 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: Close
[0m07:42:30.104448 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '394a17a8-97b3-4fe4-881b-8a085f530ed4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8554001d90>]}
[0m07:42:30.105607 [info ] [Thread-1 (]: 1 of 5 OK created sql table model lead_staging.dim_address ..................... [[32mSELECT 6103093[0m in 18.76s]
[0m07:42:30.106770 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_adress
[0m07:42:30.107619 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_date
[0m07:42:30.108519 [info ] [Thread-1 (]: 2 of 5 START sql table model lead_staging.dim_date ............................. [RUN]
[0m07:42:30.109502 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_adress, now model.dbt_lead_data.staging_dim_date)
[0m07:42:30.110278 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_date
[0m07:42:30.113995 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_date"
[0m07:42:30.115967 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_date
[0m07:42:30.120097 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_date"
[0m07:42:30.121937 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m07:42:30.122622 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: BEGIN
[0m07:42:30.123337 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:42:30.128214 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m07:42:30.129111 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m07:42:30.129852 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */

  
    

  create  table "airflow"."lead_staging"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        accessed_at
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:42:38.321070 [debug] [Thread-1 (]: SQL status: SELECT 6103093 in 8.912 seconds
[0m07:42:38.325352 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m07:42:38.326253 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
alter table "airflow"."lead_staging"."dim_finance" rename to "dim_finance__dbt_backup"
[0m07:42:38.331942 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m07:42:38.335648 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m07:42:38.336499 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
alter table "airflow"."lead_staging"."dim_finance__dbt_tmp" rename to "dim_finance"
[0m07:42:38.337645 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:42:38.340228 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: COMMIT
[0m07:42:38.340935 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m07:42:38.341613 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: COMMIT
[0m07:42:38.348444 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m07:42:38.351459 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_finance__dbt_backup"
[0m07:42:38.352694 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m07:42:38.353533 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
drop table if exists "airflow"."lead_staging"."dim_finance__dbt_backup" cascade
[0m07:42:38.359495 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m07:42:38.362250 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: Close
[0m07:42:38.363679 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7233c092-9544-4fc6-a716-02091d19ebeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37062d87d0>]}
[0m07:42:38.365935 [info ] [Thread-1 (]: 3 of 5 OK created sql table model lead_staging.dim_finance ..................... [[32mSELECT 6103093[0m in 8.98s]
[0m07:42:38.367448 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_finance
[0m07:42:38.369479 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_person
[0m07:42:38.370973 [info ] [Thread-1 (]: 4 of 5 START sql table model lead_staging.dim_person ........................... [RUN]
[0m07:42:38.373061 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_finance, now model.dbt_lead_data.staging_dim_person)
[0m07:42:38.374391 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_person
[0m07:42:38.378986 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_person"
[0m07:42:38.382044 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_person
[0m07:42:38.386789 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_person"
[0m07:42:38.389378 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m07:42:38.390171 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: BEGIN
[0m07:42:38.390908 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:42:38.397970 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m07:42:38.399276 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m07:42:38.400196 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */

  
    

  create  table "airflow"."lead_staging"."dim_person__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        person_name,
        user_name,
        email,
        phone,
        birth_date,
        personal_number
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:42:38.987367 [debug] [Thread-1 (]: SQL status: SELECT 6103093 in 8.857 seconds
[0m07:42:38.991338 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m07:42:38.992190 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
alter table "airflow"."lead_staging"."dim_date" rename to "dim_date__dbt_backup"
[0m07:42:38.993511 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:42:38.997672 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m07:42:38.998621 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
alter table "airflow"."lead_staging"."dim_date__dbt_tmp" rename to "dim_date"
[0m07:42:39.000102 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:42:39.004625 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: COMMIT
[0m07:42:39.005687 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m07:42:39.006583 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: COMMIT
[0m07:42:39.017370 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m07:42:39.020627 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_date__dbt_backup"
[0m07:42:39.021999 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m07:42:39.022722 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
drop table if exists "airflow"."lead_staging"."dim_date__dbt_backup" cascade
[0m07:42:39.033980 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.010 seconds
[0m07:42:39.036107 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: Close
[0m07:42:39.037145 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '394a17a8-97b3-4fe4-881b-8a085f530ed4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85515727b0>]}
[0m07:42:39.038142 [info ] [Thread-1 (]: 2 of 5 OK created sql table model lead_staging.dim_date ........................ [[32mSELECT 6103093[0m in 8.93s]
[0m07:42:39.039194 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_date
[0m07:42:39.040036 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_finance
[0m07:42:39.040923 [info ] [Thread-1 (]: 3 of 5 START sql table model lead_staging.dim_finance .......................... [RUN]
[0m07:42:39.041792 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_date, now model.dbt_lead_data.staging_dim_finance)
[0m07:42:39.042612 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_finance
[0m07:42:39.046429 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_finance"
[0m07:42:39.048405 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_finance
[0m07:42:39.054312 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_finance"
[0m07:42:39.056291 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m07:42:39.057046 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: BEGIN
[0m07:42:39.057722 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:42:39.062989 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m07:42:39.063772 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m07:42:39.064597 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */

  
    

  create  table "airflow"."lead_staging"."dim_finance__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        iban
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:42:49.342370 [debug] [Thread-1 (]: SQL status: SELECT 6103093 in 10.275 seconds
[0m07:42:49.346844 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m07:42:49.347693 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
alter table "airflow"."lead_staging"."dim_finance" rename to "dim_finance__dbt_backup"
[0m07:42:49.349090 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:42:49.352884 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m07:42:49.353719 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
alter table "airflow"."lead_staging"."dim_finance__dbt_tmp" rename to "dim_finance"
[0m07:42:49.355148 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:42:49.357972 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: COMMIT
[0m07:42:49.359025 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m07:42:49.359977 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: COMMIT
[0m07:42:49.379384 [debug] [Thread-1 (]: SQL status: COMMIT in 0.018 seconds
[0m07:42:49.382660 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_finance__dbt_backup"
[0m07:42:49.384010 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m07:42:49.384742 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
drop table if exists "airflow"."lead_staging"."dim_finance__dbt_backup" cascade
[0m07:42:49.397808 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.012 seconds
[0m07:42:49.399916 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: Close
[0m07:42:49.401000 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '394a17a8-97b3-4fe4-881b-8a085f530ed4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f854f92b350>]}
[0m07:42:49.402049 [info ] [Thread-1 (]: 3 of 5 OK created sql table model lead_staging.dim_finance ..................... [[32mSELECT 6103093[0m in 10.36s]
[0m07:42:49.403158 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_finance
[0m07:42:49.404189 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_person
[0m07:42:49.405169 [info ] [Thread-1 (]: 4 of 5 START sql table model lead_staging.dim_person ........................... [RUN]
[0m07:42:49.406119 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_finance, now model.dbt_lead_data.staging_dim_person)
[0m07:42:49.406920 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_person
[0m07:42:49.410741 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_person"
[0m07:42:49.413353 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_person
[0m07:42:49.417902 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_person"
[0m07:42:49.420419 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m07:42:49.421248 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: BEGIN
[0m07:42:49.422037 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:42:49.427722 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m07:42:49.428585 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m07:42:49.429361 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */

  
    

  create  table "airflow"."lead_staging"."dim_person__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        person_name,
        user_name,
        email,
        phone,
        birth_date,
        personal_number
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:42:51.527048 [debug] [Thread-1 (]: SQL status: SELECT 6103093 in 13.126 seconds
[0m07:42:51.530910 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m07:42:51.531677 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
alter table "airflow"."lead_staging"."dim_person" rename to "dim_person__dbt_backup"
[0m07:42:52.534616 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 1.002 seconds
[0m07:42:52.539557 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m07:42:52.540520 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
alter table "airflow"."lead_staging"."dim_person__dbt_tmp" rename to "dim_person"
[0m07:42:52.541961 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:42:52.544504 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: COMMIT
[0m07:42:52.545294 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m07:42:52.545997 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: COMMIT
[0m07:42:52.551095 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m07:42:52.554675 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_person__dbt_backup"
[0m07:42:52.556624 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m07:42:52.557663 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
drop table if exists "airflow"."lead_staging"."dim_person__dbt_backup" cascade
[0m07:42:52.582477 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.024 seconds
[0m07:42:52.584426 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: Close
[0m07:42:52.585444 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7233c092-9544-4fc6-a716-02091d19ebeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37062dab70>]}
[0m07:42:52.586424 [info ] [Thread-1 (]: 4 of 5 OK created sql table model lead_staging.dim_person ...................... [[32mSELECT 6103093[0m in 14.21s]
[0m07:42:52.587486 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_person
[0m07:42:52.588390 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_fact_network_usage
[0m07:42:52.589267 [info ] [Thread-1 (]: 5 of 5 START sql table model lead_staging.fact_network_usage ................... [RUN]
[0m07:42:52.590156 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_person, now model.dbt_lead_data.staging_fact_network_usage)
[0m07:42:52.590937 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_fact_network_usage
[0m07:42:52.594851 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_fact_network_usage"
[0m07:42:52.597629 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_fact_network_usage
[0m07:42:52.602000 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_fact_network_usage"
[0m07:42:52.604370 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m07:42:52.605163 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: BEGIN
[0m07:42:52.605863 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:42:52.610978 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m07:42:52.611833 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m07:42:52.612520 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */

  
    

  create  table "airflow"."lead_staging"."fact_network_usage__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        session_duration,
        download_speed,
        upload_speed,
        consumed_traffic
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:43:03.401601 [debug] [Thread-1 (]: SQL status: SELECT 6103093 in 10.788 seconds
[0m07:43:03.408623 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m07:43:03.409572 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
alter table "airflow"."lead_staging"."fact_network_usage" rename to "fact_network_usage__dbt_backup"
[0m07:43:03.412456 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m07:43:03.417762 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m07:43:03.418779 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
alter table "airflow"."lead_staging"."fact_network_usage__dbt_tmp" rename to "fact_network_usage"
[0m07:43:03.420504 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:43:03.423262 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: COMMIT
[0m07:43:03.424115 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m07:43:03.424926 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: COMMIT
[0m07:43:03.428576 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m07:43:03.432271 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."fact_network_usage__dbt_backup"
[0m07:43:03.433743 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m07:43:03.434594 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
drop table if exists "airflow"."lead_staging"."fact_network_usage__dbt_backup" cascade
[0m07:43:03.472165 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.037 seconds
[0m07:43:03.474615 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: Close
[0m07:43:03.475685 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7233c092-9544-4fc6-a716-02091d19ebeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f370638d670>]}
[0m07:43:03.477301 [info ] [Thread-1 (]: 5 of 5 OK created sql table model lead_staging.fact_network_usage .............. [[32mSELECT 6103093[0m in 10.89s]
[0m07:43:03.478788 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_fact_network_usage
[0m07:43:03.481656 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:03.482535 [debug] [MainThread]: On master: BEGIN
[0m07:43:03.483251 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:43:03.487576 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m07:43:03.488356 [debug] [MainThread]: On master: COMMIT
[0m07:43:03.489069 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:03.489779 [debug] [MainThread]: On master: COMMIT
[0m07:43:03.490910 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:43:03.491855 [debug] [MainThread]: On master: Close
[0m07:43:03.492760 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:43:03.493500 [debug] [MainThread]: Connection 'model.dbt_lead_data.staging_fact_network_usage' was properly closed.
[0m07:43:03.494352 [info ] [MainThread]: 
[0m07:43:03.495202 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 54.75 seconds (54.75s).
[0m07:43:03.497596 [debug] [MainThread]: Command end result
[0m07:43:03.556192 [info ] [MainThread]: 
[0m07:43:03.557517 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:43:03.558301 [info ] [MainThread]: 
[0m07:43:03.559250 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m07:43:03.561003 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 55.738113, "process_user_time": 3.087036, "process_kernel_time": 0.26149, "process_mem_max_rss": "121680", "process_in_blocks": "30496", "process_out_blocks": "0"}
[0m07:43:03.561969 [debug] [MainThread]: Command `dbt run` succeeded at 07:43:03.561756 after 55.74 seconds
[0m07:43:03.562690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3706ffa810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37087aea20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3706ff3a40>]}
[0m07:43:03.563490 [debug] [MainThread]: Flushing usage events
[0m07:43:05.046096 [debug] [Thread-1 (]: SQL status: SELECT 6103093 in 15.616 seconds
[0m07:43:05.049930 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m07:43:05.051106 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
alter table "airflow"."lead_staging"."dim_person" rename to "dim_person__dbt_backup"
[0m07:43:05.052850 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:43:05.056239 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m07:43:05.057148 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
alter table "airflow"."lead_staging"."dim_person__dbt_tmp" rename to "dim_person"
[0m07:43:05.058409 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:43:05.060775 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: COMMIT
[0m07:43:05.061462 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m07:43:05.062116 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: COMMIT
[0m07:43:05.083274 [debug] [Thread-1 (]: SQL status: COMMIT in 0.020 seconds
[0m07:43:05.086661 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_person__dbt_backup"
[0m07:43:05.088053 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m07:43:05.088726 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
drop table if exists "airflow"."lead_staging"."dim_person__dbt_backup" cascade
[0m07:43:05.108761 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.019 seconds
[0m07:43:05.110709 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: Close
[0m07:43:05.112072 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '394a17a8-97b3-4fe4-881b-8a085f530ed4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f854f92ce00>]}
[0m07:43:05.113275 [info ] [Thread-1 (]: 4 of 5 OK created sql table model lead_staging.dim_person ...................... [[32mSELECT 6103093[0m in 15.71s]
[0m07:43:05.114510 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_person
[0m07:43:05.115781 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_fact_network_usage
[0m07:43:05.117164 [info ] [Thread-1 (]: 5 of 5 START sql table model lead_staging.fact_network_usage ................... [RUN]
[0m07:43:05.118318 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_person, now model.dbt_lead_data.staging_fact_network_usage)
[0m07:43:05.119373 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_fact_network_usage
[0m07:43:05.125044 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_fact_network_usage"
[0m07:43:05.128067 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_fact_network_usage
[0m07:43:05.132108 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_fact_network_usage"
[0m07:43:05.135232 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m07:43:05.136063 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: BEGIN
[0m07:43:05.137021 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:43:05.142447 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m07:43:05.143288 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m07:43:05.144048 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */

  
    

  create  table "airflow"."lead_staging"."fact_network_usage__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        session_duration,
        download_speed,
        upload_speed,
        consumed_traffic
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:43:09.542807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff118ce80e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff118ce8260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1174212b0>]}


============================== 07:43:09.554432 | 040c1265-370b-4563-850a-c358b1561eca ==============================
[0m07:43:09.554432 [info ] [MainThread]: Running with dbt=1.8.0
[0m07:43:09.555778 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select tag:trusted', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:43:09.900626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '040c1265-370b-4563-850a-c358b1561eca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1178def60>]}
[0m07:43:09.991471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '040c1265-370b-4563-850a-c358b1561eca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff116a0df70>]}
[0m07:43:09.992821 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:43:10.127448 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m07:43:10.363904 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:43:10.365016 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:43:10.415058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '040c1265-370b-4563-850a-c358b1561eca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff118c43800>]}
[0m07:43:10.600281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '040c1265-370b-4563-850a-c358b1561eca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1159997f0>]}
[0m07:43:10.601448 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m07:43:10.602197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '040c1265-370b-4563-850a-c358b1561eca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff11658cd70>]}
[0m07:43:10.604842 [info ] [MainThread]: 
[0m07:43:10.605958 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:43:10.612652 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m07:43:10.659924 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m07:43:10.660927 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m07:43:10.661818 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:43:10.668529 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.007 seconds
[0m07:43:10.670523 [debug] [ThreadPool]: On list_airflow: Close
[0m07:43:10.673743 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_staging)
[0m07:43:10.681621 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:43:10.682533 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m07:43:10.683302 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:43:10.688338 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:43:10.689213 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:43:10.690073 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m07:43:10.694532 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.004 seconds
[0m07:43:10.696783 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m07:43:10.697903 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m07:43:10.699129 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now list_airflow_lead_trusted)
[0m07:43:10.703070 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:43:10.704050 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m07:43:10.704957 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:43:10.709920 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:43:10.711070 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:43:10.712051 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m07:43:10.716180 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m07:43:10.718307 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m07:43:10.719364 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m07:43:10.727081 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:10.728128 [debug] [MainThread]: On master: BEGIN
[0m07:43:10.728992 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:43:10.733987 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:43:10.734898 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:10.735826 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:43:10.740057 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m07:43:10.742455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '040c1265-370b-4563-850a-c358b1561eca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff116a14530>]}
[0m07:43:10.743604 [debug] [MainThread]: On master: ROLLBACK
[0m07:43:10.744779 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:10.745861 [debug] [MainThread]: On master: BEGIN
[0m07:43:10.747097 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:43:10.748443 [debug] [MainThread]: On master: COMMIT
[0m07:43:10.749338 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:10.750154 [debug] [MainThread]: On master: COMMIT
[0m07:43:10.751235 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:43:10.752085 [debug] [MainThread]: On master: Close
[0m07:43:10.753447 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:43:10.754384 [info ] [MainThread]: 
[0m07:43:10.766602 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_non_pii_data
[0m07:43:10.767699 [info ] [Thread-1 (]: 1 of 4 START sql table model lead_trusted.non_pii_data ......................... [RUN]
[0m07:43:10.768722 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now model.dbt_lead_data.trusted_non_pii_data)
[0m07:43:10.769538 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_non_pii_data
[0m07:43:10.780760 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_non_pii_data"
[0m07:43:10.783835 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_non_pii_data
[0m07:43:10.830895 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_non_pii_data"
[0m07:43:10.833707 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m07:43:10.834549 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: BEGIN
[0m07:43:10.835322 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:43:10.840108 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m07:43:10.840955 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m07:43:10.841777 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */

  
    

  create  table "airflow"."lead_trusted"."non_pii_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        '***MASKED***' AS person_name,
        SUBSTRING(dp.user_name, 1, 5) || '*****'  user_name,
        SUBSTRING(dp.email, 1, 5) || '*****' AS email,
        '***MASKED***'  AS personal_number, 
        '***MASKED***' AS birth_date, 
        '***MASKED***' AS address,
        '***MASKED***'  AS phone, 
        SUBSTRING(da.mac_address, 1, 5) || '*****' AS mac_address,
        SUBSTRING(da.ip_address, 1, 5) || '*****' AS ip_address,
        SUBSTRING(df.iban, 1, 5) || '*****' AS iban,
        dd.accessed_at,
        fnu.session_duration,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.consumed_traffic,
        fnu.unique_id
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    INNER JOIN
        "airflow"."lead_staging"."dim_address" da ON fnu.unique_id = da.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_date" dd ON da.unique_id = dd.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_finance" df ON dd.unique_id = df.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_person" dp ON df.unique_id = dp.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:43:11.994355 [debug] [Thread-1 (]: SQL status: SELECT 6103093 in 6.851 seconds
[0m07:43:12.000409 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m07:43:12.001356 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
alter table "airflow"."lead_staging"."fact_network_usage" rename to "fact_network_usage__dbt_backup"
[0m07:43:12.959396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb25e736840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb25e7351c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb25e736780>]}


============================== 07:43:12.966807 | 86aa8497-9baf-4ca4-8603-3abde472ba84 ==============================
[0m07:43:12.966807 [info ] [MainThread]: Running with dbt=1.8.0
[0m07:43:12.967983 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select tag:staging', 'send_anonymous_usage_stats': 'True'}
[0m07:43:13.173173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86aa8497-9baf-4ca4-8603-3abde472ba84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb25fc372f0>]}
[0m07:43:13.238114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '86aa8497-9baf-4ca4-8603-3abde472ba84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb25e6f0140>]}
[0m07:43:13.239448 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:43:13.329690 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m07:43:13.457592 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:43:13.458422 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:43:13.499920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86aa8497-9baf-4ca4-8603-3abde472ba84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb25d78c1d0>]}
[0m07:43:13.638585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86aa8497-9baf-4ca4-8603-3abde472ba84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb25cb78e90>]}
[0m07:43:13.639519 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m07:43:13.640401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86aa8497-9baf-4ca4-8603-3abde472ba84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb25cf80bc0>]}
[0m07:43:13.642932 [info ] [MainThread]: 
[0m07:43:13.644171 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:43:13.650588 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m07:43:13.690613 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m07:43:13.691462 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m07:43:13.692085 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:43:13.697770 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.006 seconds
[0m07:43:13.699786 [debug] [ThreadPool]: On list_airflow: Close
[0m07:43:13.702691 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_trusted)
[0m07:43:13.712331 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:43:13.713584 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m07:43:13.714736 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:43:13.721283 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m07:43:13.722261 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:43:13.723136 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m07:43:13.728175 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m07:43:13.731187 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m07:43:13.732926 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m07:43:13.734788 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now list_airflow_lead_staging)
[0m07:43:13.739408 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:43:13.740457 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m07:43:13.741447 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:43:13.747767 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m07:43:13.749425 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:43:13.750380 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m07:43:13.755078 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.004 seconds
[0m07:43:13.758263 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m07:43:13.759938 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m07:43:13.770024 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:13.770999 [debug] [MainThread]: On master: BEGIN
[0m07:43:13.771906 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:43:13.776922 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:43:13.777938 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:13.778741 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:43:13.782555 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m07:43:13.784533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86aa8497-9baf-4ca4-8603-3abde472ba84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb25d3be390>]}
[0m07:43:13.785389 [debug] [MainThread]: On master: ROLLBACK
[0m07:43:13.786218 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:13.786906 [debug] [MainThread]: On master: BEGIN
[0m07:43:13.788014 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:43:13.788718 [debug] [MainThread]: On master: COMMIT
[0m07:43:13.789449 [debug] [MainThread]: Using postgres connection "master"
[0m07:43:13.790112 [debug] [MainThread]: On master: COMMIT
[0m07:43:13.791049 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:43:13.791801 [debug] [MainThread]: On master: Close
[0m07:43:13.792727 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:43:13.793498 [info ] [MainThread]: 
[0m07:43:13.804238 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_adress
[0m07:43:13.805293 [info ] [Thread-1 (]: 1 of 5 START sql table model lead_staging.dim_address .......................... [RUN]
[0m07:43:13.806086 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now model.dbt_lead_data.staging_dim_adress)
[0m07:43:13.806869 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_adress
[0m07:43:13.816742 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_adress"
[0m07:43:13.818999 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_adress
[0m07:43:13.871121 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_adress"
[0m07:43:13.873743 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:43:13.874541 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: BEGIN
[0m07:43:13.875223 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:43:13.879856 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m07:43:13.880632 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:43:13.881405 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */

  
    

  create  table "airflow"."lead_staging"."dim_address__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        address,
        mac_address,
        ip_address
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:43:23.053846 [debug] [Thread-1 (]: SQL status: SELECT 6321899 in 9.172 seconds
[0m07:43:23.062117 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:43:23.063098 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
alter table "airflow"."lead_staging"."dim_address" rename to "dim_address__dbt_backup"
[0m07:44:12.019736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f549c242750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f549a211fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f549a212570>]}


============================== 07:44:12.028435 | 62069fcf-817e-4daa-8cc4-713ef0a34778 ==============================
[0m07:44:12.028435 [info ] [MainThread]: Running with dbt=1.8.0
[0m07:44:12.029400 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select tag:staging', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:44:12.331630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '62069fcf-817e-4daa-8cc4-713ef0a34778', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f549a1e75f0>]}
[0m07:44:12.402534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '62069fcf-817e-4daa-8cc4-713ef0a34778', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f549b3a8860>]}
[0m07:44:12.404126 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:44:12.503561 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m07:44:12.666997 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:44:12.667789 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:44:12.706964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '62069fcf-817e-4daa-8cc4-713ef0a34778', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54993a8410>]}
[0m07:44:12.853551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '62069fcf-817e-4daa-8cc4-713ef0a34778', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5498fa4a70>]}
[0m07:44:12.854429 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m07:44:12.855217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62069fcf-817e-4daa-8cc4-713ef0a34778', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54993a8620>]}
[0m07:44:12.857688 [info ] [MainThread]: 
[0m07:44:12.858816 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:44:12.865137 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m07:44:12.907420 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m07:44:12.908339 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m07:44:12.909100 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:44:12.915031 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.006 seconds
[0m07:44:12.916917 [debug] [ThreadPool]: On list_airflow: Close
[0m07:44:12.919554 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_staging)
[0m07:44:12.926253 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:44:12.926946 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m07:44:12.927735 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:44:12.932548 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:44:12.933387 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:44:12.934182 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m07:44:12.937362 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.003 seconds
[0m07:44:12.939346 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m07:44:12.940202 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m07:44:12.941205 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now list_airflow_lead_trusted)
[0m07:44:12.944674 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:44:12.945362 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m07:44:12.945944 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:44:12.950677 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:44:12.951419 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:44:12.952178 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m07:44:12.955361 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m07:44:12.957300 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m07:44:12.958245 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m07:44:12.965522 [debug] [MainThread]: Using postgres connection "master"
[0m07:44:12.966335 [debug] [MainThread]: On master: BEGIN
[0m07:44:12.966995 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:44:12.972364 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:44:12.973149 [debug] [MainThread]: Using postgres connection "master"
[0m07:44:12.973938 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:44:12.977882 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m07:44:12.979839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62069fcf-817e-4daa-8cc4-713ef0a34778', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5497bf4c80>]}
[0m07:44:12.980675 [debug] [MainThread]: On master: ROLLBACK
[0m07:44:12.981519 [debug] [MainThread]: Using postgres connection "master"
[0m07:44:12.982261 [debug] [MainThread]: On master: BEGIN
[0m07:44:12.983351 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:44:12.984153 [debug] [MainThread]: On master: COMMIT
[0m07:44:12.984876 [debug] [MainThread]: Using postgres connection "master"
[0m07:44:12.985606 [debug] [MainThread]: On master: COMMIT
[0m07:44:12.986523 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:44:12.987200 [debug] [MainThread]: On master: Close
[0m07:44:12.988251 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:44:12.988979 [info ] [MainThread]: 
[0m07:44:12.999417 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_adress
[0m07:44:13.000366 [info ] [Thread-1 (]: 1 of 5 START sql table model lead_staging.dim_address .......................... [RUN]
[0m07:44:13.001301 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now model.dbt_lead_data.staging_dim_adress)
[0m07:44:13.001988 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_adress
[0m07:44:13.011040 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_adress"
[0m07:44:13.013770 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_adress
[0m07:44:13.057449 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_adress"
[0m07:44:13.059698 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:44:13.060370 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: BEGIN
[0m07:44:13.060909 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:44:13.064957 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m07:44:13.065772 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:44:13.066481 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */

  
    

  create  table "airflow"."lead_staging"."dim_address__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        address,
        mac_address,
        ip_address
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:44:32.155758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45bddc92b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45bd281e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45bdf4ea80>]}


============================== 07:44:32.165308 | 4ab1c331-3839-4b57-ad78-9a8b30160e90 ==============================
[0m07:44:32.165308 [info ] [MainThread]: Running with dbt=1.8.0
[0m07:44:32.166629 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select tag:trusted', 'send_anonymous_usage_stats': 'True'}
[0m07:44:32.400295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4ab1c331-3839-4b57-ad78-9a8b30160e90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45bdfa2fc0>]}
[0m07:44:32.475096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4ab1c331-3839-4b57-ad78-9a8b30160e90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45be614920>]}
[0m07:44:32.476613 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:44:32.591067 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m07:44:32.752728 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:44:32.753617 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:44:32.800165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4ab1c331-3839-4b57-ad78-9a8b30160e90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45bdcac500>]}
[0m07:44:32.944126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4ab1c331-3839-4b57-ad78-9a8b30160e90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45bb768b30>]}
[0m07:44:32.945017 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m07:44:32.945818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ab1c331-3839-4b57-ad78-9a8b30160e90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45bbfadb20>]}
[0m07:44:32.948543 [info ] [MainThread]: 
[0m07:44:32.949638 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:44:32.955456 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m07:44:32.996304 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m07:44:32.997108 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m07:44:32.997761 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:44:33.003213 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.005 seconds
[0m07:44:33.005035 [debug] [ThreadPool]: On list_airflow: Close
[0m07:44:33.007646 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_staging)
[0m07:44:33.014423 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:44:33.015217 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m07:44:33.015903 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:44:33.020382 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m07:44:33.021118 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:44:33.021769 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m07:44:33.025254 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.003 seconds
[0m07:44:33.027476 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m07:44:33.028551 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m07:44:33.029547 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now list_airflow_lead_trusted)
[0m07:44:33.032999 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:44:33.033712 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m07:44:33.034429 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:44:33.038931 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m07:44:33.039729 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:44:33.040377 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m07:44:33.043522 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m07:44:33.045557 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m07:44:33.046457 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m07:44:33.053932 [debug] [MainThread]: Using postgres connection "master"
[0m07:44:33.054994 [debug] [MainThread]: On master: BEGIN
[0m07:44:33.055841 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:44:33.060694 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:44:33.061559 [debug] [MainThread]: Using postgres connection "master"
[0m07:44:33.062389 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:44:33.066136 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m07:44:33.068284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ab1c331-3839-4b57-ad78-9a8b30160e90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45bcbefec0>]}
[0m07:44:33.069125 [debug] [MainThread]: On master: ROLLBACK
[0m07:44:33.069991 [debug] [MainThread]: Using postgres connection "master"
[0m07:44:33.070765 [debug] [MainThread]: On master: BEGIN
[0m07:44:33.071821 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:44:33.072631 [debug] [MainThread]: On master: COMMIT
[0m07:44:33.073343 [debug] [MainThread]: Using postgres connection "master"
[0m07:44:33.073968 [debug] [MainThread]: On master: COMMIT
[0m07:44:33.075110 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:44:33.075835 [debug] [MainThread]: On master: Close
[0m07:44:33.076843 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:44:33.077657 [info ] [MainThread]: 
[0m07:44:33.088690 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_non_pii_data
[0m07:44:33.089763 [info ] [Thread-1 (]: 1 of 4 START sql table model lead_trusted.non_pii_data ......................... [RUN]
[0m07:44:33.090799 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now model.dbt_lead_data.trusted_non_pii_data)
[0m07:44:33.091604 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_non_pii_data
[0m07:44:33.102328 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_non_pii_data"
[0m07:44:33.104665 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_non_pii_data
[0m07:44:33.150929 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_non_pii_data"
[0m07:44:33.153119 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m07:44:33.153828 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: BEGIN
[0m07:44:33.154575 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:44:33.159388 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m07:44:33.160287 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m07:44:33.161010 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */

  
    

  create  table "airflow"."lead_trusted"."non_pii_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        '***MASKED***' AS person_name,
        SUBSTRING(dp.user_name, 1, 5) || '*****'  user_name,
        SUBSTRING(dp.email, 1, 5) || '*****' AS email,
        '***MASKED***'  AS personal_number, 
        '***MASKED***' AS birth_date, 
        '***MASKED***' AS address,
        '***MASKED***'  AS phone, 
        SUBSTRING(da.mac_address, 1, 5) || '*****' AS mac_address,
        SUBSTRING(da.ip_address, 1, 5) || '*****' AS ip_address,
        SUBSTRING(df.iban, 1, 5) || '*****' AS iban,
        dd.accessed_at,
        fnu.session_duration,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.consumed_traffic,
        fnu.unique_id
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    INNER JOIN
        "airflow"."lead_staging"."dim_address" da ON fnu.unique_id = da.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_date" dd ON da.unique_id = dd.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_finance" df ON dd.unique_id = df.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_person" dp ON df.unique_id = dp.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:45:10.237190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07519f84d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0750ea5e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07514628a0>]}


============================== 07:45:10.246604 | bbe96514-8999-487b-9fe6-cc422f1a3958 ==============================
[0m07:45:10.246604 [info ] [MainThread]: Running with dbt=1.8.0
[0m07:45:10.247604 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select tag:trusted', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:45:10.589499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bbe96514-8999-487b-9fe6-cc422f1a3958', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07548930e0>]}
[0m07:45:10.661835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bbe96514-8999-487b-9fe6-cc422f1a3958', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f075106a9c0>]}
[0m07:45:10.664886 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:45:10.775520 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m07:45:10.961075 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:45:10.962030 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:45:11.005722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bbe96514-8999-487b-9fe6-cc422f1a3958', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f074ff5bda0>]}
[0m07:45:11.164806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bbe96514-8999-487b-9fe6-cc422f1a3958', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f074fbd89e0>]}
[0m07:45:11.165855 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m07:45:11.166680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bbe96514-8999-487b-9fe6-cc422f1a3958', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f074f749b50>]}
[0m07:45:11.169325 [info ] [MainThread]: 
[0m07:45:11.170445 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:45:11.176369 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m07:45:11.220021 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m07:45:11.220960 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m07:45:11.221737 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:45:11.228313 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.007 seconds
[0m07:45:11.230614 [debug] [ThreadPool]: On list_airflow: Close
[0m07:45:11.233566 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_staging)
[0m07:45:11.240848 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:45:11.241739 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m07:45:11.242462 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:45:11.247594 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:45:11.248470 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:45:11.249130 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m07:45:11.252479 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.003 seconds
[0m07:45:11.254514 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m07:45:11.255400 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m07:45:11.256385 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now list_airflow_lead_trusted)
[0m07:45:11.260148 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:45:11.260903 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m07:45:11.261702 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:45:11.265847 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m07:45:11.266794 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:45:11.267526 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m07:45:11.270820 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m07:45:11.272880 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m07:45:11.273813 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m07:45:11.281610 [debug] [MainThread]: Using postgres connection "master"
[0m07:45:11.282588 [debug] [MainThread]: On master: BEGIN
[0m07:45:11.283499 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:45:11.288550 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:45:11.289550 [debug] [MainThread]: Using postgres connection "master"
[0m07:45:11.290397 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:45:11.294208 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m07:45:11.296637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bbe96514-8999-487b-9fe6-cc422f1a3958', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f074f35eed0>]}
[0m07:45:11.297601 [debug] [MainThread]: On master: ROLLBACK
[0m07:45:11.298682 [debug] [MainThread]: Using postgres connection "master"
[0m07:45:11.299427 [debug] [MainThread]: On master: BEGIN
[0m07:45:11.300629 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m07:45:11.301411 [debug] [MainThread]: On master: COMMIT
[0m07:45:11.302119 [debug] [MainThread]: Using postgres connection "master"
[0m07:45:11.302959 [debug] [MainThread]: On master: COMMIT
[0m07:45:11.304162 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:45:11.305074 [debug] [MainThread]: On master: Close
[0m07:45:11.306146 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:45:11.307080 [info ] [MainThread]: 
[0m07:45:11.318826 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_non_pii_data
[0m07:45:11.320195 [info ] [Thread-1 (]: 1 of 4 START sql table model lead_trusted.non_pii_data ......................... [RUN]
[0m07:45:11.321612 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now model.dbt_lead_data.trusted_non_pii_data)
[0m07:45:11.322773 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_non_pii_data
[0m07:45:11.334370 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_non_pii_data"
[0m07:45:11.336952 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_non_pii_data
[0m07:45:11.386108 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_non_pii_data"
[0m07:45:11.388506 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m07:45:11.389162 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: BEGIN
[0m07:45:11.389838 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:45:11.394203 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m07:45:11.395068 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m07:45:11.395898 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */

  
    

  create  table "airflow"."lead_trusted"."non_pii_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        '***MASKED***' AS person_name,
        SUBSTRING(dp.user_name, 1, 5) || '*****'  user_name,
        SUBSTRING(dp.email, 1, 5) || '*****' AS email,
        '***MASKED***'  AS personal_number, 
        '***MASKED***' AS birth_date, 
        '***MASKED***' AS address,
        '***MASKED***'  AS phone, 
        SUBSTRING(da.mac_address, 1, 5) || '*****' AS mac_address,
        SUBSTRING(da.ip_address, 1, 5) || '*****' AS ip_address,
        SUBSTRING(df.iban, 1, 5) || '*****' AS iban,
        dd.accessed_at,
        fnu.session_duration,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.consumed_traffic,
        fnu.unique_id
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    INNER JOIN
        "airflow"."lead_staging"."dim_address" da ON fnu.unique_id = da.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_date" dd ON da.unique_id = dd.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_finance" df ON dd.unique_id = df.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_person" dp ON df.unique_id = dp.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:45:15.252803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf1eb820c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf1e6773b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf1e8d7dd0>]}
[0m07:45:15.252750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46f6174dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46f48e7b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46f45e22a0>]}


============================== 07:45:15.260299 | 25c849d7-1644-426f-bcd9-974271f9a2a0 ==============================
[0m07:45:15.260299 [info ] [MainThread]: Running with dbt=1.8.0


============================== 07:45:15.260580 | 07bb646f-c8f0-4c36-9866-2f583e8a04d7 ==============================
[0m07:45:15.260580 [info ] [MainThread]: Running with dbt=1.8.0
[0m07:45:15.261433 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select tag:staging', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:45:15.261694 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select tag:staging', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:45:15.525549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '25c849d7-1644-426f-bcd9-974271f9a2a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf1f3e5790>]}
[0m07:45:15.525527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '07bb646f-c8f0-4c36-9866-2f583e8a04d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46f5505490>]}
[0m07:45:15.604642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '25c849d7-1644-426f-bcd9-974271f9a2a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf1f34a8d0>]}
[0m07:45:15.605185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '07bb646f-c8f0-4c36-9866-2f583e8a04d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46f4e5da60>]}
[0m07:45:15.605907 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:45:15.606749 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:45:15.719521 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m07:45:15.721108 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m07:45:15.882957 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:45:15.883993 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:45:15.884811 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:45:15.885611 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:45:15.928712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '25c849d7-1644-426f-bcd9-974271f9a2a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf1e03a420>]}
[0m07:45:15.929492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '07bb646f-c8f0-4c36-9866-2f583e8a04d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46f41ad430>]}
[0m07:45:16.089544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '07bb646f-c8f0-4c36-9866-2f583e8a04d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46f39b5a00>]}
[0m07:45:16.089783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '25c849d7-1644-426f-bcd9-974271f9a2a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf1d3912e0>]}
[0m07:45:16.090461 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m07:45:16.090605 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m07:45:16.091216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07bb646f-c8f0-4c36-9866-2f583e8a04d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46f413c2f0>]}
[0m07:45:16.091596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25c849d7-1644-426f-bcd9-974271f9a2a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf1e902660>]}
[0m07:45:16.093742 [info ] [MainThread]: 
[0m07:45:16.094246 [info ] [MainThread]: 
[0m07:45:16.094875 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:45:16.095524 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:45:16.100891 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m07:45:16.101904 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m07:45:16.146730 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m07:45:16.146855 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m07:45:16.147626 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m07:45:16.147953 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m07:45:16.148421 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:45:16.148682 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:45:16.154251 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.006 seconds
[0m07:45:16.155253 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.007 seconds
[0m07:45:16.156543 [debug] [ThreadPool]: On list_airflow: Close
[0m07:45:16.157505 [debug] [ThreadPool]: On list_airflow: Close
[0m07:45:16.160581 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_trusted)
[0m07:45:16.161503 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_staging)
[0m07:45:16.168814 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:45:16.168942 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:45:16.169739 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m07:45:16.169985 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m07:45:16.170526 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:45:16.170855 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:45:16.175578 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:45:16.175789 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:45:16.176454 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:45:16.176738 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:45:16.177090 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m07:45:16.177597 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m07:45:16.180541 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m07:45:16.180934 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.003 seconds
[0m07:45:16.182683 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m07:45:16.183113 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m07:45:16.183717 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m07:45:16.184207 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m07:45:16.184830 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now list_airflow_lead_staging)
[0m07:45:16.185552 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now list_airflow_lead_trusted)
[0m07:45:16.188438 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:45:16.189149 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m07:45:16.189227 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:45:16.190021 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:45:16.190407 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m07:45:16.191107 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:45:16.194933 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:45:16.195521 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m07:45:16.195820 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:45:16.196289 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:45:16.196675 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m07:45:16.197114 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m07:45:16.200294 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.003 seconds
[0m07:45:16.200280 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m07:45:16.202543 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m07:45:16.202737 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m07:45:16.203606 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m07:45:16.203890 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m07:45:16.212092 [debug] [MainThread]: Using postgres connection "master"
[0m07:45:16.212192 [debug] [MainThread]: Using postgres connection "master"
[0m07:45:16.213134 [debug] [MainThread]: On master: BEGIN
[0m07:45:16.213558 [debug] [MainThread]: On master: BEGIN
[0m07:45:16.214080 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:45:16.214394 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:45:16.219135 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:45:16.219678 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:45:16.220114 [debug] [MainThread]: Using postgres connection "master"
[0m07:45:16.220601 [debug] [MainThread]: Using postgres connection "master"
[0m07:45:16.221164 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:45:16.221634 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:45:16.225327 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m07:45:16.226096 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m07:45:16.227681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25c849d7-1644-426f-bcd9-974271f9a2a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf1d76bec0>]}
[0m07:45:16.228250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07bb646f-c8f0-4c36-9866-2f583e8a04d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46f58e5460>]}
[0m07:45:16.228537 [debug] [MainThread]: On master: ROLLBACK
[0m07:45:16.229257 [debug] [MainThread]: On master: ROLLBACK
[0m07:45:16.229645 [debug] [MainThread]: Using postgres connection "master"
[0m07:45:16.230257 [debug] [MainThread]: Using postgres connection "master"
[0m07:45:16.230408 [debug] [MainThread]: On master: BEGIN
[0m07:45:16.231103 [debug] [MainThread]: On master: BEGIN
[0m07:45:16.232003 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:45:16.232651 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m07:45:16.233011 [debug] [MainThread]: On master: COMMIT
[0m07:45:16.233630 [debug] [MainThread]: On master: COMMIT
[0m07:45:16.233979 [debug] [MainThread]: Using postgres connection "master"
[0m07:45:16.234408 [debug] [MainThread]: Using postgres connection "master"
[0m07:45:16.234802 [debug] [MainThread]: On master: COMMIT
[0m07:45:16.235065 [debug] [MainThread]: On master: COMMIT
[0m07:45:16.235730 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:45:16.236053 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:45:16.236493 [debug] [MainThread]: On master: Close
[0m07:45:16.236813 [debug] [MainThread]: On master: Close
[0m07:45:16.237466 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:45:16.237782 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:45:16.238302 [info ] [MainThread]: 
[0m07:45:16.238811 [info ] [MainThread]: 
[0m07:45:16.249683 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_adress
[0m07:45:16.250141 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_adress
[0m07:45:16.250823 [info ] [Thread-1 (]: 1 of 5 START sql table model lead_staging.dim_address .......................... [RUN]
[0m07:45:16.251245 [info ] [Thread-1 (]: 1 of 5 START sql table model lead_staging.dim_address .......................... [RUN]
[0m07:45:16.251829 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now model.dbt_lead_data.staging_dim_adress)
[0m07:45:16.252591 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now model.dbt_lead_data.staging_dim_adress)
[0m07:45:16.252769 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_adress
[0m07:45:16.253360 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_adress
[0m07:45:16.262207 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_adress"
[0m07:45:16.262388 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_adress"
[0m07:45:16.265050 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_adress
[0m07:45:16.265381 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_adress
[0m07:45:16.314611 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_adress"
[0m07:45:16.316099 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_adress"
[0m07:45:16.317815 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:45:16.318566 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:45:16.318661 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: BEGIN
[0m07:45:16.319721 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: BEGIN
[0m07:45:16.319938 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:45:16.320518 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:45:16.325582 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m07:45:16.325634 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m07:45:16.326673 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:45:16.327045 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:45:16.327932 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */

  
    

  create  table "airflow"."lead_staging"."dim_address__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        address,
        mac_address,
        ip_address
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:45:16.328307 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */

  
    

  create  table "airflow"."lead_staging"."dim_address__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        address,
        mac_address,
        ip_address
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:45:18.198240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f916d40e720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f916e2fdbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f916fc18c20>]}


============================== 07:45:18.206016 | dfda9632-ec64-4571-b65d-3ac874df5453 ==============================
[0m07:45:18.206016 [info ] [MainThread]: Running with dbt=1.8.0
[0m07:45:18.207066 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select tag:trusted', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:45:18.449721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dfda9632-ec64-4571-b65d-3ac874df5453', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f916e31f110>]}
[0m07:45:18.525398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dfda9632-ec64-4571-b65d-3ac874df5453', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f916e31f080>]}
[0m07:45:18.526824 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:45:18.624281 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m07:45:18.789110 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:45:18.789990 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:45:18.841460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dfda9632-ec64-4571-b65d-3ac874df5453', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f916c7a40b0>]}
[0m07:45:18.997786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dfda9632-ec64-4571-b65d-3ac874df5453', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f916bb74d70>]}
[0m07:45:18.999011 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m07:45:19.000021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dfda9632-ec64-4571-b65d-3ac874df5453', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f916cf583b0>]}
[0m07:45:19.003649 [info ] [MainThread]: 
[0m07:45:19.004882 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:45:19.012255 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m07:45:19.067164 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m07:45:19.068613 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m07:45:19.069440 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:45:19.075789 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.006 seconds
[0m07:45:19.078636 [debug] [ThreadPool]: On list_airflow: Close
[0m07:45:19.084292 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_staging)
[0m07:45:19.092216 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:45:19.093079 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m07:45:19.093847 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:45:19.098855 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:45:19.099807 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:45:19.100724 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m07:45:19.104303 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.003 seconds
[0m07:45:19.106302 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m07:45:19.107407 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m07:45:19.108598 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now list_airflow_lead_trusted)
[0m07:45:19.112373 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:45:19.113116 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m07:45:19.113783 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:45:19.119539 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m07:45:19.120446 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:45:19.121154 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m07:45:19.124693 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m07:45:19.126867 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m07:45:19.128000 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m07:45:19.136813 [debug] [MainThread]: Using postgres connection "master"
[0m07:45:19.137776 [debug] [MainThread]: On master: BEGIN
[0m07:45:19.138561 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:45:19.143634 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:45:19.144517 [debug] [MainThread]: Using postgres connection "master"
[0m07:45:19.145509 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:45:19.149509 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m07:45:19.152287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dfda9632-ec64-4571-b65d-3ac874df5453', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f916afecce0>]}
[0m07:45:19.153437 [debug] [MainThread]: On master: ROLLBACK
[0m07:45:19.154435 [debug] [MainThread]: Using postgres connection "master"
[0m07:45:19.155349 [debug] [MainThread]: On master: BEGIN
[0m07:45:19.156729 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m07:45:19.157643 [debug] [MainThread]: On master: COMMIT
[0m07:45:19.158432 [debug] [MainThread]: Using postgres connection "master"
[0m07:45:19.159137 [debug] [MainThread]: On master: COMMIT
[0m07:45:19.160145 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:45:19.161018 [debug] [MainThread]: On master: Close
[0m07:45:19.162038 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:45:19.162949 [info ] [MainThread]: 
[0m07:45:19.175850 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_non_pii_data
[0m07:45:19.176951 [info ] [Thread-1 (]: 1 of 4 START sql table model lead_trusted.non_pii_data ......................... [RUN]
[0m07:45:19.178036 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now model.dbt_lead_data.trusted_non_pii_data)
[0m07:45:19.178927 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_non_pii_data
[0m07:45:19.190945 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_non_pii_data"
[0m07:45:19.193918 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_non_pii_data
[0m07:45:19.247029 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_non_pii_data"
[0m07:45:19.249782 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m07:45:19.250803 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: BEGIN
[0m07:45:19.251659 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:45:19.256560 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m07:45:19.257666 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m07:45:19.259003 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */

  
    

  create  table "airflow"."lead_trusted"."non_pii_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        '***MASKED***' AS person_name,
        SUBSTRING(dp.user_name, 1, 5) || '*****'  user_name,
        SUBSTRING(dp.email, 1, 5) || '*****' AS email,
        '***MASKED***'  AS personal_number, 
        '***MASKED***' AS birth_date, 
        '***MASKED***' AS address,
        '***MASKED***'  AS phone, 
        SUBSTRING(da.mac_address, 1, 5) || '*****' AS mac_address,
        SUBSTRING(da.ip_address, 1, 5) || '*****' AS ip_address,
        SUBSTRING(df.iban, 1, 5) || '*****' AS iban,
        dd.accessed_at,
        fnu.session_duration,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.consumed_traffic,
        fnu.unique_id
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    INNER JOIN
        "airflow"."lead_staging"."dim_address" da ON fnu.unique_id = da.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_date" dd ON da.unique_id = dd.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_finance" df ON dd.unique_id = df.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_person" dp ON df.unique_id = dp.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:45:41.060873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f713741e0c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7137b7ddc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7136f18920>]}


============================== 07:45:41.068587 | 7b11059b-b504-4d11-b116-c4890c041191 ==============================
[0m07:45:41.068587 [info ] [MainThread]: Running with dbt=1.8.0
[0m07:45:41.069594 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select tag:staging', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:45:41.344854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b11059b-b504-4d11-b116-c4890c041191', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7136f65e20>]}
[0m07:45:41.406279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7b11059b-b504-4d11-b116-c4890c041191', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7137331c40>]}
[0m07:45:41.407712 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:45:41.500208 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m07:45:41.659236 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:45:41.660013 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:45:41.703915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b11059b-b504-4d11-b116-c4890c041191', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f713634c350>]}
[0m07:45:41.845510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7b11059b-b504-4d11-b116-c4890c041191', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f713574cd40>]}
[0m07:45:41.846449 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m07:45:41.847270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b11059b-b504-4d11-b116-c4890c041191', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71372e2990>]}
[0m07:45:41.850107 [info ] [MainThread]: 
[0m07:45:41.851324 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:45:41.857250 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m07:45:41.898027 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m07:45:41.898729 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m07:45:41.899389 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:45:41.905062 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.006 seconds
[0m07:45:41.906646 [debug] [ThreadPool]: On list_airflow: Close
[0m07:45:41.908788 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_staging)
[0m07:45:41.915349 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:45:41.916116 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m07:45:41.916782 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:45:41.921310 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m07:45:41.922230 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:45:41.922986 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m07:45:41.926010 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m07:45:41.927695 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m07:45:41.928359 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m07:45:41.929354 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now list_airflow_lead_trusted)
[0m07:45:41.933340 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:45:41.934007 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m07:45:41.934631 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:45:41.938954 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m07:45:41.939745 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:45:41.940438 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m07:45:41.943566 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m07:45:41.945229 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m07:45:41.946178 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m07:45:41.952907 [debug] [MainThread]: Using postgres connection "master"
[0m07:45:41.953713 [debug] [MainThread]: On master: BEGIN
[0m07:45:41.954363 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:45:41.958851 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m07:45:41.959625 [debug] [MainThread]: Using postgres connection "master"
[0m07:45:41.960295 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:45:41.963518 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m07:45:41.965332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b11059b-b504-4d11-b116-c4890c041191', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71372e2990>]}
[0m07:45:41.966401 [debug] [MainThread]: On master: ROLLBACK
[0m07:45:41.967258 [debug] [MainThread]: Using postgres connection "master"
[0m07:45:41.968219 [debug] [MainThread]: On master: BEGIN
[0m07:45:41.969603 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m07:45:41.970717 [debug] [MainThread]: On master: COMMIT
[0m07:45:41.971573 [debug] [MainThread]: Using postgres connection "master"
[0m07:45:41.972176 [debug] [MainThread]: On master: COMMIT
[0m07:45:41.973213 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:45:41.973957 [debug] [MainThread]: On master: Close
[0m07:45:41.974897 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:45:41.975719 [info ] [MainThread]: 
[0m07:45:41.986819 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_adress
[0m07:45:41.987862 [info ] [Thread-1 (]: 1 of 5 START sql table model lead_staging.dim_address .......................... [RUN]
[0m07:45:41.988774 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now model.dbt_lead_data.staging_dim_adress)
[0m07:45:41.989341 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_adress
[0m07:45:41.998301 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_adress"
[0m07:45:42.001135 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_adress
[0m07:45:42.048762 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_adress"
[0m07:45:42.051090 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:45:42.051682 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: BEGIN
[0m07:45:42.052206 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:45:42.056391 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m07:45:42.057182 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:45:42.057863 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */

  
    

  create  table "airflow"."lead_staging"."dim_address__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        address,
        mac_address,
        ip_address
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:46:12.968284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff96e696ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff96e6960f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff96e86fb60>]}


============================== 07:46:12.976487 | 060b4754-9438-4fda-8e86-b7fa2c95bc02 ==============================
[0m07:46:12.976487 [info ] [MainThread]: Running with dbt=1.8.0
[0m07:46:12.977430 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select tag:staging', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:46:13.197659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '060b4754-9438-4fda-8e86-b7fa2c95bc02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff96f33b080>]}
[0m07:46:13.279764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '060b4754-9438-4fda-8e86-b7fa2c95bc02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff96f33b110>]}
[0m07:46:13.281228 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:46:13.390298 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m07:46:13.586612 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:46:13.587492 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:46:13.636918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '060b4754-9438-4fda-8e86-b7fa2c95bc02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff96e07aea0>]}
[0m07:46:13.804082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '060b4754-9438-4fda-8e86-b7fa2c95bc02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff96cb78aa0>]}
[0m07:46:13.805566 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m07:46:13.807454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '060b4754-9438-4fda-8e86-b7fa2c95bc02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff96cb6ebd0>]}
[0m07:46:13.812028 [info ] [MainThread]: 
[0m07:46:13.814500 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:46:13.821738 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m07:46:13.868022 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m07:46:13.869074 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m07:46:13.869787 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:46:13.875645 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.006 seconds
[0m07:46:13.877532 [debug] [ThreadPool]: On list_airflow: Close
[0m07:46:13.880189 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_staging)
[0m07:46:13.887277 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:46:13.888047 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m07:46:13.888768 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:46:13.893451 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:46:13.894184 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:46:13.894962 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m07:46:13.898613 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.003 seconds
[0m07:46:13.900578 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m07:46:13.901403 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m07:46:13.902586 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now list_airflow_lead_trusted)
[0m07:46:13.906044 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:46:13.906799 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m07:46:13.907463 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:46:13.911618 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m07:46:13.912408 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:46:13.913081 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m07:46:13.916238 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m07:46:13.918008 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m07:46:13.918932 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m07:46:13.926669 [debug] [MainThread]: Using postgres connection "master"
[0m07:46:13.927545 [debug] [MainThread]: On master: BEGIN
[0m07:46:13.928274 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:46:13.932897 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:46:13.933742 [debug] [MainThread]: Using postgres connection "master"
[0m07:46:13.934622 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:46:13.938438 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m07:46:13.940890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '060b4754-9438-4fda-8e86-b7fa2c95bc02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff96e058b30>]}
[0m07:46:13.941804 [debug] [MainThread]: On master: ROLLBACK
[0m07:46:13.942724 [debug] [MainThread]: Using postgres connection "master"
[0m07:46:13.943420 [debug] [MainThread]: On master: BEGIN
[0m07:46:13.944451 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:46:13.945103 [debug] [MainThread]: On master: COMMIT
[0m07:46:13.945779 [debug] [MainThread]: Using postgres connection "master"
[0m07:46:13.946466 [debug] [MainThread]: On master: COMMIT
[0m07:46:13.947355 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:46:13.948041 [debug] [MainThread]: On master: Close
[0m07:46:13.949196 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:46:13.949963 [info ] [MainThread]: 
[0m07:46:13.960448 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_adress
[0m07:46:13.961428 [info ] [Thread-1 (]: 1 of 5 START sql table model lead_staging.dim_address .......................... [RUN]
[0m07:46:13.962390 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now model.dbt_lead_data.staging_dim_adress)
[0m07:46:13.963108 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_adress
[0m07:46:13.973000 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_adress"
[0m07:46:13.975257 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_adress
[0m07:46:14.021451 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_adress"
[0m07:46:14.024356 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:46:14.025167 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: BEGIN
[0m07:46:14.025931 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:46:14.030539 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m07:46:14.031368 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:46:14.032036 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */

  
    

  create  table "airflow"."lead_staging"."dim_address__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        address,
        mac_address,
        ip_address
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:47:12.565090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89cb6acbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89cb6addf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89cb6accb0>]}


============================== 07:47:12.574510 | 9ab2398e-6e69-4c50-927c-4eab27f81f8e ==============================
[0m07:47:12.574510 [info ] [MainThread]: Running with dbt=1.8.0
[0m07:47:12.575528 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select tag:staging', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:47:12.952521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9ab2398e-6e69-4c50-927c-4eab27f81f8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89cbd96f60>]}
[0m07:47:13.018121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9ab2398e-6e69-4c50-927c-4eab27f81f8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89cb642810>]}
[0m07:47:13.019721 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:47:13.127859 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m07:47:13.317064 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:47:13.326101 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:47:13.376650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ab2398e-6e69-4c50-927c-4eab27f81f8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89ca19e8a0>]}
[0m07:47:13.535128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ab2398e-6e69-4c50-927c-4eab27f81f8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89ca19c860>]}
[0m07:47:13.536037 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m07:47:13.536893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ab2398e-6e69-4c50-927c-4eab27f81f8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89caa2b620>]}
[0m07:47:13.539752 [info ] [MainThread]: 
[0m07:47:13.541048 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:47:13.547738 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m07:47:13.600269 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m07:47:13.601351 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m07:47:13.602212 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:47:13.613097 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.011 seconds
[0m07:47:13.615359 [debug] [ThreadPool]: On list_airflow: Close
[0m07:47:13.618355 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_trusted)
[0m07:47:13.626154 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:47:13.627009 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m07:47:13.627652 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:47:13.632390 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:47:13.633381 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:47:13.634148 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m07:47:13.637477 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m07:47:13.639449 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m07:47:13.640403 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m07:47:13.641442 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now list_airflow_lead_staging)
[0m07:47:13.645106 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:47:13.645880 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m07:47:13.646733 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:47:13.651590 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:47:13.652628 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:47:13.653452 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m07:47:13.657250 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.003 seconds
[0m07:47:13.659579 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m07:47:13.660790 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m07:47:13.669335 [debug] [MainThread]: Using postgres connection "master"
[0m07:47:13.670255 [debug] [MainThread]: On master: BEGIN
[0m07:47:13.671097 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:47:13.676111 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:47:13.677042 [debug] [MainThread]: Using postgres connection "master"
[0m07:47:13.677875 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:47:13.681937 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m07:47:13.684091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ab2398e-6e69-4c50-927c-4eab27f81f8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89ca9a9d00>]}
[0m07:47:13.685019 [debug] [MainThread]: On master: ROLLBACK
[0m07:47:13.685998 [debug] [MainThread]: Using postgres connection "master"
[0m07:47:13.686662 [debug] [MainThread]: On master: BEGIN
[0m07:47:13.687884 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:47:13.688671 [debug] [MainThread]: On master: COMMIT
[0m07:47:13.689435 [debug] [MainThread]: Using postgres connection "master"
[0m07:47:13.690141 [debug] [MainThread]: On master: COMMIT
[0m07:47:13.691066 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:47:13.691934 [debug] [MainThread]: On master: Close
[0m07:47:13.693182 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:47:13.694083 [info ] [MainThread]: 
[0m07:47:13.705993 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_adress
[0m07:47:13.707140 [info ] [Thread-1 (]: 1 of 5 START sql table model lead_staging.dim_address .......................... [RUN]
[0m07:47:13.708160 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now model.dbt_lead_data.staging_dim_adress)
[0m07:47:13.709128 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_adress
[0m07:47:13.719320 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_adress"
[0m07:47:13.723139 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_adress
[0m07:47:13.772666 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_adress"
[0m07:47:13.775604 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:47:13.776537 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: BEGIN
[0m07:47:13.777337 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:47:13.782252 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m07:47:13.783150 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:47:13.783926 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */

  
    

  create  table "airflow"."lead_staging"."dim_address__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        address,
        mac_address,
        ip_address
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:47:17.284244 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 234.222 seconds
[0m07:47:17.284311 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 245.284 seconds
[0m07:47:17.289026 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:47:17.289154 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m07:47:17.290409 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
alter table "airflow"."lead_staging"."dim_address__dbt_tmp" rename to "dim_address"
[0m07:47:17.291004 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
alter table "airflow"."lead_staging"."fact_network_usage__dbt_tmp" rename to "fact_network_usage"
[0m07:47:17.292435 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:47:17.293235 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:47:17.296123 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: COMMIT
[0m07:47:17.296881 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m07:47:17.298180 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: COMMIT
[0m07:47:17.302854 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m07:47:17.306761 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."fact_network_usage__dbt_backup"
[0m07:47:17.308529 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m07:47:17.309464 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
drop table if exists "airflow"."lead_staging"."fact_network_usage__dbt_backup" cascade
[0m07:47:17.320966 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.010 seconds
[0m07:47:17.323275 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: Close
[0m07:47:17.324279 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m07:47:17.325021 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '394a17a8-97b3-4fe4-881b-8a085f530ed4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f854f90d3d0>]}
[0m07:47:17.325281 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:47:17.326743 [info ] [Thread-1 (]: 5 of 5 OK created sql table model lead_staging.fact_network_usage .............. [[32mSELECT 6103093[0m in 252.21s]
[0m07:47:17.327071 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m07:47:17.328804 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_fact_network_usage
[0m07:47:17.330996 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m07:47:17.332528 [debug] [MainThread]: Using postgres connection "master"
[0m07:47:17.333552 [debug] [MainThread]: On master: BEGIN
[0m07:47:17.334567 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:47:17.340739 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m07:47:17.341981 [debug] [MainThread]: On master: COMMIT
[0m07:47:17.342054 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_address__dbt_backup"
[0m07:47:17.343026 [debug] [MainThread]: Using postgres connection "master"
[0m07:47:17.344178 [debug] [MainThread]: On master: COMMIT
[0m07:47:17.345978 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:47:17.346987 [debug] [MainThread]: On master: Close
[0m07:47:17.348209 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:47:17.349200 [debug] [MainThread]: Connection 'model.dbt_lead_data.staging_fact_network_usage' was properly closed.
[0m07:47:17.350445 [info ] [MainThread]: 
[0m07:47:17.351459 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:47:17.351995 [info ] [MainThread]: Finished running 5 table models in 0 hours 5 minutes and 6.16 seconds (306.16s).
[0m07:47:17.352480 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
drop table if exists "airflow"."lead_staging"."dim_address__dbt_backup" cascade
[0m07:47:17.355482 [debug] [MainThread]: Command end result
[0m07:47:17.358603 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m07:47:17.362907 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: Close
[0m07:47:17.366052 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86aa8497-9baf-4ca4-8603-3abde472ba84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb25fc35b20>]}
[0m07:47:17.367783 [info ] [Thread-1 (]: 1 of 5 OK created sql table model lead_staging.dim_address ..................... [[32mSELECT 6321899[0m in 243.56s]
[0m07:47:17.369776 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_adress
[0m07:47:17.371302 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_date
[0m07:47:17.372703 [info ] [Thread-1 (]: 2 of 5 START sql table model lead_staging.dim_date ............................. [RUN]
[0m07:47:17.374460 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_adress, now model.dbt_lead_data.staging_dim_date)
[0m07:47:17.375955 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_date
[0m07:47:17.382537 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_date"
[0m07:47:17.388378 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_date
[0m07:47:17.396687 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_date"
[0m07:47:17.401445 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m07:47:17.403251 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: BEGIN
[0m07:47:17.404269 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:47:17.412471 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m07:47:17.413976 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m07:47:17.415151 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */

  
    

  create  table "airflow"."lead_staging"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        accessed_at
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:47:17.457288 [info ] [MainThread]: 
[0m07:47:17.458949 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:47:17.460175 [info ] [MainThread]: 
[0m07:47:17.461746 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m07:47:17.469480 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 307.15244, "process_user_time": 3.404902, "process_kernel_time": 0.241911, "process_mem_max_rss": "119820", "process_in_blocks": "256", "process_out_blocks": "0"}
[0m07:47:17.471443 [debug] [MainThread]: Command `dbt run` succeeded at 07:47:17.471145 after 307.16 seconds
[0m07:47:17.472604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f855337d220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f855210a780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85509a74d0>]}
[0m07:47:17.474037 [debug] [MainThread]: Flushing usage events
[0m07:47:17.510567 [debug] [Thread-1 (]: Postgres adapter: Postgres error: could not extend file "base/16384/18122.9": No space left on device
HINT:  Check free disk space.

[0m07:47:17.563255 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: ROLLBACK
[0m07:47:17.564601 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: Close
[0m07:47:17.599446 [debug] [Thread-1 (]: Database Error in model trusted_non_pii_data (models/trusted_non_pii_data.sql)
  could not extend file "base/16384/18122.9": No space left on device
  HINT:  Check free disk space.
  compiled code at target/run/dbt_lead_data/models/trusted_non_pii_data.sql
[0m07:47:17.602568 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '040c1265-370b-4563-850a-c358b1561eca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff115d634a0>]}
[0m07:47:17.604223 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model lead_trusted.non_pii_data ................ [[31mERROR[0m in 246.83s]
[0m07:47:17.606427 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_non_pii_data
[0m07:47:17.607533 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_payment_data
[0m07:47:17.609367 [info ] [Thread-1 (]: 2 of 4 START sql table model lead_trusted.payment_data ......................... [RUN]
[0m07:47:17.610561 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_non_pii_data, now model.dbt_lead_data.trusted_payment_data)
[0m07:47:17.611625 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_payment_data
[0m07:47:17.616986 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_payment_data"
[0m07:47:17.620183 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_payment_data
[0m07:47:17.625186 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_payment_data"
[0m07:47:17.627859 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m07:47:17.628927 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: BEGIN
[0m07:47:17.630060 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:47:17.636335 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m07:47:17.670835 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m07:47:17.672240 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */

  
    

  create  table "airflow"."lead_trusted"."payment_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        fnu.unique_id,
        df.iban,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.session_duration,
        fnu.consumed_traffic,
        ((fnu.download_speed + fnu.upload_speed + 1)/2) + (fnu.consumed_traffic / (fnu.session_duration + 1)) AS payment_amount
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    JOIN
        "airflow"."lead_staging"."dim_finance" df
    ON
	    fnu.unique_id = df.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:47:31.842972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff112e1c830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff10fee88c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff10fc391c0>]}


============================== 07:47:31.852963 | b8da7a7f-a5ad-48be-bb82-6b24c42365c4 ==============================
[0m07:47:31.852963 [info ] [MainThread]: Running with dbt=1.8.0
[0m07:47:31.854289 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select tag:trusted', 'send_anonymous_usage_stats': 'True'}
[0m07:47:32.223421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b8da7a7f-a5ad-48be-bb82-6b24c42365c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff10fe7ca70>]}
[0m07:47:32.309429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b8da7a7f-a5ad-48be-bb82-6b24c42365c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff110416b40>]}
[0m07:47:32.311496 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:47:32.449155 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m07:47:32.673590 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:47:32.674363 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:47:32.719751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b8da7a7f-a5ad-48be-bb82-6b24c42365c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff10efb1130>]}
[0m07:47:32.914909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b8da7a7f-a5ad-48be-bb82-6b24c42365c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff10e378980>]}
[0m07:47:32.915898 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m07:47:32.916610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8da7a7f-a5ad-48be-bb82-6b24c42365c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff10e3739e0>]}
[0m07:47:32.919186 [info ] [MainThread]: 
[0m07:47:32.920175 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:47:32.925918 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m07:47:32.979598 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m07:47:32.980474 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m07:47:32.981164 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:47:32.993480 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.012 seconds
[0m07:47:32.995689 [debug] [ThreadPool]: On list_airflow: Close
[0m07:47:33.000275 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_staging)
[0m07:47:33.010432 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:47:33.011546 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m07:47:33.012675 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:47:33.018421 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m07:47:33.019395 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:47:33.020230 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m07:47:33.024531 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.003 seconds
[0m07:47:33.026930 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m07:47:33.028275 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m07:47:33.029992 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now list_airflow_lead_trusted)
[0m07:47:33.035054 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:47:33.035921 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m07:47:33.036909 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:47:33.042764 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m07:47:33.044026 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:47:33.044919 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m07:47:33.048792 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m07:47:33.051210 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m07:47:33.052355 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m07:47:33.060656 [debug] [MainThread]: Using postgres connection "master"
[0m07:47:33.061605 [debug] [MainThread]: On master: BEGIN
[0m07:47:33.062458 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:47:33.068059 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:47:33.069028 [debug] [MainThread]: Using postgres connection "master"
[0m07:47:33.070053 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:47:33.074957 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m07:47:33.077246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8da7a7f-a5ad-48be-bb82-6b24c42365c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff10ef7bda0>]}
[0m07:47:33.078373 [debug] [MainThread]: On master: ROLLBACK
[0m07:47:33.080105 [debug] [MainThread]: Using postgres connection "master"
[0m07:47:33.081028 [debug] [MainThread]: On master: BEGIN
[0m07:47:33.082554 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m07:47:33.083718 [debug] [MainThread]: On master: COMMIT
[0m07:47:33.084756 [debug] [MainThread]: Using postgres connection "master"
[0m07:47:33.085739 [debug] [MainThread]: On master: COMMIT
[0m07:47:33.087167 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:47:33.088110 [debug] [MainThread]: On master: Close
[0m07:47:33.089233 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:47:33.090443 [info ] [MainThread]: 
[0m07:47:33.103693 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_non_pii_data
[0m07:47:33.105061 [info ] [Thread-1 (]: 1 of 4 START sql table model lead_trusted.non_pii_data ......................... [RUN]
[0m07:47:33.106433 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now model.dbt_lead_data.trusted_non_pii_data)
[0m07:47:33.107604 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_non_pii_data
[0m07:47:33.119745 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_non_pii_data"
[0m07:47:33.123172 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_non_pii_data
[0m07:47:33.196269 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_non_pii_data"
[0m07:47:33.198536 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m07:47:33.199474 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: BEGIN
[0m07:47:33.200228 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:47:33.205235 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m07:47:33.206096 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m07:47:33.206803 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */

  
    

  create  table "airflow"."lead_trusted"."non_pii_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        '***MASKED***' AS person_name,
        SUBSTRING(dp.user_name, 1, 5) || '*****'  user_name,
        SUBSTRING(dp.email, 1, 5) || '*****' AS email,
        '***MASKED***'  AS personal_number, 
        '***MASKED***' AS birth_date, 
        '***MASKED***' AS address,
        '***MASKED***'  AS phone, 
        SUBSTRING(da.mac_address, 1, 5) || '*****' AS mac_address,
        SUBSTRING(da.ip_address, 1, 5) || '*****' AS ip_address,
        SUBSTRING(df.iban, 1, 5) || '*****' AS iban,
        dd.accessed_at,
        fnu.session_duration,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.consumed_traffic,
        fnu.unique_id
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    INNER JOIN
        "airflow"."lead_staging"."dim_address" da ON fnu.unique_id = da.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_date" dd ON da.unique_id = dd.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_finance" df ON dd.unique_id = df.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_person" dp ON df.unique_id = dp.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:47:59.880292 [debug] [Thread-1 (]: SQL status: SELECT 7644653 in 42.460 seconds
[0m07:47:59.885853 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m07:47:59.886738 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
alter table "airflow"."lead_staging"."dim_date" rename to "dim_date__dbt_backup"
[0m07:48:00.213336 [debug] [Thread-1 (]: SQL status: SELECT 9086605 in 42.537 seconds
[0m07:48:00.224510 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m07:48:00.225410 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
alter table "airflow"."lead_trusted"."payment_data" rename to "payment_data__dbt_backup"
[0m07:48:00.227063 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:48:00.231604 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m07:48:00.232763 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
alter table "airflow"."lead_trusted"."payment_data__dbt_tmp" rename to "payment_data"
[0m07:48:00.234467 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:48:00.274559 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: COMMIT
[0m07:48:00.275639 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m07:48:00.276969 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: COMMIT
[0m07:48:00.352523 [debug] [Thread-1 (]: SQL status: COMMIT in 0.075 seconds
[0m07:48:00.360430 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."payment_data__dbt_backup"
[0m07:48:00.368369 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m07:48:00.369219 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
drop table if exists "airflow"."lead_trusted"."payment_data__dbt_backup" cascade
[0m07:48:00.385809 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.016 seconds
[0m07:48:00.389573 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: Close
[0m07:48:00.390810 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '040c1265-370b-4563-850a-c358b1561eca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff117eca030>]}
[0m07:48:00.392124 [info ] [Thread-1 (]: 2 of 4 OK created sql table model lead_trusted.payment_data .................... [[32mSELECT 9086605[0m in 42.78s]
[0m07:48:00.393236 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_payment_data
[0m07:48:00.394366 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_pii_data
[0m07:48:00.395527 [info ] [Thread-1 (]: 3 of 4 START sql table model lead_trusted.pii_data ............................. [RUN]
[0m07:48:00.396586 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_payment_data, now model.dbt_lead_data.trusted_pii_data)
[0m07:48:00.397544 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_pii_data
[0m07:48:00.404334 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_pii_data"
[0m07:48:00.407178 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_pii_data
[0m07:48:00.411463 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_pii_data"
[0m07:48:00.414006 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m07:48:00.414721 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: BEGIN
[0m07:48:00.415522 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:48:00.420755 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m07:48:00.421720 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m07:48:00.422597 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */

  
    

  create  table "airflow"."lead_trusted"."pii_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        dp.person_name,
        dp.user_name,
        dp.email,
        dp.personal_number, 
        dp.birth_date, 
        da.address,
        dp.phone, 
        da.mac_address,
        da.ip_address,
        df.iban,
        dd.accessed_at,
        fnu.session_duration,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.consumed_traffic,
        fnu.unique_id
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    INNER JOIN
        "airflow"."lead_staging"."dim_address" da ON fnu.unique_id = da.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_date" dd ON da.unique_id = dd.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_finance" df ON dd.unique_id = df.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_person" dp ON df.unique_id = dp.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:48:00.657203 [debug] [Thread-1 (]: SQL status: SELECT 7422497 in 106.622 seconds
[0m07:48:00.667416 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:48:00.668794 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
alter table "airflow"."lead_staging"."dim_address" rename to "dim_address__dbt_backup"
[0m07:48:18.227047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4eff0dd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4f077a030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4f077ae40>]}


============================== 07:48:18.235731 | 6f8c5955-ec02-4818-af62-fd501fd13748 ==============================
[0m07:48:18.235731 [info ] [MainThread]: Running with dbt=1.8.0
[0m07:48:18.236850 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select tag:staging', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:48:18.558796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6f8c5955-ec02-4818-af62-fd501fd13748', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4f0e06fc0>]}
[0m07:48:18.642290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6f8c5955-ec02-4818-af62-fd501fd13748', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4ef341490>]}
[0m07:48:18.643891 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:48:18.759436 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m07:48:18.941084 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:48:18.941955 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:48:18.991982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6f8c5955-ec02-4818-af62-fd501fd13748', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4eef385c0>]}
[0m07:48:19.198954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6f8c5955-ec02-4818-af62-fd501fd13748', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4ee324bf0>]}
[0m07:48:19.200184 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m07:48:19.201791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f8c5955-ec02-4818-af62-fd501fd13748', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4eef39250>]}
[0m07:48:19.206031 [info ] [MainThread]: 
[0m07:48:19.208298 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:48:19.218029 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m07:48:19.297383 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m07:48:19.298964 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m07:48:19.300462 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:48:19.319814 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.019 seconds
[0m07:48:19.323005 [debug] [ThreadPool]: On list_airflow: Close
[0m07:48:19.328529 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_trusted)
[0m07:48:19.340424 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:48:19.341897 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m07:48:19.343303 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:48:19.350961 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m07:48:19.352183 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:48:19.353751 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m07:48:19.359513 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m07:48:19.363296 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m07:48:19.365468 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m07:48:19.367825 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now list_airflow_lead_staging)
[0m07:48:19.374152 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:48:19.375442 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m07:48:19.376870 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:48:19.384903 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m07:48:19.386105 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:48:19.387109 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m07:48:19.391518 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.003 seconds
[0m07:48:19.394400 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m07:48:19.396187 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m07:48:19.406774 [debug] [MainThread]: Using postgres connection "master"
[0m07:48:19.407900 [debug] [MainThread]: On master: BEGIN
[0m07:48:19.409094 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:48:19.415300 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m07:48:19.416803 [debug] [MainThread]: Using postgres connection "master"
[0m07:48:19.417950 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:48:19.422328 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m07:48:19.424724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f8c5955-ec02-4818-af62-fd501fd13748', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4ecf9c560>]}
[0m07:48:19.425879 [debug] [MainThread]: On master: ROLLBACK
[0m07:48:19.427054 [debug] [MainThread]: Using postgres connection "master"
[0m07:48:19.427901 [debug] [MainThread]: On master: BEGIN
[0m07:48:19.429379 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:48:19.430215 [debug] [MainThread]: On master: COMMIT
[0m07:48:19.431080 [debug] [MainThread]: Using postgres connection "master"
[0m07:48:19.431910 [debug] [MainThread]: On master: COMMIT
[0m07:48:19.433213 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:48:19.434081 [debug] [MainThread]: On master: Close
[0m07:48:19.435084 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:48:19.436148 [info ] [MainThread]: 
[0m07:48:19.448535 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_adress
[0m07:48:19.449876 [info ] [Thread-1 (]: 1 of 5 START sql table model lead_staging.dim_address .......................... [RUN]
[0m07:48:19.450996 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now model.dbt_lead_data.staging_dim_adress)
[0m07:48:19.451929 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_adress
[0m07:48:19.462381 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_adress"
[0m07:48:19.465897 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_adress
[0m07:48:19.521181 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_adress"
[0m07:48:19.524987 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:48:19.526890 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: BEGIN
[0m07:48:19.528145 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:48:19.536540 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m07:48:19.538905 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:48:19.539792 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */

  
    

  create  table "airflow"."lead_staging"."dim_address__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        address,
        mac_address,
        ip_address
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:49:15.293092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43b4740470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43b447e030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43b4ca09e0>]}


============================== 07:49:15.301339 | 963753f6-f12c-4fa9-a4b1-7f0efe59b579 ==============================
[0m07:49:15.301339 [info ] [MainThread]: Running with dbt=1.8.0
[0m07:49:15.302328 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select tag:staging', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:49:15.741204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '963753f6-f12c-4fa9-a4b1-7f0efe59b579', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43b538d1c0>]}
[0m07:49:15.811185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '963753f6-f12c-4fa9-a4b1-7f0efe59b579', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43b4bfe270>]}
[0m07:49:15.812948 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:49:15.933121 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m07:49:16.171606 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:49:16.172534 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:49:16.215049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '963753f6-f12c-4fa9-a4b1-7f0efe59b579', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43b3790ef0>]}
[0m07:49:16.368373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '963753f6-f12c-4fa9-a4b1-7f0efe59b579', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43b2b78dd0>]}
[0m07:49:16.369374 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m07:49:16.370197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '963753f6-f12c-4fa9-a4b1-7f0efe59b579', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43b33bfe30>]}
[0m07:49:16.372817 [info ] [MainThread]: 
[0m07:49:16.374091 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:49:16.380645 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m07:49:16.439455 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m07:49:16.440423 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m07:49:16.441114 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:49:16.450143 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.009 seconds
[0m07:49:16.452230 [debug] [ThreadPool]: On list_airflow: Close
[0m07:49:16.455249 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_staging)
[0m07:49:16.463137 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:49:16.464236 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m07:49:16.465227 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:49:16.470613 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:49:16.471746 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:49:16.476865 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m07:49:16.485010 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.005 seconds
[0m07:49:16.488008 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m07:49:16.489246 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m07:49:16.490487 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now list_airflow_lead_trusted)
[0m07:49:16.494682 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:49:16.495461 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m07:49:16.496513 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:49:16.501752 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:49:16.502639 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:49:16.503485 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m07:49:16.507386 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m07:49:16.509418 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m07:49:16.510208 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m07:49:16.518226 [debug] [MainThread]: Using postgres connection "master"
[0m07:49:16.519090 [debug] [MainThread]: On master: BEGIN
[0m07:49:16.519902 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:49:16.524588 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m07:49:16.525557 [debug] [MainThread]: Using postgres connection "master"
[0m07:49:16.526564 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:49:16.530611 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m07:49:16.532914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '963753f6-f12c-4fa9-a4b1-7f0efe59b579', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43b3701ac0>]}
[0m07:49:16.533978 [debug] [MainThread]: On master: ROLLBACK
[0m07:49:16.535002 [debug] [MainThread]: Using postgres connection "master"
[0m07:49:16.535776 [debug] [MainThread]: On master: BEGIN
[0m07:49:16.536926 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:49:16.537736 [debug] [MainThread]: On master: COMMIT
[0m07:49:16.538471 [debug] [MainThread]: Using postgres connection "master"
[0m07:49:16.539155 [debug] [MainThread]: On master: COMMIT
[0m07:49:16.540074 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:49:16.540981 [debug] [MainThread]: On master: Close
[0m07:49:16.541929 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:49:16.542911 [info ] [MainThread]: 
[0m07:49:16.554231 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_adress
[0m07:49:16.555465 [info ] [Thread-1 (]: 1 of 5 START sql table model lead_staging.dim_address .......................... [RUN]
[0m07:49:16.556469 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now model.dbt_lead_data.staging_dim_adress)
[0m07:49:16.557147 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_adress
[0m07:49:16.566957 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_adress"
[0m07:49:16.569573 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_adress
[0m07:49:16.618015 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_adress"
[0m07:49:16.621798 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:49:16.622948 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: BEGIN
[0m07:49:16.623857 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:49:16.629669 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m07:49:16.630627 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:49:16.631767 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */

  
    

  create  table "airflow"."lead_staging"."dim_address__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        address,
        mac_address,
        ip_address
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:50:13.795417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0aa2aacf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0aae08e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0aa2233b0>]}


============================== 07:50:13.805675 | a1cc40f1-c9a3-48e4-967d-bf00857f9d78 ==============================
[0m07:50:13.805675 [info ] [MainThread]: Running with dbt=1.8.0
[0m07:50:13.806635 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select tag:staging', 'send_anonymous_usage_stats': 'True'}
[0m07:50:14.190714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a1cc40f1-c9a3-48e4-967d-bf00857f9d78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0ab17af00>]}
[0m07:50:14.270860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a1cc40f1-c9a3-48e4-967d-bf00857f9d78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0aae79e50>]}
[0m07:50:14.273210 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:50:14.410306 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m07:50:14.601296 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:50:14.602275 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:50:14.647539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a1cc40f1-c9a3-48e4-967d-bf00857f9d78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0a9575e80>]}
[0m07:50:14.816644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a1cc40f1-c9a3-48e4-967d-bf00857f9d78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0a8978aa0>]}
[0m07:50:14.817631 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m07:50:14.818515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1cc40f1-c9a3-48e4-967d-bf00857f9d78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0a9574d70>]}
[0m07:50:14.821175 [info ] [MainThread]: 
[0m07:50:14.822257 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:50:14.828254 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m07:50:14.888243 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m07:50:14.889285 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m07:50:14.890195 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:50:14.903059 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.012 seconds
[0m07:50:14.905048 [debug] [ThreadPool]: On list_airflow: Close
[0m07:50:14.907889 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_staging)
[0m07:50:14.915179 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:50:14.915951 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m07:50:14.916582 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:50:14.921114 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m07:50:14.922075 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:50:14.923011 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m07:50:14.927875 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.004 seconds
[0m07:50:14.929924 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m07:50:14.930815 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m07:50:14.931735 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now list_airflow_lead_trusted)
[0m07:50:14.935903 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:50:14.936605 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m07:50:14.937388 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:50:14.942130 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:50:14.943046 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:50:14.944120 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m07:50:14.947821 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m07:50:14.952874 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m07:50:14.955523 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m07:50:14.964830 [debug] [MainThread]: Using postgres connection "master"
[0m07:50:14.965933 [debug] [MainThread]: On master: BEGIN
[0m07:50:14.966846 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:50:14.972953 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m07:50:14.973823 [debug] [MainThread]: Using postgres connection "master"
[0m07:50:14.974650 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:50:14.980203 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m07:50:14.982312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1cc40f1-c9a3-48e4-967d-bf00857f9d78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0ab838da0>]}
[0m07:50:14.983236 [debug] [MainThread]: On master: ROLLBACK
[0m07:50:14.984209 [debug] [MainThread]: Using postgres connection "master"
[0m07:50:14.985003 [debug] [MainThread]: On master: BEGIN
[0m07:50:14.986182 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:50:14.986860 [debug] [MainThread]: On master: COMMIT
[0m07:50:14.987565 [debug] [MainThread]: Using postgres connection "master"
[0m07:50:14.988348 [debug] [MainThread]: On master: COMMIT
[0m07:50:14.989324 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:50:14.990188 [debug] [MainThread]: On master: Close
[0m07:50:14.991219 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:50:14.992113 [info ] [MainThread]: 
[0m07:50:15.004297 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_adress
[0m07:50:15.005359 [info ] [Thread-1 (]: 1 of 5 START sql table model lead_staging.dim_address .......................... [RUN]
[0m07:50:15.006310 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now model.dbt_lead_data.staging_dim_adress)
[0m07:50:15.007186 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_adress
[0m07:50:15.016584 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_adress"
[0m07:50:15.020359 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_adress
[0m07:50:15.069291 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_adress"
[0m07:50:15.072642 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:50:15.073974 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: BEGIN
[0m07:50:15.074795 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:50:15.079603 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m07:50:15.080524 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:50:15.081379 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */

  
    

  create  table "airflow"."lead_staging"."dim_address__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        address,
        mac_address,
        ip_address
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:50:22.649091 [debug] [Thread-1 (]: Postgres adapter: Postgres error: could not extend file "base/16384/18162.6": No space left on device
HINT:  Check free disk space.

[0m07:50:22.662644 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: ROLLBACK
[0m07:50:22.664147 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: Close
[0m07:50:22.702971 [debug] [Thread-1 (]: Database Error in model trusted_non_pii_data (models/trusted_non_pii_data.sql)
  could not extend file "base/16384/18162.6": No space left on device
  HINT:  Check free disk space.
  compiled code at target/run/dbt_lead_data/models/trusted_non_pii_data.sql
[0m07:50:22.705054 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ab1c331-3839-4b57-ad78-9a8b30160e90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45bd879340>]}
[0m07:50:22.707883 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model lead_trusted.non_pii_data ................ [[31mERROR[0m in 349.61s]
[0m07:50:22.709098 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_non_pii_data
[0m07:50:22.710014 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_payment_data
[0m07:50:22.711939 [info ] [Thread-1 (]: 2 of 4 START sql table model lead_trusted.payment_data ......................... [RUN]
[0m07:50:22.712931 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_non_pii_data, now model.dbt_lead_data.trusted_payment_data)
[0m07:50:22.714632 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_payment_data
[0m07:50:22.751985 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_payment_data"
[0m07:50:22.754702 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_payment_data
[0m07:50:22.759271 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_payment_data"
[0m07:50:22.761499 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m07:50:22.762250 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: BEGIN
[0m07:50:22.762884 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:50:22.768841 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m07:50:22.769846 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m07:50:22.770869 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */

  
    

  create  table "airflow"."lead_trusted"."payment_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        fnu.unique_id,
        df.iban,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.session_duration,
        fnu.consumed_traffic,
        ((fnu.download_speed + fnu.upload_speed + 1)/2) + (fnu.consumed_traffic / (fnu.session_duration + 1)) AS payment_amount
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    JOIN
        "airflow"."lead_staging"."dim_finance" df
    ON
	    fnu.unique_id = df.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:50:51.291220 [debug] [Thread-1 (]: SQL status: SELECT 9086605 in 28.518 seconds
[0m07:50:51.300655 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m07:50:51.301629 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
alter table "airflow"."lead_trusted"."payment_data" rename to "payment_data__dbt_backup"
[0m07:50:51.304270 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m07:50:51.308475 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m07:50:51.309485 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
alter table "airflow"."lead_trusted"."payment_data__dbt_tmp" rename to "payment_data"
[0m07:50:51.311019 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:50:51.339888 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: COMMIT
[0m07:50:51.340997 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m07:50:51.341783 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: COMMIT
[0m07:50:51.345978 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m07:50:51.355975 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."payment_data__dbt_backup"
[0m07:50:51.365210 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m07:50:51.366182 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
drop table if exists "airflow"."lead_trusted"."payment_data__dbt_backup" cascade
[0m07:50:51.399270 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.032 seconds
[0m07:50:51.403341 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: Close
[0m07:50:51.404755 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ab1c331-3839-4b57-ad78-9a8b30160e90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45be535b50>]}
[0m07:50:51.406155 [info ] [Thread-1 (]: 2 of 4 OK created sql table model lead_trusted.payment_data .................... [[32mSELECT 9086605[0m in 28.69s]
[0m07:50:51.407472 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_payment_data
[0m07:50:51.408542 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_pii_data
[0m07:50:51.410043 [info ] [Thread-1 (]: 3 of 4 START sql table model lead_trusted.pii_data ............................. [RUN]
[0m07:50:51.411603 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_payment_data, now model.dbt_lead_data.trusted_pii_data)
[0m07:50:51.413280 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_pii_data
[0m07:50:51.423815 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_pii_data"
[0m07:50:51.428689 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_pii_data
[0m07:50:51.436323 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_pii_data"
[0m07:50:51.440436 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m07:50:51.442036 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: BEGIN
[0m07:50:51.443544 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:50:51.452115 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m07:50:51.453664 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m07:50:51.455341 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */

  
    

  create  table "airflow"."lead_trusted"."pii_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        dp.person_name,
        dp.user_name,
        dp.email,
        dp.personal_number, 
        dp.birth_date, 
        da.address,
        dp.phone, 
        da.mac_address,
        da.ip_address,
        df.iban,
        dd.accessed_at,
        fnu.session_duration,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.consumed_traffic,
        fnu.unique_id
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    INNER JOIN
        "airflow"."lead_staging"."dim_address" da ON fnu.unique_id = da.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_date" dd ON da.unique_id = dd.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_finance" df ON dd.unique_id = df.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_person" dp ON df.unique_id = dp.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m07:51:15.358593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4a512bfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4a3066300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4a33d6840>]}


============================== 07:51:15.367639 | e7197e31-76c3-47b4-80a9-3d29d5be1a61 ==============================
[0m07:51:15.367639 [info ] [MainThread]: Running with dbt=1.8.0
[0m07:51:15.368632 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select tag:staging', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:51:15.739453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7197e31-76c3-47b4-80a9-3d29d5be1a61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4a3245f10>]}
[0m07:51:15.829338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e7197e31-76c3-47b4-80a9-3d29d5be1a61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4a24fd5e0>]}
[0m07:51:15.830907 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:51:15.968450 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m07:51:16.167095 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:51:16.167969 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:51:16.210571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7197e31-76c3-47b4-80a9-3d29d5be1a61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4a1da9580>]}
[0m07:51:16.374448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7197e31-76c3-47b4-80a9-3d29d5be1a61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4a199a6c0>]}
[0m07:51:16.375638 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m07:51:16.376574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7197e31-76c3-47b4-80a9-3d29d5be1a61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4a1da9b50>]}
[0m07:51:16.379348 [info ] [MainThread]: 
[0m07:51:16.380616 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:51:16.388071 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m07:51:16.460371 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m07:51:16.461390 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m07:51:16.462330 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:51:16.482312 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.020 seconds
[0m07:51:16.484337 [debug] [ThreadPool]: On list_airflow: Close
[0m07:51:16.490222 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_trusted)
[0m07:51:16.499118 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:51:16.500004 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m07:51:16.500814 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:51:16.505686 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:51:16.506709 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m07:51:16.507692 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m07:51:16.513842 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m07:51:16.516112 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m07:51:16.517361 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m07:51:16.518647 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now list_airflow_lead_staging)
[0m07:51:16.522797 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:51:16.523654 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m07:51:16.524463 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:51:16.529560 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m07:51:16.530343 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m07:51:16.531045 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m07:51:16.534672 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.003 seconds
[0m07:51:16.537004 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m07:51:16.538141 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m07:51:16.546448 [debug] [MainThread]: Using postgres connection "master"
[0m07:51:16.547288 [debug] [MainThread]: On master: BEGIN
[0m07:51:16.548015 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:51:16.553666 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m07:51:16.554720 [debug] [MainThread]: Using postgres connection "master"
[0m07:51:16.555694 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:51:16.561710 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m07:51:16.564102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7197e31-76c3-47b4-80a9-3d29d5be1a61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4a3e993a0>]}
[0m07:51:16.565214 [debug] [MainThread]: On master: ROLLBACK
[0m07:51:16.566531 [debug] [MainThread]: Using postgres connection "master"
[0m07:51:16.567404 [debug] [MainThread]: On master: BEGIN
[0m07:51:16.568762 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m07:51:16.569705 [debug] [MainThread]: On master: COMMIT
[0m07:51:16.570607 [debug] [MainThread]: Using postgres connection "master"
[0m07:51:16.571381 [debug] [MainThread]: On master: COMMIT
[0m07:51:16.572521 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:51:16.573429 [debug] [MainThread]: On master: Close
[0m07:51:16.574654 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:51:16.575643 [info ] [MainThread]: 
[0m07:51:16.587329 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_adress
[0m07:51:16.588427 [info ] [Thread-1 (]: 1 of 5 START sql table model lead_staging.dim_address .......................... [RUN]
[0m07:51:16.589466 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now model.dbt_lead_data.staging_dim_adress)
[0m07:51:16.590338 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_adress
[0m07:51:16.600182 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_adress"
[0m07:51:16.603834 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_adress
[0m07:51:16.652003 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_adress"
[0m07:51:16.656745 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:51:16.657647 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: BEGIN
[0m07:51:16.658473 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:51:16.663666 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m07:51:16.664667 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m07:51:16.665544 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */

  
    

  create  table "airflow"."lead_staging"."dim_address__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        address,
        mac_address,
        ip_address
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m08:03:14.643956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49bebe39e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49bebdd3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49bc46ff20>]}


============================== 08:03:14.667487 | bcde4a6a-0d03-484b-bd82-3053a4198b1f ==============================
[0m08:03:14.667487 [info ] [MainThread]: Running with dbt=1.8.0
[0m08:03:14.668431 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select tag:staging', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:03:14.902189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bcde4a6a-0d03-484b-bd82-3053a4198b1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49bc091e80>]}
[0m08:03:14.961394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bcde4a6a-0d03-484b-bd82-3053a4198b1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49bc483f80>]}
[0m08:03:14.963083 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:03:15.058328 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m08:03:15.219917 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:03:15.220829 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:03:15.262249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bcde4a6a-0d03-484b-bd82-3053a4198b1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49bbe4f5c0>]}
[0m08:03:15.394589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bcde4a6a-0d03-484b-bd82-3053a4198b1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49bbe6b890>]}
[0m08:03:15.395426 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m08:03:15.396163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bcde4a6a-0d03-484b-bd82-3053a4198b1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49bc2ccf20>]}
[0m08:03:15.398661 [info ] [MainThread]: 
[0m08:03:15.399645 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:03:15.405438 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m08:03:15.448379 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m08:03:15.449224 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m08:03:15.449952 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:03:15.455828 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.006 seconds
[0m08:03:15.457727 [debug] [ThreadPool]: On list_airflow: Close
[0m08:03:15.459124 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now create_airflow_lead_staging)
[0m08:03:15.459920 [debug] [ThreadPool]: Creating schema "database: "airflow"
schema: "lead_staging"
"
[0m08:03:15.465767 [debug] [ThreadPool]: Using postgres connection "create_airflow_lead_staging"
[0m08:03:15.466634 [debug] [ThreadPool]: On create_airflow_lead_staging: BEGIN
[0m08:03:15.467369 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:03:15.471523 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m08:03:15.472190 [debug] [ThreadPool]: Using postgres connection "create_airflow_lead_staging"
[0m08:03:15.472783 [debug] [ThreadPool]: On create_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "create_airflow_lead_staging"} */
create schema if not exists "lead_staging"
[0m08:03:15.473789 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m08:03:15.475075 [debug] [ThreadPool]: On create_airflow_lead_staging: COMMIT
[0m08:03:15.475839 [debug] [ThreadPool]: Using postgres connection "create_airflow_lead_staging"
[0m08:03:15.476505 [debug] [ThreadPool]: On create_airflow_lead_staging: COMMIT
[0m08:03:15.477680 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m08:03:15.478298 [debug] [ThreadPool]: On create_airflow_lead_staging: Close
[0m08:03:15.480628 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_airflow_lead_staging, now list_airflow_lead_trusted)
[0m08:03:15.487072 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m08:03:15.487775 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m08:03:15.488418 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:03:15.492557 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m08:03:15.493254 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m08:03:15.493899 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m08:03:15.497122 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m08:03:15.498779 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m08:03:15.499624 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m08:03:15.500570 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now list_airflow_lead_staging)
[0m08:03:15.503115 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m08:03:15.503816 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m08:03:15.504480 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:03:15.508514 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m08:03:15.509206 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m08:03:15.509857 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m08:03:15.512888 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m08:03:15.514505 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m08:03:15.515313 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m08:03:15.521493 [debug] [MainThread]: Using postgres connection "master"
[0m08:03:15.522287 [debug] [MainThread]: On master: BEGIN
[0m08:03:15.522980 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:03:15.527301 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m08:03:15.527975 [debug] [MainThread]: Using postgres connection "master"
[0m08:03:15.528693 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:03:15.532255 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m08:03:15.534121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bcde4a6a-0d03-484b-bd82-3053a4198b1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49bb1baf00>]}
[0m08:03:15.534998 [debug] [MainThread]: On master: ROLLBACK
[0m08:03:15.535984 [debug] [MainThread]: Using postgres connection "master"
[0m08:03:15.536763 [debug] [MainThread]: On master: BEGIN
[0m08:03:15.537758 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:03:15.538493 [debug] [MainThread]: On master: COMMIT
[0m08:03:15.539161 [debug] [MainThread]: Using postgres connection "master"
[0m08:03:15.539783 [debug] [MainThread]: On master: COMMIT
[0m08:03:15.540599 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:03:15.541267 [debug] [MainThread]: On master: Close
[0m08:03:15.542177 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:03:15.542914 [info ] [MainThread]: 
[0m08:03:15.552724 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_adress
[0m08:03:15.553878 [info ] [Thread-1 (]: 1 of 5 START sql table model lead_staging.dim_address .......................... [RUN]
[0m08:03:15.554824 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now model.dbt_lead_data.staging_dim_adress)
[0m08:03:15.555550 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_adress
[0m08:03:15.563990 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_adress"
[0m08:03:15.567502 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_adress
[0m08:03:15.609112 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_adress"
[0m08:03:15.612079 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m08:03:15.612689 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: BEGIN
[0m08:03:15.613283 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:03:15.625336 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m08:03:15.626745 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m08:03:15.627742 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */

  
    

  create  table "airflow"."lead_staging"."dim_address__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        address,
        mac_address,
        ip_address
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m08:03:15.926738 [debug] [Thread-1 (]: SQL status: SELECT 227459 in 0.298 seconds
[0m08:03:15.936030 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m08:03:15.937233 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
alter table "airflow"."lead_staging"."dim_address__dbt_tmp" rename to "dim_address"
[0m08:03:15.938759 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m08:03:15.964214 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m08:03:15.965350 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m08:03:15.966360 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m08:03:15.972570 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m08:03:15.981590 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_address__dbt_backup"
[0m08:03:15.989879 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m08:03:15.990922 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
drop table if exists "airflow"."lead_staging"."dim_address__dbt_backup" cascade
[0m08:03:15.992334 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m08:03:15.995881 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: Close
[0m08:03:15.998099 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcde4a6a-0d03-484b-bd82-3053a4198b1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49bd92abd0>]}
[0m08:03:15.999461 [info ] [Thread-1 (]: 1 of 5 OK created sql table model lead_staging.dim_address ..................... [[32mSELECT 227459[0m in 0.44s]
[0m08:03:16.000826 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_adress
[0m08:03:16.001907 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_date
[0m08:03:16.003345 [info ] [Thread-1 (]: 2 of 5 START sql table model lead_staging.dim_date ............................. [RUN]
[0m08:03:16.004484 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_adress, now model.dbt_lead_data.staging_dim_date)
[0m08:03:16.005370 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_date
[0m08:03:16.009974 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_date"
[0m08:03:16.012953 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_date
[0m08:03:16.017962 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_date"
[0m08:03:16.020400 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m08:03:16.021257 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: BEGIN
[0m08:03:16.022088 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:03:16.028207 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m08:03:16.029160 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m08:03:16.029892 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */

  
    

  create  table "airflow"."lead_staging"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        accessed_at
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m08:03:16.200438 [debug] [Thread-1 (]: SQL status: SELECT 227459 in 0.170 seconds
[0m08:03:16.204310 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m08:03:16.205145 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
alter table "airflow"."lead_staging"."dim_date__dbt_tmp" rename to "dim_date"
[0m08:03:16.206398 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:03:16.208578 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: COMMIT
[0m08:03:16.209344 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m08:03:16.210118 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: COMMIT
[0m08:03:16.218136 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m08:03:16.221373 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_date__dbt_backup"
[0m08:03:16.222656 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m08:03:16.223515 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
drop table if exists "airflow"."lead_staging"."dim_date__dbt_backup" cascade
[0m08:03:16.224507 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m08:03:16.226367 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: Close
[0m08:03:16.227330 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcde4a6a-0d03-484b-bd82-3053a4198b1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49bbf5d700>]}
[0m08:03:16.228324 [info ] [Thread-1 (]: 2 of 5 OK created sql table model lead_staging.dim_date ........................ [[32mSELECT 227459[0m in 0.22s]
[0m08:03:16.229332 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_date
[0m08:03:16.230153 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_finance
[0m08:03:16.231005 [info ] [Thread-1 (]: 3 of 5 START sql table model lead_staging.dim_finance .......................... [RUN]
[0m08:03:16.231887 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_date, now model.dbt_lead_data.staging_dim_finance)
[0m08:03:16.232626 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_finance
[0m08:03:16.236286 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_finance"
[0m08:03:16.238284 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_finance
[0m08:03:16.242423 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_finance"
[0m08:03:16.244264 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m08:03:16.244905 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: BEGIN
[0m08:03:16.245597 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:03:16.250251 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m08:03:16.251112 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m08:03:16.251803 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */

  
    

  create  table "airflow"."lead_staging"."dim_finance__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        iban
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m08:03:16.454143 [debug] [Thread-1 (]: SQL status: SELECT 227459 in 0.201 seconds
[0m08:03:16.457795 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m08:03:16.458625 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
alter table "airflow"."lead_staging"."dim_finance__dbt_tmp" rename to "dim_finance"
[0m08:03:16.459818 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:03:16.461982 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: COMMIT
[0m08:03:16.462746 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m08:03:16.463477 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: COMMIT
[0m08:03:16.468472 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m08:03:16.472911 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_finance__dbt_backup"
[0m08:03:16.474165 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m08:03:16.474841 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
drop table if exists "airflow"."lead_staging"."dim_finance__dbt_backup" cascade
[0m08:03:16.476091 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m08:03:16.479143 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: Close
[0m08:03:16.480067 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcde4a6a-0d03-484b-bd82-3053a4198b1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49b9d6b1d0>]}
[0m08:03:16.480922 [info ] [Thread-1 (]: 3 of 5 OK created sql table model lead_staging.dim_finance ..................... [[32mSELECT 227459[0m in 0.25s]
[0m08:03:16.481905 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_finance
[0m08:03:16.482699 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_person
[0m08:03:16.483567 [info ] [Thread-1 (]: 4 of 5 START sql table model lead_staging.dim_person ........................... [RUN]
[0m08:03:16.484422 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_finance, now model.dbt_lead_data.staging_dim_person)
[0m08:03:16.485174 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_person
[0m08:03:16.488920 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_person"
[0m08:03:16.490757 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_person
[0m08:03:16.494582 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_person"
[0m08:03:16.496361 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m08:03:16.497119 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: BEGIN
[0m08:03:16.497767 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:03:16.502342 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m08:03:16.503249 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m08:03:16.504039 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */

  
    

  create  table "airflow"."lead_staging"."dim_person__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        person_name,
        user_name,
        email,
        phone,
        birth_date,
        personal_number
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m08:03:16.773573 [debug] [Thread-1 (]: SQL status: SELECT 227459 in 0.269 seconds
[0m08:03:16.777648 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m08:03:16.778632 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
alter table "airflow"."lead_staging"."dim_person__dbt_tmp" rename to "dim_person"
[0m08:03:16.779827 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:03:16.782139 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: COMMIT
[0m08:03:16.782863 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m08:03:16.783664 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: COMMIT
[0m08:03:16.809197 [debug] [Thread-1 (]: SQL status: COMMIT in 0.025 seconds
[0m08:03:16.812439 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_person__dbt_backup"
[0m08:03:16.813697 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m08:03:16.814521 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
drop table if exists "airflow"."lead_staging"."dim_person__dbt_backup" cascade
[0m08:03:16.815787 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m08:03:16.817758 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: Close
[0m08:03:16.818762 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcde4a6a-0d03-484b-bd82-3053a4198b1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49b9d581a0>]}
[0m08:03:16.819807 [info ] [Thread-1 (]: 4 of 5 OK created sql table model lead_staging.dim_person ...................... [[32mSELECT 227459[0m in 0.33s]
[0m08:03:16.820877 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_person
[0m08:03:16.821714 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_fact_network_usage
[0m08:03:16.822617 [info ] [Thread-1 (]: 5 of 5 START sql table model lead_staging.fact_network_usage ................... [RUN]
[0m08:03:16.823461 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_person, now model.dbt_lead_data.staging_fact_network_usage)
[0m08:03:16.824216 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_fact_network_usage
[0m08:03:16.827854 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_fact_network_usage"
[0m08:03:16.830210 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_fact_network_usage
[0m08:03:16.834048 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_fact_network_usage"
[0m08:03:16.836385 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m08:03:16.837102 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: BEGIN
[0m08:03:16.837732 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:03:16.842363 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m08:03:16.843243 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m08:03:16.844060 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */

  
    

  create  table "airflow"."lead_staging"."fact_network_usage__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        session_duration,
        download_speed,
        upload_speed,
        consumed_traffic
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m08:03:17.033485 [debug] [Thread-1 (]: SQL status: SELECT 227459 in 0.189 seconds
[0m08:03:17.037193 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m08:03:17.038076 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
alter table "airflow"."lead_staging"."fact_network_usage__dbt_tmp" rename to "fact_network_usage"
[0m08:03:17.039363 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:03:17.041569 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: COMMIT
[0m08:03:17.042317 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m08:03:17.043097 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: COMMIT
[0m08:03:17.049925 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m08:03:17.053010 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."fact_network_usage__dbt_backup"
[0m08:03:17.054476 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m08:03:17.055321 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
drop table if exists "airflow"."lead_staging"."fact_network_usage__dbt_backup" cascade
[0m08:03:17.056260 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m08:03:17.058000 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: Close
[0m08:03:17.059068 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcde4a6a-0d03-484b-bd82-3053a4198b1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49ba1d7260>]}
[0m08:03:17.059985 [info ] [Thread-1 (]: 5 of 5 OK created sql table model lead_staging.fact_network_usage .............. [[32mSELECT 227459[0m in 0.24s]
[0m08:03:17.061141 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_fact_network_usage
[0m08:03:17.063312 [debug] [MainThread]: Using postgres connection "master"
[0m08:03:17.064014 [debug] [MainThread]: On master: BEGIN
[0m08:03:17.064666 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:03:17.068618 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m08:03:17.069340 [debug] [MainThread]: On master: COMMIT
[0m08:03:17.070017 [debug] [MainThread]: Using postgres connection "master"
[0m08:03:17.070653 [debug] [MainThread]: On master: COMMIT
[0m08:03:17.071505 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:03:17.072153 [debug] [MainThread]: On master: Close
[0m08:03:17.072927 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:03:17.073600 [debug] [MainThread]: Connection 'model.dbt_lead_data.staging_fact_network_usage' was properly closed.
[0m08:03:17.074373 [info ] [MainThread]: 
[0m08:03:17.075212 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 1.67 seconds (1.67s).
[0m08:03:17.077212 [debug] [MainThread]: Command end result
[0m08:03:17.128709 [info ] [MainThread]: 
[0m08:03:17.129444 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:03:17.130325 [info ] [MainThread]: 
[0m08:03:17.131827 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m08:03:17.134663 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.5769086, "process_user_time": 3.233664, "process_kernel_time": 0.229042, "process_mem_max_rss": "123228", "process_in_blocks": "35352", "process_out_blocks": "4056"}
[0m08:03:17.136847 [debug] [MainThread]: Command `dbt run` succeeded at 08:03:17.136696 after 2.58 seconds
[0m08:03:17.137855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49bd85a4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49bbf5d700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49bd0cc5f0>]}
[0m08:03:17.138745 [debug] [MainThread]: Flushing usage events
[0m08:03:21.651628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb3e57c9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb3dd98290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb3ea99580>]}


============================== 08:03:21.658403 | 4c9db807-e319-4f96-84d1-63bdf3875cf8 ==============================
[0m08:03:21.658403 [info ] [MainThread]: Running with dbt=1.8.0
[0m08:03:21.659359 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select tag:trusted', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:03:21.860361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c9db807-e319-4f96-84d1-63bdf3875cf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb3ec654f0>]}
[0m08:03:21.918707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4c9db807-e319-4f96-84d1-63bdf3875cf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb3f5bec90>]}
[0m08:03:21.919998 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:03:22.001300 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m08:03:22.118229 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:03:22.118891 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:03:22.154694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c9db807-e319-4f96-84d1-63bdf3875cf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb3cd6fa10>]}
[0m08:03:22.275726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c9db807-e319-4f96-84d1-63bdf3875cf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb3c999160>]}
[0m08:03:22.276581 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m08:03:22.277326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c9db807-e319-4f96-84d1-63bdf3875cf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb3dd47e60>]}
[0m08:03:22.279569 [info ] [MainThread]: 
[0m08:03:22.280523 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:03:22.286326 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m08:03:22.354655 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m08:03:22.355520 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m08:03:22.356330 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:03:22.362809 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.006 seconds
[0m08:03:22.364834 [debug] [ThreadPool]: On list_airflow: Close
[0m08:03:22.366375 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now create_airflow_lead_trusted)
[0m08:03:22.367302 [debug] [ThreadPool]: Creating schema "database: "airflow"
schema: "lead_trusted"
"
[0m08:03:22.373312 [debug] [ThreadPool]: Using postgres connection "create_airflow_lead_trusted"
[0m08:03:22.374090 [debug] [ThreadPool]: On create_airflow_lead_trusted: BEGIN
[0m08:03:22.374793 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:03:22.379502 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m08:03:22.380310 [debug] [ThreadPool]: Using postgres connection "create_airflow_lead_trusted"
[0m08:03:22.380956 [debug] [ThreadPool]: On create_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "create_airflow_lead_trusted"} */
create schema if not exists "lead_trusted"
[0m08:03:22.382174 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m08:03:22.383815 [debug] [ThreadPool]: On create_airflow_lead_trusted: COMMIT
[0m08:03:22.384570 [debug] [ThreadPool]: Using postgres connection "create_airflow_lead_trusted"
[0m08:03:22.385259 [debug] [ThreadPool]: On create_airflow_lead_trusted: COMMIT
[0m08:03:22.386719 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m08:03:22.387461 [debug] [ThreadPool]: On create_airflow_lead_trusted: Close
[0m08:03:22.390299 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_airflow_lead_trusted, now list_airflow_lead_staging)
[0m08:03:22.397328 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m08:03:22.398158 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m08:03:22.398858 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:03:22.403828 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m08:03:22.404843 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m08:03:22.405943 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m08:03:22.409712 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.003 seconds
[0m08:03:22.411669 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m08:03:22.412644 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m08:03:22.413688 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now list_airflow_lead_trusted)
[0m08:03:22.417176 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m08:03:22.417903 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m08:03:22.418707 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:03:22.422983 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m08:03:22.423696 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m08:03:22.424426 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m08:03:22.427643 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m08:03:22.429366 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m08:03:22.430239 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m08:03:22.436385 [debug] [MainThread]: Using postgres connection "master"
[0m08:03:22.437271 [debug] [MainThread]: On master: BEGIN
[0m08:03:22.438103 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:03:22.442821 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m08:03:22.443667 [debug] [MainThread]: Using postgres connection "master"
[0m08:03:22.444457 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:03:22.448346 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m08:03:22.450412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c9db807-e319-4f96-84d1-63bdf3875cf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb3c59bc20>]}
[0m08:03:22.451276 [debug] [MainThread]: On master: ROLLBACK
[0m08:03:22.452161 [debug] [MainThread]: Using postgres connection "master"
[0m08:03:22.452821 [debug] [MainThread]: On master: BEGIN
[0m08:03:22.454130 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:03:22.454819 [debug] [MainThread]: On master: COMMIT
[0m08:03:22.455504 [debug] [MainThread]: Using postgres connection "master"
[0m08:03:22.456186 [debug] [MainThread]: On master: COMMIT
[0m08:03:22.457055 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:03:22.457710 [debug] [MainThread]: On master: Close
[0m08:03:22.458786 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:03:22.459615 [info ] [MainThread]: 
[0m08:03:22.469749 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_non_pii_data
[0m08:03:22.470713 [info ] [Thread-1 (]: 1 of 4 START sql table model lead_trusted.non_pii_data ......................... [RUN]
[0m08:03:22.471594 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now model.dbt_lead_data.trusted_non_pii_data)
[0m08:03:22.472288 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_non_pii_data
[0m08:03:22.481820 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_non_pii_data"
[0m08:03:22.484517 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_non_pii_data
[0m08:03:22.528889 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_non_pii_data"
[0m08:03:22.531521 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m08:03:22.532200 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: BEGIN
[0m08:03:22.532843 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:03:22.537387 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m08:03:22.538206 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m08:03:22.538928 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */

  
    

  create  table "airflow"."lead_trusted"."non_pii_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        '***MASKED***' AS person_name,
        SUBSTRING(dp.user_name, 1, 5) || '*****'  user_name,
        SUBSTRING(dp.email, 1, 5) || '*****' AS email,
        '***MASKED***'  AS personal_number, 
        '***MASKED***' AS birth_date, 
        '***MASKED***' AS address,
        '***MASKED***'  AS phone, 
        SUBSTRING(da.mac_address, 1, 5) || '*****' AS mac_address,
        SUBSTRING(da.ip_address, 1, 5) || '*****' AS ip_address,
        SUBSTRING(df.iban, 1, 5) || '*****' AS iban,
        dd.accessed_at,
        fnu.session_duration,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.consumed_traffic,
        fnu.unique_id
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    INNER JOIN
        "airflow"."lead_staging"."dim_address" da ON fnu.unique_id = da.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_date" dd ON da.unique_id = dd.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_finance" df ON dd.unique_id = df.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_person" dp ON df.unique_id = dp.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m08:03:26.304277 [debug] [Thread-1 (]: SQL status: SELECT 227459 in 3.765 seconds
[0m08:03:26.311434 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m08:03:26.312233 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
alter table "airflow"."lead_trusted"."non_pii_data__dbt_tmp" rename to "non_pii_data"
[0m08:03:26.313451 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:03:26.332662 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: COMMIT
[0m08:03:26.333518 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m08:03:26.334281 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: COMMIT
[0m08:03:26.337107 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m08:03:26.343907 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."non_pii_data__dbt_backup"
[0m08:03:26.350463 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m08:03:26.351228 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
drop table if exists "airflow"."lead_trusted"."non_pii_data__dbt_backup" cascade
[0m08:03:26.352349 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m08:03:26.355209 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: Close
[0m08:03:26.357049 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c9db807-e319-4f96-84d1-63bdf3875cf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb3f24dbe0>]}
[0m08:03:26.358013 [info ] [Thread-1 (]: 1 of 4 OK created sql table model lead_trusted.non_pii_data .................... [[32mSELECT 227459[0m in 3.88s]
[0m08:03:26.359381 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_non_pii_data
[0m08:03:26.360290 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_payment_data
[0m08:03:26.361200 [info ] [Thread-1 (]: 2 of 4 START sql table model lead_trusted.payment_data ......................... [RUN]
[0m08:03:26.362158 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_non_pii_data, now model.dbt_lead_data.trusted_payment_data)
[0m08:03:26.362927 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_payment_data
[0m08:03:26.366975 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_payment_data"
[0m08:03:26.369953 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_payment_data
[0m08:03:26.373805 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_payment_data"
[0m08:03:26.376104 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m08:03:26.376802 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: BEGIN
[0m08:03:26.377447 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:03:26.382201 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m08:03:26.382901 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m08:03:26.383737 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */

  
    

  create  table "airflow"."lead_trusted"."payment_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        fnu.unique_id,
        df.iban,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.session_duration,
        fnu.consumed_traffic,
        ((fnu.download_speed + fnu.upload_speed + 1)/2) + (fnu.consumed_traffic / (fnu.session_duration + 1)) AS payment_amount
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    JOIN
        "airflow"."lead_staging"."dim_finance" df
    ON
	    fnu.unique_id = df.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m08:03:27.744062 [debug] [Thread-1 (]: SQL status: SELECT 227459 in 1.360 seconds
[0m08:03:27.747341 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m08:03:27.748037 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
alter table "airflow"."lead_trusted"."payment_data__dbt_tmp" rename to "payment_data"
[0m08:03:27.748978 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:03:27.750903 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: COMMIT
[0m08:03:27.752110 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m08:03:27.752929 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: COMMIT
[0m08:03:27.765371 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m08:03:27.768377 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."payment_data__dbt_backup"
[0m08:03:27.769667 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m08:03:27.770446 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
drop table if exists "airflow"."lead_trusted"."payment_data__dbt_backup" cascade
[0m08:03:27.771428 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m08:03:27.773202 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: Close
[0m08:03:27.774239 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c9db807-e319-4f96-84d1-63bdf3875cf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb3aca7f80>]}
[0m08:03:27.775170 [info ] [Thread-1 (]: 2 of 4 OK created sql table model lead_trusted.payment_data .................... [[32mSELECT 227459[0m in 1.41s]
[0m08:03:27.776263 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_payment_data
[0m08:03:27.777027 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_pii_data
[0m08:03:27.778039 [info ] [Thread-1 (]: 3 of 4 START sql table model lead_trusted.pii_data ............................. [RUN]
[0m08:03:27.778942 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_payment_data, now model.dbt_lead_data.trusted_pii_data)
[0m08:03:27.779784 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_pii_data
[0m08:03:27.784758 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_pii_data"
[0m08:03:27.787213 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_pii_data
[0m08:03:27.792785 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_pii_data"
[0m08:03:27.794948 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m08:03:27.795763 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: BEGIN
[0m08:03:27.796419 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:03:27.801323 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m08:03:27.802108 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m08:03:27.802796 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */

  
    

  create  table "airflow"."lead_trusted"."pii_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        dp.person_name,
        dp.user_name,
        dp.email,
        dp.personal_number, 
        dp.birth_date, 
        da.address,
        dp.phone, 
        da.mac_address,
        da.ip_address,
        df.iban,
        dd.accessed_at,
        fnu.session_duration,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.consumed_traffic,
        fnu.unique_id
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    INNER JOIN
        "airflow"."lead_staging"."dim_address" da ON fnu.unique_id = da.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_date" dd ON da.unique_id = dd.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_finance" df ON dd.unique_id = df.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_person" dp ON df.unique_id = dp.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m08:03:28.932743 [debug] [Thread-1 (]: SQL status: SELECT 227459 in 1.129 seconds
[0m08:03:28.936578 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m08:03:28.937374 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */
alter table "airflow"."lead_trusted"."pii_data__dbt_tmp" rename to "pii_data"
[0m08:03:28.951687 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.013 seconds
[0m08:03:28.954388 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: COMMIT
[0m08:03:28.955162 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m08:03:28.955914 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: COMMIT
[0m08:03:28.957709 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:03:28.960804 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."pii_data__dbt_backup"
[0m08:03:28.962309 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m08:03:28.963174 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */
drop table if exists "airflow"."lead_trusted"."pii_data__dbt_backup" cascade
[0m08:03:28.964431 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m08:03:28.966348 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: Close
[0m08:03:28.967318 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c9db807-e319-4f96-84d1-63bdf3875cf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb3aca1940>]}
[0m08:03:28.968258 [info ] [Thread-1 (]: 3 of 4 OK created sql table model lead_trusted.pii_data ........................ [[32mSELECT 227459[0m in 1.19s]
[0m08:03:28.969320 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_pii_data
[0m08:03:28.970161 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_technical_data
[0m08:03:28.970957 [info ] [Thread-1 (]: 4 of 4 START sql table model lead_trusted.technical_data ....................... [RUN]
[0m08:03:28.971811 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_pii_data, now model.dbt_lead_data.trusted_technical_data)
[0m08:03:28.972580 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_technical_data
[0m08:03:28.976571 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_technical_data"
[0m08:03:28.979200 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_technical_data
[0m08:03:28.983240 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_technical_data"
[0m08:03:28.985431 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m08:03:28.986193 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: BEGIN
[0m08:03:28.986833 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:03:28.991710 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m08:03:28.992540 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m08:03:28.993326 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */

  
    

  create  table "airflow"."lead_trusted"."technical_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        fnu.unique_id,
        da.address,
        da.mac_address,
        da.ip_address,
        fnu.download_speed,
        fnu.upload_speed,
        ROUND((fnu.session_duration/60), 1) as min_session_duration,
        CASE 
            WHEN fnu.download_speed < 50 OR fnu.upload_speed < 30 OR fnu.session_duration/60 < 1 THEN true
            ELSE false
        END AS technical_issue
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    JOIN
        "airflow"."lead_staging"."dim_address" da
    ON
	    fnu.unique_id = da.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m08:03:29.489220 [debug] [Thread-1 (]: SQL status: SELECT 227459 in 0.495 seconds
[0m08:03:29.492907 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m08:03:29.493768 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
alter table "airflow"."lead_trusted"."technical_data__dbt_tmp" rename to "technical_data"
[0m08:03:29.495036 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:03:29.497108 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: COMMIT
[0m08:03:29.498117 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m08:03:29.498903 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: COMMIT
[0m08:03:29.508853 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m08:03:29.511964 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."technical_data__dbt_backup"
[0m08:03:29.513199 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m08:03:29.513916 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
drop table if exists "airflow"."lead_trusted"."technical_data__dbt_backup" cascade
[0m08:03:29.514988 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m08:03:29.516735 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: Close
[0m08:03:29.517595 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c9db807-e319-4f96-84d1-63bdf3875cf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb3ab0ccb0>]}
[0m08:03:29.518577 [info ] [Thread-1 (]: 4 of 4 OK created sql table model lead_trusted.technical_data .................. [[32mSELECT 227459[0m in 0.55s]
[0m08:03:29.519638 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_technical_data
[0m08:03:29.521764 [debug] [MainThread]: Using postgres connection "master"
[0m08:03:29.522480 [debug] [MainThread]: On master: BEGIN
[0m08:03:29.523104 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:03:29.527334 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m08:03:29.528045 [debug] [MainThread]: On master: COMMIT
[0m08:03:29.528757 [debug] [MainThread]: Using postgres connection "master"
[0m08:03:29.529450 [debug] [MainThread]: On master: COMMIT
[0m08:03:29.530299 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:03:29.530970 [debug] [MainThread]: On master: Close
[0m08:03:29.531877 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:03:29.532544 [debug] [MainThread]: Connection 'model.dbt_lead_data.trusted_technical_data' was properly closed.
[0m08:03:29.533329 [info ] [MainThread]: 
[0m08:03:29.534132 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 7.25 seconds (7.25s).
[0m08:03:29.535884 [debug] [MainThread]: Command end result
[0m08:03:29.587718 [info ] [MainThread]: 
[0m08:03:29.588464 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:03:29.589149 [info ] [MainThread]: 
[0m08:03:29.590230 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m08:03:29.592251 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.995964, "process_user_time": 2.716077, "process_kernel_time": 0.158994, "process_mem_max_rss": "120828", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m08:03:29.593784 [debug] [MainThread]: Command `dbt run` succeeded at 08:03:29.593589 after 8.00 seconds
[0m08:03:29.595193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb4197b110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb3c167fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb3dfe22a0>]}
[0m08:03:29.595866 [debug] [MainThread]: Flushing usage events
[0m14:05:18.723706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8c74b4e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8c940ff20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8c74b6b70>]}


============================== 14:05:18.748908 | c5596a7f-ebc0-4648-a9a8-68d397eb023b ==============================
[0m14:05:18.748908 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:18.749953 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select tag:staging', 'send_anonymous_usage_stats': 'True'}
[0m14:05:19.030072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c5596a7f-ebc0-4648-a9a8-68d397eb023b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8c76baba0>]}
[0m14:05:19.091562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c5596a7f-ebc0-4648-a9a8-68d397eb023b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8c9101f40>]}
[0m14:05:19.093141 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:05:19.178717 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:19.320047 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:05:19.320912 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:05:19.358363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c5596a7f-ebc0-4648-a9a8-68d397eb023b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8c68f30b0>]}
[0m14:05:19.488068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c5596a7f-ebc0-4648-a9a8-68d397eb023b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8c6786fc0>]}
[0m14:05:19.488943 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m14:05:19.489892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5596a7f-ebc0-4648-a9a8-68d397eb023b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8c59c4740>]}
[0m14:05:19.492278 [info ] [MainThread]: 
[0m14:05:19.493434 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:05:19.501268 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m14:05:19.538107 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m14:05:19.539069 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m14:05:19.539685 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:19.544548 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.005 seconds
[0m14:05:19.546247 [debug] [ThreadPool]: On list_airflow: Close
[0m14:05:19.547560 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now create_airflow_lead_staging)
[0m14:05:19.548638 [debug] [ThreadPool]: Creating schema "database: "airflow"
schema: "lead_staging"
"
[0m14:05:19.554410 [debug] [ThreadPool]: Using postgres connection "create_airflow_lead_staging"
[0m14:05:19.555089 [debug] [ThreadPool]: On create_airflow_lead_staging: BEGIN
[0m14:05:19.555853 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:19.559878 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m14:05:19.560905 [debug] [ThreadPool]: Using postgres connection "create_airflow_lead_staging"
[0m14:05:19.561500 [debug] [ThreadPool]: On create_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "create_airflow_lead_staging"} */
create schema if not exists "lead_staging"
[0m14:05:19.562492 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m14:05:19.563818 [debug] [ThreadPool]: On create_airflow_lead_staging: COMMIT
[0m14:05:19.564397 [debug] [ThreadPool]: Using postgres connection "create_airflow_lead_staging"
[0m14:05:19.565126 [debug] [ThreadPool]: On create_airflow_lead_staging: COMMIT
[0m14:05:19.566333 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m14:05:19.566990 [debug] [ThreadPool]: On create_airflow_lead_staging: Close
[0m14:05:19.569530 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_airflow_lead_staging, now list_airflow_lead_staging)
[0m14:05:19.575906 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m14:05:19.576604 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m14:05:19.577235 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:19.581141 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m14:05:19.581836 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m14:05:19.582442 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m14:05:19.589113 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m14:05:19.590836 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m14:05:19.591702 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m14:05:19.592686 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now list_airflow_lead_trusted)
[0m14:05:19.595115 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m14:05:19.595696 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m14:05:19.596387 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:19.600566 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m14:05:19.601310 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m14:05:19.601973 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m14:05:19.604792 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m14:05:19.606539 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m14:05:19.607321 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m14:05:19.613400 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:19.614214 [debug] [MainThread]: On master: BEGIN
[0m14:05:19.614976 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:19.619117 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m14:05:19.619787 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:19.620523 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:05:19.624557 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m14:05:19.626594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5596a7f-ebc0-4648-a9a8-68d397eb023b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8c747c2c0>]}
[0m14:05:19.627452 [debug] [MainThread]: On master: ROLLBACK
[0m14:05:19.628421 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:19.629148 [debug] [MainThread]: On master: BEGIN
[0m14:05:19.630220 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:05:19.630935 [debug] [MainThread]: On master: COMMIT
[0m14:05:19.631602 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:19.632322 [debug] [MainThread]: On master: COMMIT
[0m14:05:19.633172 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:05:19.633863 [debug] [MainThread]: On master: Close
[0m14:05:19.634701 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:05:19.635459 [info ] [MainThread]: 
[0m14:05:19.645590 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_adress
[0m14:05:19.646559 [info ] [Thread-1 (]: 1 of 5 START sql table model lead_staging.dim_address .......................... [RUN]
[0m14:05:19.647634 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now model.dbt_lead_data.staging_dim_adress)
[0m14:05:19.648445 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_adress
[0m14:05:19.657182 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_adress"
[0m14:05:19.660488 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_adress
[0m14:05:19.702424 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_adress"
[0m14:05:19.705378 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m14:05:19.706254 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: BEGIN
[0m14:05:19.707009 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:19.711513 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m14:05:19.712311 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m14:05:19.713045 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */

  
    

  create  table "airflow"."lead_staging"."dim_address__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        address,
        mac_address,
        ip_address
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m14:05:19.816666 [debug] [Thread-1 (]: SQL status: SELECT 100372 in 0.103 seconds
[0m14:05:19.823738 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m14:05:19.824548 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
alter table "airflow"."lead_staging"."dim_address__dbt_tmp" rename to "dim_address"
[0m14:05:19.825840 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:05:19.845113 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m14:05:19.846103 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m14:05:19.846992 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m14:05:19.875420 [debug] [Thread-1 (]: SQL status: COMMIT in 0.028 seconds
[0m14:05:19.882907 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_address__dbt_backup"
[0m14:05:19.889946 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m14:05:19.890872 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
drop table if exists "airflow"."lead_staging"."dim_address__dbt_backup" cascade
[0m14:05:19.892029 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m14:05:19.895102 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: Close
[0m14:05:19.897079 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5596a7f-ebc0-4648-a9a8-68d397eb023b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8c816aed0>]}
[0m14:05:19.898111 [info ] [Thread-1 (]: 1 of 5 OK created sql table model lead_staging.dim_address ..................... [[32mSELECT 100372[0m in 0.25s]
[0m14:05:19.899206 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_adress
[0m14:05:19.900126 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_date
[0m14:05:19.901138 [info ] [Thread-1 (]: 2 of 5 START sql table model lead_staging.dim_date ............................. [RUN]
[0m14:05:19.902154 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_adress, now model.dbt_lead_data.staging_dim_date)
[0m14:05:19.903125 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_date
[0m14:05:19.907230 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_date"
[0m14:05:19.909542 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_date
[0m14:05:19.913922 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_date"
[0m14:05:19.916356 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m14:05:19.917113 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: BEGIN
[0m14:05:19.917857 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:19.923214 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m14:05:19.924089 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m14:05:19.924888 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */

  
    

  create  table "airflow"."lead_staging"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        accessed_at
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m14:05:19.997998 [debug] [Thread-1 (]: SQL status: SELECT 100372 in 0.072 seconds
[0m14:05:20.001937 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m14:05:20.002811 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
alter table "airflow"."lead_staging"."dim_date__dbt_tmp" rename to "dim_date"
[0m14:05:20.004072 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:05:20.006221 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: COMMIT
[0m14:05:20.006990 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m14:05:20.007833 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: COMMIT
[0m14:05:20.015212 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m14:05:20.018440 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_date__dbt_backup"
[0m14:05:20.019864 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m14:05:20.020653 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
drop table if exists "airflow"."lead_staging"."dim_date__dbt_backup" cascade
[0m14:05:20.021893 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m14:05:20.023805 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: Close
[0m14:05:20.024845 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5596a7f-ebc0-4648-a9a8-68d397eb023b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8c4dbeb70>]}
[0m14:05:20.025722 [info ] [Thread-1 (]: 2 of 5 OK created sql table model lead_staging.dim_date ........................ [[32mSELECT 100372[0m in 0.12s]
[0m14:05:20.026692 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_date
[0m14:05:20.027505 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_finance
[0m14:05:20.028436 [info ] [Thread-1 (]: 3 of 5 START sql table model lead_staging.dim_finance .......................... [RUN]
[0m14:05:20.029312 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_date, now model.dbt_lead_data.staging_dim_finance)
[0m14:05:20.030087 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_finance
[0m14:05:20.033923 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_finance"
[0m14:05:20.035974 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_finance
[0m14:05:20.040233 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_finance"
[0m14:05:20.042215 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m14:05:20.042944 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: BEGIN
[0m14:05:20.043576 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:20.048251 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m14:05:20.049223 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m14:05:20.050080 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */

  
    

  create  table "airflow"."lead_staging"."dim_finance__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        iban
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m14:05:20.148142 [debug] [Thread-1 (]: SQL status: SELECT 100372 in 0.097 seconds
[0m14:05:20.151965 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m14:05:20.152815 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
alter table "airflow"."lead_staging"."dim_finance__dbt_tmp" rename to "dim_finance"
[0m14:05:20.154065 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:05:20.156187 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: COMMIT
[0m14:05:20.156980 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m14:05:20.157794 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: COMMIT
[0m14:05:20.163014 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m14:05:20.167602 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_finance__dbt_backup"
[0m14:05:20.168905 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m14:05:20.169600 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
drop table if exists "airflow"."lead_staging"."dim_finance__dbt_backup" cascade
[0m14:05:20.170653 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m14:05:20.172538 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: Close
[0m14:05:20.173478 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5596a7f-ebc0-4648-a9a8-68d397eb023b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8c457e240>]}
[0m14:05:20.174436 [info ] [Thread-1 (]: 3 of 5 OK created sql table model lead_staging.dim_finance ..................... [[32mSELECT 100372[0m in 0.14s]
[0m14:05:20.175442 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_finance
[0m14:05:20.176199 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_person
[0m14:05:20.177025 [info ] [Thread-1 (]: 4 of 5 START sql table model lead_staging.dim_person ........................... [RUN]
[0m14:05:20.177914 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_finance, now model.dbt_lead_data.staging_dim_person)
[0m14:05:20.178599 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_person
[0m14:05:20.182468 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_person"
[0m14:05:20.184684 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_person
[0m14:05:20.188766 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_person"
[0m14:05:20.190867 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m14:05:20.191514 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: BEGIN
[0m14:05:20.192156 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:20.196428 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m14:05:20.197264 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m14:05:20.198020 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */

  
    

  create  table "airflow"."lead_staging"."dim_person__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        person_name,
        user_name,
        email,
        phone,
        birth_date,
        personal_number
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m14:05:20.337407 [debug] [Thread-1 (]: SQL status: SELECT 100372 in 0.139 seconds
[0m14:05:20.341232 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m14:05:20.342063 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
alter table "airflow"."lead_staging"."dim_person__dbt_tmp" rename to "dim_person"
[0m14:05:20.343222 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:05:20.345377 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: COMMIT
[0m14:05:20.346141 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m14:05:20.347022 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: COMMIT
[0m14:05:20.350870 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m14:05:20.354004 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_person__dbt_backup"
[0m14:05:20.355243 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m14:05:20.355935 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
drop table if exists "airflow"."lead_staging"."dim_person__dbt_backup" cascade
[0m14:05:20.357015 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m14:05:20.358776 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: Close
[0m14:05:20.359778 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5596a7f-ebc0-4648-a9a8-68d397eb023b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8c4564980>]}
[0m14:05:20.360674 [info ] [Thread-1 (]: 4 of 5 OK created sql table model lead_staging.dim_person ...................... [[32mSELECT 100372[0m in 0.18s]
[0m14:05:20.361673 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_person
[0m14:05:20.362523 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_fact_network_usage
[0m14:05:20.363493 [info ] [Thread-1 (]: 5 of 5 START sql table model lead_staging.fact_network_usage ................... [RUN]
[0m14:05:20.364367 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_person, now model.dbt_lead_data.staging_fact_network_usage)
[0m14:05:20.365104 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_fact_network_usage
[0m14:05:20.368895 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_fact_network_usage"
[0m14:05:20.370796 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_fact_network_usage
[0m14:05:20.374774 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_fact_network_usage"
[0m14:05:20.376901 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m14:05:20.377583 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: BEGIN
[0m14:05:20.378278 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:20.382858 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m14:05:20.383853 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m14:05:20.384583 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */

  
    

  create  table "airflow"."lead_staging"."fact_network_usage__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        session_duration,
        download_speed,
        upload_speed,
        consumed_traffic
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m14:05:20.482620 [debug] [Thread-1 (]: SQL status: SELECT 100372 in 0.097 seconds
[0m14:05:20.487328 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m14:05:20.488303 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
alter table "airflow"."lead_staging"."fact_network_usage__dbt_tmp" rename to "fact_network_usage"
[0m14:05:20.489942 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:05:20.492612 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: COMMIT
[0m14:05:20.493597 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m14:05:20.494586 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: COMMIT
[0m14:05:20.500531 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m14:05:20.503804 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."fact_network_usage__dbt_backup"
[0m14:05:20.505155 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m14:05:20.505896 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
drop table if exists "airflow"."lead_staging"."fact_network_usage__dbt_backup" cascade
[0m14:05:20.507030 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m14:05:20.508914 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: Close
[0m14:05:20.510007 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5596a7f-ebc0-4648-a9a8-68d397eb023b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8c491e1e0>]}
[0m14:05:20.511034 [info ] [Thread-1 (]: 5 of 5 OK created sql table model lead_staging.fact_network_usage .............. [[32mSELECT 100372[0m in 0.15s]
[0m14:05:20.512107 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_fact_network_usage
[0m14:05:20.514428 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:20.515254 [debug] [MainThread]: On master: BEGIN
[0m14:05:20.516064 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:20.520267 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m14:05:20.521022 [debug] [MainThread]: On master: COMMIT
[0m14:05:20.521837 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:20.522510 [debug] [MainThread]: On master: COMMIT
[0m14:05:20.523430 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:05:20.524149 [debug] [MainThread]: On master: Close
[0m14:05:20.525115 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:20.525838 [debug] [MainThread]: Connection 'model.dbt_lead_data.staging_fact_network_usage' was properly closed.
[0m14:05:20.526573 [info ] [MainThread]: 
[0m14:05:20.527353 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 1.03 seconds (1.03s).
[0m14:05:20.529415 [debug] [MainThread]: Command end result
[0m14:05:20.587246 [info ] [MainThread]: 
[0m14:05:20.588103 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:20.588898 [info ] [MainThread]: 
[0m14:05:20.589656 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m14:05:20.591119 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.9714326, "process_user_time": 2.975325, "process_kernel_time": 0.184689, "process_mem_max_rss": "122284", "process_in_blocks": "4672", "process_out_blocks": "4056"}
[0m14:05:20.592093 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:20.591951 after 1.97 seconds
[0m14:05:20.592939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8c74b6060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8c59a41a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8c6ed4470>]}
[0m14:05:20.593645 [debug] [MainThread]: Flushing usage events
[0m14:05:25.409462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd981842060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd982422420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9817fa9f0>]}


============================== 14:05:25.416258 | c38dbcc3-49f6-4462-aee8-318bbdc7763b ==============================
[0m14:05:25.416258 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:05:25.417251 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select tag:trusted', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:25.628637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c38dbcc3-49f6-4462-aee8-318bbdc7763b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9814286b0>]}
[0m14:05:25.687362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c38dbcc3-49f6-4462-aee8-318bbdc7763b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd980993170>]}
[0m14:05:25.688456 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:05:25.769296 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:05:25.887926 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:05:25.888934 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:05:25.923538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c38dbcc3-49f6-4462-aee8-318bbdc7763b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd98095e030>]}
[0m14:05:26.046606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c38dbcc3-49f6-4462-aee8-318bbdc7763b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd98014cb30>]}
[0m14:05:26.047410 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m14:05:26.048067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c38dbcc3-49f6-4462-aee8-318bbdc7763b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd97f91bfb0>]}
[0m14:05:26.050448 [info ] [MainThread]: 
[0m14:05:26.051608 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:05:26.057204 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m14:05:26.095801 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m14:05:26.096583 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m14:05:26.097231 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:26.102183 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.005 seconds
[0m14:05:26.104026 [debug] [ThreadPool]: On list_airflow: Close
[0m14:05:26.105194 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now create_airflow_lead_trusted)
[0m14:05:26.106019 [debug] [ThreadPool]: Creating schema "database: "airflow"
schema: "lead_trusted"
"
[0m14:05:26.111878 [debug] [ThreadPool]: Using postgres connection "create_airflow_lead_trusted"
[0m14:05:26.112584 [debug] [ThreadPool]: On create_airflow_lead_trusted: BEGIN
[0m14:05:26.113217 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:26.117278 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m14:05:26.117987 [debug] [ThreadPool]: Using postgres connection "create_airflow_lead_trusted"
[0m14:05:26.118680 [debug] [ThreadPool]: On create_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "create_airflow_lead_trusted"} */
create schema if not exists "lead_trusted"
[0m14:05:26.119740 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m14:05:26.121037 [debug] [ThreadPool]: On create_airflow_lead_trusted: COMMIT
[0m14:05:26.121711 [debug] [ThreadPool]: Using postgres connection "create_airflow_lead_trusted"
[0m14:05:26.122335 [debug] [ThreadPool]: On create_airflow_lead_trusted: COMMIT
[0m14:05:26.123912 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m14:05:26.124650 [debug] [ThreadPool]: On create_airflow_lead_trusted: Close
[0m14:05:26.127269 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_airflow_lead_trusted, now list_airflow_lead_trusted)
[0m14:05:26.133846 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m14:05:26.134512 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m14:05:26.135094 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:26.138893 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m14:05:26.139612 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m14:05:26.140256 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m14:05:26.143443 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m14:05:26.145174 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m14:05:26.145974 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m14:05:26.146858 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now list_airflow_lead_staging)
[0m14:05:26.149291 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m14:05:26.150001 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m14:05:26.150659 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:26.154613 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m14:05:26.155205 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m14:05:26.155876 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m14:05:26.158729 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m14:05:26.160453 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m14:05:26.161253 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m14:05:26.168438 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:26.169240 [debug] [MainThread]: On master: BEGIN
[0m14:05:26.170023 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:26.173993 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m14:05:26.174741 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:26.175516 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:05:26.178976 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m14:05:26.180799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c38dbcc3-49f6-4462-aee8-318bbdc7763b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9820342c0>]}
[0m14:05:26.181657 [debug] [MainThread]: On master: ROLLBACK
[0m14:05:26.182531 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:26.183159 [debug] [MainThread]: On master: BEGIN
[0m14:05:26.184162 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:05:26.184858 [debug] [MainThread]: On master: COMMIT
[0m14:05:26.185478 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:26.186079 [debug] [MainThread]: On master: COMMIT
[0m14:05:26.186874 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:05:26.187539 [debug] [MainThread]: On master: Close
[0m14:05:26.188375 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:05:26.189107 [info ] [MainThread]: 
[0m14:05:26.199090 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_non_pii_data
[0m14:05:26.200057 [info ] [Thread-1 (]: 1 of 4 START sql table model lead_trusted.non_pii_data ......................... [RUN]
[0m14:05:26.201054 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now model.dbt_lead_data.trusted_non_pii_data)
[0m14:05:26.201759 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_non_pii_data
[0m14:05:26.211518 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_non_pii_data"
[0m14:05:26.214141 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_non_pii_data
[0m14:05:26.268418 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_non_pii_data"
[0m14:05:26.270724 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m14:05:26.271280 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: BEGIN
[0m14:05:26.271982 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:26.276294 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m14:05:26.278272 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m14:05:26.279156 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */

  
    

  create  table "airflow"."lead_trusted"."non_pii_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        '***MASKED***' AS person_name,
        SUBSTRING(dp.user_name, 1, 5) || '*****'  user_name,
        SUBSTRING(dp.email, 1, 5) || '*****' AS email,
        '***MASKED***'  AS personal_number, 
        '***MASKED***' AS birth_date, 
        '***MASKED***' AS address,
        '***MASKED***'  AS phone, 
        SUBSTRING(da.mac_address, 1, 5) || '*****' AS mac_address,
        SUBSTRING(da.ip_address, 1, 5) || '*****' AS ip_address,
        SUBSTRING(df.iban, 1, 5) || '*****' AS iban,
        dd.accessed_at,
        fnu.session_duration,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.consumed_traffic,
        fnu.unique_id
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    INNER JOIN
        "airflow"."lead_staging"."dim_address" da ON fnu.unique_id = da.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_date" dd ON da.unique_id = dd.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_finance" df ON dd.unique_id = df.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_person" dp ON df.unique_id = dp.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m14:05:28.407627 [debug] [Thread-1 (]: SQL status: SELECT 100372 in 2.127 seconds
[0m14:05:28.414858 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m14:05:28.415706 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
alter table "airflow"."lead_trusted"."non_pii_data__dbt_tmp" rename to "non_pii_data"
[0m14:05:28.416951 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:05:28.436764 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: COMMIT
[0m14:05:28.437649 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m14:05:28.438484 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: COMMIT
[0m14:05:28.440927 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:05:28.447013 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."non_pii_data__dbt_backup"
[0m14:05:28.454253 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m14:05:28.457471 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
drop table if exists "airflow"."lead_trusted"."non_pii_data__dbt_backup" cascade
[0m14:05:28.461015 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m14:05:28.468071 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: Close
[0m14:05:28.471381 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c38dbcc3-49f6-4462-aee8-318bbdc7763b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd982d2d940>]}
[0m14:05:28.472633 [info ] [Thread-1 (]: 1 of 4 OK created sql table model lead_trusted.non_pii_data .................... [[32mSELECT 100372[0m in 2.27s]
[0m14:05:28.473848 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_non_pii_data
[0m14:05:28.474732 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_payment_data
[0m14:05:28.475683 [info ] [Thread-1 (]: 2 of 4 START sql table model lead_trusted.payment_data ......................... [RUN]
[0m14:05:28.476637 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_non_pii_data, now model.dbt_lead_data.trusted_payment_data)
[0m14:05:28.477338 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_payment_data
[0m14:05:28.481607 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_payment_data"
[0m14:05:28.484862 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_payment_data
[0m14:05:28.489159 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_payment_data"
[0m14:05:28.491994 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m14:05:28.492740 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: BEGIN
[0m14:05:28.493475 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:28.498472 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m14:05:28.499592 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m14:05:28.500324 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */

  
    

  create  table "airflow"."lead_trusted"."payment_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        fnu.unique_id,
        df.iban,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.session_duration,
        fnu.consumed_traffic,
        ((fnu.download_speed + fnu.upload_speed + 1)/2) + (fnu.consumed_traffic / (fnu.session_duration + 1)) AS payment_amount
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    JOIN
        "airflow"."lead_staging"."dim_finance" df
    ON
	    fnu.unique_id = df.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m14:05:29.126115 [debug] [Thread-1 (]: SQL status: SELECT 100372 in 0.625 seconds
[0m14:05:29.130490 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m14:05:29.131670 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
alter table "airflow"."lead_trusted"."payment_data__dbt_tmp" rename to "payment_data"
[0m14:05:29.133163 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:05:29.136305 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: COMMIT
[0m14:05:29.137316 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m14:05:29.138303 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: COMMIT
[0m14:05:29.147830 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m14:05:29.153605 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."payment_data__dbt_backup"
[0m14:05:29.155209 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m14:05:29.156539 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
drop table if exists "airflow"."lead_trusted"."payment_data__dbt_backup" cascade
[0m14:05:29.158288 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m14:05:29.161105 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: Close
[0m14:05:29.162432 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c38dbcc3-49f6-4462-aee8-318bbdc7763b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd97e7947a0>]}
[0m14:05:29.164259 [info ] [Thread-1 (]: 2 of 4 OK created sql table model lead_trusted.payment_data .................... [[32mSELECT 100372[0m in 0.69s]
[0m14:05:29.165986 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_payment_data
[0m14:05:29.167384 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_pii_data
[0m14:05:29.168852 [info ] [Thread-1 (]: 3 of 4 START sql table model lead_trusted.pii_data ............................. [RUN]
[0m14:05:29.169920 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_payment_data, now model.dbt_lead_data.trusted_pii_data)
[0m14:05:29.170893 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_pii_data
[0m14:05:29.177923 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_pii_data"
[0m14:05:29.182202 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_pii_data
[0m14:05:29.189690 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_pii_data"
[0m14:05:29.193731 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m14:05:29.195254 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: BEGIN
[0m14:05:29.196766 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:29.204552 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m14:05:29.205684 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m14:05:29.206778 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */

  
    

  create  table "airflow"."lead_trusted"."pii_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        dp.person_name,
        dp.user_name,
        dp.email,
        dp.personal_number, 
        dp.birth_date, 
        da.address,
        dp.phone, 
        da.mac_address,
        da.ip_address,
        df.iban,
        dd.accessed_at,
        fnu.session_duration,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.consumed_traffic,
        fnu.unique_id
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    INNER JOIN
        "airflow"."lead_staging"."dim_address" da ON fnu.unique_id = da.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_date" dd ON da.unique_id = dd.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_finance" df ON dd.unique_id = df.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_person" dp ON df.unique_id = dp.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m14:05:31.476657 [debug] [Thread-1 (]: SQL status: SELECT 100372 in 2.269 seconds
[0m14:05:31.481052 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m14:05:31.482025 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */
alter table "airflow"."lead_trusted"."pii_data__dbt_tmp" rename to "pii_data"
[0m14:05:31.483578 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:05:31.486225 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: COMMIT
[0m14:05:31.486965 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m14:05:31.487663 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: COMMIT
[0m14:05:31.490233 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:05:31.493149 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."pii_data__dbt_backup"
[0m14:05:31.494291 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m14:05:31.495051 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */
drop table if exists "airflow"."lead_trusted"."pii_data__dbt_backup" cascade
[0m14:05:31.495993 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m14:05:31.497940 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: Close
[0m14:05:31.498988 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c38dbcc3-49f6-4462-aee8-318bbdc7763b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd97e7d52e0>]}
[0m14:05:31.499982 [info ] [Thread-1 (]: 3 of 4 OK created sql table model lead_trusted.pii_data ........................ [[32mSELECT 100372[0m in 2.33s]
[0m14:05:31.501044 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_pii_data
[0m14:05:31.501925 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_technical_data
[0m14:05:31.502811 [info ] [Thread-1 (]: 4 of 4 START sql table model lead_trusted.technical_data ....................... [RUN]
[0m14:05:31.503683 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_pii_data, now model.dbt_lead_data.trusted_technical_data)
[0m14:05:31.504509 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_technical_data
[0m14:05:31.509038 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_technical_data"
[0m14:05:31.512365 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_technical_data
[0m14:05:31.517004 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_technical_data"
[0m14:05:31.519868 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m14:05:31.520613 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: BEGIN
[0m14:05:31.521708 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:31.527372 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m14:05:31.528344 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m14:05:31.529212 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */

  
    

  create  table "airflow"."lead_trusted"."technical_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        fnu.unique_id,
        da.address,
        da.mac_address,
        da.ip_address,
        fnu.download_speed,
        fnu.upload_speed,
        ROUND((fnu.session_duration/60), 1) as min_session_duration,
        CASE 
            WHEN fnu.download_speed < 50 OR fnu.upload_speed < 30 OR fnu.session_duration/60 < 1 THEN true
            ELSE false
        END AS technical_issue
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    JOIN
        "airflow"."lead_staging"."dim_address" da
    ON
	    fnu.unique_id = da.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m14:05:32.219332 [debug] [Thread-1 (]: SQL status: SELECT 100372 in 0.689 seconds
[0m14:05:32.234866 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m14:05:32.235924 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
alter table "airflow"."lead_trusted"."technical_data__dbt_tmp" rename to "technical_data"
[0m14:05:32.237102 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:05:32.239374 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: COMMIT
[0m14:05:32.240211 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m14:05:32.240994 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: COMMIT
[0m14:05:32.248722 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m14:05:32.251920 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."technical_data__dbt_backup"
[0m14:05:32.253152 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m14:05:32.254021 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
drop table if exists "airflow"."lead_trusted"."technical_data__dbt_backup" cascade
[0m14:05:32.255024 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m14:05:32.257068 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: Close
[0m14:05:32.258159 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c38dbcc3-49f6-4462-aee8-318bbdc7763b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd97e797bc0>]}
[0m14:05:32.259170 [info ] [Thread-1 (]: 4 of 4 OK created sql table model lead_trusted.technical_data .................. [[32mSELECT 100372[0m in 0.75s]
[0m14:05:32.260393 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_technical_data
[0m14:05:32.263041 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:32.263875 [debug] [MainThread]: On master: BEGIN
[0m14:05:32.264630 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:32.269320 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m14:05:32.270290 [debug] [MainThread]: On master: COMMIT
[0m14:05:32.271024 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:32.271771 [debug] [MainThread]: On master: COMMIT
[0m14:05:32.272687 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:05:32.273556 [debug] [MainThread]: On master: Close
[0m14:05:32.274675 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:32.275692 [debug] [MainThread]: Connection 'model.dbt_lead_data.trusted_technical_data' was properly closed.
[0m14:05:32.276572 [info ] [MainThread]: 
[0m14:05:32.277505 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 6.22 seconds (6.22s).
[0m14:05:32.279386 [debug] [MainThread]: Command end result
[0m14:05:32.336369 [info ] [MainThread]: 
[0m14:05:32.337515 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:32.338597 [info ] [MainThread]: 
[0m14:05:32.339699 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m14:05:32.341327 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.991478, "process_user_time": 2.954909, "process_kernel_time": 0.174237, "process_mem_max_rss": "121104", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:05:32.342380 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:32.342222 after 6.99 seconds
[0m14:05:32.343186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9821d1760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd98093d250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd97f918ad0>]}
[0m14:05:32.344001 [debug] [MainThread]: Flushing usage events
[0m14:11:48.882942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3241c08830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3240722600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3240371460>]}


============================== 14:11:48.890420 | 944540b8-9503-4149-8388-b55957c678d6 ==============================
[0m14:11:48.890420 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:11:48.891379 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select tag:staging', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:11:49.093549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '944540b8-9503-4149-8388-b55957c678d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3240f9aed0>]}
[0m14:11:49.164904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '944540b8-9503-4149-8388-b55957c678d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32400c6960>]}
[0m14:11:49.166378 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:11:49.264908 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:11:49.403998 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:11:49.404863 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:11:49.446618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '944540b8-9503-4149-8388-b55957c678d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f323f376000>]}
[0m14:11:49.572951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '944540b8-9503-4149-8388-b55957c678d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f323ef9cd10>]}
[0m14:11:49.573819 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m14:11:49.574554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '944540b8-9503-4149-8388-b55957c678d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f323e768aa0>]}
[0m14:11:49.576898 [info ] [MainThread]: 
[0m14:11:49.577999 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:11:49.583422 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m14:11:49.621111 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m14:11:49.621942 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m14:11:49.622728 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:11:49.628314 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.006 seconds
[0m14:11:49.630189 [debug] [ThreadPool]: On list_airflow: Close
[0m14:11:49.631609 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now create_airflow_lead_staging)
[0m14:11:49.632475 [debug] [ThreadPool]: Creating schema "database: "airflow"
schema: "lead_staging"
"
[0m14:11:49.638778 [debug] [ThreadPool]: Using postgres connection "create_airflow_lead_staging"
[0m14:11:49.639584 [debug] [ThreadPool]: On create_airflow_lead_staging: BEGIN
[0m14:11:49.640259 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:11:49.644621 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m14:11:49.645420 [debug] [ThreadPool]: Using postgres connection "create_airflow_lead_staging"
[0m14:11:49.646087 [debug] [ThreadPool]: On create_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "create_airflow_lead_staging"} */
create schema if not exists "lead_staging"
[0m14:11:49.647247 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m14:11:49.648707 [debug] [ThreadPool]: On create_airflow_lead_staging: COMMIT
[0m14:11:49.649399 [debug] [ThreadPool]: Using postgres connection "create_airflow_lead_staging"
[0m14:11:49.650026 [debug] [ThreadPool]: On create_airflow_lead_staging: COMMIT
[0m14:11:49.651443 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m14:11:49.652086 [debug] [ThreadPool]: On create_airflow_lead_staging: Close
[0m14:11:49.654897 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_airflow_lead_staging, now list_airflow_lead_trusted)
[0m14:11:49.662378 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m14:11:49.663287 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m14:11:49.664059 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:11:49.668417 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m14:11:49.669262 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m14:11:49.670100 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m14:11:49.673237 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m14:11:49.675606 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m14:11:49.676571 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m14:11:49.677680 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now list_airflow_lead_staging)
[0m14:11:49.680716 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m14:11:49.681654 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m14:11:49.682367 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:11:49.686552 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m14:11:49.687340 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m14:11:49.688066 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m14:11:49.691263 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m14:11:49.693241 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m14:11:49.694272 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m14:11:49.700741 [debug] [MainThread]: Using postgres connection "master"
[0m14:11:49.701721 [debug] [MainThread]: On master: BEGIN
[0m14:11:49.702529 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:11:49.706740 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m14:11:49.707472 [debug] [MainThread]: Using postgres connection "master"
[0m14:11:49.708276 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:11:49.712255 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m14:11:49.714391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '944540b8-9503-4149-8388-b55957c678d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f323fbe8c80>]}
[0m14:11:49.715308 [debug] [MainThread]: On master: ROLLBACK
[0m14:11:49.716264 [debug] [MainThread]: Using postgres connection "master"
[0m14:11:49.717021 [debug] [MainThread]: On master: BEGIN
[0m14:11:49.718079 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:11:49.718779 [debug] [MainThread]: On master: COMMIT
[0m14:11:49.719495 [debug] [MainThread]: Using postgres connection "master"
[0m14:11:49.720158 [debug] [MainThread]: On master: COMMIT
[0m14:11:49.721068 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:11:49.721821 [debug] [MainThread]: On master: Close
[0m14:11:49.722806 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:11:49.723639 [info ] [MainThread]: 
[0m14:11:49.734427 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_adress
[0m14:11:49.735461 [info ] [Thread-1 (]: 1 of 5 START sql table model lead_staging.dim_address .......................... [RUN]
[0m14:11:49.736322 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now model.dbt_lead_data.staging_dim_adress)
[0m14:11:49.737108 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_adress
[0m14:11:49.746029 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_adress"
[0m14:11:49.748573 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_adress
[0m14:11:49.793007 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_adress"
[0m14:11:49.796075 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m14:11:49.796866 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: BEGIN
[0m14:11:49.797631 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:49.801751 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m14:11:49.802635 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m14:11:49.803342 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */

  
    

  create  table "airflow"."lead_staging"."dim_address__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        address,
        mac_address,
        ip_address
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m14:11:49.906489 [debug] [Thread-1 (]: SQL status: SELECT 100372 in 0.102 seconds
[0m14:11:49.914409 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m14:11:49.915295 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
alter table "airflow"."lead_staging"."dim_address__dbt_tmp" rename to "dim_address"
[0m14:11:49.916496 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:11:49.936562 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m14:11:49.937475 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m14:11:49.938276 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m14:11:49.947675 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m14:11:49.955114 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_address__dbt_backup"
[0m14:11:49.961776 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m14:11:49.962628 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
drop table if exists "airflow"."lead_staging"."dim_address__dbt_backup" cascade
[0m14:11:49.963708 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m14:11:49.966656 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: Close
[0m14:11:49.968661 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '944540b8-9503-4149-8388-b55957c678d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32408a9490>]}
[0m14:11:49.969810 [info ] [Thread-1 (]: 1 of 5 OK created sql table model lead_staging.dim_address ..................... [[32mSELECT 100372[0m in 0.23s]
[0m14:11:49.971018 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_adress
[0m14:11:49.972034 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_date
[0m14:11:49.972966 [info ] [Thread-1 (]: 2 of 5 START sql table model lead_staging.dim_date ............................. [RUN]
[0m14:11:49.974015 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_adress, now model.dbt_lead_data.staging_dim_date)
[0m14:11:49.974798 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_date
[0m14:11:49.978863 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_date"
[0m14:11:49.980984 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_date
[0m14:11:49.985224 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_date"
[0m14:11:49.987326 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m14:11:49.988177 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: BEGIN
[0m14:11:49.988834 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:49.993705 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m14:11:49.994660 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m14:11:49.995512 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */

  
    

  create  table "airflow"."lead_staging"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        accessed_at
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m14:11:50.067239 [debug] [Thread-1 (]: SQL status: SELECT 100372 in 0.071 seconds
[0m14:11:50.071398 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m14:11:50.072267 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
alter table "airflow"."lead_staging"."dim_date__dbt_tmp" rename to "dim_date"
[0m14:11:50.073544 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:11:50.075841 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: COMMIT
[0m14:11:50.076686 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m14:11:50.077409 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: COMMIT
[0m14:11:50.085229 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m14:11:50.088385 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_date__dbt_backup"
[0m14:11:50.089791 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m14:11:50.090625 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
drop table if exists "airflow"."lead_staging"."dim_date__dbt_backup" cascade
[0m14:11:50.091722 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m14:11:50.093718 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: Close
[0m14:11:50.094791 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '944540b8-9503-4149-8388-b55957c678d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f323cf78f80>]}
[0m14:11:50.095798 [info ] [Thread-1 (]: 2 of 5 OK created sql table model lead_staging.dim_date ........................ [[32mSELECT 100372[0m in 0.12s]
[0m14:11:50.096928 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_date
[0m14:11:50.097913 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_finance
[0m14:11:50.098784 [info ] [Thread-1 (]: 3 of 5 START sql table model lead_staging.dim_finance .......................... [RUN]
[0m14:11:50.099700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_date, now model.dbt_lead_data.staging_dim_finance)
[0m14:11:50.100397 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_finance
[0m14:11:50.104106 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_finance"
[0m14:11:50.106225 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_finance
[0m14:11:50.111802 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_finance"
[0m14:11:50.113954 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m14:11:50.114715 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: BEGIN
[0m14:11:50.115485 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:50.120915 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m14:11:50.121855 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m14:11:50.122800 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */

  
    

  create  table "airflow"."lead_staging"."dim_finance__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        iban
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m14:11:50.197515 [debug] [Thread-1 (]: SQL status: SELECT 100372 in 0.074 seconds
[0m14:11:50.201408 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m14:11:50.202319 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
alter table "airflow"."lead_staging"."dim_finance__dbt_tmp" rename to "dim_finance"
[0m14:11:50.203613 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:11:50.205925 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: COMMIT
[0m14:11:50.206800 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m14:11:50.207602 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: COMMIT
[0m14:11:50.215493 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m14:11:50.218570 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_finance__dbt_backup"
[0m14:11:50.219811 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m14:11:50.220593 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
drop table if exists "airflow"."lead_staging"."dim_finance__dbt_backup" cascade
[0m14:11:50.221580 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m14:11:50.223396 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: Close
[0m14:11:50.224320 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '944540b8-9503-4149-8388-b55957c678d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f323cfdac90>]}
[0m14:11:50.225289 [info ] [Thread-1 (]: 3 of 5 OK created sql table model lead_staging.dim_finance ..................... [[32mSELECT 100372[0m in 0.12s]
[0m14:11:50.226473 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_finance
[0m14:11:50.227313 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_person
[0m14:11:50.228185 [info ] [Thread-1 (]: 4 of 5 START sql table model lead_staging.dim_person ........................... [RUN]
[0m14:11:50.229012 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_finance, now model.dbt_lead_data.staging_dim_person)
[0m14:11:50.229658 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_person
[0m14:11:50.233340 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_person"
[0m14:11:50.235420 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_person
[0m14:11:50.239545 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_person"
[0m14:11:50.241417 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m14:11:50.242132 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: BEGIN
[0m14:11:50.242781 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:50.247355 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m14:11:50.248301 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m14:11:50.249148 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */

  
    

  create  table "airflow"."lead_staging"."dim_person__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        person_name,
        user_name,
        email,
        phone,
        birth_date,
        personal_number
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m14:11:50.355184 [debug] [Thread-1 (]: SQL status: SELECT 100372 in 0.105 seconds
[0m14:11:50.359169 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m14:11:50.360032 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
alter table "airflow"."lead_staging"."dim_person__dbt_tmp" rename to "dim_person"
[0m14:11:50.361375 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:11:50.363651 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: COMMIT
[0m14:11:50.364376 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m14:11:50.365170 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: COMMIT
[0m14:11:50.374077 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m14:11:50.377479 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_person__dbt_backup"
[0m14:11:50.378695 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m14:11:50.379386 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
drop table if exists "airflow"."lead_staging"."dim_person__dbt_backup" cascade
[0m14:11:50.380433 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m14:11:50.382361 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: Close
[0m14:11:50.383295 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '944540b8-9503-4149-8388-b55957c678d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f323dbe1b20>]}
[0m14:11:50.384297 [info ] [Thread-1 (]: 4 of 5 OK created sql table model lead_staging.dim_person ...................... [[32mSELECT 100372[0m in 0.15s]
[0m14:11:50.385636 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_person
[0m14:11:50.386534 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_fact_network_usage
[0m14:11:50.387452 [info ] [Thread-1 (]: 5 of 5 START sql table model lead_staging.fact_network_usage ................... [RUN]
[0m14:11:50.388361 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_person, now model.dbt_lead_data.staging_fact_network_usage)
[0m14:11:50.389148 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_fact_network_usage
[0m14:11:50.392924 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_fact_network_usage"
[0m14:11:50.395202 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_fact_network_usage
[0m14:11:50.399363 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_fact_network_usage"
[0m14:11:50.401501 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m14:11:50.402228 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: BEGIN
[0m14:11:50.402890 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:50.407761 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m14:11:50.408747 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m14:11:50.409653 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */

  
    

  create  table "airflow"."lead_staging"."fact_network_usage__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        session_duration,
        download_speed,
        upload_speed,
        consumed_traffic
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m14:11:50.487360 [debug] [Thread-1 (]: SQL status: SELECT 100372 in 0.077 seconds
[0m14:11:50.491177 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m14:11:50.491930 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
alter table "airflow"."lead_staging"."fact_network_usage__dbt_tmp" rename to "fact_network_usage"
[0m14:11:50.493324 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:11:50.495595 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: COMMIT
[0m14:11:50.496312 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m14:11:50.497071 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: COMMIT
[0m14:11:50.503871 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m14:11:50.507301 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."fact_network_usage__dbt_backup"
[0m14:11:50.508576 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m14:11:50.509376 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
drop table if exists "airflow"."lead_staging"."fact_network_usage__dbt_backup" cascade
[0m14:11:50.510480 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m14:11:50.512383 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: Close
[0m14:11:50.513365 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '944540b8-9503-4149-8388-b55957c678d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f323cfab410>]}
[0m14:11:50.514382 [info ] [Thread-1 (]: 5 of 5 OK created sql table model lead_staging.fact_network_usage .............. [[32mSELECT 100372[0m in 0.13s]
[0m14:11:50.515423 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_fact_network_usage
[0m14:11:50.517968 [debug] [MainThread]: Using postgres connection "master"
[0m14:11:50.518735 [debug] [MainThread]: On master: BEGIN
[0m14:11:50.519425 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:11:50.523732 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m14:11:50.524592 [debug] [MainThread]: On master: COMMIT
[0m14:11:50.525385 [debug] [MainThread]: Using postgres connection "master"
[0m14:11:50.526145 [debug] [MainThread]: On master: COMMIT
[0m14:11:50.527078 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:11:50.527817 [debug] [MainThread]: On master: Close
[0m14:11:50.528830 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:11:50.529585 [debug] [MainThread]: Connection 'model.dbt_lead_data.staging_fact_network_usage' was properly closed.
[0m14:11:50.530408 [info ] [MainThread]: 
[0m14:11:50.531196 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.95 seconds (0.95s).
[0m14:11:50.533272 [debug] [MainThread]: Command end result
[0m14:11:50.591088 [info ] [MainThread]: 
[0m14:11:50.592064 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:11:50.592775 [info ] [MainThread]: 
[0m14:11:50.593592 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m14:11:50.594969 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.774586, "process_user_time": 2.997864, "process_kernel_time": 0.197427, "process_mem_max_rss": "125528", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:11:50.595854 [debug] [MainThread]: Command `dbt run` succeeded at 14:11:50.595723 after 1.78 seconds
[0m14:11:50.596606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3241c08830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f323dfc9f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32400c6db0>]}
[0m14:11:50.597464 [debug] [MainThread]: Flushing usage events
[0m14:11:55.335223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe45d722fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe45bcbad50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe45bcb8c50>]}


============================== 14:11:55.343300 | 8f01dfb1-af57-490c-b4d0-437493263dc8 ==============================
[0m14:11:55.343300 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:11:55.344583 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select tag:trusted', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:11:55.610936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8f01dfb1-af57-490c-b4d0-437493263dc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe45b5b5970>]}
[0m14:11:55.695124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8f01dfb1-af57-490c-b4d0-437493263dc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe45c045f70>]}
[0m14:11:55.696423 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:11:55.800346 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:11:55.935202 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:11:55.936042 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:11:55.973773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8f01dfb1-af57-490c-b4d0-437493263dc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe45a534440>]}
[0m14:11:56.109195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8f01dfb1-af57-490c-b4d0-437493263dc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe459924b30>]}
[0m14:11:56.110250 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m14:11:56.111056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f01dfb1-af57-490c-b4d0-437493263dc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe459903170>]}
[0m14:11:56.113671 [info ] [MainThread]: 
[0m14:11:56.114882 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:11:56.122481 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m14:11:56.162398 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m14:11:56.163209 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m14:11:56.163799 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:11:56.169397 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.006 seconds
[0m14:11:56.171465 [debug] [ThreadPool]: On list_airflow: Close
[0m14:11:56.172683 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now create_airflow_lead_trusted)
[0m14:11:56.173535 [debug] [ThreadPool]: Creating schema "database: "airflow"
schema: "lead_trusted"
"
[0m14:11:56.179748 [debug] [ThreadPool]: Using postgres connection "create_airflow_lead_trusted"
[0m14:11:56.180520 [debug] [ThreadPool]: On create_airflow_lead_trusted: BEGIN
[0m14:11:56.181136 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:11:56.185464 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m14:11:56.186215 [debug] [ThreadPool]: Using postgres connection "create_airflow_lead_trusted"
[0m14:11:56.186795 [debug] [ThreadPool]: On create_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "create_airflow_lead_trusted"} */
create schema if not exists "lead_trusted"
[0m14:11:56.187926 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m14:11:56.189284 [debug] [ThreadPool]: On create_airflow_lead_trusted: COMMIT
[0m14:11:56.189875 [debug] [ThreadPool]: Using postgres connection "create_airflow_lead_trusted"
[0m14:11:56.190496 [debug] [ThreadPool]: On create_airflow_lead_trusted: COMMIT
[0m14:11:56.191818 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m14:11:56.192497 [debug] [ThreadPool]: On create_airflow_lead_trusted: Close
[0m14:11:56.195054 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_airflow_lead_trusted, now list_airflow_lead_trusted)
[0m14:11:56.201568 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m14:11:56.202327 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m14:11:56.202888 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:11:56.206904 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m14:11:56.207607 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m14:11:56.208268 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m14:11:56.211467 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m14:11:56.213183 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m14:11:56.214022 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m14:11:56.214923 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now list_airflow_lead_staging)
[0m14:11:56.217400 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m14:11:56.218029 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m14:11:56.218625 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:11:56.222626 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m14:11:56.223281 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m14:11:56.223836 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m14:11:56.226908 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m14:11:56.228876 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m14:11:56.229720 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m14:11:56.236879 [debug] [MainThread]: Using postgres connection "master"
[0m14:11:56.237704 [debug] [MainThread]: On master: BEGIN
[0m14:11:56.238506 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:11:56.242777 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m14:11:56.243615 [debug] [MainThread]: Using postgres connection "master"
[0m14:11:56.244370 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:11:56.247960 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m14:11:56.249860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f01dfb1-af57-490c-b4d0-437493263dc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe45a95c3b0>]}
[0m14:11:56.250726 [debug] [MainThread]: On master: ROLLBACK
[0m14:11:56.251605 [debug] [MainThread]: Using postgres connection "master"
[0m14:11:56.252437 [debug] [MainThread]: On master: BEGIN
[0m14:11:56.253616 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:11:56.254528 [debug] [MainThread]: On master: COMMIT
[0m14:11:56.255338 [debug] [MainThread]: Using postgres connection "master"
[0m14:11:56.256070 [debug] [MainThread]: On master: COMMIT
[0m14:11:56.256976 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:11:56.257767 [debug] [MainThread]: On master: Close
[0m14:11:56.258767 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:11:56.259676 [info ] [MainThread]: 
[0m14:11:56.270167 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_non_pii_data
[0m14:11:56.271215 [info ] [Thread-1 (]: 1 of 4 START sql table model lead_trusted.non_pii_data ......................... [RUN]
[0m14:11:56.272254 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now model.dbt_lead_data.trusted_non_pii_data)
[0m14:11:56.273042 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_non_pii_data
[0m14:11:56.282848 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_non_pii_data"
[0m14:11:56.286418 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_non_pii_data
[0m14:11:56.328398 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_non_pii_data"
[0m14:11:56.330939 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m14:11:56.331553 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: BEGIN
[0m14:11:56.332197 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:56.336241 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m14:11:56.336961 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m14:11:56.337589 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */

  
    

  create  table "airflow"."lead_trusted"."non_pii_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        '***MASKED***' AS person_name,
        SUBSTRING(dp.user_name, 1, 5) || '*****'  user_name,
        SUBSTRING(dp.email, 1, 5) || '*****' AS email,
        '***MASKED***'  AS personal_number, 
        '***MASKED***' AS birth_date, 
        '***MASKED***' AS address,
        '***MASKED***'  AS phone, 
        SUBSTRING(da.mac_address, 1, 5) || '*****' AS mac_address,
        SUBSTRING(da.ip_address, 1, 5) || '*****' AS ip_address,
        SUBSTRING(df.iban, 1, 5) || '*****' AS iban,
        dd.accessed_at,
        fnu.session_duration,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.consumed_traffic,
        fnu.unique_id
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    INNER JOIN
        "airflow"."lead_staging"."dim_address" da ON fnu.unique_id = da.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_date" dd ON da.unique_id = dd.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_finance" df ON dd.unique_id = df.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_person" dp ON df.unique_id = dp.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m14:11:56.830848 [debug] [Thread-1 (]: SQL status: SELECT 100372 in 0.492 seconds
[0m14:11:56.838834 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m14:11:56.839733 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
alter table "airflow"."lead_trusted"."non_pii_data__dbt_tmp" rename to "non_pii_data"
[0m14:11:56.842389 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:11:56.863003 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: COMMIT
[0m14:11:56.864033 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m14:11:56.865004 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: COMMIT
[0m14:11:56.868409 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m14:11:56.875996 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."non_pii_data__dbt_backup"
[0m14:11:56.883226 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m14:11:56.884130 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
drop table if exists "airflow"."lead_trusted"."non_pii_data__dbt_backup" cascade
[0m14:11:56.885284 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m14:11:56.888242 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: Close
[0m14:11:56.890113 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f01dfb1-af57-490c-b4d0-437493263dc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe45c9addf0>]}
[0m14:11:56.891224 [info ] [Thread-1 (]: 1 of 4 OK created sql table model lead_trusted.non_pii_data .................... [[32mSELECT 100372[0m in 0.62s]
[0m14:11:56.892407 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_non_pii_data
[0m14:11:56.893319 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_payment_data
[0m14:11:56.894277 [info ] [Thread-1 (]: 2 of 4 START sql table model lead_trusted.payment_data ......................... [RUN]
[0m14:11:56.895261 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_non_pii_data, now model.dbt_lead_data.trusted_payment_data)
[0m14:11:56.896095 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_payment_data
[0m14:11:56.900174 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_payment_data"
[0m14:11:56.902464 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_payment_data
[0m14:11:56.906605 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_payment_data"
[0m14:11:56.908699 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m14:11:56.909450 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: BEGIN
[0m14:11:56.910171 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:56.915148 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m14:11:56.915986 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m14:11:56.916647 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */

  
    

  create  table "airflow"."lead_trusted"."payment_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        fnu.unique_id,
        df.iban,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.session_duration,
        fnu.consumed_traffic,
        ((fnu.download_speed + fnu.upload_speed + 1)/2) + (fnu.consumed_traffic / (fnu.session_duration + 1)) AS payment_amount
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    JOIN
        "airflow"."lead_staging"."dim_finance" df
    ON
	    fnu.unique_id = df.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m14:11:57.081600 [debug] [Thread-1 (]: SQL status: SELECT 100372 in 0.164 seconds
[0m14:11:57.085549 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m14:11:57.086428 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
alter table "airflow"."lead_trusted"."payment_data__dbt_tmp" rename to "payment_data"
[0m14:11:57.088150 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:11:57.090545 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: COMMIT
[0m14:11:57.091263 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m14:11:57.091998 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: COMMIT
[0m14:11:57.098115 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m14:11:57.101208 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."payment_data__dbt_backup"
[0m14:11:57.102554 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m14:11:57.103376 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
drop table if exists "airflow"."lead_trusted"."payment_data__dbt_backup" cascade
[0m14:11:57.104638 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m14:11:57.106601 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: Close
[0m14:11:57.107546 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f01dfb1-af57-490c-b4d0-437493263dc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe45844c4a0>]}
[0m14:11:57.108761 [info ] [Thread-1 (]: 2 of 4 OK created sql table model lead_trusted.payment_data .................... [[32mSELECT 100372[0m in 0.21s]
[0m14:11:57.111027 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_payment_data
[0m14:11:57.112402 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_pii_data
[0m14:11:57.113493 [info ] [Thread-1 (]: 3 of 4 START sql table model lead_trusted.pii_data ............................. [RUN]
[0m14:11:57.115372 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_payment_data, now model.dbt_lead_data.trusted_pii_data)
[0m14:11:57.116648 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_pii_data
[0m14:11:57.122749 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_pii_data"
[0m14:11:57.125844 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_pii_data
[0m14:11:57.132812 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_pii_data"
[0m14:11:57.135719 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m14:11:57.137445 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: BEGIN
[0m14:11:57.138309 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:57.142790 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m14:11:57.143641 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m14:11:57.144427 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */

  
    

  create  table "airflow"."lead_trusted"."pii_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        dp.person_name,
        dp.user_name,
        dp.email,
        dp.personal_number, 
        dp.birth_date, 
        da.address,
        dp.phone, 
        da.mac_address,
        da.ip_address,
        df.iban,
        dd.accessed_at,
        fnu.session_duration,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.consumed_traffic,
        fnu.unique_id
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    INNER JOIN
        "airflow"."lead_staging"."dim_address" da ON fnu.unique_id = da.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_date" dd ON da.unique_id = dd.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_finance" df ON dd.unique_id = df.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_person" dp ON df.unique_id = dp.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m14:11:57.473077 [debug] [Thread-1 (]: SQL status: SELECT 100372 in 0.328 seconds
[0m14:11:57.476990 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m14:11:57.477723 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */
alter table "airflow"."lead_trusted"."pii_data__dbt_tmp" rename to "pii_data"
[0m14:11:57.478949 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:11:57.481016 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: COMMIT
[0m14:11:57.481708 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m14:11:57.482468 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: COMMIT
[0m14:11:57.486849 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m14:11:57.489840 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."pii_data__dbt_backup"
[0m14:11:57.491108 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m14:11:57.491805 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */
drop table if exists "airflow"."lead_trusted"."pii_data__dbt_backup" cascade
[0m14:11:57.492832 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m14:11:57.494665 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: Close
[0m14:11:57.495653 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f01dfb1-af57-490c-b4d0-437493263dc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe45845d640>]}
[0m14:11:57.496626 [info ] [Thread-1 (]: 3 of 4 OK created sql table model lead_trusted.pii_data ........................ [[32mSELECT 100372[0m in 0.38s]
[0m14:11:57.497650 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_pii_data
[0m14:11:57.498457 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_technical_data
[0m14:11:57.499294 [info ] [Thread-1 (]: 4 of 4 START sql table model lead_trusted.technical_data ....................... [RUN]
[0m14:11:57.500134 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_pii_data, now model.dbt_lead_data.trusted_technical_data)
[0m14:11:57.500785 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_technical_data
[0m14:11:57.504835 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_technical_data"
[0m14:11:57.506994 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_technical_data
[0m14:11:57.510946 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_technical_data"
[0m14:11:57.513176 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m14:11:57.513831 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: BEGIN
[0m14:11:57.514483 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:57.519085 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m14:11:57.519850 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m14:11:57.522184 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */

  
    

  create  table "airflow"."lead_trusted"."technical_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        fnu.unique_id,
        da.address,
        da.mac_address,
        da.ip_address,
        fnu.download_speed,
        fnu.upload_speed,
        ROUND((fnu.session_duration/60), 1) as min_session_duration,
        CASE 
            WHEN fnu.download_speed < 50 OR fnu.upload_speed < 30 OR fnu.session_duration/60 < 1 THEN true
            ELSE false
        END AS technical_issue
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    JOIN
        "airflow"."lead_staging"."dim_address" da
    ON
	    fnu.unique_id = da.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m14:11:57.733170 [debug] [Thread-1 (]: SQL status: SELECT 100372 in 0.210 seconds
[0m14:11:57.736994 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m14:11:57.737725 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
alter table "airflow"."lead_trusted"."technical_data__dbt_tmp" rename to "technical_data"
[0m14:11:57.738869 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:11:57.741132 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: COMMIT
[0m14:11:57.742005 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m14:11:57.742840 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: COMMIT
[0m14:11:57.775269 [debug] [Thread-1 (]: SQL status: COMMIT in 0.031 seconds
[0m14:11:57.778548 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."technical_data__dbt_backup"
[0m14:11:57.779807 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m14:11:57.780616 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
drop table if exists "airflow"."lead_trusted"."technical_data__dbt_backup" cascade
[0m14:11:57.781678 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m14:11:57.783610 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: Close
[0m14:11:57.784554 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f01dfb1-af57-490c-b4d0-437493263dc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4584badb0>]}
[0m14:11:57.785591 [info ] [Thread-1 (]: 4 of 4 OK created sql table model lead_trusted.technical_data .................. [[32mSELECT 100372[0m in 0.28s]
[0m14:11:57.786689 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_technical_data
[0m14:11:57.789179 [debug] [MainThread]: Using postgres connection "master"
[0m14:11:57.789817 [debug] [MainThread]: On master: BEGIN
[0m14:11:57.790491 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:11:57.794547 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m14:11:57.795293 [debug] [MainThread]: On master: COMMIT
[0m14:11:57.795957 [debug] [MainThread]: Using postgres connection "master"
[0m14:11:57.796658 [debug] [MainThread]: On master: COMMIT
[0m14:11:57.797508 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:11:57.798235 [debug] [MainThread]: On master: Close
[0m14:11:57.799094 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:11:57.799731 [debug] [MainThread]: Connection 'model.dbt_lead_data.trusted_technical_data' was properly closed.
[0m14:11:57.800545 [info ] [MainThread]: 
[0m14:11:57.801393 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 1.69 seconds (1.69s).
[0m14:11:57.803300 [debug] [MainThread]: Command end result
[0m14:11:57.854413 [info ] [MainThread]: 
[0m14:11:57.855237 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:11:57.855980 [info ] [MainThread]: 
[0m14:11:57.856904 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m14:11:57.858480 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.5925097, "process_user_time": 3.367491, "process_kernel_time": 0.184714, "process_mem_max_rss": "122996", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:11:57.859360 [debug] [MainThread]: Command `dbt run` succeeded at 14:11:57.859207 after 2.59 seconds
[0m14:11:57.860082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe45b475b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe45a5350d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe45b909af0>]}
[0m14:11:57.860757 [debug] [MainThread]: Flushing usage events
[0m14:23:39.220220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7565a9b2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7565d658e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7565e6c920>]}


============================== 14:23:39.227271 | 3cfd81b0-b42d-47eb-ae85-1a6aa8a02ba6 ==============================
[0m14:23:39.227271 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:23:39.228245 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select tag:staging', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:23:39.439753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3cfd81b0-b42d-47eb-ae85-1a6aa8a02ba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75665e1520>]}
[0m14:23:39.508532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3cfd81b0-b42d-47eb-ae85-1a6aa8a02ba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7565316e70>]}
[0m14:23:39.510340 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:23:39.607071 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:23:39.748917 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:23:39.749878 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:23:39.791584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3cfd81b0-b42d-47eb-ae85-1a6aa8a02ba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7565396990>]}
[0m14:23:39.925348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3cfd81b0-b42d-47eb-ae85-1a6aa8a02ba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f756434d5e0>]}
[0m14:23:39.926236 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m14:23:39.926984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3cfd81b0-b42d-47eb-ae85-1a6aa8a02ba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7564b3d160>]}
[0m14:23:39.929546 [info ] [MainThread]: 
[0m14:23:39.930562 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:23:39.936302 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m14:23:39.975824 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m14:23:39.976842 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m14:23:39.977716 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:23:39.983310 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.006 seconds
[0m14:23:39.985170 [debug] [ThreadPool]: On list_airflow: Close
[0m14:23:39.988020 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_staging)
[0m14:23:39.994946 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m14:23:39.995752 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m14:23:39.996450 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:23:40.000770 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m14:23:40.001619 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m14:23:40.002340 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m14:23:40.005603 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.003 seconds
[0m14:23:40.007592 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m14:23:40.008483 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m14:23:40.009579 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now list_airflow_lead_trusted)
[0m14:23:40.012996 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m14:23:40.013769 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m14:23:40.014548 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:23:40.018634 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m14:23:40.019406 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m14:23:40.020138 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m14:23:40.023335 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m14:23:40.025292 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m14:23:40.026195 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m14:23:40.033481 [debug] [MainThread]: Using postgres connection "master"
[0m14:23:40.034386 [debug] [MainThread]: On master: BEGIN
[0m14:23:40.035139 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:23:40.039340 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m14:23:40.040102 [debug] [MainThread]: Using postgres connection "master"
[0m14:23:40.040973 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:23:40.044766 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m14:23:40.046727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3cfd81b0-b42d-47eb-ae85-1a6aa8a02ba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7564b91ac0>]}
[0m14:23:40.047600 [debug] [MainThread]: On master: ROLLBACK
[0m14:23:40.048501 [debug] [MainThread]: Using postgres connection "master"
[0m14:23:40.049211 [debug] [MainThread]: On master: BEGIN
[0m14:23:40.050295 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:23:40.050983 [debug] [MainThread]: On master: COMMIT
[0m14:23:40.051704 [debug] [MainThread]: Using postgres connection "master"
[0m14:23:40.052407 [debug] [MainThread]: On master: COMMIT
[0m14:23:40.053261 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:23:40.053905 [debug] [MainThread]: On master: Close
[0m14:23:40.054775 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:23:40.055481 [info ] [MainThread]: 
[0m14:23:40.065687 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_adress
[0m14:23:40.066763 [info ] [Thread-1 (]: 1 of 5 START sql table model lead_staging.dim_address .......................... [RUN]
[0m14:23:40.067644 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now model.dbt_lead_data.staging_dim_adress)
[0m14:23:40.068393 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_adress
[0m14:23:40.077420 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_adress"
[0m14:23:40.080184 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_adress
[0m14:23:40.121697 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_adress"
[0m14:23:40.124579 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m14:23:40.125193 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: BEGIN
[0m14:23:40.125750 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:23:40.129659 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m14:23:40.130533 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m14:23:40.131139 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */

  
    

  create  table "airflow"."lead_staging"."dim_address__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        address,
        mac_address,
        ip_address
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m14:23:40.334758 [debug] [Thread-1 (]: SQL status: SELECT 200744 in 0.203 seconds
[0m14:23:40.342074 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m14:23:40.342966 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
alter table "airflow"."lead_staging"."dim_address" rename to "dim_address__dbt_backup"
[0m14:23:40.344223 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:23:40.347832 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m14:23:40.348651 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
alter table "airflow"."lead_staging"."dim_address__dbt_tmp" rename to "dim_address"
[0m14:23:40.349721 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:23:40.370896 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m14:23:40.371682 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m14:23:40.372460 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m14:23:40.385275 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m14:23:40.392447 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_address__dbt_backup"
[0m14:23:40.398861 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m14:23:40.399639 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
drop table if exists "airflow"."lead_staging"."dim_address__dbt_backup" cascade
[0m14:23:40.403562 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m14:23:40.406132 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: Close
[0m14:23:40.408051 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3cfd81b0-b42d-47eb-ae85-1a6aa8a02ba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7566bcdc70>]}
[0m14:23:40.409079 [info ] [Thread-1 (]: 1 of 5 OK created sql table model lead_staging.dim_address ..................... [[32mSELECT 200744[0m in 0.34s]
[0m14:23:40.410405 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_adress
[0m14:23:40.411334 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_date
[0m14:23:40.412499 [info ] [Thread-1 (]: 2 of 5 START sql table model lead_staging.dim_date ............................. [RUN]
[0m14:23:40.413475 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_adress, now model.dbt_lead_data.staging_dim_date)
[0m14:23:40.414208 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_date
[0m14:23:40.417882 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_date"
[0m14:23:40.419914 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_date
[0m14:23:40.423981 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_date"
[0m14:23:40.426053 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m14:23:40.426742 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: BEGIN
[0m14:23:40.427449 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:23:40.433971 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m14:23:40.434960 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m14:23:40.435793 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */

  
    

  create  table "airflow"."lead_staging"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        accessed_at
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m14:23:40.590788 [debug] [Thread-1 (]: SQL status: SELECT 200744 in 0.154 seconds
[0m14:23:40.595564 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m14:23:40.596621 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
alter table "airflow"."lead_staging"."dim_date" rename to "dim_date__dbt_backup"
[0m14:23:40.598209 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:23:40.602717 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m14:23:40.603824 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
alter table "airflow"."lead_staging"."dim_date__dbt_tmp" rename to "dim_date"
[0m14:23:40.605594 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:23:40.608993 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: COMMIT
[0m14:23:40.609997 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m14:23:40.610938 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: COMMIT
[0m14:23:40.613249 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:23:40.617274 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_date__dbt_backup"
[0m14:23:40.618748 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m14:23:40.619702 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
drop table if exists "airflow"."lead_staging"."dim_date__dbt_backup" cascade
[0m14:23:40.623510 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m14:23:40.625871 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: Close
[0m14:23:40.627224 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3cfd81b0-b42d-47eb-ae85-1a6aa8a02ba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f756278df70>]}
[0m14:23:40.628654 [info ] [Thread-1 (]: 2 of 5 OK created sql table model lead_staging.dim_date ........................ [[32mSELECT 200744[0m in 0.21s]
[0m14:23:40.630028 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_date
[0m14:23:40.631316 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_finance
[0m14:23:40.632548 [info ] [Thread-1 (]: 3 of 5 START sql table model lead_staging.dim_finance .......................... [RUN]
[0m14:23:40.633726 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_date, now model.dbt_lead_data.staging_dim_finance)
[0m14:23:40.634695 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_finance
[0m14:23:40.639270 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_finance"
[0m14:23:40.642427 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_finance
[0m14:23:40.649566 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_finance"
[0m14:23:40.652684 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m14:23:40.653835 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: BEGIN
[0m14:23:40.654791 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:23:40.660090 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m14:23:40.661005 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m14:23:40.661848 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */

  
    

  create  table "airflow"."lead_staging"."dim_finance__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        iban
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m14:23:40.836415 [debug] [Thread-1 (]: SQL status: SELECT 200744 in 0.174 seconds
[0m14:23:40.840214 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m14:23:40.841117 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
alter table "airflow"."lead_staging"."dim_finance" rename to "dim_finance__dbt_backup"
[0m14:23:40.842397 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:23:40.845988 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m14:23:40.846850 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
alter table "airflow"."lead_staging"."dim_finance__dbt_tmp" rename to "dim_finance"
[0m14:23:40.847994 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:23:40.850813 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: COMMIT
[0m14:23:40.851539 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m14:23:40.852166 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: COMMIT
[0m14:23:40.854561 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:23:40.857143 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_finance__dbt_backup"
[0m14:23:40.858492 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m14:23:40.859149 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
drop table if exists "airflow"."lead_staging"."dim_finance__dbt_backup" cascade
[0m14:23:40.862489 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m14:23:40.864335 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: Close
[0m14:23:40.865360 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3cfd81b0-b42d-47eb-ae85-1a6aa8a02ba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75626d4560>]}
[0m14:23:40.866291 [info ] [Thread-1 (]: 3 of 5 OK created sql table model lead_staging.dim_finance ..................... [[32mSELECT 200744[0m in 0.23s]
[0m14:23:40.867323 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_finance
[0m14:23:40.868118 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_person
[0m14:23:40.868911 [info ] [Thread-1 (]: 4 of 5 START sql table model lead_staging.dim_person ........................... [RUN]
[0m14:23:40.869830 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_finance, now model.dbt_lead_data.staging_dim_person)
[0m14:23:40.870527 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_person
[0m14:23:40.874023 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_person"
[0m14:23:40.876004 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_person
[0m14:23:40.880275 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_person"
[0m14:23:40.882014 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m14:23:40.882695 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: BEGIN
[0m14:23:40.883342 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:23:40.887610 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m14:23:40.888535 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m14:23:40.889229 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */

  
    

  create  table "airflow"."lead_staging"."dim_person__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        person_name,
        user_name,
        email,
        phone,
        birth_date,
        personal_number
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m14:23:41.106322 [debug] [Thread-1 (]: SQL status: SELECT 200744 in 0.216 seconds
[0m14:23:41.110030 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m14:23:41.110819 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
alter table "airflow"."lead_staging"."dim_person" rename to "dim_person__dbt_backup"
[0m14:23:41.112098 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:23:41.115407 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m14:23:41.116166 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
alter table "airflow"."lead_staging"."dim_person__dbt_tmp" rename to "dim_person"
[0m14:23:41.117355 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:23:41.119586 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: COMMIT
[0m14:23:41.120266 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m14:23:41.120936 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: COMMIT
[0m14:23:41.128706 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m14:23:41.131935 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_person__dbt_backup"
[0m14:23:41.133071 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m14:23:41.133800 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
drop table if exists "airflow"."lead_staging"."dim_person__dbt_backup" cascade
[0m14:23:41.137840 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m14:23:41.139609 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: Close
[0m14:23:41.140494 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3cfd81b0-b42d-47eb-ae85-1a6aa8a02ba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f756279a6c0>]}
[0m14:23:41.141502 [info ] [Thread-1 (]: 4 of 5 OK created sql table model lead_staging.dim_person ...................... [[32mSELECT 200744[0m in 0.27s]
[0m14:23:41.142570 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_person
[0m14:23:41.143371 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_fact_network_usage
[0m14:23:41.144250 [info ] [Thread-1 (]: 5 of 5 START sql table model lead_staging.fact_network_usage ................... [RUN]
[0m14:23:41.145130 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_person, now model.dbt_lead_data.staging_fact_network_usage)
[0m14:23:41.145804 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_fact_network_usage
[0m14:23:41.149513 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_fact_network_usage"
[0m14:23:41.151805 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_fact_network_usage
[0m14:23:41.155705 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_fact_network_usage"
[0m14:23:41.157845 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m14:23:41.158510 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: BEGIN
[0m14:23:41.159134 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:23:41.163624 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m14:23:41.164478 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m14:23:41.165248 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */

  
    

  create  table "airflow"."lead_staging"."fact_network_usage__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        session_duration,
        download_speed,
        upload_speed,
        consumed_traffic
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m14:23:41.348993 [debug] [Thread-1 (]: SQL status: SELECT 200744 in 0.183 seconds
[0m14:23:41.354294 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m14:23:41.355172 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
alter table "airflow"."lead_staging"."fact_network_usage" rename to "fact_network_usage__dbt_backup"
[0m14:23:41.356514 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:23:41.360078 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m14:23:41.360873 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
alter table "airflow"."lead_staging"."fact_network_usage__dbt_tmp" rename to "fact_network_usage"
[0m14:23:41.362373 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:23:41.365012 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: COMMIT
[0m14:23:41.365825 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m14:23:41.366594 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: COMMIT
[0m14:23:41.370633 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m14:23:41.373602 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."fact_network_usage__dbt_backup"
[0m14:23:41.374908 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m14:23:41.375770 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
drop table if exists "airflow"."lead_staging"."fact_network_usage__dbt_backup" cascade
[0m14:23:41.378961 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m14:23:41.381159 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: Close
[0m14:23:41.382256 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3cfd81b0-b42d-47eb-ae85-1a6aa8a02ba6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f756267b200>]}
[0m14:23:41.383217 [info ] [Thread-1 (]: 5 of 5 OK created sql table model lead_staging.fact_network_usage .............. [[32mSELECT 200744[0m in 0.24s]
[0m14:23:41.384295 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_fact_network_usage
[0m14:23:41.386653 [debug] [MainThread]: Using postgres connection "master"
[0m14:23:41.387349 [debug] [MainThread]: On master: BEGIN
[0m14:23:41.387970 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:23:41.392192 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m14:23:41.392883 [debug] [MainThread]: On master: COMMIT
[0m14:23:41.393583 [debug] [MainThread]: Using postgres connection "master"
[0m14:23:41.394271 [debug] [MainThread]: On master: COMMIT
[0m14:23:41.395112 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:23:41.395765 [debug] [MainThread]: On master: Close
[0m14:23:41.396624 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:23:41.397353 [debug] [MainThread]: Connection 'model.dbt_lead_data.staging_fact_network_usage' was properly closed.
[0m14:23:41.398215 [info ] [MainThread]: 
[0m14:23:41.398935 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 1.47 seconds (1.47s).
[0m14:23:41.400848 [debug] [MainThread]: Command end result
[0m14:23:41.450894 [info ] [MainThread]: 
[0m14:23:41.451680 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:23:41.452523 [info ] [MainThread]: 
[0m14:23:41.453543 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m14:23:41.455786 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.2984161, "process_user_time": 3.005834, "process_kernel_time": 0.178063, "process_mem_max_rss": "123080", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:23:41.457101 [debug] [MainThread]: Command `dbt run` succeeded at 14:23:41.456853 after 2.30 seconds
[0m14:23:41.457814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f756644b0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7563b1a7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75626c94f0>]}
[0m14:23:41.458605 [debug] [MainThread]: Flushing usage events
[0m14:23:45.433444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c6664740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c62436b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c6426690>]}


============================== 14:23:45.439970 | 30b5fbd7-fa5c-43f0-873e-2cd9a0ff5144 ==============================
[0m14:23:45.439970 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:23:45.440923 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select tag:trusted', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:23:45.620875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '30b5fbd7-fa5c-43f0-873e-2cd9a0ff5144', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c6ef1700>]}
[0m14:23:45.688030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '30b5fbd7-fa5c-43f0-873e-2cd9a0ff5144', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c6d4bc20>]}
[0m14:23:45.689415 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:23:45.785542 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:23:45.923518 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:23:45.924347 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:23:45.964799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '30b5fbd7-fa5c-43f0-873e-2cd9a0ff5144', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c53ab740>]}
[0m14:23:46.082527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '30b5fbd7-fa5c-43f0-873e-2cd9a0ff5144', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c477d0d0>]}
[0m14:23:46.083199 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m14:23:46.083767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30b5fbd7-fa5c-43f0-873e-2cd9a0ff5144', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c53684d0>]}
[0m14:23:46.085689 [info ] [MainThread]: 
[0m14:23:46.086602 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:23:46.091037 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m14:23:46.128236 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m14:23:46.129031 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m14:23:46.129668 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:23:46.134512 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.005 seconds
[0m14:23:46.136143 [debug] [ThreadPool]: On list_airflow: Close
[0m14:23:46.138735 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_staging)
[0m14:23:46.145279 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m14:23:46.146124 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m14:23:46.146868 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:23:46.151074 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m14:23:46.151773 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m14:23:46.152415 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m14:23:46.155359 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m14:23:46.157207 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m14:23:46.158018 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m14:23:46.159035 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now list_airflow_lead_trusted)
[0m14:23:46.162321 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m14:23:46.162967 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m14:23:46.163678 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:23:46.167342 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m14:23:46.167947 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m14:23:46.168588 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m14:23:46.171574 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m14:23:46.173289 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m14:23:46.174126 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m14:23:46.181023 [debug] [MainThread]: Using postgres connection "master"
[0m14:23:46.181798 [debug] [MainThread]: On master: BEGIN
[0m14:23:46.182508 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:23:46.186346 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m14:23:46.187063 [debug] [MainThread]: Using postgres connection "master"
[0m14:23:46.187809 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:23:46.191483 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m14:23:46.193339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30b5fbd7-fa5c-43f0-873e-2cd9a0ff5144', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c3bd9100>]}
[0m14:23:46.194192 [debug] [MainThread]: On master: ROLLBACK
[0m14:23:46.195093 [debug] [MainThread]: Using postgres connection "master"
[0m14:23:46.195793 [debug] [MainThread]: On master: BEGIN
[0m14:23:46.196900 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:23:46.197636 [debug] [MainThread]: On master: COMMIT
[0m14:23:46.198291 [debug] [MainThread]: Using postgres connection "master"
[0m14:23:46.198916 [debug] [MainThread]: On master: COMMIT
[0m14:23:46.199738 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:23:46.200467 [debug] [MainThread]: On master: Close
[0m14:23:46.201293 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:23:46.201980 [info ] [MainThread]: 
[0m14:23:46.211921 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_non_pii_data
[0m14:23:46.212808 [info ] [Thread-1 (]: 1 of 4 START sql table model lead_trusted.non_pii_data ......................... [RUN]
[0m14:23:46.213728 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now model.dbt_lead_data.trusted_non_pii_data)
[0m14:23:46.214411 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_non_pii_data
[0m14:23:46.223965 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_non_pii_data"
[0m14:23:46.226466 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_non_pii_data
[0m14:23:46.266525 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_non_pii_data"
[0m14:23:46.268886 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m14:23:46.269460 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: BEGIN
[0m14:23:46.269957 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:23:46.273649 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m14:23:46.274338 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m14:23:46.275103 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */

  
    

  create  table "airflow"."lead_trusted"."non_pii_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        '***MASKED***' AS person_name,
        SUBSTRING(dp.user_name, 1, 5) || '*****'  user_name,
        SUBSTRING(dp.email, 1, 5) || '*****' AS email,
        '***MASKED***'  AS personal_number, 
        '***MASKED***' AS birth_date, 
        '***MASKED***' AS address,
        '***MASKED***'  AS phone, 
        SUBSTRING(da.mac_address, 1, 5) || '*****' AS mac_address,
        SUBSTRING(da.ip_address, 1, 5) || '*****' AS ip_address,
        SUBSTRING(df.iban, 1, 5) || '*****' AS iban,
        dd.accessed_at,
        fnu.session_duration,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.consumed_traffic,
        fnu.unique_id
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    INNER JOIN
        "airflow"."lead_staging"."dim_address" da ON fnu.unique_id = da.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_date" dd ON da.unique_id = dd.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_finance" df ON dd.unique_id = df.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_person" dp ON df.unique_id = dp.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m14:23:49.578493 [debug] [Thread-1 (]: SQL status: SELECT 200744 in 3.303 seconds
[0m14:23:49.587790 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m14:23:49.588572 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
alter table "airflow"."lead_trusted"."non_pii_data" rename to "non_pii_data__dbt_backup"
[0m14:23:49.589688 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:23:49.593004 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m14:23:49.593698 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
alter table "airflow"."lead_trusted"."non_pii_data__dbt_tmp" rename to "non_pii_data"
[0m14:23:49.594616 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:23:49.613347 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: COMMIT
[0m14:23:49.614114 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m14:23:49.614928 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: COMMIT
[0m14:23:49.620019 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m14:23:49.627754 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."non_pii_data__dbt_backup"
[0m14:23:49.634262 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m14:23:49.634923 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
drop table if exists "airflow"."lead_trusted"."non_pii_data__dbt_backup" cascade
[0m14:23:49.639082 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m14:23:49.641789 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: Close
[0m14:23:49.643502 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30b5fbd7-fa5c-43f0-873e-2cd9a0ff5144', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c3b5cef0>]}
[0m14:23:49.644451 [info ] [Thread-1 (]: 1 of 4 OK created sql table model lead_trusted.non_pii_data .................... [[32mSELECT 200744[0m in 3.43s]
[0m14:23:49.645614 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_non_pii_data
[0m14:23:49.646428 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_payment_data
[0m14:23:49.647302 [info ] [Thread-1 (]: 2 of 4 START sql table model lead_trusted.payment_data ......................... [RUN]
[0m14:23:49.648120 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_non_pii_data, now model.dbt_lead_data.trusted_payment_data)
[0m14:23:49.648764 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_payment_data
[0m14:23:49.652715 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_payment_data"
[0m14:23:49.654976 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_payment_data
[0m14:23:49.659040 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_payment_data"
[0m14:23:49.661244 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m14:23:49.661900 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: BEGIN
[0m14:23:49.662646 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:23:49.667063 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m14:23:49.667924 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m14:23:49.668734 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */

  
    

  create  table "airflow"."lead_trusted"."payment_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        fnu.unique_id,
        df.iban,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.session_duration,
        fnu.consumed_traffic,
        ((fnu.download_speed + fnu.upload_speed + 1)/2) + (fnu.consumed_traffic / (fnu.session_duration + 1)) AS payment_amount
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    JOIN
        "airflow"."lead_staging"."dim_finance" df
    ON
	    fnu.unique_id = df.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m14:23:50.737749 [debug] [Thread-1 (]: SQL status: SELECT 200744 in 1.068 seconds
[0m14:23:50.741753 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m14:23:50.742536 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
alter table "airflow"."lead_trusted"."payment_data" rename to "payment_data__dbt_backup"
[0m14:23:50.743586 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:23:50.747186 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m14:23:50.747907 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
alter table "airflow"."lead_trusted"."payment_data__dbt_tmp" rename to "payment_data"
[0m14:23:50.749068 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:23:50.751541 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: COMMIT
[0m14:23:50.752309 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m14:23:50.752989 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: COMMIT
[0m14:23:50.754419 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:23:50.757120 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."payment_data__dbt_backup"
[0m14:23:50.758362 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m14:23:50.759257 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
drop table if exists "airflow"."lead_trusted"."payment_data__dbt_backup" cascade
[0m14:23:50.762897 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m14:23:50.764849 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: Close
[0m14:23:50.765870 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30b5fbd7-fa5c-43f0-873e-2cd9a0ff5144', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c2e2fb90>]}
[0m14:23:50.766833 [info ] [Thread-1 (]: 2 of 4 OK created sql table model lead_trusted.payment_data .................... [[32mSELECT 200744[0m in 1.12s]
[0m14:23:50.767863 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_payment_data
[0m14:23:50.768685 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_pii_data
[0m14:23:50.769574 [info ] [Thread-1 (]: 3 of 4 START sql table model lead_trusted.pii_data ............................. [RUN]
[0m14:23:50.770430 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_payment_data, now model.dbt_lead_data.trusted_pii_data)
[0m14:23:50.771179 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_pii_data
[0m14:23:50.775946 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_pii_data"
[0m14:23:50.778489 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_pii_data
[0m14:23:50.784075 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_pii_data"
[0m14:23:50.786367 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m14:23:50.787025 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: BEGIN
[0m14:23:50.787780 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:23:50.792482 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m14:23:50.793338 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m14:23:50.794140 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */

  
    

  create  table "airflow"."lead_trusted"."pii_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        dp.person_name,
        dp.user_name,
        dp.email,
        dp.personal_number, 
        dp.birth_date, 
        da.address,
        dp.phone, 
        da.mac_address,
        da.ip_address,
        df.iban,
        dd.accessed_at,
        fnu.session_duration,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.consumed_traffic,
        fnu.unique_id
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    INNER JOIN
        "airflow"."lead_staging"."dim_address" da ON fnu.unique_id = da.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_date" dd ON da.unique_id = dd.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_finance" df ON dd.unique_id = df.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_person" dp ON df.unique_id = dp.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m14:23:54.555851 [debug] [Thread-1 (]: SQL status: SELECT 200744 in 3.761 seconds
[0m14:23:54.560356 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m14:23:54.561175 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */
alter table "airflow"."lead_trusted"."pii_data" rename to "pii_data__dbt_backup"
[0m14:23:54.562432 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:23:54.565789 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m14:23:54.566489 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */
alter table "airflow"."lead_trusted"."pii_data__dbt_tmp" rename to "pii_data"
[0m14:23:54.567427 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:23:54.569786 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: COMMIT
[0m14:23:54.570652 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m14:23:54.571257 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: COMMIT
[0m14:23:54.584247 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m14:23:54.587477 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."pii_data__dbt_backup"
[0m14:23:54.588882 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m14:23:54.589746 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */
drop table if exists "airflow"."lead_trusted"."pii_data__dbt_backup" cascade
[0m14:23:54.595417 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m14:23:54.597534 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: Close
[0m14:23:54.598617 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30b5fbd7-fa5c-43f0-873e-2cd9a0ff5144', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c2e2d0d0>]}
[0m14:23:54.599675 [info ] [Thread-1 (]: 3 of 4 OK created sql table model lead_trusted.pii_data ........................ [[32mSELECT 200744[0m in 3.83s]
[0m14:23:54.600828 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_pii_data
[0m14:23:54.601687 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_technical_data
[0m14:23:54.602573 [info ] [Thread-1 (]: 4 of 4 START sql table model lead_trusted.technical_data ....................... [RUN]
[0m14:23:54.603511 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_pii_data, now model.dbt_lead_data.trusted_technical_data)
[0m14:23:54.604230 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_technical_data
[0m14:23:54.608372 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_technical_data"
[0m14:23:54.611182 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_technical_data
[0m14:23:54.615610 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_technical_data"
[0m14:23:54.618201 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m14:23:54.618918 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: BEGIN
[0m14:23:54.619687 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:23:54.626078 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m14:23:54.626947 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m14:23:54.627825 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */

  
    

  create  table "airflow"."lead_trusted"."technical_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        fnu.unique_id,
        da.address,
        da.mac_address,
        da.ip_address,
        fnu.download_speed,
        fnu.upload_speed,
        ROUND((fnu.session_duration/60), 1) as min_session_duration,
        CASE 
            WHEN fnu.download_speed < 50 OR fnu.upload_speed < 30 OR fnu.session_duration/60 < 1 THEN true
            ELSE false
        END AS technical_issue
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    JOIN
        "airflow"."lead_staging"."dim_address" da
    ON
	    fnu.unique_id = da.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m14:23:55.968625 [debug] [Thread-1 (]: SQL status: SELECT 200744 in 1.339 seconds
[0m14:23:55.973735 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m14:23:55.974875 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
alter table "airflow"."lead_trusted"."technical_data" rename to "technical_data__dbt_backup"
[0m14:23:55.976967 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:23:55.982530 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m14:23:55.983741 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
alter table "airflow"."lead_trusted"."technical_data__dbt_tmp" rename to "technical_data"
[0m14:23:55.985544 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:23:55.988840 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: COMMIT
[0m14:23:55.990004 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m14:23:55.990911 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: COMMIT
[0m14:23:56.005223 [debug] [Thread-1 (]: SQL status: COMMIT in 0.013 seconds
[0m14:23:56.009040 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."technical_data__dbt_backup"
[0m14:23:56.010661 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m14:23:56.012328 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
drop table if exists "airflow"."lead_trusted"."technical_data__dbt_backup" cascade
[0m14:23:56.020799 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m14:23:56.024878 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: Close
[0m14:23:56.027311 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30b5fbd7-fa5c-43f0-873e-2cd9a0ff5144', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c3b5d310>]}
[0m14:23:56.029792 [info ] [Thread-1 (]: 4 of 4 OK created sql table model lead_trusted.technical_data .................. [[32mSELECT 200744[0m in 1.42s]
[0m14:23:56.032262 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_technical_data
[0m14:23:56.036434 [debug] [MainThread]: Using postgres connection "master"
[0m14:23:56.037887 [debug] [MainThread]: On master: BEGIN
[0m14:23:56.039410 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:23:56.047393 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m14:23:56.049111 [debug] [MainThread]: On master: COMMIT
[0m14:23:56.050697 [debug] [MainThread]: Using postgres connection "master"
[0m14:23:56.052799 [debug] [MainThread]: On master: COMMIT
[0m14:23:56.054950 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:23:56.056865 [debug] [MainThread]: On master: Close
[0m14:23:56.058361 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:23:56.059251 [debug] [MainThread]: Connection 'model.dbt_lead_data.trusted_technical_data' was properly closed.
[0m14:23:56.060488 [info ] [MainThread]: 
[0m14:23:56.061545 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 9.97 seconds (9.97s).
[0m14:23:56.063816 [debug] [MainThread]: Command end result
[0m14:23:56.129425 [info ] [MainThread]: 
[0m14:23:56.130605 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:23:56.131973 [info ] [MainThread]: 
[0m14:23:56.133794 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m14:23:56.135488 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.757971, "process_user_time": 2.846444, "process_kernel_time": 0.167021, "process_mem_max_rss": "123088", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:23:56.136524 [debug] [MainThread]: Command `dbt run` succeeded at 14:23:56.136385 after 10.76 seconds
[0m14:23:56.137343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c602b0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c5fdd760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82c680d670>]}
[0m14:23:56.138151 [debug] [MainThread]: Flushing usage events
[0m14:27:42.814699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfb88aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cf77d880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cf354800>]}


============================== 14:27:42.821171 | 96edab7a-839a-405e-ab52-2e44ebc671bd ==============================
[0m14:27:42.821171 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:27:42.822030 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select tag:staging', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:27:43.021643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '96edab7a-839a-405e-ab52-2e44ebc671bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77d02716a0>]}
[0m14:27:43.086849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '96edab7a-839a-405e-ab52-2e44ebc671bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cee86090>]}
[0m14:27:43.088011 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:27:43.189009 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:27:43.334184 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:27:43.335021 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:27:43.378167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '96edab7a-839a-405e-ab52-2e44ebc671bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77ce368140>]}
[0m14:27:43.525253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '96edab7a-839a-405e-ab52-2e44ebc671bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77ce3b15e0>]}
[0m14:27:43.526241 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m14:27:43.527117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96edab7a-839a-405e-ab52-2e44ebc671bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cef94350>]}
[0m14:27:43.530062 [info ] [MainThread]: 
[0m14:27:43.531123 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:27:43.537415 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m14:27:43.578051 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m14:27:43.578940 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m14:27:43.579674 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:27:43.585376 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.006 seconds
[0m14:27:43.587395 [debug] [ThreadPool]: On list_airflow: Close
[0m14:27:43.590203 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_trusted)
[0m14:27:43.597298 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m14:27:43.598226 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m14:27:43.598961 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:27:43.603292 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m14:27:43.604051 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m14:27:43.604725 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m14:27:43.611658 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.006 seconds
[0m14:27:43.613630 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m14:27:43.614485 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m14:27:43.615520 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now list_airflow_lead_staging)
[0m14:27:43.618929 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m14:27:43.619609 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m14:27:43.620250 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:27:43.624792 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m14:27:43.625614 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m14:27:43.626294 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m14:27:43.629613 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.003 seconds
[0m14:27:43.631653 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m14:27:43.632538 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m14:27:43.640324 [debug] [MainThread]: Using postgres connection "master"
[0m14:27:43.641235 [debug] [MainThread]: On master: BEGIN
[0m14:27:43.642110 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:27:43.646541 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m14:27:43.647316 [debug] [MainThread]: Using postgres connection "master"
[0m14:27:43.648192 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:27:43.652088 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m14:27:43.654165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96edab7a-839a-405e-ab52-2e44ebc671bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77ce362a20>]}
[0m14:27:43.655077 [debug] [MainThread]: On master: ROLLBACK
[0m14:27:43.656032 [debug] [MainThread]: Using postgres connection "master"
[0m14:27:43.656776 [debug] [MainThread]: On master: BEGIN
[0m14:27:43.657906 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:27:43.658608 [debug] [MainThread]: On master: COMMIT
[0m14:27:43.659238 [debug] [MainThread]: Using postgres connection "master"
[0m14:27:43.659908 [debug] [MainThread]: On master: COMMIT
[0m14:27:43.660811 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:27:43.661598 [debug] [MainThread]: On master: Close
[0m14:27:43.662441 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:27:43.663222 [info ] [MainThread]: 
[0m14:27:43.674168 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_adress
[0m14:27:43.675152 [info ] [Thread-1 (]: 1 of 5 START sql table model lead_staging.dim_address .......................... [RUN]
[0m14:27:43.676224 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now model.dbt_lead_data.staging_dim_adress)
[0m14:27:43.677018 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_adress
[0m14:27:43.686630 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_adress"
[0m14:27:43.688786 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_adress
[0m14:27:43.734177 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_adress"
[0m14:27:43.736643 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m14:27:43.737456 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: BEGIN
[0m14:27:43.738176 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:27:43.742407 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m14:27:43.743211 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m14:27:43.744059 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */

  
    

  create  table "airflow"."lead_staging"."dim_address__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        address,
        mac_address,
        ip_address
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m14:27:44.057031 [debug] [Thread-1 (]: SQL status: SELECT 301116 in 0.312 seconds
[0m14:27:44.064477 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m14:27:44.065328 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
alter table "airflow"."lead_staging"."dim_address" rename to "dim_address__dbt_backup"
[0m14:27:44.066721 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:27:44.070208 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m14:27:44.071002 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
alter table "airflow"."lead_staging"."dim_address__dbt_tmp" rename to "dim_address"
[0m14:27:44.072101 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:27:44.094014 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m14:27:44.095066 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m14:27:44.096920 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m14:27:44.102109 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m14:27:44.109590 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_address__dbt_backup"
[0m14:27:44.116250 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m14:27:44.117082 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
drop table if exists "airflow"."lead_staging"."dim_address__dbt_backup" cascade
[0m14:27:44.122475 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m14:27:44.125529 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: Close
[0m14:27:44.127382 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96edab7a-839a-405e-ab52-2e44ebc671bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77d0852210>]}
[0m14:27:44.128549 [info ] [Thread-1 (]: 1 of 5 OK created sql table model lead_staging.dim_address ..................... [[32mSELECT 301116[0m in 0.45s]
[0m14:27:44.129839 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_adress
[0m14:27:44.130681 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_date
[0m14:27:44.131534 [info ] [Thread-1 (]: 2 of 5 START sql table model lead_staging.dim_date ............................. [RUN]
[0m14:27:44.132373 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_adress, now model.dbt_lead_data.staging_dim_date)
[0m14:27:44.133141 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_date
[0m14:27:44.137068 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_date"
[0m14:27:44.139160 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_date
[0m14:27:44.143177 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_date"
[0m14:27:44.145336 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m14:27:44.146076 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: BEGIN
[0m14:27:44.146732 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:27:44.151409 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m14:27:44.152233 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m14:27:44.152993 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */

  
    

  create  table "airflow"."lead_staging"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        accessed_at
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m14:27:44.392676 [debug] [Thread-1 (]: SQL status: SELECT 301116 in 0.239 seconds
[0m14:27:44.396537 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m14:27:44.397397 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
alter table "airflow"."lead_staging"."dim_date" rename to "dim_date__dbt_backup"
[0m14:27:44.398498 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:27:44.402337 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m14:27:44.403251 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
alter table "airflow"."lead_staging"."dim_date__dbt_tmp" rename to "dim_date"
[0m14:27:44.404535 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:27:44.406993 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: COMMIT
[0m14:27:44.407724 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m14:27:44.408491 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: COMMIT
[0m14:27:44.409740 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:27:44.412800 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_date__dbt_backup"
[0m14:27:44.413985 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m14:27:44.414721 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
drop table if exists "airflow"."lead_staging"."dim_date__dbt_backup" cascade
[0m14:27:44.418518 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m14:27:44.420535 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: Close
[0m14:27:44.421706 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96edab7a-839a-405e-ab52-2e44ebc671bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cc290470>]}
[0m14:27:44.422647 [info ] [Thread-1 (]: 2 of 5 OK created sql table model lead_staging.dim_date ........................ [[32mSELECT 301116[0m in 0.29s]
[0m14:27:44.423785 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_date
[0m14:27:44.424678 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_finance
[0m14:27:44.425609 [info ] [Thread-1 (]: 3 of 5 START sql table model lead_staging.dim_finance .......................... [RUN]
[0m14:27:44.426478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_date, now model.dbt_lead_data.staging_dim_finance)
[0m14:27:44.427133 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_finance
[0m14:27:44.430907 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_finance"
[0m14:27:44.432828 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_finance
[0m14:27:44.438327 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_finance"
[0m14:27:44.440172 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m14:27:44.440871 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: BEGIN
[0m14:27:44.441549 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:27:44.446098 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m14:27:44.446899 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m14:27:44.447575 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */

  
    

  create  table "airflow"."lead_staging"."dim_finance__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        iban
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m14:27:44.672205 [debug] [Thread-1 (]: SQL status: SELECT 301116 in 0.224 seconds
[0m14:27:44.675999 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m14:27:44.676803 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
alter table "airflow"."lead_staging"."dim_finance" rename to "dim_finance__dbt_backup"
[0m14:27:44.678098 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:27:44.681602 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m14:27:44.682433 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
alter table "airflow"."lead_staging"."dim_finance__dbt_tmp" rename to "dim_finance"
[0m14:27:44.683548 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:27:44.686045 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: COMMIT
[0m14:27:44.686819 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m14:27:44.687534 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: COMMIT
[0m14:27:44.695872 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m14:27:44.698797 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_finance__dbt_backup"
[0m14:27:44.700117 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m14:27:44.701090 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
drop table if exists "airflow"."lead_staging"."dim_finance__dbt_backup" cascade
[0m14:27:44.705398 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m14:27:44.707268 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: Close
[0m14:27:44.708235 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96edab7a-839a-405e-ab52-2e44ebc671bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cc12dfa0>]}
[0m14:27:44.709228 [info ] [Thread-1 (]: 3 of 5 OK created sql table model lead_staging.dim_finance ..................... [[32mSELECT 301116[0m in 0.28s]
[0m14:27:44.710277 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_finance
[0m14:27:44.711318 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_person
[0m14:27:44.712241 [info ] [Thread-1 (]: 4 of 5 START sql table model lead_staging.dim_person ........................... [RUN]
[0m14:27:44.713093 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_finance, now model.dbt_lead_data.staging_dim_person)
[0m14:27:44.713776 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_person
[0m14:27:44.717474 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_person"
[0m14:27:44.720216 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_person
[0m14:27:44.724792 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_person"
[0m14:27:44.726707 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m14:27:44.727484 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: BEGIN
[0m14:27:44.728252 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:27:44.733749 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m14:27:44.734636 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m14:27:44.735475 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */

  
    

  create  table "airflow"."lead_staging"."dim_person__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        person_name,
        user_name,
        email,
        phone,
        birth_date,
        personal_number
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m14:27:45.066156 [debug] [Thread-1 (]: SQL status: SELECT 301116 in 0.330 seconds
[0m14:27:45.069926 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m14:27:45.070656 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
alter table "airflow"."lead_staging"."dim_person" rename to "dim_person__dbt_backup"
[0m14:27:45.071834 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:27:45.074757 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m14:27:45.075445 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
alter table "airflow"."lead_staging"."dim_person__dbt_tmp" rename to "dim_person"
[0m14:27:45.076477 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:27:45.078872 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: COMMIT
[0m14:27:45.079679 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m14:27:45.080295 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: COMMIT
[0m14:27:45.100190 [debug] [Thread-1 (]: SQL status: COMMIT in 0.019 seconds
[0m14:27:45.103439 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_person__dbt_backup"
[0m14:27:45.104662 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m14:27:45.105473 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
drop table if exists "airflow"."lead_staging"."dim_person__dbt_backup" cascade
[0m14:27:45.110994 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m14:27:45.112908 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: Close
[0m14:27:45.113887 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96edab7a-839a-405e-ab52-2e44ebc671bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cc355130>]}
[0m14:27:45.114971 [info ] [Thread-1 (]: 4 of 5 OK created sql table model lead_staging.dim_person ...................... [[32mSELECT 301116[0m in 0.40s]
[0m14:27:45.116099 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_person
[0m14:27:45.116927 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_fact_network_usage
[0m14:27:45.117778 [info ] [Thread-1 (]: 5 of 5 START sql table model lead_staging.fact_network_usage ................... [RUN]
[0m14:27:45.118587 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_person, now model.dbt_lead_data.staging_fact_network_usage)
[0m14:27:45.119244 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_fact_network_usage
[0m14:27:45.122815 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_fact_network_usage"
[0m14:27:45.124813 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_fact_network_usage
[0m14:27:45.128605 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_fact_network_usage"
[0m14:27:45.131012 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m14:27:45.131823 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: BEGIN
[0m14:27:45.132557 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:27:45.137217 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m14:27:45.138120 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m14:27:45.138938 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */

  
    

  create  table "airflow"."lead_staging"."fact_network_usage__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        session_duration,
        download_speed,
        upload_speed,
        consumed_traffic
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m14:27:45.394571 [debug] [Thread-1 (]: SQL status: SELECT 301116 in 0.255 seconds
[0m14:27:45.400871 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m14:27:45.401989 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
alter table "airflow"."lead_staging"."fact_network_usage" rename to "fact_network_usage__dbt_backup"
[0m14:27:45.403600 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:27:45.408250 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m14:27:45.409309 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
alter table "airflow"."lead_staging"."fact_network_usage__dbt_tmp" rename to "fact_network_usage"
[0m14:27:45.410861 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:27:45.413935 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: COMMIT
[0m14:27:45.414957 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m14:27:45.415941 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: COMMIT
[0m14:27:45.426878 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m14:27:45.430866 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."fact_network_usage__dbt_backup"
[0m14:27:45.432607 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m14:27:45.433614 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
drop table if exists "airflow"."lead_staging"."fact_network_usage__dbt_backup" cascade
[0m14:27:45.438648 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m14:27:45.441131 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: Close
[0m14:27:45.442600 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96edab7a-839a-405e-ab52-2e44ebc671bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cc126060>]}
[0m14:27:45.443835 [info ] [Thread-1 (]: 5 of 5 OK created sql table model lead_staging.fact_network_usage .............. [[32mSELECT 301116[0m in 0.32s]
[0m14:27:45.445337 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_fact_network_usage
[0m14:27:45.448455 [debug] [MainThread]: Using postgres connection "master"
[0m14:27:45.449573 [debug] [MainThread]: On master: BEGIN
[0m14:27:45.450549 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:27:45.456060 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m14:27:45.457202 [debug] [MainThread]: On master: COMMIT
[0m14:27:45.458108 [debug] [MainThread]: Using postgres connection "master"
[0m14:27:45.459069 [debug] [MainThread]: On master: COMMIT
[0m14:27:45.460227 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:27:45.461318 [debug] [MainThread]: On master: Close
[0m14:27:45.462552 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:27:45.463475 [debug] [MainThread]: Connection 'model.dbt_lead_data.staging_fact_network_usage' was properly closed.
[0m14:27:45.464558 [info ] [MainThread]: 
[0m14:27:45.465551 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 1.93 seconds (1.93s).
[0m14:27:45.468313 [debug] [MainThread]: Command end result
[0m14:27:45.530776 [info ] [MainThread]: 
[0m14:27:45.531865 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:27:45.532759 [info ] [MainThread]: 
[0m14:27:45.533783 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m14:27:45.535250 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.7752595, "process_user_time": 2.851377, "process_kernel_time": 0.171769, "process_mem_max_rss": "123020", "process_in_blocks": "224", "process_out_blocks": "0"}
[0m14:27:45.536193 [debug] [MainThread]: Command `dbt run` succeeded at 14:27:45.536060 after 2.78 seconds
[0m14:27:45.536969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cf6872f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfb8a990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77cfa02f30>]}
[0m14:27:45.537829 [debug] [MainThread]: Flushing usage events
[0m14:27:49.287009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b0ea3b860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b0c3ec230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b0e4defc0>]}


============================== 14:27:49.294491 | 36452075-25b9-4c73-bbea-cd9361cdf71f ==============================
[0m14:27:49.294491 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:27:49.295640 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select tag:trusted', 'send_anonymous_usage_stats': 'True'}
[0m14:27:49.537540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '36452075-25b9-4c73-bbea-cd9361cdf71f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b0d1753d0>]}
[0m14:27:49.621439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '36452075-25b9-4c73-bbea-cd9361cdf71f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b0d1287d0>]}
[0m14:27:49.628197 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:27:49.730762 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:27:49.885026 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:27:49.886093 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:27:49.933756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '36452075-25b9-4c73-bbea-cd9361cdf71f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b0b3ac470>]}
[0m14:27:50.095884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '36452075-25b9-4c73-bbea-cd9361cdf71f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b0ab4d790>]}
[0m14:27:50.097282 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m14:27:50.098439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36452075-25b9-4c73-bbea-cd9361cdf71f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b0af2bd40>]}
[0m14:27:50.102489 [info ] [MainThread]: 
[0m14:27:50.104676 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:27:50.112508 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m14:27:50.156546 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m14:27:50.157301 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m14:27:50.157977 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:27:50.164090 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.006 seconds
[0m14:27:50.166200 [debug] [ThreadPool]: On list_airflow: Close
[0m14:27:50.169274 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_staging)
[0m14:27:50.176631 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m14:27:50.177496 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m14:27:50.178166 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:27:50.182706 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m14:27:50.183596 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m14:27:50.184273 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m14:27:50.187451 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m14:27:50.189782 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m14:27:50.190658 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m14:27:50.191795 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now list_airflow_lead_trusted)
[0m14:27:50.195488 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m14:27:50.196794 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m14:27:50.197609 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:27:50.202148 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m14:27:50.203194 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m14:27:50.204173 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m14:27:50.207693 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m14:27:50.209652 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m14:27:50.210570 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m14:27:50.218872 [debug] [MainThread]: Using postgres connection "master"
[0m14:27:50.219970 [debug] [MainThread]: On master: BEGIN
[0m14:27:50.221147 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:27:50.226323 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m14:27:50.227586 [debug] [MainThread]: Using postgres connection "master"
[0m14:27:50.228704 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:27:50.233369 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m14:27:50.236218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36452075-25b9-4c73-bbea-cd9361cdf71f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b092a0260>]}
[0m14:27:50.237572 [debug] [MainThread]: On master: ROLLBACK
[0m14:27:50.238757 [debug] [MainThread]: Using postgres connection "master"
[0m14:27:50.239758 [debug] [MainThread]: On master: BEGIN
[0m14:27:50.241040 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:27:50.241901 [debug] [MainThread]: On master: COMMIT
[0m14:27:50.242820 [debug] [MainThread]: Using postgres connection "master"
[0m14:27:50.243774 [debug] [MainThread]: On master: COMMIT
[0m14:27:50.245415 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:27:50.246587 [debug] [MainThread]: On master: Close
[0m14:27:50.248275 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:27:50.249558 [info ] [MainThread]: 
[0m14:27:50.262100 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_non_pii_data
[0m14:27:50.263746 [info ] [Thread-1 (]: 1 of 4 START sql table model lead_trusted.non_pii_data ......................... [RUN]
[0m14:27:50.265341 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now model.dbt_lead_data.trusted_non_pii_data)
[0m14:27:50.266606 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_non_pii_data
[0m14:27:50.280237 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_non_pii_data"
[0m14:27:50.283390 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_non_pii_data
[0m14:27:50.335972 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_non_pii_data"
[0m14:27:50.339762 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m14:27:50.340653 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: BEGIN
[0m14:27:50.341633 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:27:50.346448 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m14:27:50.347540 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m14:27:50.348537 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */

  
    

  create  table "airflow"."lead_trusted"."non_pii_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        '***MASKED***' AS person_name,
        SUBSTRING(dp.user_name, 1, 5) || '*****'  user_name,
        SUBSTRING(dp.email, 1, 5) || '*****' AS email,
        '***MASKED***'  AS personal_number, 
        '***MASKED***' AS birth_date, 
        '***MASKED***' AS address,
        '***MASKED***'  AS phone, 
        SUBSTRING(da.mac_address, 1, 5) || '*****' AS mac_address,
        SUBSTRING(da.ip_address, 1, 5) || '*****' AS ip_address,
        SUBSTRING(df.iban, 1, 5) || '*****' AS iban,
        dd.accessed_at,
        fnu.session_duration,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.consumed_traffic,
        fnu.unique_id
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    INNER JOIN
        "airflow"."lead_staging"."dim_address" da ON fnu.unique_id = da.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_date" dd ON da.unique_id = dd.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_finance" df ON dd.unique_id = df.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_person" dp ON df.unique_id = dp.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m14:27:55.801766 [debug] [Thread-1 (]: SQL status: SELECT 301116 in 5.452 seconds
[0m14:27:55.809440 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m14:27:55.810331 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
alter table "airflow"."lead_trusted"."non_pii_data" rename to "non_pii_data__dbt_backup"
[0m14:27:55.811790 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:27:55.815392 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m14:27:55.816138 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
alter table "airflow"."lead_trusted"."non_pii_data__dbt_tmp" rename to "non_pii_data"
[0m14:27:55.817460 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:27:55.841473 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: COMMIT
[0m14:27:55.842403 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m14:27:55.843189 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: COMMIT
[0m14:27:55.848328 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m14:27:55.856461 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."non_pii_data__dbt_backup"
[0m14:27:55.863638 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m14:27:55.864549 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
drop table if exists "airflow"."lead_trusted"."non_pii_data__dbt_backup" cascade
[0m14:27:55.871522 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m14:27:55.874604 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: Close
[0m14:27:55.876942 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36452075-25b9-4c73-bbea-cd9361cdf71f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b0d775eb0>]}
[0m14:27:55.878358 [info ] [Thread-1 (]: 1 of 4 OK created sql table model lead_trusted.non_pii_data .................... [[32mSELECT 301116[0m in 5.61s]
[0m14:27:55.879607 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_non_pii_data
[0m14:27:55.880543 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_payment_data
[0m14:27:55.881577 [info ] [Thread-1 (]: 2 of 4 START sql table model lead_trusted.payment_data ......................... [RUN]
[0m14:27:55.882509 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_non_pii_data, now model.dbt_lead_data.trusted_payment_data)
[0m14:27:55.883254 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_payment_data
[0m14:27:55.887903 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_payment_data"
[0m14:27:55.891080 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_payment_data
[0m14:27:55.895563 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_payment_data"
[0m14:27:55.898240 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m14:27:55.899132 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: BEGIN
[0m14:27:55.899935 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:27:55.906109 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m14:27:55.906981 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m14:27:55.907758 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */

  
    

  create  table "airflow"."lead_trusted"."payment_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        fnu.unique_id,
        df.iban,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.session_duration,
        fnu.consumed_traffic,
        ((fnu.download_speed + fnu.upload_speed + 1)/2) + (fnu.consumed_traffic / (fnu.session_duration + 1)) AS payment_amount
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    JOIN
        "airflow"."lead_staging"."dim_finance" df
    ON
	    fnu.unique_id = df.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m14:27:57.688383 [debug] [Thread-1 (]: SQL status: SELECT 301116 in 1.779 seconds
[0m14:27:57.692188 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m14:27:57.692831 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
alter table "airflow"."lead_trusted"."payment_data" rename to "payment_data__dbt_backup"
[0m14:27:57.694192 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:27:57.697841 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m14:27:57.698741 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
alter table "airflow"."lead_trusted"."payment_data__dbt_tmp" rename to "payment_data"
[0m14:27:57.699970 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:27:57.702745 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: COMMIT
[0m14:27:57.703587 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m14:27:57.704299 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: COMMIT
[0m14:27:57.727157 [debug] [Thread-1 (]: SQL status: COMMIT in 0.022 seconds
[0m14:27:57.730548 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."payment_data__dbt_backup"
[0m14:27:57.731805 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m14:27:57.732592 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
drop table if exists "airflow"."lead_trusted"."payment_data__dbt_backup" cascade
[0m14:27:57.736978 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m14:27:57.738988 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: Close
[0m14:27:57.740006 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36452075-25b9-4c73-bbea-cd9361cdf71f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b09134170>]}
[0m14:27:57.741067 [info ] [Thread-1 (]: 2 of 4 OK created sql table model lead_trusted.payment_data .................... [[32mSELECT 301116[0m in 1.86s]
[0m14:27:57.742117 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_payment_data
[0m14:27:57.743001 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_pii_data
[0m14:27:57.743779 [info ] [Thread-1 (]: 3 of 4 START sql table model lead_trusted.pii_data ............................. [RUN]
[0m14:27:57.744664 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_payment_data, now model.dbt_lead_data.trusted_pii_data)
[0m14:27:57.745443 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_pii_data
[0m14:27:57.750494 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_pii_data"
[0m14:27:57.752792 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_pii_data
[0m14:27:57.758686 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_pii_data"
[0m14:27:57.760653 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m14:27:57.761431 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: BEGIN
[0m14:27:57.762153 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:27:57.767224 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m14:27:57.768121 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m14:27:57.768841 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */

  
    

  create  table "airflow"."lead_trusted"."pii_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        dp.person_name,
        dp.user_name,
        dp.email,
        dp.personal_number, 
        dp.birth_date, 
        da.address,
        dp.phone, 
        da.mac_address,
        da.ip_address,
        df.iban,
        dd.accessed_at,
        fnu.session_duration,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.consumed_traffic,
        fnu.unique_id
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    INNER JOIN
        "airflow"."lead_staging"."dim_address" da ON fnu.unique_id = da.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_date" dd ON da.unique_id = dd.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_finance" df ON dd.unique_id = df.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_person" dp ON df.unique_id = dp.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m14:28:03.539631 [debug] [Thread-1 (]: SQL status: SELECT 301116 in 5.770 seconds
[0m14:28:03.543539 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m14:28:03.544324 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */
alter table "airflow"."lead_trusted"."pii_data" rename to "pii_data__dbt_backup"
[0m14:28:03.545669 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:28:03.549293 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m14:28:03.550029 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */
alter table "airflow"."lead_trusted"."pii_data__dbt_tmp" rename to "pii_data"
[0m14:28:03.551128 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:28:03.553586 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: COMMIT
[0m14:28:03.554328 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m14:28:03.554996 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: COMMIT
[0m14:28:03.557605 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:28:03.560577 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."pii_data__dbt_backup"
[0m14:28:03.561890 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m14:28:03.562738 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */
drop table if exists "airflow"."lead_trusted"."pii_data__dbt_backup" cascade
[0m14:28:03.569987 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m14:28:03.572077 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: Close
[0m14:28:03.572970 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36452075-25b9-4c73-bbea-cd9361cdf71f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b091dd0a0>]}
[0m14:28:03.573881 [info ] [Thread-1 (]: 3 of 4 OK created sql table model lead_trusted.pii_data ........................ [[32mSELECT 301116[0m in 5.83s]
[0m14:28:03.574981 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_pii_data
[0m14:28:03.576015 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_technical_data
[0m14:28:03.576972 [info ] [Thread-1 (]: 4 of 4 START sql table model lead_trusted.technical_data ....................... [RUN]
[0m14:28:03.577963 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_pii_data, now model.dbt_lead_data.trusted_technical_data)
[0m14:28:03.578660 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_technical_data
[0m14:28:03.582700 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_technical_data"
[0m14:28:03.584983 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_technical_data
[0m14:28:03.589171 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_technical_data"
[0m14:28:03.591274 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m14:28:03.591958 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: BEGIN
[0m14:28:03.592696 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:28:03.597441 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m14:28:03.598336 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m14:28:03.599141 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */

  
    

  create  table "airflow"."lead_trusted"."technical_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        fnu.unique_id,
        da.address,
        da.mac_address,
        da.ip_address,
        fnu.download_speed,
        fnu.upload_speed,
        ROUND((fnu.session_duration/60), 1) as min_session_duration,
        CASE 
            WHEN fnu.download_speed < 50 OR fnu.upload_speed < 30 OR fnu.session_duration/60 < 1 THEN true
            ELSE false
        END AS technical_issue
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    JOIN
        "airflow"."lead_staging"."dim_address" da
    ON
	    fnu.unique_id = da.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m14:28:04.054299 [debug] [Thread-1 (]: SQL status: SELECT 301116 in 0.454 seconds
[0m14:28:04.058392 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m14:28:04.059139 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
alter table "airflow"."lead_trusted"."technical_data" rename to "technical_data__dbt_backup"
[0m14:28:04.060252 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:28:04.063709 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m14:28:04.064447 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
alter table "airflow"."lead_trusted"."technical_data__dbt_tmp" rename to "technical_data"
[0m14:28:04.065445 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:28:04.067901 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: COMMIT
[0m14:28:04.068711 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m14:28:04.069431 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: COMMIT
[0m14:28:04.074782 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m14:28:04.077787 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."technical_data__dbt_backup"
[0m14:28:04.079109 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m14:28:04.079835 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
drop table if exists "airflow"."lead_trusted"."technical_data__dbt_backup" cascade
[0m14:28:04.084093 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m14:28:04.085982 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: Close
[0m14:28:04.086946 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36452075-25b9-4c73-bbea-cd9361cdf71f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b091e1490>]}
[0m14:28:04.087841 [info ] [Thread-1 (]: 4 of 4 OK created sql table model lead_trusted.technical_data .................. [[32mSELECT 301116[0m in 0.51s]
[0m14:28:04.088868 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_technical_data
[0m14:28:04.090990 [debug] [MainThread]: Using postgres connection "master"
[0m14:28:04.091691 [debug] [MainThread]: On master: BEGIN
[0m14:28:04.092378 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:28:04.096519 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m14:28:04.097279 [debug] [MainThread]: On master: COMMIT
[0m14:28:04.097978 [debug] [MainThread]: Using postgres connection "master"
[0m14:28:04.098649 [debug] [MainThread]: On master: COMMIT
[0m14:28:04.099557 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:28:04.100301 [debug] [MainThread]: On master: Close
[0m14:28:04.101205 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:28:04.101951 [debug] [MainThread]: Connection 'model.dbt_lead_data.trusted_technical_data' was properly closed.
[0m14:28:04.102905 [info ] [MainThread]: 
[0m14:28:04.103663 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 14.00 seconds (14.00s).
[0m14:28:04.105496 [debug] [MainThread]: Command end result
[0m14:28:04.159970 [info ] [MainThread]: 
[0m14:28:04.161481 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:28:04.163992 [info ] [MainThread]: 
[0m14:28:04.165229 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m14:28:04.166952 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.941043, "process_user_time": 3.02282, "process_kernel_time": 0.152555, "process_mem_max_rss": "123268", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:28:04.167932 [debug] [MainThread]: Command `dbt run` succeeded at 14:28:04.167736 after 14.94 seconds
[0m14:28:04.168620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b0ce70c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b0ab978c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b091ef620>]}
[0m14:28:04.169377 [debug] [MainThread]: Flushing usage events
[0m14:28:54.839855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94e2074080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94e22564e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94e3bac950>]}


============================== 14:28:54.846775 | 6880870f-b8bd-4aa5-bde7-780c93f6990c ==============================
[0m14:28:54.846775 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:28:54.847733 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select tag:staging', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:28:55.029900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6880870f-b8bd-4aa5-bde7-780c93f6990c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94e2f33170>]}
[0m14:28:55.091094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6880870f-b8bd-4aa5-bde7-780c93f6990c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94e2074050>]}
[0m14:28:55.092374 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:28:55.176107 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:28:55.291974 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:28:55.292669 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:28:55.328010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6880870f-b8bd-4aa5-bde7-780c93f6990c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94e1377d40>]}
[0m14:28:55.458676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6880870f-b8bd-4aa5-bde7-780c93f6990c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94e0fa1b50>]}
[0m14:28:55.459645 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m14:28:55.460392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6880870f-b8bd-4aa5-bde7-780c93f6990c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94e0b4cc50>]}
[0m14:28:55.462753 [info ] [MainThread]: 
[0m14:28:55.463701 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:28:55.469080 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m14:28:55.507139 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m14:28:55.507923 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m14:28:55.508618 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:28:55.515867 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.007 seconds
[0m14:28:55.517682 [debug] [ThreadPool]: On list_airflow: Close
[0m14:28:55.520301 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_staging)
[0m14:28:55.526805 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m14:28:55.527496 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m14:28:55.528145 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:28:55.532144 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m14:28:55.532916 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m14:28:55.533656 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m14:28:55.536682 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m14:28:55.538435 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m14:28:55.539194 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m14:28:55.540179 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now list_airflow_lead_trusted)
[0m14:28:55.543512 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m14:28:55.544103 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m14:28:55.544755 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:28:55.548849 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m14:28:55.549523 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m14:28:55.550135 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m14:28:55.553232 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m14:28:55.555045 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m14:28:55.555837 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m14:28:55.562576 [debug] [MainThread]: Using postgres connection "master"
[0m14:28:55.563250 [debug] [MainThread]: On master: BEGIN
[0m14:28:55.563879 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:28:55.567968 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m14:28:55.568722 [debug] [MainThread]: Using postgres connection "master"
[0m14:28:55.569460 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:28:55.572867 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m14:28:55.574690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6880870f-b8bd-4aa5-bde7-780c93f6990c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94e0ba1c70>]}
[0m14:28:55.575496 [debug] [MainThread]: On master: ROLLBACK
[0m14:28:55.576309 [debug] [MainThread]: Using postgres connection "master"
[0m14:28:55.576952 [debug] [MainThread]: On master: BEGIN
[0m14:28:55.577977 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:28:55.578778 [debug] [MainThread]: On master: COMMIT
[0m14:28:55.579458 [debug] [MainThread]: Using postgres connection "master"
[0m14:28:55.580080 [debug] [MainThread]: On master: COMMIT
[0m14:28:55.580931 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:28:55.581626 [debug] [MainThread]: On master: Close
[0m14:28:55.582485 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:28:55.583366 [info ] [MainThread]: 
[0m14:28:55.593479 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_adress
[0m14:28:55.594354 [info ] [Thread-1 (]: 1 of 5 START sql table model lead_staging.dim_address .......................... [RUN]
[0m14:28:55.595183 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now model.dbt_lead_data.staging_dim_adress)
[0m14:28:55.595938 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_adress
[0m14:28:55.604656 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_adress"
[0m14:28:55.607082 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_adress
[0m14:28:55.650838 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_adress"
[0m14:28:55.653529 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m14:28:55.654254 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: BEGIN
[0m14:28:55.654886 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:28:55.659324 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m14:28:55.660154 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m14:28:55.660905 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */

  
    

  create  table "airflow"."lead_staging"."dim_address__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        address,
        mac_address,
        ip_address
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m14:28:56.353993 [debug] [Thread-1 (]: SQL status: SELECT 501860 in 0.692 seconds
[0m14:28:56.361442 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m14:28:56.362438 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
alter table "airflow"."lead_staging"."dim_address" rename to "dim_address__dbt_backup"
[0m14:28:56.363855 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:28:56.367792 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m14:28:56.368611 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
alter table "airflow"."lead_staging"."dim_address__dbt_tmp" rename to "dim_address"
[0m14:28:56.369849 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:28:56.391855 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m14:28:56.392632 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m14:28:56.393348 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m14:28:56.397278 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m14:28:56.404057 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_address__dbt_backup"
[0m14:28:56.410309 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m14:28:56.411084 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
drop table if exists "airflow"."lead_staging"."dim_address__dbt_backup" cascade
[0m14:28:56.417811 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m14:28:56.420854 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: Close
[0m14:28:56.422673 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6880870f-b8bd-4aa5-bde7-780c93f6990c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94e3519fa0>]}
[0m14:28:56.423798 [info ] [Thread-1 (]: 1 of 5 OK created sql table model lead_staging.dim_address ..................... [[32mSELECT 501860[0m in 0.83s]
[0m14:28:56.424887 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_adress
[0m14:28:56.425663 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_date
[0m14:28:56.426490 [info ] [Thread-1 (]: 2 of 5 START sql table model lead_staging.dim_date ............................. [RUN]
[0m14:28:56.427339 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_adress, now model.dbt_lead_data.staging_dim_date)
[0m14:28:56.428013 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_date
[0m14:28:56.431756 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_date"
[0m14:28:56.433845 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_date
[0m14:28:56.438077 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_date"
[0m14:28:56.439913 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m14:28:56.440588 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: BEGIN
[0m14:28:56.441280 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:28:56.446161 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m14:28:56.447089 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m14:28:56.447803 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */

  
    

  create  table "airflow"."lead_staging"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        accessed_at
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m14:28:56.875180 [debug] [Thread-1 (]: SQL status: SELECT 501860 in 0.427 seconds
[0m14:28:56.879113 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m14:28:56.879960 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
alter table "airflow"."lead_staging"."dim_date" rename to "dim_date__dbt_backup"
[0m14:28:56.881166 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:28:56.884574 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m14:28:56.885376 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
alter table "airflow"."lead_staging"."dim_date__dbt_tmp" rename to "dim_date"
[0m14:28:56.886544 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:28:56.889021 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: COMMIT
[0m14:28:56.889831 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m14:28:56.890558 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: COMMIT
[0m14:28:56.922674 [debug] [Thread-1 (]: SQL status: COMMIT in 0.031 seconds
[0m14:28:56.925992 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_date__dbt_backup"
[0m14:28:56.927210 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m14:28:56.927908 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
drop table if exists "airflow"."lead_staging"."dim_date__dbt_backup" cascade
[0m14:28:56.930689 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m14:28:56.932580 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: Close
[0m14:28:56.933531 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6880870f-b8bd-4aa5-bde7-780c93f6990c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94dee08170>]}
[0m14:28:56.934538 [info ] [Thread-1 (]: 2 of 5 OK created sql table model lead_staging.dim_date ........................ [[32mSELECT 501860[0m in 0.51s]
[0m14:28:56.935648 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_date
[0m14:28:56.936614 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_finance
[0m14:28:56.937500 [info ] [Thread-1 (]: 3 of 5 START sql table model lead_staging.dim_finance .......................... [RUN]
[0m14:28:56.938396 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_date, now model.dbt_lead_data.staging_dim_finance)
[0m14:28:56.939107 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_finance
[0m14:28:56.942848 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_finance"
[0m14:28:56.945181 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_finance
[0m14:28:56.951301 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_finance"
[0m14:28:56.954058 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m14:28:56.954942 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: BEGIN
[0m14:28:56.955951 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:28:56.960613 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m14:28:56.961568 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m14:28:56.962537 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */

  
    

  create  table "airflow"."lead_staging"."dim_finance__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        iban
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m14:28:57.426264 [debug] [Thread-1 (]: SQL status: SELECT 501860 in 0.463 seconds
[0m14:28:57.430109 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m14:28:57.430990 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
alter table "airflow"."lead_staging"."dim_finance" rename to "dim_finance__dbt_backup"
[0m14:28:57.432324 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:28:57.436048 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m14:28:57.436864 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
alter table "airflow"."lead_staging"."dim_finance__dbt_tmp" rename to "dim_finance"
[0m14:28:57.437994 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:28:57.440518 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: COMMIT
[0m14:28:57.441314 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m14:28:57.442043 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: COMMIT
[0m14:28:57.449397 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m14:28:57.452549 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_finance__dbt_backup"
[0m14:28:57.453891 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m14:28:57.454583 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
drop table if exists "airflow"."lead_staging"."dim_finance__dbt_backup" cascade
[0m14:28:57.457224 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m14:28:57.459090 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: Close
[0m14:28:57.459988 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6880870f-b8bd-4aa5-bde7-780c93f6990c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94dee30e00>]}
[0m14:28:57.460961 [info ] [Thread-1 (]: 3 of 5 OK created sql table model lead_staging.dim_finance ..................... [[32mSELECT 501860[0m in 0.52s]
[0m14:28:57.462054 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_finance
[0m14:28:57.463016 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_person
[0m14:28:57.463908 [info ] [Thread-1 (]: 4 of 5 START sql table model lead_staging.dim_person ........................... [RUN]
[0m14:28:57.464732 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_finance, now model.dbt_lead_data.staging_dim_person)
[0m14:28:57.465471 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_person
[0m14:28:57.469172 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_person"
[0m14:28:57.471294 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_person
[0m14:28:57.475544 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_person"
[0m14:28:57.478075 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m14:28:57.478962 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: BEGIN
[0m14:28:57.479652 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:28:57.485117 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m14:28:57.486136 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m14:28:57.486988 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */

  
    

  create  table "airflow"."lead_staging"."dim_person__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        person_name,
        user_name,
        email,
        phone,
        birth_date,
        personal_number
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m14:28:58.131221 [debug] [Thread-1 (]: SQL status: SELECT 501860 in 0.643 seconds
[0m14:28:58.135560 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m14:28:58.136841 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
alter table "airflow"."lead_staging"."dim_person" rename to "dim_person__dbt_backup"
[0m14:28:58.138284 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:28:58.142797 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m14:28:58.143656 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
alter table "airflow"."lead_staging"."dim_person__dbt_tmp" rename to "dim_person"
[0m14:28:58.145199 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:28:58.147644 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: COMMIT
[0m14:28:58.148495 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m14:28:58.149359 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: COMMIT
[0m14:28:58.173607 [debug] [Thread-1 (]: SQL status: COMMIT in 0.023 seconds
[0m14:28:58.177018 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_person__dbt_backup"
[0m14:28:58.178238 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m14:28:58.179049 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
drop table if exists "airflow"."lead_staging"."dim_person__dbt_backup" cascade
[0m14:28:58.185903 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m14:28:58.187760 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: Close
[0m14:28:58.188712 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6880870f-b8bd-4aa5-bde7-780c93f6990c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94dfbce900>]}
[0m14:28:58.189725 [info ] [Thread-1 (]: 4 of 5 OK created sql table model lead_staging.dim_person ...................... [[32mSELECT 501860[0m in 0.72s]
[0m14:28:58.190901 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_person
[0m14:28:58.191758 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_fact_network_usage
[0m14:28:58.192561 [info ] [Thread-1 (]: 5 of 5 START sql table model lead_staging.fact_network_usage ................... [RUN]
[0m14:28:58.193472 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_person, now model.dbt_lead_data.staging_fact_network_usage)
[0m14:28:58.194245 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_fact_network_usage
[0m14:28:58.198116 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_fact_network_usage"
[0m14:28:58.200459 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_fact_network_usage
[0m14:28:58.204723 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_fact_network_usage"
[0m14:28:58.207077 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m14:28:58.207786 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: BEGIN
[0m14:28:58.208409 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:28:58.213114 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m14:28:58.213913 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m14:28:58.214627 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */

  
    

  create  table "airflow"."lead_staging"."fact_network_usage__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        session_duration,
        download_speed,
        upload_speed,
        consumed_traffic
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m14:28:58.846373 [debug] [Thread-1 (]: SQL status: SELECT 501860 in 0.631 seconds
[0m14:28:58.851887 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m14:28:58.852840 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
alter table "airflow"."lead_staging"."fact_network_usage" rename to "fact_network_usage__dbt_backup"
[0m14:28:58.854103 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:28:58.857693 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m14:28:58.858504 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
alter table "airflow"."lead_staging"."fact_network_usage__dbt_tmp" rename to "fact_network_usage"
[0m14:28:58.859636 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:28:58.862037 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: COMMIT
[0m14:28:58.862850 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m14:28:58.863575 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: COMMIT
[0m14:28:58.865778 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:28:58.869024 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."fact_network_usage__dbt_backup"
[0m14:28:58.870317 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m14:28:58.871067 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
drop table if exists "airflow"."lead_staging"."fact_network_usage__dbt_backup" cascade
[0m14:28:58.875168 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m14:28:58.877056 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: Close
[0m14:28:58.878084 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6880870f-b8bd-4aa5-bde7-780c93f6990c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94dee11e20>]}
[0m14:28:58.879124 [info ] [Thread-1 (]: 5 of 5 OK created sql table model lead_staging.fact_network_usage .............. [[32mSELECT 501860[0m in 0.68s]
[0m14:28:58.880214 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_fact_network_usage
[0m14:28:58.882642 [debug] [MainThread]: Using postgres connection "master"
[0m14:28:58.883421 [debug] [MainThread]: On master: BEGIN
[0m14:28:58.884112 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:28:58.888246 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m14:28:58.888982 [debug] [MainThread]: On master: COMMIT
[0m14:28:58.889671 [debug] [MainThread]: Using postgres connection "master"
[0m14:28:58.890463 [debug] [MainThread]: On master: COMMIT
[0m14:28:58.891374 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:28:58.892081 [debug] [MainThread]: On master: Close
[0m14:28:58.892894 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:28:58.893490 [debug] [MainThread]: Connection 'model.dbt_lead_data.staging_fact_network_usage' was properly closed.
[0m14:28:58.894372 [info ] [MainThread]: 
[0m14:28:58.895175 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 3.43 seconds (3.43s).
[0m14:28:58.897383 [debug] [MainThread]: Command end result
[0m14:28:58.954474 [info ] [MainThread]: 
[0m14:28:58.955375 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:28:58.956155 [info ] [MainThread]: 
[0m14:28:58.956978 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m14:28:58.958551 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.178066, "process_user_time": 2.955773, "process_kernel_time": 0.150361, "process_mem_max_rss": "123356", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:28:58.959622 [debug] [MainThread]: Command `dbt run` succeeded at 14:28:58.959482 after 4.18 seconds
[0m14:28:58.960368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94e2c42f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94e1b94f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94e2256960>]}
[0m14:28:58.961066 [debug] [MainThread]: Flushing usage events
[0m14:29:03.048841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86b5125ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86b44f1dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86b7e8dcd0>]}


============================== 14:29:03.057134 | 6b10575a-a7ab-4263-945f-b9274a8c9619 ==============================
[0m14:29:03.057134 [info ] [MainThread]: Running with dbt=1.8.0
[0m14:29:03.058208 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select tag:trusted', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:29:03.284095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b10575a-a7ab-4263-945f-b9274a8c9619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86b3b1e930>]}
[0m14:29:03.370131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b10575a-a7ab-4263-945f-b9274a8c9619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86b46ecd40>]}
[0m14:29:03.371511 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:29:03.471229 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m14:29:03.612279 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:29:03.613210 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:29:03.657345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b10575a-a7ab-4263-945f-b9274a8c9619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86b3a9ef90>]}
[0m14:29:03.795979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b10575a-a7ab-4263-945f-b9274a8c9619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86b334caa0>]}
[0m14:29:03.796914 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m14:29:03.797638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b10575a-a7ab-4263-945f-b9274a8c9619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86b4bb7f50>]}
[0m14:29:03.800431 [info ] [MainThread]: 
[0m14:29:03.801628 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:29:03.807312 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m14:29:03.850166 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m14:29:03.851004 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m14:29:03.851967 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:29:03.857571 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.006 seconds
[0m14:29:03.859648 [debug] [ThreadPool]: On list_airflow: Close
[0m14:29:03.862277 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_trusted)
[0m14:29:03.869635 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m14:29:03.870478 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m14:29:03.871339 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:29:03.875586 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m14:29:03.876414 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m14:29:03.877174 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m14:29:03.880765 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m14:29:03.883007 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m14:29:03.884152 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m14:29:03.885241 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now list_airflow_lead_staging)
[0m14:29:03.888590 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m14:29:03.889304 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m14:29:03.889954 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:29:03.894441 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m14:29:03.895324 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m14:29:03.896109 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m14:29:03.900021 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.003 seconds
[0m14:29:03.902531 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m14:29:03.903622 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m14:29:03.911642 [debug] [MainThread]: Using postgres connection "master"
[0m14:29:03.912541 [debug] [MainThread]: On master: BEGIN
[0m14:29:03.913392 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:29:03.917849 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m14:29:03.918818 [debug] [MainThread]: Using postgres connection "master"
[0m14:29:03.919800 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:29:03.923772 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m14:29:03.925926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b10575a-a7ab-4263-945f-b9274a8c9619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86b2379f40>]}
[0m14:29:03.926883 [debug] [MainThread]: On master: ROLLBACK
[0m14:29:03.927807 [debug] [MainThread]: Using postgres connection "master"
[0m14:29:03.928534 [debug] [MainThread]: On master: BEGIN
[0m14:29:03.929924 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:29:03.930872 [debug] [MainThread]: On master: COMMIT
[0m14:29:03.931785 [debug] [MainThread]: Using postgres connection "master"
[0m14:29:03.932601 [debug] [MainThread]: On master: COMMIT
[0m14:29:03.933649 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:29:03.934654 [debug] [MainThread]: On master: Close
[0m14:29:03.935922 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:29:03.937057 [info ] [MainThread]: 
[0m14:29:03.948258 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_non_pii_data
[0m14:29:03.949375 [info ] [Thread-1 (]: 1 of 4 START sql table model lead_trusted.non_pii_data ......................... [RUN]
[0m14:29:03.950405 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now model.dbt_lead_data.trusted_non_pii_data)
[0m14:29:03.951219 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_non_pii_data
[0m14:29:03.961860 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_non_pii_data"
[0m14:29:03.964556 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_non_pii_data
[0m14:29:04.012369 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_non_pii_data"
[0m14:29:04.015013 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m14:29:04.015718 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: BEGIN
[0m14:29:04.016452 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:29:04.020874 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m14:29:04.021790 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m14:29:04.022535 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */

  
    

  create  table "airflow"."lead_trusted"."non_pii_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        '***MASKED***' AS person_name,
        SUBSTRING(dp.user_name, 1, 5) || '*****'  user_name,
        SUBSTRING(dp.email, 1, 5) || '*****' AS email,
        '***MASKED***'  AS personal_number, 
        '***MASKED***' AS birth_date, 
        '***MASKED***' AS address,
        '***MASKED***'  AS phone, 
        SUBSTRING(da.mac_address, 1, 5) || '*****' AS mac_address,
        SUBSTRING(da.ip_address, 1, 5) || '*****' AS ip_address,
        SUBSTRING(df.iban, 1, 5) || '*****' AS iban,
        dd.accessed_at,
        fnu.session_duration,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.consumed_traffic,
        fnu.unique_id
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    INNER JOIN
        "airflow"."lead_staging"."dim_address" da ON fnu.unique_id = da.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_date" dd ON da.unique_id = dd.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_finance" df ON dd.unique_id = df.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_person" dp ON df.unique_id = dp.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m14:29:19.270074 [debug] [Thread-1 (]: SQL status: SELECT 3513020 in 15.245 seconds
[0m14:29:19.277395 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m14:29:19.278212 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
alter table "airflow"."lead_trusted"."non_pii_data" rename to "non_pii_data__dbt_backup"
[0m14:29:19.279538 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:29:19.283089 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m14:29:19.283834 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
alter table "airflow"."lead_trusted"."non_pii_data__dbt_tmp" rename to "non_pii_data"
[0m14:29:19.285079 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:29:19.307007 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: COMMIT
[0m14:29:19.307802 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m14:29:19.308490 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: COMMIT
[0m14:29:19.317955 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m14:29:19.325444 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."non_pii_data__dbt_backup"
[0m14:29:19.331999 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m14:29:19.332837 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
drop table if exists "airflow"."lead_trusted"."non_pii_data__dbt_backup" cascade
[0m14:29:19.342689 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.009 seconds
[0m14:29:19.345915 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: Close
[0m14:29:19.347858 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b10575a-a7ab-4263-945f-b9274a8c9619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86b58e5d60>]}
[0m14:29:19.348935 [info ] [Thread-1 (]: 1 of 4 OK created sql table model lead_trusted.non_pii_data .................... [[32mSELECT 3513020[0m in 15.40s]
[0m14:29:19.350104 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_non_pii_data
[0m14:29:19.351017 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_payment_data
[0m14:29:19.351957 [info ] [Thread-1 (]: 2 of 4 START sql table model lead_trusted.payment_data ......................... [RUN]
[0m14:29:19.352991 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_non_pii_data, now model.dbt_lead_data.trusted_payment_data)
[0m14:29:19.353682 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_payment_data
[0m14:29:19.357749 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_payment_data"
[0m14:29:19.360154 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_payment_data
[0m14:29:19.364975 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_payment_data"
[0m14:29:19.367196 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m14:29:19.367913 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: BEGIN
[0m14:29:19.368597 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:29:19.373048 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m14:29:19.373789 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m14:29:19.374458 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */

  
    

  create  table "airflow"."lead_trusted"."payment_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        fnu.unique_id,
        df.iban,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.session_duration,
        fnu.consumed_traffic,
        ((fnu.download_speed + fnu.upload_speed + 1)/2) + (fnu.consumed_traffic / (fnu.session_duration + 1)) AS payment_amount
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    JOIN
        "airflow"."lead_staging"."dim_finance" df
    ON
	    fnu.unique_id = df.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m14:29:22.678302 [debug] [Thread-1 (]: SQL status: SELECT 702604 in 3.303 seconds
[0m14:29:22.682333 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m14:29:22.683147 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
alter table "airflow"."lead_trusted"."payment_data" rename to "payment_data__dbt_backup"
[0m14:29:22.684372 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:29:22.688067 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m14:29:22.688879 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
alter table "airflow"."lead_trusted"."payment_data__dbt_tmp" rename to "payment_data"
[0m14:29:22.690012 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:29:22.692466 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: COMMIT
[0m14:29:22.693340 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m14:29:22.694032 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: COMMIT
[0m14:29:22.701034 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m14:29:22.704170 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."payment_data__dbt_backup"
[0m14:29:22.705367 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m14:29:22.706098 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
drop table if exists "airflow"."lead_trusted"."payment_data__dbt_backup" cascade
[0m14:29:22.711921 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m14:29:22.713777 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: Close
[0m14:29:22.714847 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b10575a-a7ab-4263-945f-b9274a8c9619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86b3b38380>]}
[0m14:29:22.715746 [info ] [Thread-1 (]: 2 of 4 OK created sql table model lead_trusted.payment_data .................... [[32mSELECT 702604[0m in 3.36s]
[0m14:29:22.716968 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_payment_data
[0m14:29:22.717838 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_pii_data
[0m14:29:22.718797 [info ] [Thread-1 (]: 3 of 4 START sql table model lead_trusted.pii_data ............................. [RUN]
[0m14:29:22.719779 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_payment_data, now model.dbt_lead_data.trusted_pii_data)
[0m14:29:22.720496 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_pii_data
[0m14:29:22.725555 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_pii_data"
[0m14:29:22.728139 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_pii_data
[0m14:29:22.734196 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_pii_data"
[0m14:29:22.736876 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m14:29:22.737579 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: BEGIN
[0m14:29:22.738331 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:29:22.743037 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m14:29:22.743800 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m14:29:22.744522 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */

  
    

  create  table "airflow"."lead_trusted"."pii_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        dp.person_name,
        dp.user_name,
        dp.email,
        dp.personal_number, 
        dp.birth_date, 
        da.address,
        dp.phone, 
        da.mac_address,
        da.ip_address,
        df.iban,
        dd.accessed_at,
        fnu.session_duration,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.consumed_traffic,
        fnu.unique_id
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    INNER JOIN
        "airflow"."lead_staging"."dim_address" da ON fnu.unique_id = da.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_date" dd ON da.unique_id = dd.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_finance" df ON dd.unique_id = df.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_person" dp ON df.unique_id = dp.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m14:29:37.660614 [debug] [Thread-1 (]: SQL status: SELECT 3513020 in 14.915 seconds
[0m14:29:37.664605 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m14:29:37.665424 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */
alter table "airflow"."lead_trusted"."pii_data" rename to "pii_data__dbt_backup"
[0m14:29:37.666665 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:29:37.670268 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m14:29:37.671103 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */
alter table "airflow"."lead_trusted"."pii_data__dbt_tmp" rename to "pii_data"
[0m14:29:37.672271 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:29:37.674824 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: COMMIT
[0m14:29:37.675714 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m14:29:37.676536 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: COMMIT
[0m14:29:37.682701 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m14:29:37.685909 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."pii_data__dbt_backup"
[0m14:29:37.687232 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m14:29:37.687919 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */
drop table if exists "airflow"."lead_trusted"."pii_data__dbt_backup" cascade
[0m14:29:37.697669 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.009 seconds
[0m14:29:37.699600 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: Close
[0m14:29:37.700598 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b10575a-a7ab-4263-945f-b9274a8c9619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86b13d8710>]}
[0m14:29:37.701609 [info ] [Thread-1 (]: 3 of 4 OK created sql table model lead_trusted.pii_data ........................ [[32mSELECT 3513020[0m in 14.98s]
[0m14:29:37.702700 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_pii_data
[0m14:29:37.703601 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_technical_data
[0m14:29:37.704456 [info ] [Thread-1 (]: 4 of 4 START sql table model lead_trusted.technical_data ....................... [RUN]
[0m14:29:37.705328 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_pii_data, now model.dbt_lead_data.trusted_technical_data)
[0m14:29:37.706106 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_technical_data
[0m14:29:37.710141 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_technical_data"
[0m14:29:37.713212 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_technical_data
[0m14:29:37.717768 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_technical_data"
[0m14:29:37.720237 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m14:29:37.720926 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: BEGIN
[0m14:29:37.721652 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:29:37.725744 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m14:29:37.726466 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m14:29:37.727140 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */

  
    

  create  table "airflow"."lead_trusted"."technical_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        fnu.unique_id,
        da.address,
        da.mac_address,
        da.ip_address,
        fnu.download_speed,
        fnu.upload_speed,
        ROUND((fnu.session_duration/60), 1) as min_session_duration,
        CASE 
            WHEN fnu.download_speed < 50 OR fnu.upload_speed < 30 OR fnu.session_duration/60 < 1 THEN true
            ELSE false
        END AS technical_issue
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    JOIN
        "airflow"."lead_staging"."dim_address" da
    ON
	    fnu.unique_id = da.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m14:29:41.285226 [debug] [Thread-1 (]: SQL status: SELECT 702604 in 3.557 seconds
[0m14:29:41.289283 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m14:29:41.290093 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
alter table "airflow"."lead_trusted"."technical_data" rename to "technical_data__dbt_backup"
[0m14:29:41.291324 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:29:41.294672 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m14:29:41.295418 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
alter table "airflow"."lead_trusted"."technical_data__dbt_tmp" rename to "technical_data"
[0m14:29:41.296504 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:29:41.298892 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: COMMIT
[0m14:29:41.299725 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m14:29:41.300559 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: COMMIT
[0m14:29:41.305192 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m14:29:41.308190 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."technical_data__dbt_backup"
[0m14:29:41.309387 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m14:29:41.310136 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
drop table if exists "airflow"."lead_trusted"."technical_data__dbt_backup" cascade
[0m14:29:41.317195 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m14:29:41.319056 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: Close
[0m14:29:41.320128 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b10575a-a7ab-4263-945f-b9274a8c9619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86b13dd7c0>]}
[0m14:29:41.320989 [info ] [Thread-1 (]: 4 of 4 OK created sql table model lead_trusted.technical_data .................. [[32mSELECT 702604[0m in 3.61s]
[0m14:29:41.321967 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_technical_data
[0m14:29:41.324276 [debug] [MainThread]: Using postgres connection "master"
[0m14:29:41.324928 [debug] [MainThread]: On master: BEGIN
[0m14:29:41.325599 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:29:41.330004 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m14:29:41.330716 [debug] [MainThread]: On master: COMMIT
[0m14:29:41.331400 [debug] [MainThread]: Using postgres connection "master"
[0m14:29:41.332062 [debug] [MainThread]: On master: COMMIT
[0m14:29:41.333130 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:29:41.333828 [debug] [MainThread]: On master: Close
[0m14:29:41.334741 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:29:41.335383 [debug] [MainThread]: Connection 'model.dbt_lead_data.trusted_technical_data' was properly closed.
[0m14:29:41.336135 [info ] [MainThread]: 
[0m14:29:41.336874 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 37.53 seconds (37.53s).
[0m14:29:41.338837 [debug] [MainThread]: Command end result
[0m14:29:41.392196 [info ] [MainThread]: 
[0m14:29:41.393122 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:29:41.393893 [info ] [MainThread]: 
[0m14:29:41.395099 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m14:29:41.396986 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 38.40747, "process_user_time": 3.352524, "process_kernel_time": 0.185463, "process_mem_max_rss": "123044", "process_in_blocks": "200", "process_out_blocks": "0"}
[0m14:29:41.398074 [debug] [MainThread]: Command `dbt run` succeeded at 14:29:41.397835 after 38.41 seconds
[0m14:29:41.398827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86b4bf0a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86b2379df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86b13318e0>]}
[0m14:29:41.399576 [debug] [MainThread]: Flushing usage events
[0m13:52:43.088074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f852db35250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f852db37800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f852dd8a9c0>]}


============================== 13:52:43.111718 | dae8e903-cc8e-423f-856c-0b86c8148665 ==============================
[0m13:52:43.111718 [info ] [MainThread]: Running with dbt=1.8.0
[0m13:52:43.112685 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select tag:staging', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:52:43.342949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dae8e903-cc8e-423f-856c-0b86c8148665', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f852e090680>]}
[0m13:52:43.398344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dae8e903-cc8e-423f-856c-0b86c8148665', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f852d5be5d0>]}
[0m13:52:43.400111 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:52:43.483925 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m13:52:43.648533 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:52:43.649226 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:52:43.683673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dae8e903-cc8e-423f-856c-0b86c8148665', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f852cd0f0b0>]}
[0m13:52:43.808750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dae8e903-cc8e-423f-856c-0b86c8148665', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f852cf82300>]}
[0m13:52:43.809483 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m13:52:43.810177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dae8e903-cc8e-423f-856c-0b86c8148665', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f852e76cd70>]}
[0m13:52:43.812231 [info ] [MainThread]: 
[0m13:52:43.813089 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:52:43.818104 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m13:52:43.858891 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m13:52:43.859668 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m13:52:43.860304 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:52:43.865311 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.005 seconds
[0m13:52:43.867015 [debug] [ThreadPool]: On list_airflow: Close
[0m13:52:43.868229 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now create_airflow_lead_staging)
[0m13:52:43.869078 [debug] [ThreadPool]: Creating schema "database: "airflow"
schema: "lead_staging"
"
[0m13:52:43.874813 [debug] [ThreadPool]: Using postgres connection "create_airflow_lead_staging"
[0m13:52:43.875455 [debug] [ThreadPool]: On create_airflow_lead_staging: BEGIN
[0m13:52:43.876135 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:52:43.879689 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m13:52:43.880372 [debug] [ThreadPool]: Using postgres connection "create_airflow_lead_staging"
[0m13:52:43.881085 [debug] [ThreadPool]: On create_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "create_airflow_lead_staging"} */
create schema if not exists "lead_staging"
[0m13:52:43.882092 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m13:52:43.883385 [debug] [ThreadPool]: On create_airflow_lead_staging: COMMIT
[0m13:52:43.884044 [debug] [ThreadPool]: Using postgres connection "create_airflow_lead_staging"
[0m13:52:43.884713 [debug] [ThreadPool]: On create_airflow_lead_staging: COMMIT
[0m13:52:43.885891 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m13:52:43.886490 [debug] [ThreadPool]: On create_airflow_lead_staging: Close
[0m13:52:43.888602 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_airflow_lead_staging, now list_airflow_lead_staging)
[0m13:52:43.894267 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m13:52:43.894912 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m13:52:43.895438 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:52:43.898845 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m13:52:43.899413 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m13:52:43.900125 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m13:52:43.902935 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m13:52:43.904328 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m13:52:43.905074 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m13:52:43.905944 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now list_airflow_lead_trusted)
[0m13:52:43.908018 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m13:52:43.908519 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m13:52:43.909105 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:52:43.912567 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m13:52:43.913201 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m13:52:43.913874 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m13:52:43.916456 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m13:52:43.918106 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m13:52:43.918989 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m13:52:43.924301 [debug] [MainThread]: Using postgres connection "master"
[0m13:52:43.925020 [debug] [MainThread]: On master: BEGIN
[0m13:52:43.925809 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:52:43.929680 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m13:52:43.930480 [debug] [MainThread]: Using postgres connection "master"
[0m13:52:43.931342 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:52:43.934614 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m13:52:43.936384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dae8e903-cc8e-423f-856c-0b86c8148665', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f852cdfbd70>]}
[0m13:52:43.937299 [debug] [MainThread]: On master: ROLLBACK
[0m13:52:43.938134 [debug] [MainThread]: Using postgres connection "master"
[0m13:52:43.938797 [debug] [MainThread]: On master: BEGIN
[0m13:52:43.939671 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:52:43.940309 [debug] [MainThread]: On master: COMMIT
[0m13:52:43.941091 [debug] [MainThread]: Using postgres connection "master"
[0m13:52:43.941924 [debug] [MainThread]: On master: COMMIT
[0m13:52:43.942615 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:52:43.943344 [debug] [MainThread]: On master: Close
[0m13:52:43.944234 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:52:43.945184 [info ] [MainThread]: 
[0m13:52:43.955095 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_adress
[0m13:52:43.956073 [info ] [Thread-1 (]: 1 of 5 START sql table model lead_staging.dim_address .......................... [RUN]
[0m13:52:43.956795 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now model.dbt_lead_data.staging_dim_adress)
[0m13:52:43.957671 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_adress
[0m13:52:43.965928 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_adress"
[0m13:52:43.968543 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_adress
[0m13:52:44.006224 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_adress"
[0m13:52:44.008860 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m13:52:44.009454 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: BEGIN
[0m13:52:44.010091 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:44.013802 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m13:52:44.014429 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m13:52:44.015116 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */

  
    

  create  table "airflow"."lead_staging"."dim_address__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        address,
        mac_address,
        ip_address
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m13:52:44.128353 [debug] [Thread-1 (]: SQL status: SELECT 100372 in 0.113 seconds
[0m13:52:44.135587 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m13:52:44.136400 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
alter table "airflow"."lead_staging"."dim_address__dbt_tmp" rename to "dim_address"
[0m13:52:44.137728 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:52:44.157109 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m13:52:44.157808 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m13:52:44.158458 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m13:52:44.163084 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m13:52:44.169540 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_address__dbt_backup"
[0m13:52:44.175730 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m13:52:44.176439 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
drop table if exists "airflow"."lead_staging"."dim_address__dbt_backup" cascade
[0m13:52:44.177468 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m13:52:44.179981 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: Close
[0m13:52:44.181578 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dae8e903-cc8e-423f-856c-0b86c8148665', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f852e7e7260>]}
[0m13:52:44.182442 [info ] [Thread-1 (]: 1 of 5 OK created sql table model lead_staging.dim_address ..................... [[32mSELECT 100372[0m in 0.22s]
[0m13:52:44.183462 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_adress
[0m13:52:44.184353 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_date
[0m13:52:44.185171 [info ] [Thread-1 (]: 2 of 5 START sql table model lead_staging.dim_date ............................. [RUN]
[0m13:52:44.186031 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_adress, now model.dbt_lead_data.staging_dim_date)
[0m13:52:44.186644 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_date
[0m13:52:44.189949 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_date"
[0m13:52:44.191830 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_date
[0m13:52:44.195198 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_date"
[0m13:52:44.196874 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m13:52:44.197399 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: BEGIN
[0m13:52:44.197988 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:44.201867 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m13:52:44.203185 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m13:52:44.205231 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */

  
    

  create  table "airflow"."lead_staging"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        accessed_at
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m13:52:44.278850 [debug] [Thread-1 (]: SQL status: SELECT 100372 in 0.072 seconds
[0m13:52:44.283181 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m13:52:44.284067 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
alter table "airflow"."lead_staging"."dim_date__dbt_tmp" rename to "dim_date"
[0m13:52:44.285365 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:52:44.288183 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: COMMIT
[0m13:52:44.289057 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m13:52:44.289857 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: COMMIT
[0m13:52:44.294504 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m13:52:44.298180 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_date__dbt_backup"
[0m13:52:44.299829 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m13:52:44.300744 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
drop table if exists "airflow"."lead_staging"."dim_date__dbt_backup" cascade
[0m13:52:44.301948 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m13:52:44.304055 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: Close
[0m13:52:44.305016 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dae8e903-cc8e-423f-856c-0b86c8148665', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f852af5fb00>]}
[0m13:52:44.306271 [info ] [Thread-1 (]: 2 of 5 OK created sql table model lead_staging.dim_date ........................ [[32mSELECT 100372[0m in 0.12s]
[0m13:52:44.307522 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_date
[0m13:52:44.308592 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_finance
[0m13:52:44.309591 [info ] [Thread-1 (]: 3 of 5 START sql table model lead_staging.dim_finance .......................... [RUN]
[0m13:52:44.310556 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_date, now model.dbt_lead_data.staging_dim_finance)
[0m13:52:44.311392 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_finance
[0m13:52:44.316007 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_finance"
[0m13:52:44.318958 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_finance
[0m13:52:44.324429 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_finance"
[0m13:52:44.327963 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m13:52:44.329430 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: BEGIN
[0m13:52:44.331037 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:44.337473 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m13:52:44.338541 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m13:52:44.339588 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */

  
    

  create  table "airflow"."lead_staging"."dim_finance__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        iban
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m13:52:44.436996 [debug] [Thread-1 (]: SQL status: SELECT 100372 in 0.096 seconds
[0m13:52:44.441113 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m13:52:44.441924 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
alter table "airflow"."lead_staging"."dim_finance__dbt_tmp" rename to "dim_finance"
[0m13:52:44.443212 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:52:44.445624 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: COMMIT
[0m13:52:44.446460 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m13:52:44.447399 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: COMMIT
[0m13:52:44.455428 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m13:52:44.459723 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_finance__dbt_backup"
[0m13:52:44.461003 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m13:52:44.461782 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
drop table if exists "airflow"."lead_staging"."dim_finance__dbt_backup" cascade
[0m13:52:44.462900 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m13:52:44.464746 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: Close
[0m13:52:44.465789 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dae8e903-cc8e-423f-856c-0b86c8148665', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f852af74dd0>]}
[0m13:52:44.466859 [info ] [Thread-1 (]: 3 of 5 OK created sql table model lead_staging.dim_finance ..................... [[32mSELECT 100372[0m in 0.16s]
[0m13:52:44.467904 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_finance
[0m13:52:44.468733 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_person
[0m13:52:44.469554 [info ] [Thread-1 (]: 4 of 5 START sql table model lead_staging.dim_person ........................... [RUN]
[0m13:52:44.470417 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_finance, now model.dbt_lead_data.staging_dim_person)
[0m13:52:44.471143 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_person
[0m13:52:44.474866 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_person"
[0m13:52:44.477059 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_person
[0m13:52:44.481085 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_person"
[0m13:52:44.483146 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m13:52:44.483914 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: BEGIN
[0m13:52:44.484686 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:44.489231 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m13:52:44.490033 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m13:52:44.490810 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */

  
    

  create  table "airflow"."lead_staging"."dim_person__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        person_name,
        user_name,
        email,
        phone,
        birth_date,
        personal_number
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m13:52:44.618981 [debug] [Thread-1 (]: SQL status: SELECT 100372 in 0.127 seconds
[0m13:52:44.622721 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m13:52:44.623453 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
alter table "airflow"."lead_staging"."dim_person__dbt_tmp" rename to "dim_person"
[0m13:52:44.624617 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:52:44.626766 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: COMMIT
[0m13:52:44.627395 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m13:52:44.628153 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: COMMIT
[0m13:52:44.641312 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m13:52:44.644504 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_person__dbt_backup"
[0m13:52:44.645836 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m13:52:44.646591 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
drop table if exists "airflow"."lead_staging"."dim_person__dbt_backup" cascade
[0m13:52:44.647889 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m13:52:44.649845 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: Close
[0m13:52:44.650949 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dae8e903-cc8e-423f-856c-0b86c8148665', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f852af5dc40>]}
[0m13:52:44.651956 [info ] [Thread-1 (]: 4 of 5 OK created sql table model lead_staging.dim_person ...................... [[32mSELECT 100372[0m in 0.18s]
[0m13:52:44.653053 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_person
[0m13:52:44.653938 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_fact_network_usage
[0m13:52:44.654814 [info ] [Thread-1 (]: 5 of 5 START sql table model lead_staging.fact_network_usage ................... [RUN]
[0m13:52:44.655722 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_person, now model.dbt_lead_data.staging_fact_network_usage)
[0m13:52:44.656438 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_fact_network_usage
[0m13:52:44.660270 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_fact_network_usage"
[0m13:52:44.662806 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_fact_network_usage
[0m13:52:44.666762 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_fact_network_usage"
[0m13:52:44.668773 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m13:52:44.669422 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: BEGIN
[0m13:52:44.670089 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:44.674038 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m13:52:44.674732 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m13:52:44.675361 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */

  
    

  create  table "airflow"."lead_staging"."fact_network_usage__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        session_duration,
        download_speed,
        upload_speed,
        consumed_traffic
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m13:52:44.767195 [debug] [Thread-1 (]: SQL status: SELECT 100372 in 0.091 seconds
[0m13:52:44.770946 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m13:52:44.771742 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
alter table "airflow"."lead_staging"."fact_network_usage__dbt_tmp" rename to "fact_network_usage"
[0m13:52:44.772975 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:52:44.775291 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: COMMIT
[0m13:52:44.776078 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m13:52:44.776825 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: COMMIT
[0m13:52:44.783499 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m13:52:44.786506 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."fact_network_usage__dbt_backup"
[0m13:52:44.787658 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m13:52:44.788466 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
drop table if exists "airflow"."lead_staging"."fact_network_usage__dbt_backup" cascade
[0m13:52:44.789537 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m13:52:44.791398 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: Close
[0m13:52:44.792293 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dae8e903-cc8e-423f-856c-0b86c8148665', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f852af5ef60>]}
[0m13:52:44.793219 [info ] [Thread-1 (]: 5 of 5 OK created sql table model lead_staging.fact_network_usage .............. [[32mSELECT 100372[0m in 0.14s]
[0m13:52:44.794224 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_fact_network_usage
[0m13:52:44.796574 [debug] [MainThread]: Using postgres connection "master"
[0m13:52:44.797343 [debug] [MainThread]: On master: BEGIN
[0m13:52:44.797969 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:52:44.801934 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m13:52:44.802489 [debug] [MainThread]: On master: COMMIT
[0m13:52:44.803061 [debug] [MainThread]: Using postgres connection "master"
[0m13:52:44.803561 [debug] [MainThread]: On master: COMMIT
[0m13:52:44.804384 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:52:44.805080 [debug] [MainThread]: On master: Close
[0m13:52:44.805808 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:52:44.806343 [debug] [MainThread]: Connection 'model.dbt_lead_data.staging_fact_network_usage' was properly closed.
[0m13:52:44.807052 [info ] [MainThread]: 
[0m13:52:44.807765 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.99 seconds (0.99s).
[0m13:52:44.809967 [debug] [MainThread]: Command end result
[0m13:52:44.856967 [info ] [MainThread]: 
[0m13:52:44.857639 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:52:44.858608 [info ] [MainThread]: 
[0m13:52:44.860151 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m13:52:44.863403 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.8724791, "process_user_time": 2.876319, "process_kernel_time": 0.227352, "process_mem_max_rss": "121928", "process_in_blocks": "35616", "process_out_blocks": "4056"}
[0m13:52:44.864957 [debug] [MainThread]: Command `dbt run` succeeded at 13:52:44.864515 after 1.87 seconds
[0m13:52:44.865813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f852db26210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f852c3981a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f852c398110>]}
[0m13:52:44.866350 [debug] [MainThread]: Flushing usage events
[0m13:52:48.815542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e22ec69c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e23762720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e232bd100>]}


============================== 13:52:48.822771 | 9b00729e-b2de-4df5-95cc-339a1c1b10e5 ==============================
[0m13:52:48.822771 [info ] [MainThread]: Running with dbt=1.8.0
[0m13:52:48.823813 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select tag:trusted', 'send_anonymous_usage_stats': 'True'}
[0m13:52:48.999826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9b00729e-b2de-4df5-95cc-339a1c1b10e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e230f8740>]}
[0m13:52:49.056711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9b00729e-b2de-4df5-95cc-339a1c1b10e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e236b7e30>]}
[0m13:52:49.058891 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:52:49.151592 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m13:52:49.267823 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:52:49.268489 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:52:49.301982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9b00729e-b2de-4df5-95cc-339a1c1b10e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e22a81700>]}
[0m13:52:49.418068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9b00729e-b2de-4df5-95cc-339a1c1b10e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e21978b90>]}
[0m13:52:49.418865 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m13:52:49.419471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b00729e-b2de-4df5-95cc-339a1c1b10e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e22a81d90>]}
[0m13:52:49.421666 [info ] [MainThread]: 
[0m13:52:49.422489 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:52:49.427460 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m13:52:49.461363 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m13:52:49.462154 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m13:52:49.462750 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:52:49.467364 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.005 seconds
[0m13:52:49.469076 [debug] [ThreadPool]: On list_airflow: Close
[0m13:52:49.470327 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now create_airflow_lead_trusted)
[0m13:52:49.471177 [debug] [ThreadPool]: Creating schema "database: "airflow"
schema: "lead_trusted"
"
[0m13:52:49.477061 [debug] [ThreadPool]: Using postgres connection "create_airflow_lead_trusted"
[0m13:52:49.477797 [debug] [ThreadPool]: On create_airflow_lead_trusted: BEGIN
[0m13:52:49.478438 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:52:49.482626 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m13:52:49.483411 [debug] [ThreadPool]: Using postgres connection "create_airflow_lead_trusted"
[0m13:52:49.484112 [debug] [ThreadPool]: On create_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "create_airflow_lead_trusted"} */
create schema if not exists "lead_trusted"
[0m13:52:49.485206 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m13:52:49.486584 [debug] [ThreadPool]: On create_airflow_lead_trusted: COMMIT
[0m13:52:49.487227 [debug] [ThreadPool]: Using postgres connection "create_airflow_lead_trusted"
[0m13:52:49.487866 [debug] [ThreadPool]: On create_airflow_lead_trusted: COMMIT
[0m13:52:49.489329 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m13:52:49.490015 [debug] [ThreadPool]: On create_airflow_lead_trusted: Close
[0m13:52:49.492434 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_airflow_lead_trusted, now list_airflow_lead_trusted)
[0m13:52:49.499099 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m13:52:49.499870 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m13:52:49.500468 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:52:49.504367 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m13:52:49.505053 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m13:52:49.505679 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m13:52:49.508531 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m13:52:49.510261 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m13:52:49.511129 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m13:52:49.512062 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now list_airflow_lead_staging)
[0m13:52:49.514455 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m13:52:49.515142 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m13:52:49.515767 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:52:49.519529 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m13:52:49.520196 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m13:52:49.520886 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m13:52:49.523848 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m13:52:49.525601 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m13:52:49.526550 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m13:52:49.533425 [debug] [MainThread]: Using postgres connection "master"
[0m13:52:49.534231 [debug] [MainThread]: On master: BEGIN
[0m13:52:49.535053 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:52:49.539185 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m13:52:49.539984 [debug] [MainThread]: Using postgres connection "master"
[0m13:52:49.540828 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:52:49.544165 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m13:52:49.546041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b00729e-b2de-4df5-95cc-339a1c1b10e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e22e83770>]}
[0m13:52:49.546857 [debug] [MainThread]: On master: ROLLBACK
[0m13:52:49.547767 [debug] [MainThread]: Using postgres connection "master"
[0m13:52:49.548447 [debug] [MainThread]: On master: BEGIN
[0m13:52:49.549489 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:52:49.550254 [debug] [MainThread]: On master: COMMIT
[0m13:52:49.550954 [debug] [MainThread]: Using postgres connection "master"
[0m13:52:49.551612 [debug] [MainThread]: On master: COMMIT
[0m13:52:49.552535 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:52:49.553262 [debug] [MainThread]: On master: Close
[0m13:52:49.554138 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:52:49.554859 [info ] [MainThread]: 
[0m13:52:49.564207 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_non_pii_data
[0m13:52:49.565081 [info ] [Thread-1 (]: 1 of 4 START sql table model lead_trusted.non_pii_data ......................... [RUN]
[0m13:52:49.566102 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now model.dbt_lead_data.trusted_non_pii_data)
[0m13:52:49.566714 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_non_pii_data
[0m13:52:49.575698 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_non_pii_data"
[0m13:52:49.578279 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_non_pii_data
[0m13:52:49.617503 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_non_pii_data"
[0m13:52:49.620026 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m13:52:49.620624 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: BEGIN
[0m13:52:49.621355 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:49.624945 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m13:52:49.625542 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m13:52:49.626216 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */

  
    

  create  table "airflow"."lead_trusted"."non_pii_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        '***MASKED***' AS person_name,
        SUBSTRING(dp.user_name, 1, 5) || '*****'  user_name,
        SUBSTRING(dp.email, 1, 5) || '*****' AS email,
        '***MASKED***'  AS personal_number, 
        '***MASKED***' AS birth_date, 
        '***MASKED***' AS address,
        '***MASKED***'  AS phone, 
        SUBSTRING(da.mac_address, 1, 5) || '*****' AS mac_address,
        SUBSTRING(da.ip_address, 1, 5) || '*****' AS ip_address,
        SUBSTRING(df.iban, 1, 5) || '*****' AS iban,
        dd.accessed_at,
        fnu.session_duration,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.consumed_traffic,
        fnu.unique_id
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    INNER JOIN
        "airflow"."lead_staging"."dim_address" da ON fnu.unique_id = da.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_date" dd ON da.unique_id = dd.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_finance" df ON dd.unique_id = df.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_person" dp ON df.unique_id = dp.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m13:52:51.499115 [debug] [Thread-1 (]: SQL status: SELECT 100372 in 1.872 seconds
[0m13:52:51.505001 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m13:52:51.505739 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
alter table "airflow"."lead_trusted"."non_pii_data__dbt_tmp" rename to "non_pii_data"
[0m13:52:51.506816 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:52:51.522962 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: COMMIT
[0m13:52:51.523653 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m13:52:51.524309 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: COMMIT
[0m13:52:51.528122 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m13:52:51.534822 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."non_pii_data__dbt_backup"
[0m13:52:51.540948 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m13:52:51.541679 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
drop table if exists "airflow"."lead_trusted"."non_pii_data__dbt_backup" cascade
[0m13:52:51.542861 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m13:52:51.545332 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: Close
[0m13:52:51.547235 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b00729e-b2de-4df5-95cc-339a1c1b10e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e236f13a0>]}
[0m13:52:51.548318 [info ] [Thread-1 (]: 1 of 4 OK created sql table model lead_trusted.non_pii_data .................... [[32mSELECT 100372[0m in 1.98s]
[0m13:52:51.549459 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_non_pii_data
[0m13:52:51.550267 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_payment_data
[0m13:52:51.551032 [info ] [Thread-1 (]: 2 of 4 START sql table model lead_trusted.payment_data ......................... [RUN]
[0m13:52:51.551874 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_non_pii_data, now model.dbt_lead_data.trusted_payment_data)
[0m13:52:51.552486 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_payment_data
[0m13:52:51.555901 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_payment_data"
[0m13:52:51.558019 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_payment_data
[0m13:52:51.561429 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_payment_data"
[0m13:52:51.563278 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m13:52:51.563965 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: BEGIN
[0m13:52:51.564503 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:51.568330 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m13:52:51.569560 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m13:52:51.571006 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */

  
    

  create  table "airflow"."lead_trusted"."payment_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        fnu.unique_id,
        df.iban,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.session_duration,
        fnu.consumed_traffic,
        ((fnu.download_speed + fnu.upload_speed + 1)/2) + (fnu.consumed_traffic / (fnu.session_duration + 1)) AS payment_amount
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    JOIN
        "airflow"."lead_staging"."dim_finance" df
    ON
	    fnu.unique_id = df.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m13:52:52.065440 [debug] [Thread-1 (]: SQL status: SELECT 100372 in 0.493 seconds
[0m13:52:52.069667 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m13:52:52.070705 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
alter table "airflow"."lead_trusted"."payment_data__dbt_tmp" rename to "payment_data"
[0m13:52:52.072022 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:52:52.074398 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: COMMIT
[0m13:52:52.075242 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m13:52:52.076029 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: COMMIT
[0m13:52:52.078322 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:52:52.081897 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."payment_data__dbt_backup"
[0m13:52:52.083916 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m13:52:52.085016 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
drop table if exists "airflow"."lead_trusted"."payment_data__dbt_backup" cascade
[0m13:52:52.086175 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m13:52:52.088561 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: Close
[0m13:52:52.089899 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b00729e-b2de-4df5-95cc-339a1c1b10e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e20995a90>]}
[0m13:52:52.091218 [info ] [Thread-1 (]: 2 of 4 OK created sql table model lead_trusted.payment_data .................... [[32mSELECT 100372[0m in 0.54s]
[0m13:52:52.093165 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_payment_data
[0m13:52:52.094417 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_pii_data
[0m13:52:52.095611 [info ] [Thread-1 (]: 3 of 4 START sql table model lead_trusted.pii_data ............................. [RUN]
[0m13:52:52.097055 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_payment_data, now model.dbt_lead_data.trusted_pii_data)
[0m13:52:52.097960 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_pii_data
[0m13:52:52.103198 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_pii_data"
[0m13:52:52.105185 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_pii_data
[0m13:52:52.109762 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_pii_data"
[0m13:52:52.111529 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m13:52:52.112207 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: BEGIN
[0m13:52:52.112838 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:52.118179 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m13:52:52.119188 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m13:52:52.119960 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */

  
    

  create  table "airflow"."lead_trusted"."pii_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        dp.person_name,
        dp.user_name,
        dp.email,
        dp.personal_number, 
        dp.birth_date, 
        da.address,
        dp.phone, 
        da.mac_address,
        da.ip_address,
        df.iban,
        dd.accessed_at,
        fnu.session_duration,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.consumed_traffic,
        fnu.unique_id
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    INNER JOIN
        "airflow"."lead_staging"."dim_address" da ON fnu.unique_id = da.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_date" dd ON da.unique_id = dd.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_finance" df ON dd.unique_id = df.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_person" dp ON df.unique_id = dp.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m13:52:53.893900 [debug] [Thread-1 (]: SQL status: SELECT 100372 in 1.773 seconds
[0m13:52:53.897498 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m13:52:53.898283 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */
alter table "airflow"."lead_trusted"."pii_data__dbt_tmp" rename to "pii_data"
[0m13:52:53.899508 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:52:53.901580 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: COMMIT
[0m13:52:53.902370 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m13:52:53.903055 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: COMMIT
[0m13:52:53.909486 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m13:52:53.912229 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."pii_data__dbt_backup"
[0m13:52:53.913376 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m13:52:53.914129 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */
drop table if exists "airflow"."lead_trusted"."pii_data__dbt_backup" cascade
[0m13:52:53.915092 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m13:52:53.916617 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: Close
[0m13:52:53.917595 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b00729e-b2de-4df5-95cc-339a1c1b10e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e1fd09580>]}
[0m13:52:53.918408 [info ] [Thread-1 (]: 3 of 4 OK created sql table model lead_trusted.pii_data ........................ [[32mSELECT 100372[0m in 1.82s]
[0m13:52:53.919496 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_pii_data
[0m13:52:53.920489 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_technical_data
[0m13:52:53.921417 [info ] [Thread-1 (]: 4 of 4 START sql table model lead_trusted.technical_data ....................... [RUN]
[0m13:52:53.922287 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_pii_data, now model.dbt_lead_data.trusted_technical_data)
[0m13:52:53.922929 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_technical_data
[0m13:52:53.926612 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_technical_data"
[0m13:52:53.930289 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_technical_data
[0m13:52:53.934115 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_technical_data"
[0m13:52:53.936815 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m13:52:53.937405 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: BEGIN
[0m13:52:53.938096 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:53.943993 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m13:52:53.944901 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m13:52:53.945547 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */

  
    

  create  table "airflow"."lead_trusted"."technical_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        fnu.unique_id,
        da.address,
        da.mac_address,
        da.ip_address,
        fnu.download_speed,
        fnu.upload_speed,
        ROUND((fnu.session_duration/60), 1) as min_session_duration,
        CASE 
            WHEN fnu.download_speed < 50 OR fnu.upload_speed < 30 OR fnu.session_duration/60 < 1 THEN true
            ELSE false
        END AS technical_issue
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    JOIN
        "airflow"."lead_staging"."dim_address" da
    ON
	    fnu.unique_id = da.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m13:52:54.495252 [debug] [Thread-1 (]: SQL status: SELECT 100372 in 0.549 seconds
[0m13:52:54.498978 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m13:52:54.499814 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
alter table "airflow"."lead_trusted"."technical_data__dbt_tmp" rename to "technical_data"
[0m13:52:54.500776 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:52:54.502566 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: COMMIT
[0m13:52:54.503254 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m13:52:54.503871 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: COMMIT
[0m13:52:54.510898 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m13:52:54.513381 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."technical_data__dbt_backup"
[0m13:52:54.514500 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m13:52:54.515456 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
drop table if exists "airflow"."lead_trusted"."technical_data__dbt_backup" cascade
[0m13:52:54.516382 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m13:52:54.517941 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: Close
[0m13:52:54.518732 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b00729e-b2de-4df5-95cc-339a1c1b10e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e1fd0f050>]}
[0m13:52:54.519606 [info ] [Thread-1 (]: 4 of 4 OK created sql table model lead_trusted.technical_data .................. [[32mSELECT 100372[0m in 0.60s]
[0m13:52:54.520624 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_technical_data
[0m13:52:54.523377 [debug] [MainThread]: Using postgres connection "master"
[0m13:52:54.524115 [debug] [MainThread]: On master: BEGIN
[0m13:52:54.524873 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:52:54.529533 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m13:52:54.530359 [debug] [MainThread]: On master: COMMIT
[0m13:52:54.531159 [debug] [MainThread]: Using postgres connection "master"
[0m13:52:54.531865 [debug] [MainThread]: On master: COMMIT
[0m13:52:54.532600 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:52:54.533265 [debug] [MainThread]: On master: Close
[0m13:52:54.534069 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:52:54.534622 [debug] [MainThread]: Connection 'model.dbt_lead_data.trusted_technical_data' was properly closed.
[0m13:52:54.535459 [info ] [MainThread]: 
[0m13:52:54.536156 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 5.11 seconds (5.11s).
[0m13:52:54.538200 [debug] [MainThread]: Command end result
[0m13:52:54.588747 [info ] [MainThread]: 
[0m13:52:54.589725 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:52:54.591116 [info ] [MainThread]: 
[0m13:52:54.592148 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m13:52:54.593498 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.834857, "process_user_time": 2.725347, "process_kernel_time": 0.163581, "process_mem_max_rss": "120976", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:52:54.594858 [debug] [MainThread]: Command `dbt run` succeeded at 13:52:54.594587 after 5.84 seconds
[0m13:52:54.595530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e23206660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e23078ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e211cdee0>]}
[0m13:52:54.596334 [debug] [MainThread]: Flushing usage events
[0m13:54:57.923777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcef24f4920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcef24f4ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcef24f5670>]}


============================== 13:54:57.931231 | 14d1d4ae-e0f2-400d-921f-cd636a32f6ed ==============================
[0m13:54:57.931231 [info ] [MainThread]: Running with dbt=1.8.0
[0m13:54:57.932150 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select tag:staging', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:54:58.153235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '14d1d4ae-e0f2-400d-921f-cd636a32f6ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcef1f94740>]}
[0m13:54:58.225389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '14d1d4ae-e0f2-400d-921f-cd636a32f6ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcef2b8aab0>]}
[0m13:54:58.226824 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:54:58.323500 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m13:54:58.476672 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:54:58.477666 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:54:58.524165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '14d1d4ae-e0f2-400d-921f-cd636a32f6ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcef18114f0>]}
[0m13:54:58.663274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '14d1d4ae-e0f2-400d-921f-cd636a32f6ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcef0fa1640>]}
[0m13:54:58.664227 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m13:54:58.665179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14d1d4ae-e0f2-400d-921f-cd636a32f6ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcef2f56f60>]}
[0m13:54:58.667749 [info ] [MainThread]: 
[0m13:54:58.668782 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:54:58.674554 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m13:54:58.713218 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m13:54:58.714073 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m13:54:58.714840 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:54:58.720239 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.005 seconds
[0m13:54:58.722298 [debug] [ThreadPool]: On list_airflow: Close
[0m13:54:58.725049 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_trusted)
[0m13:54:58.731963 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m13:54:58.732902 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m13:54:58.733656 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:54:58.737865 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m13:54:58.738634 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m13:54:58.739363 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m13:54:58.742607 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m13:54:58.744424 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m13:54:58.745462 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m13:54:58.746533 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now list_airflow_lead_staging)
[0m13:54:58.749737 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m13:54:58.750522 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m13:54:58.751244 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:54:58.755324 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m13:54:58.756030 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m13:54:58.756796 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m13:54:58.759961 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m13:54:58.761974 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m13:54:58.762986 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m13:54:58.770526 [debug] [MainThread]: Using postgres connection "master"
[0m13:54:58.771370 [debug] [MainThread]: On master: BEGIN
[0m13:54:58.772136 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:54:58.776426 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m13:54:58.777215 [debug] [MainThread]: Using postgres connection "master"
[0m13:54:58.777994 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:54:58.781758 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m13:54:58.783768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14d1d4ae-e0f2-400d-921f-cd636a32f6ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcef12d2840>]}
[0m13:54:58.784653 [debug] [MainThread]: On master: ROLLBACK
[0m13:54:58.785654 [debug] [MainThread]: Using postgres connection "master"
[0m13:54:58.786345 [debug] [MainThread]: On master: BEGIN
[0m13:54:58.787434 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:54:58.788076 [debug] [MainThread]: On master: COMMIT
[0m13:54:58.788741 [debug] [MainThread]: Using postgres connection "master"
[0m13:54:58.789514 [debug] [MainThread]: On master: COMMIT
[0m13:54:58.790432 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:54:58.791169 [debug] [MainThread]: On master: Close
[0m13:54:58.792202 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:54:58.792955 [info ] [MainThread]: 
[0m13:54:58.803412 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_adress
[0m13:54:58.804441 [info ] [Thread-1 (]: 1 of 5 START sql table model lead_staging.dim_address .......................... [RUN]
[0m13:54:58.805336 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now model.dbt_lead_data.staging_dim_adress)
[0m13:54:58.806021 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_adress
[0m13:54:58.815400 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_adress"
[0m13:54:58.817744 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_adress
[0m13:54:58.862126 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_adress"
[0m13:54:58.864555 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m13:54:58.865200 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: BEGIN
[0m13:54:58.866003 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:58.870460 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m13:54:58.871255 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m13:54:58.871914 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */

  
    

  create  table "airflow"."lead_staging"."dim_address__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        address,
        mac_address,
        ip_address
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m13:54:58.998348 [debug] [Thread-1 (]: SQL status: SELECT 100481 in 0.126 seconds
[0m13:54:59.006080 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m13:54:59.006973 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
alter table "airflow"."lead_staging"."dim_address" rename to "dim_address__dbt_backup"
[0m13:54:59.008297 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:54:59.012209 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m13:54:59.014443 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
alter table "airflow"."lead_staging"."dim_address__dbt_tmp" rename to "dim_address"
[0m13:54:59.016452 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:54:59.047891 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m13:54:59.050093 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m13:54:59.051763 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m13:54:59.063396 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m13:54:59.072663 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_address__dbt_backup"
[0m13:54:59.080559 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m13:54:59.081537 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
drop table if exists "airflow"."lead_staging"."dim_address__dbt_backup" cascade
[0m13:54:59.086063 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m13:54:59.089589 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: Close
[0m13:54:59.091964 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14d1d4ae-e0f2-400d-921f-cd636a32f6ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcef31cdb80>]}
[0m13:54:59.093212 [info ] [Thread-1 (]: 1 of 5 OK created sql table model lead_staging.dim_address ..................... [[32mSELECT 100481[0m in 0.29s]
[0m13:54:59.094463 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_adress
[0m13:54:59.095403 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_date
[0m13:54:59.096384 [info ] [Thread-1 (]: 2 of 5 START sql table model lead_staging.dim_date ............................. [RUN]
[0m13:54:59.097419 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_adress, now model.dbt_lead_data.staging_dim_date)
[0m13:54:59.098163 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_date
[0m13:54:59.102337 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_date"
[0m13:54:59.104556 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_date
[0m13:54:59.109595 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_date"
[0m13:54:59.111714 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m13:54:59.112527 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: BEGIN
[0m13:54:59.113324 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:59.131427 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m13:54:59.132488 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m13:54:59.133422 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */

  
    

  create  table "airflow"."lead_staging"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        accessed_at
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m13:54:59.211336 [debug] [Thread-1 (]: SQL status: SELECT 100481 in 0.077 seconds
[0m13:54:59.215307 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m13:54:59.216352 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
alter table "airflow"."lead_staging"."dim_date" rename to "dim_date__dbt_backup"
[0m13:54:59.217732 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:54:59.221537 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m13:54:59.222393 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
alter table "airflow"."lead_staging"."dim_date__dbt_tmp" rename to "dim_date"
[0m13:54:59.223622 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:54:59.226118 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: COMMIT
[0m13:54:59.226982 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m13:54:59.227809 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: COMMIT
[0m13:54:59.229272 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:54:59.232448 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_date__dbt_backup"
[0m13:54:59.233730 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m13:54:59.234484 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
drop table if exists "airflow"."lead_staging"."dim_date__dbt_backup" cascade
[0m13:54:59.237237 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m13:54:59.239132 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: Close
[0m13:54:59.240295 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14d1d4ae-e0f2-400d-921f-cd636a32f6ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fceed323590>]}
[0m13:54:59.241367 [info ] [Thread-1 (]: 2 of 5 OK created sql table model lead_staging.dim_date ........................ [[32mSELECT 100481[0m in 0.14s]
[0m13:54:59.242482 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_date
[0m13:54:59.243439 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_finance
[0m13:54:59.244394 [info ] [Thread-1 (]: 3 of 5 START sql table model lead_staging.dim_finance .......................... [RUN]
[0m13:54:59.245291 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_date, now model.dbt_lead_data.staging_dim_finance)
[0m13:54:59.246098 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_finance
[0m13:54:59.250102 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_finance"
[0m13:54:59.252301 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_finance
[0m13:54:59.258437 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_finance"
[0m13:54:59.261499 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m13:54:59.262996 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: BEGIN
[0m13:54:59.265402 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:59.270115 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m13:54:59.271113 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m13:54:59.272090 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */

  
    

  create  table "airflow"."lead_staging"."dim_finance__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        iban
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m13:54:59.370926 [debug] [Thread-1 (]: SQL status: SELECT 100481 in 0.098 seconds
[0m13:54:59.374588 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m13:54:59.375361 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
alter table "airflow"."lead_staging"."dim_finance" rename to "dim_finance__dbt_backup"
[0m13:54:59.376521 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:54:59.379884 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m13:54:59.380619 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
alter table "airflow"."lead_staging"."dim_finance__dbt_tmp" rename to "dim_finance"
[0m13:54:59.381639 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:54:59.384083 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: COMMIT
[0m13:54:59.384852 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m13:54:59.385553 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: COMMIT
[0m13:54:59.391285 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m13:54:59.394283 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_finance__dbt_backup"
[0m13:54:59.395612 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m13:54:59.396423 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
drop table if exists "airflow"."lead_staging"."dim_finance__dbt_backup" cascade
[0m13:54:59.399550 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m13:54:59.401490 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: Close
[0m13:54:59.402438 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14d1d4ae-e0f2-400d-921f-cd636a32f6ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcef073cef0>]}
[0m13:54:59.403411 [info ] [Thread-1 (]: 3 of 5 OK created sql table model lead_staging.dim_finance ..................... [[32mSELECT 100481[0m in 0.16s]
[0m13:54:59.404438 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_finance
[0m13:54:59.405317 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_person
[0m13:54:59.406192 [info ] [Thread-1 (]: 4 of 5 START sql table model lead_staging.dim_person ........................... [RUN]
[0m13:54:59.406989 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_finance, now model.dbt_lead_data.staging_dim_person)
[0m13:54:59.407682 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_person
[0m13:54:59.411160 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_person"
[0m13:54:59.413267 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_person
[0m13:54:59.417657 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_person"
[0m13:54:59.419531 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m13:54:59.420231 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: BEGIN
[0m13:54:59.420840 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:59.425368 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m13:54:59.426084 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m13:54:59.426809 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */

  
    

  create  table "airflow"."lead_staging"."dim_person__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        person_name,
        user_name,
        email,
        phone,
        birth_date,
        personal_number
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m13:54:59.558401 [debug] [Thread-1 (]: SQL status: SELECT 100481 in 0.131 seconds
[0m13:54:59.562387 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m13:54:59.563316 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
alter table "airflow"."lead_staging"."dim_person" rename to "dim_person__dbt_backup"
[0m13:54:59.564535 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:54:59.568177 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m13:54:59.569024 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
alter table "airflow"."lead_staging"."dim_person__dbt_tmp" rename to "dim_person"
[0m13:54:59.570378 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:54:59.572788 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: COMMIT
[0m13:54:59.573520 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m13:54:59.574315 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: COMMIT
[0m13:54:59.575658 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:54:59.578565 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_person__dbt_backup"
[0m13:54:59.579736 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m13:54:59.580467 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
drop table if exists "airflow"."lead_staging"."dim_person__dbt_backup" cascade
[0m13:54:59.584175 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m13:54:59.586166 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: Close
[0m13:54:59.587129 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14d1d4ae-e0f2-400d-921f-cd636a32f6ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fceef7932c0>]}
[0m13:54:59.588062 [info ] [Thread-1 (]: 4 of 5 OK created sql table model lead_staging.dim_person ...................... [[32mSELECT 100481[0m in 0.18s]
[0m13:54:59.589041 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_person
[0m13:54:59.589867 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_fact_network_usage
[0m13:54:59.590751 [info ] [Thread-1 (]: 5 of 5 START sql table model lead_staging.fact_network_usage ................... [RUN]
[0m13:54:59.591602 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_person, now model.dbt_lead_data.staging_fact_network_usage)
[0m13:54:59.592303 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_fact_network_usage
[0m13:54:59.595988 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_fact_network_usage"
[0m13:54:59.597806 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_fact_network_usage
[0m13:54:59.601817 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_fact_network_usage"
[0m13:54:59.603611 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m13:54:59.604274 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: BEGIN
[0m13:54:59.604874 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:59.609266 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m13:54:59.610606 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m13:54:59.611481 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */

  
    

  create  table "airflow"."lead_staging"."fact_network_usage__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        session_duration,
        download_speed,
        upload_speed,
        consumed_traffic
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m13:54:59.712594 [debug] [Thread-1 (]: SQL status: SELECT 100481 in 0.100 seconds
[0m13:54:59.719193 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m13:54:59.720130 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
alter table "airflow"."lead_staging"."fact_network_usage" rename to "fact_network_usage__dbt_backup"
[0m13:54:59.721621 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:54:59.725908 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m13:54:59.726802 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
alter table "airflow"."lead_staging"."fact_network_usage__dbt_tmp" rename to "fact_network_usage"
[0m13:54:59.728074 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:54:59.730945 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: COMMIT
[0m13:54:59.731826 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m13:54:59.732793 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: COMMIT
[0m13:54:59.735904 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:54:59.739218 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."fact_network_usage__dbt_backup"
[0m13:54:59.740662 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m13:54:59.741464 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
drop table if exists "airflow"."lead_staging"."fact_network_usage__dbt_backup" cascade
[0m13:54:59.744689 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m13:54:59.746793 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: Close
[0m13:54:59.747805 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14d1d4ae-e0f2-400d-921f-cd636a32f6ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fceed304320>]}
[0m13:54:59.748867 [info ] [Thread-1 (]: 5 of 5 OK created sql table model lead_staging.fact_network_usage .............. [[32mSELECT 100481[0m in 0.16s]
[0m13:54:59.750478 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_fact_network_usage
[0m13:54:59.752674 [debug] [MainThread]: Using postgres connection "master"
[0m13:54:59.753518 [debug] [MainThread]: On master: BEGIN
[0m13:54:59.754305 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:54:59.758686 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m13:54:59.759535 [debug] [MainThread]: On master: COMMIT
[0m13:54:59.760245 [debug] [MainThread]: Using postgres connection "master"
[0m13:54:59.760964 [debug] [MainThread]: On master: COMMIT
[0m13:54:59.761921 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:54:59.762704 [debug] [MainThread]: On master: Close
[0m13:54:59.763602 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:54:59.764201 [debug] [MainThread]: Connection 'model.dbt_lead_data.staging_fact_network_usage' was properly closed.
[0m13:54:59.765092 [info ] [MainThread]: 
[0m13:54:59.766037 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 1.10 seconds (1.10s).
[0m13:54:59.768148 [debug] [MainThread]: Command end result
[0m13:54:59.824847 [info ] [MainThread]: 
[0m13:54:59.825961 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:54:59.826977 [info ] [MainThread]: 
[0m13:54:59.828079 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m13:54:59.829769 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.9635154, "process_user_time": 3.174993, "process_kernel_time": 0.178915, "process_mem_max_rss": "121108", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:54:59.830728 [debug] [MainThread]: Command `dbt run` succeeded at 13:54:59.830596 after 1.96 seconds
[0m13:54:59.831438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcef1f311f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcef1f5a330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcef0731d30>]}
[0m13:54:59.832165 [debug] [MainThread]: Flushing usage events
[0m13:55:01.443374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10836aa7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1081bf5100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f108135b860>]}


============================== 13:55:01.450165 | e2d05bda-5d3b-4849-96a2-b82a80228d23 ==============================
[0m13:55:01.450165 [info ] [MainThread]: Running with dbt=1.8.0
[0m13:55:01.451201 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select tag:staging', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:55:01.645231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e2d05bda-5d3b-4849-96a2-b82a80228d23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10822af0e0>]}
[0m13:55:01.709625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e2d05bda-5d3b-4849-96a2-b82a80228d23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10813efb60>]}
[0m13:55:01.711360 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:55:01.804743 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m13:55:01.942084 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:55:01.942944 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:55:01.984865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e2d05bda-5d3b-4849-96a2-b82a80228d23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1080373a40>]}
[0m13:55:02.118986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e2d05bda-5d3b-4849-96a2-b82a80228d23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10803b9730>]}
[0m13:55:02.119774 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m13:55:02.120462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2d05bda-5d3b-4849-96a2-b82a80228d23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1080365c10>]}
[0m13:55:02.122758 [info ] [MainThread]: 
[0m13:55:02.123715 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:55:02.130237 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m13:55:02.166683 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m13:55:02.167408 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m13:55:02.168013 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:55:02.173067 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.005 seconds
[0m13:55:02.174717 [debug] [ThreadPool]: On list_airflow: Close
[0m13:55:02.177321 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_trusted)
[0m13:55:02.183922 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m13:55:02.184652 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m13:55:02.185378 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:55:02.189375 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m13:55:02.190105 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m13:55:02.190848 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m13:55:02.193933 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m13:55:02.195827 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m13:55:02.196770 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m13:55:02.197760 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now list_airflow_lead_staging)
[0m13:55:02.200805 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m13:55:02.201568 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m13:55:02.202255 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:55:02.206469 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m13:55:02.207370 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m13:55:02.207979 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m13:55:02.210909 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m13:55:02.212967 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m13:55:02.213954 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m13:55:02.221226 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:02.222297 [debug] [MainThread]: On master: BEGIN
[0m13:55:02.223047 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:55:02.227716 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m13:55:02.228581 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:02.229329 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:55:02.233244 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m13:55:02.235126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2d05bda-5d3b-4849-96a2-b82a80228d23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f107efca2a0>]}
[0m13:55:02.235980 [debug] [MainThread]: On master: ROLLBACK
[0m13:55:02.236892 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:02.237693 [debug] [MainThread]: On master: BEGIN
[0m13:55:02.239054 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:55:02.240462 [debug] [MainThread]: On master: COMMIT
[0m13:55:02.241076 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:02.241726 [debug] [MainThread]: On master: COMMIT
[0m13:55:02.242506 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:55:02.243416 [debug] [MainThread]: On master: Close
[0m13:55:02.244528 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:55:02.245645 [info ] [MainThread]: 
[0m13:55:02.256062 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_adress
[0m13:55:02.257137 [info ] [Thread-1 (]: 1 of 5 START sql table model lead_staging.dim_address .......................... [RUN]
[0m13:55:02.258023 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now model.dbt_lead_data.staging_dim_adress)
[0m13:55:02.258719 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_adress
[0m13:55:02.267476 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_adress"
[0m13:55:02.269923 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_adress
[0m13:55:02.310858 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_adress"
[0m13:55:02.313673 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m13:55:02.314461 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: BEGIN
[0m13:55:02.315050 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:55:02.319468 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m13:55:02.320241 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m13:55:02.320883 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */

  
    

  create  table "airflow"."lead_staging"."dim_address__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        address,
        mac_address,
        ip_address
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m13:55:02.419238 [debug] [Thread-1 (]: SQL status: SELECT 100481 in 0.097 seconds
[0m13:55:02.426397 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m13:55:02.427458 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
alter table "airflow"."lead_staging"."dim_address" rename to "dim_address__dbt_backup"
[0m13:55:02.428683 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:55:02.432196 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m13:55:02.432943 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
alter table "airflow"."lead_staging"."dim_address__dbt_tmp" rename to "dim_address"
[0m13:55:02.434084 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:55:02.456400 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m13:55:02.457388 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m13:55:02.458215 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: COMMIT
[0m13:55:02.490265 [debug] [Thread-1 (]: SQL status: COMMIT in 0.031 seconds
[0m13:55:02.497617 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_address__dbt_backup"
[0m13:55:02.503856 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_adress"
[0m13:55:02.504602 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_adress"} */
drop table if exists "airflow"."lead_staging"."dim_address__dbt_backup" cascade
[0m13:55:02.508883 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m13:55:02.511839 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_adress: Close
[0m13:55:02.513739 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2d05bda-5d3b-4849-96a2-b82a80228d23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10828a5c10>]}
[0m13:55:02.514757 [info ] [Thread-1 (]: 1 of 5 OK created sql table model lead_staging.dim_address ..................... [[32mSELECT 100481[0m in 0.25s]
[0m13:55:02.515945 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_adress
[0m13:55:02.516887 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_date
[0m13:55:02.517862 [info ] [Thread-1 (]: 2 of 5 START sql table model lead_staging.dim_date ............................. [RUN]
[0m13:55:02.518821 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_adress, now model.dbt_lead_data.staging_dim_date)
[0m13:55:02.519667 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_date
[0m13:55:02.523678 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_date"
[0m13:55:02.525516 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_date
[0m13:55:02.529797 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_date"
[0m13:55:02.532089 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m13:55:02.532922 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: BEGIN
[0m13:55:02.533674 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:55:02.538254 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m13:55:02.539106 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m13:55:02.539849 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */

  
    

  create  table "airflow"."lead_staging"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        accessed_at
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m13:55:02.612274 [debug] [Thread-1 (]: SQL status: SELECT 100481 in 0.071 seconds
[0m13:55:02.616201 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m13:55:02.617024 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
alter table "airflow"."lead_staging"."dim_date" rename to "dim_date__dbt_backup"
[0m13:55:02.618266 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:55:02.621695 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m13:55:02.622458 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
alter table "airflow"."lead_staging"."dim_date__dbt_tmp" rename to "dim_date"
[0m13:55:02.623665 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:55:02.626069 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: COMMIT
[0m13:55:02.626841 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m13:55:02.627577 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: COMMIT
[0m13:55:02.634541 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m13:55:02.637513 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_date__dbt_backup"
[0m13:55:02.638626 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_date"
[0m13:55:02.639446 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_date"} */
drop table if exists "airflow"."lead_staging"."dim_date__dbt_backup" cascade
[0m13:55:02.642333 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m13:55:02.644212 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_date: Close
[0m13:55:02.645096 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2d05bda-5d3b-4849-96a2-b82a80228d23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f107e34d610>]}
[0m13:55:02.646140 [info ] [Thread-1 (]: 2 of 5 OK created sql table model lead_staging.dim_date ........................ [[32mSELECT 100481[0m in 0.13s]
[0m13:55:02.647258 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_date
[0m13:55:02.648055 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_finance
[0m13:55:02.648991 [info ] [Thread-1 (]: 3 of 5 START sql table model lead_staging.dim_finance .......................... [RUN]
[0m13:55:02.649825 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_date, now model.dbt_lead_data.staging_dim_finance)
[0m13:55:02.650518 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_finance
[0m13:55:02.654111 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_finance"
[0m13:55:02.656057 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_finance
[0m13:55:02.661473 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_finance"
[0m13:55:02.663353 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m13:55:02.664019 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: BEGIN
[0m13:55:02.664707 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:55:02.669376 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m13:55:02.670320 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m13:55:02.671003 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */

  
    

  create  table "airflow"."lead_staging"."dim_finance__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        iban
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m13:55:02.794261 [debug] [Thread-1 (]: SQL status: SELECT 100481 in 0.122 seconds
[0m13:55:02.797902 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m13:55:02.798689 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
alter table "airflow"."lead_staging"."dim_finance" rename to "dim_finance__dbt_backup"
[0m13:55:02.799882 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:55:02.803522 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m13:55:02.804368 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
alter table "airflow"."lead_staging"."dim_finance__dbt_tmp" rename to "dim_finance"
[0m13:55:02.805498 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:55:02.808047 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: COMMIT
[0m13:55:02.808917 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m13:55:02.809841 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: COMMIT
[0m13:55:02.820003 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m13:55:02.822970 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_finance__dbt_backup"
[0m13:55:02.824187 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_finance"
[0m13:55:02.824915 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_finance"} */
drop table if exists "airflow"."lead_staging"."dim_finance__dbt_backup" cascade
[0m13:55:02.828055 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m13:55:02.829975 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_finance: Close
[0m13:55:02.830927 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2d05bda-5d3b-4849-96a2-b82a80228d23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f107e130ce0>]}
[0m13:55:02.831848 [info ] [Thread-1 (]: 3 of 5 OK created sql table model lead_staging.dim_finance ..................... [[32mSELECT 100481[0m in 0.18s]
[0m13:55:02.832928 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_finance
[0m13:55:02.833737 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_dim_person
[0m13:55:02.834561 [info ] [Thread-1 (]: 4 of 5 START sql table model lead_staging.dim_person ........................... [RUN]
[0m13:55:02.835346 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_finance, now model.dbt_lead_data.staging_dim_person)
[0m13:55:02.836023 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_dim_person
[0m13:55:02.839561 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_dim_person"
[0m13:55:02.841378 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_dim_person
[0m13:55:02.845751 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_dim_person"
[0m13:55:02.847521 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m13:55:02.848199 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: BEGIN
[0m13:55:02.848798 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:55:02.853432 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m13:55:02.854302 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m13:55:02.855051 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */

  
    

  create  table "airflow"."lead_staging"."dim_person__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        person_name,
        user_name,
        email,
        phone,
        birth_date,
        personal_number
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m13:55:03.040472 [debug] [Thread-1 (]: SQL status: SELECT 100481 in 0.185 seconds
[0m13:55:03.044464 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m13:55:03.045447 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
alter table "airflow"."lead_staging"."dim_person" rename to "dim_person__dbt_backup"
[0m13:55:03.046772 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:55:03.050614 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m13:55:03.051493 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
alter table "airflow"."lead_staging"."dim_person__dbt_tmp" rename to "dim_person"
[0m13:55:03.052941 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:55:03.055549 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: COMMIT
[0m13:55:03.056405 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m13:55:03.057215 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: COMMIT
[0m13:55:03.061554 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m13:55:03.064740 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."dim_person__dbt_backup"
[0m13:55:03.065944 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_dim_person"
[0m13:55:03.066737 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_dim_person"} */
drop table if exists "airflow"."lead_staging"."dim_person__dbt_backup" cascade
[0m13:55:03.070865 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m13:55:03.072760 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_dim_person: Close
[0m13:55:03.073727 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2d05bda-5d3b-4849-96a2-b82a80228d23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f107e12a6f0>]}
[0m13:55:03.074748 [info ] [Thread-1 (]: 4 of 5 OK created sql table model lead_staging.dim_person ...................... [[32mSELECT 100481[0m in 0.24s]
[0m13:55:03.075872 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_dim_person
[0m13:55:03.076761 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.staging_fact_network_usage
[0m13:55:03.077690 [info ] [Thread-1 (]: 5 of 5 START sql table model lead_staging.fact_network_usage ................... [RUN]
[0m13:55:03.078782 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.staging_dim_person, now model.dbt_lead_data.staging_fact_network_usage)
[0m13:55:03.079643 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.staging_fact_network_usage
[0m13:55:03.083646 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.staging_fact_network_usage"
[0m13:55:03.085595 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.staging_fact_network_usage
[0m13:55:03.089921 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.staging_fact_network_usage"
[0m13:55:03.091869 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m13:55:03.092610 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: BEGIN
[0m13:55:03.093260 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:55:03.097892 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m13:55:03.098801 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m13:55:03.099636 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */

  
    

  create  table "airflow"."lead_staging"."fact_network_usage__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        unique_id,
        session_duration,
        download_speed,
        upload_speed,
        consumed_traffic
    FROM
        "airflow"."lead_raw"."raw_batch_data"
)

SELECT
    *
FROM
    source_data
  );
  
[0m13:55:03.215185 [debug] [Thread-1 (]: SQL status: SELECT 100481 in 0.115 seconds
[0m13:55:03.220330 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m13:55:03.221230 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
alter table "airflow"."lead_staging"."fact_network_usage" rename to "fact_network_usage__dbt_backup"
[0m13:55:03.222557 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:55:03.226014 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m13:55:03.226873 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
alter table "airflow"."lead_staging"."fact_network_usage__dbt_tmp" rename to "fact_network_usage"
[0m13:55:03.228238 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:55:03.230710 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: COMMIT
[0m13:55:03.231490 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m13:55:03.232261 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: COMMIT
[0m13:55:03.237796 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m13:55:03.240846 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_staging"."fact_network_usage__dbt_backup"
[0m13:55:03.242020 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.staging_fact_network_usage"
[0m13:55:03.242810 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.staging_fact_network_usage"} */
drop table if exists "airflow"."lead_staging"."fact_network_usage__dbt_backup" cascade
[0m13:55:03.246404 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m13:55:03.248485 [debug] [Thread-1 (]: On model.dbt_lead_data.staging_fact_network_usage: Close
[0m13:55:03.250088 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2d05bda-5d3b-4849-96a2-b82a80228d23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f107e11b7a0>]}
[0m13:55:03.251897 [info ] [Thread-1 (]: 5 of 5 OK created sql table model lead_staging.fact_network_usage .............. [[32mSELECT 100481[0m in 0.17s]
[0m13:55:03.253420 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.staging_fact_network_usage
[0m13:55:03.255922 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:03.256752 [debug] [MainThread]: On master: BEGIN
[0m13:55:03.257541 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:55:03.262147 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m13:55:03.263002 [debug] [MainThread]: On master: COMMIT
[0m13:55:03.263688 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:03.264352 [debug] [MainThread]: On master: COMMIT
[0m13:55:03.265169 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:55:03.266043 [debug] [MainThread]: On master: Close
[0m13:55:03.266979 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:55:03.267742 [debug] [MainThread]: Connection 'model.dbt_lead_data.staging_fact_network_usage' was properly closed.
[0m13:55:03.268539 [info ] [MainThread]: 
[0m13:55:03.269381 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 1.14 seconds (1.14s).
[0m13:55:03.271375 [debug] [MainThread]: Command end result
[0m13:55:03.324664 [info ] [MainThread]: 
[0m13:55:03.325630 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:55:03.326673 [info ] [MainThread]: 
[0m13:55:03.327706 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m13:55:03.329186 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.9410396, "process_user_time": 3.064734, "process_kernel_time": 0.18838, "process_mem_max_rss": "121592", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:55:03.330158 [debug] [MainThread]: Command `dbt run` succeeded at 13:55:03.329974 after 1.94 seconds
[0m13:55:03.330897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10817970b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f107e36f020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1081396960>]}
[0m13:55:03.331648 [debug] [MainThread]: Flushing usage events
[0m13:55:04.145194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5bd9abfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5bfc27710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5bc3fedb0>]}


============================== 13:55:04.152572 | b06bc594-a43f-45e1-ab25-90b6900228c5 ==============================
[0m13:55:04.152572 [info ] [MainThread]: Running with dbt=1.8.0
[0m13:55:04.153631 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select tag:trusted', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:55:04.363332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b06bc594-a43f-45e1-ab25-90b6900228c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5bbfbe210>]}
[0m13:55:04.432465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b06bc594-a43f-45e1-ab25-90b6900228c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5bc58e480>]}
[0m13:55:04.433824 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:55:04.516595 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m13:55:04.635524 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:55:04.636378 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:55:04.678703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b06bc594-a43f-45e1-ab25-90b6900228c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5bb325940>]}
[0m13:55:04.817017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b06bc594-a43f-45e1-ab25-90b6900228c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5bb3162a0>]}
[0m13:55:04.817892 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m13:55:04.818673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b06bc594-a43f-45e1-ab25-90b6900228c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5baf49790>]}
[0m13:55:04.821006 [info ] [MainThread]: 
[0m13:55:04.822102 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:55:04.827835 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m13:55:04.866606 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m13:55:04.867441 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m13:55:04.868146 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:55:04.873413 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.005 seconds
[0m13:55:04.875158 [debug] [ThreadPool]: On list_airflow: Close
[0m13:55:04.877826 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_staging)
[0m13:55:04.884710 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m13:55:04.885519 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m13:55:04.886224 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:55:04.890409 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m13:55:04.891114 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m13:55:04.891820 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m13:55:04.894931 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m13:55:04.896742 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m13:55:04.897560 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m13:55:04.898548 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now list_airflow_lead_trusted)
[0m13:55:04.902148 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m13:55:04.902955 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m13:55:04.903678 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:55:04.907638 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m13:55:04.908278 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m13:55:04.908888 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m13:55:04.911951 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m13:55:04.913745 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m13:55:04.914591 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m13:55:04.921460 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:04.922269 [debug] [MainThread]: On master: BEGIN
[0m13:55:04.922962 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:55:04.927000 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m13:55:04.927787 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:04.928563 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:55:04.932288 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m13:55:04.934148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b06bc594-a43f-45e1-ab25-90b6900228c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5bb342870>]}
[0m13:55:04.934997 [debug] [MainThread]: On master: ROLLBACK
[0m13:55:04.935912 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:04.936612 [debug] [MainThread]: On master: BEGIN
[0m13:55:04.937636 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:55:04.938330 [debug] [MainThread]: On master: COMMIT
[0m13:55:04.939046 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:04.939770 [debug] [MainThread]: On master: COMMIT
[0m13:55:04.941779 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:55:04.942754 [debug] [MainThread]: On master: Close
[0m13:55:04.944326 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:55:04.945374 [info ] [MainThread]: 
[0m13:55:04.956543 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_non_pii_data
[0m13:55:04.957590 [info ] [Thread-1 (]: 1 of 4 START sql table model lead_trusted.non_pii_data ......................... [RUN]
[0m13:55:04.958525 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now model.dbt_lead_data.trusted_non_pii_data)
[0m13:55:04.959168 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_non_pii_data
[0m13:55:04.969978 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_non_pii_data"
[0m13:55:04.972673 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_non_pii_data
[0m13:55:05.018693 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_non_pii_data"
[0m13:55:05.021523 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m13:55:05.022157 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: BEGIN
[0m13:55:05.023018 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:55:05.027761 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m13:55:05.028778 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m13:55:05.029482 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */

  
    

  create  table "airflow"."lead_trusted"."non_pii_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        '***MASKED***' AS person_name,
        SUBSTRING(dp.user_name, 1, 5) || '*****'  user_name,
        SUBSTRING(dp.email, 1, 5) || '*****' AS email,
        '***MASKED***'  AS personal_number, 
        '***MASKED***' AS birth_date, 
        '***MASKED***' AS address,
        '***MASKED***'  AS phone, 
        SUBSTRING(da.mac_address, 1, 5) || '*****' AS mac_address,
        SUBSTRING(da.ip_address, 1, 5) || '*****' AS ip_address,
        SUBSTRING(df.iban, 1, 5) || '*****' AS iban,
        dd.accessed_at,
        fnu.session_duration,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.consumed_traffic,
        fnu.unique_id
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    INNER JOIN
        "airflow"."lead_staging"."dim_address" da ON fnu.unique_id = da.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_date" dd ON da.unique_id = dd.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_finance" df ON dd.unique_id = df.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_person" dp ON df.unique_id = dp.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m13:55:07.133707 [debug] [Thread-1 (]: SQL status: SELECT 100481 in 2.103 seconds
[0m13:55:07.141409 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m13:55:07.142310 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
alter table "airflow"."lead_trusted"."non_pii_data" rename to "non_pii_data__dbt_backup"
[0m13:55:07.143831 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:55:07.148140 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m13:55:07.148984 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
alter table "airflow"."lead_trusted"."non_pii_data__dbt_tmp" rename to "non_pii_data"
[0m13:55:07.150257 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:55:07.173531 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: COMMIT
[0m13:55:07.174488 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m13:55:07.175407 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: COMMIT
[0m13:55:07.178944 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m13:55:07.187287 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."non_pii_data__dbt_backup"
[0m13:55:07.194859 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m13:55:07.195939 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
drop table if exists "airflow"."lead_trusted"."non_pii_data__dbt_backup" cascade
[0m13:55:07.200820 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m13:55:07.204127 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: Close
[0m13:55:07.206096 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b06bc594-a43f-45e1-ab25-90b6900228c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5bd801820>]}
[0m13:55:07.207228 [info ] [Thread-1 (]: 1 of 4 OK created sql table model lead_trusted.non_pii_data .................... [[32mSELECT 100481[0m in 2.25s]
[0m13:55:07.208724 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_non_pii_data
[0m13:55:07.209698 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_payment_data
[0m13:55:07.210709 [info ] [Thread-1 (]: 2 of 4 START sql table model lead_trusted.payment_data ......................... [RUN]
[0m13:55:07.211654 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_non_pii_data, now model.dbt_lead_data.trusted_payment_data)
[0m13:55:07.212479 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_payment_data
[0m13:55:07.216983 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_payment_data"
[0m13:55:07.219385 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_payment_data
[0m13:55:07.224143 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_payment_data"
[0m13:55:07.226301 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m13:55:07.227114 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: BEGIN
[0m13:55:07.227910 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:55:07.233206 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m13:55:07.234135 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m13:55:07.235015 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */

  
    

  create  table "airflow"."lead_trusted"."payment_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        fnu.unique_id,
        df.iban,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.session_duration,
        fnu.consumed_traffic,
        ((fnu.download_speed + fnu.upload_speed + 1)/2) + (fnu.consumed_traffic / (fnu.session_duration + 1)) AS payment_amount
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    JOIN
        "airflow"."lead_staging"."dim_finance" df
    ON
	    fnu.unique_id = df.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m13:55:07.433292 [debug] [Thread-1 (]: SQL status: SELECT 100481 in 0.197 seconds
[0m13:55:07.437668 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m13:55:07.438514 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
alter table "airflow"."lead_trusted"."payment_data" rename to "payment_data__dbt_backup"
[0m13:55:07.439813 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:55:07.443398 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m13:55:07.444484 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
alter table "airflow"."lead_trusted"."payment_data__dbt_tmp" rename to "payment_data"
[0m13:55:07.445725 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:55:07.448544 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: COMMIT
[0m13:55:07.449353 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m13:55:07.450259 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: COMMIT
[0m13:55:07.454349 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m13:55:07.458076 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."payment_data__dbt_backup"
[0m13:55:07.459263 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m13:55:07.460144 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
drop table if exists "airflow"."lead_trusted"."payment_data__dbt_backup" cascade
[0m13:55:07.463436 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m13:55:07.465665 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: Close
[0m13:55:07.466744 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b06bc594-a43f-45e1-ab25-90b6900228c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5b92d7f20>]}
[0m13:55:07.467748 [info ] [Thread-1 (]: 2 of 4 OK created sql table model lead_trusted.payment_data .................... [[32mSELECT 100481[0m in 0.26s]
[0m13:55:07.468845 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_payment_data
[0m13:55:07.469692 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_pii_data
[0m13:55:07.470545 [info ] [Thread-1 (]: 3 of 4 START sql table model lead_trusted.pii_data ............................. [RUN]
[0m13:55:07.471499 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_payment_data, now model.dbt_lead_data.trusted_pii_data)
[0m13:55:07.472473 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_pii_data
[0m13:55:07.477655 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_pii_data"
[0m13:55:07.479638 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_pii_data
[0m13:55:07.485516 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_pii_data"
[0m13:55:07.487645 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m13:55:07.488441 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: BEGIN
[0m13:55:07.489153 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:55:07.494229 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m13:55:07.495168 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m13:55:07.495960 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */

  
    

  create  table "airflow"."lead_trusted"."pii_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        dp.person_name,
        dp.user_name,
        dp.email,
        dp.personal_number, 
        dp.birth_date, 
        da.address,
        dp.phone, 
        da.mac_address,
        da.ip_address,
        df.iban,
        dd.accessed_at,
        fnu.session_duration,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.consumed_traffic,
        fnu.unique_id
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    INNER JOIN
        "airflow"."lead_staging"."dim_address" da ON fnu.unique_id = da.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_date" dd ON da.unique_id = dd.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_finance" df ON dd.unique_id = df.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_person" dp ON df.unique_id = dp.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m13:55:07.734452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c4d041550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c4d3c51f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c4d043a10>]}


============================== 13:55:07.742640 | 5328797d-9fe9-4e50-a351-866680f1e6b6 ==============================
[0m13:55:07.742640 [info ] [MainThread]: Running with dbt=1.8.0
[0m13:55:07.743820 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select tag:trusted', 'send_anonymous_usage_stats': 'True'}
[0m13:55:07.980390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5328797d-9fe9-4e50-a351-866680f1e6b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c4d725400>]}
[0m13:55:08.061016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5328797d-9fe9-4e50-a351-866680f1e6b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c4dd0d9d0>]}
[0m13:55:08.062365 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:55:08.146645 [debug] [Thread-1 (]: SQL status: SELECT 100481 in 0.650 seconds
[0m13:55:08.151226 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m13:55:08.152776 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */
alter table "airflow"."lead_trusted"."pii_data" rename to "pii_data__dbt_backup"
[0m13:55:08.154463 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:55:08.158713 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m13:55:08.159666 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */
alter table "airflow"."lead_trusted"."pii_data__dbt_tmp" rename to "pii_data"
[0m13:55:08.160966 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:55:08.163999 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: COMMIT
[0m13:55:08.164880 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m13:55:08.165676 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: COMMIT
[0m13:55:08.171700 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m13:55:08.174913 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."pii_data__dbt_backup"
[0m13:55:08.176166 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m13:55:08.176542 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m13:55:08.177048 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */
drop table if exists "airflow"."lead_trusted"."pii_data__dbt_backup" cascade
[0m13:55:08.182344 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m13:55:08.184643 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: Close
[0m13:55:08.185664 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b06bc594-a43f-45e1-ab25-90b6900228c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5b92be120>]}
[0m13:55:08.186555 [info ] [Thread-1 (]: 3 of 4 OK created sql table model lead_trusted.pii_data ........................ [[32mSELECT 100481[0m in 0.71s]
[0m13:55:08.187615 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_pii_data
[0m13:55:08.188439 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_technical_data
[0m13:55:08.189288 [info ] [Thread-1 (]: 4 of 4 START sql table model lead_trusted.technical_data ....................... [RUN]
[0m13:55:08.190136 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_pii_data, now model.dbt_lead_data.trusted_technical_data)
[0m13:55:08.190812 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_technical_data
[0m13:55:08.194637 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_technical_data"
[0m13:55:08.196465 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_technical_data
[0m13:55:08.201009 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_technical_data"
[0m13:55:08.203071 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m13:55:08.203751 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: BEGIN
[0m13:55:08.204386 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:55:08.208878 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m13:55:08.209725 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m13:55:08.210439 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */

  
    

  create  table "airflow"."lead_trusted"."technical_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        fnu.unique_id,
        da.address,
        da.mac_address,
        da.ip_address,
        fnu.download_speed,
        fnu.upload_speed,
        ROUND((fnu.session_duration/60), 1) as min_session_duration,
        CASE 
            WHEN fnu.download_speed < 50 OR fnu.upload_speed < 30 OR fnu.session_duration/60 < 1 THEN true
            ELSE false
        END AS technical_issue
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    JOIN
        "airflow"."lead_staging"."dim_address" da
    ON
	    fnu.unique_id = da.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m13:55:08.310475 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:55:08.311329 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:55:08.352941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5328797d-9fe9-4e50-a351-866680f1e6b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c4bb7b680>]}
[0m13:55:08.433681 [debug] [Thread-1 (]: SQL status: SELECT 100481 in 0.222 seconds
[0m13:55:08.437622 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m13:55:08.438410 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
alter table "airflow"."lead_trusted"."technical_data" rename to "technical_data__dbt_backup"
[0m13:55:08.439798 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:55:08.444783 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m13:55:08.445641 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
alter table "airflow"."lead_trusted"."technical_data__dbt_tmp" rename to "technical_data"
[0m13:55:08.447016 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:55:08.449483 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: COMMIT
[0m13:55:08.450330 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m13:55:08.451107 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: COMMIT
[0m13:55:08.464384 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m13:55:08.467727 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."technical_data__dbt_backup"
[0m13:55:08.468987 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m13:55:08.469658 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
drop table if exists "airflow"."lead_trusted"."technical_data__dbt_backup" cascade
[0m13:55:08.473420 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m13:55:08.475487 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: Close
[0m13:55:08.476505 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b06bc594-a43f-45e1-ab25-90b6900228c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5b93798e0>]}
[0m13:55:08.477509 [info ] [Thread-1 (]: 4 of 4 OK created sql table model lead_trusted.technical_data .................. [[32mSELECT 100481[0m in 0.29s]
[0m13:55:08.478624 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_technical_data
[0m13:55:08.481960 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:08.482843 [debug] [MainThread]: On master: BEGIN
[0m13:55:08.483649 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:55:08.487851 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m13:55:08.488622 [debug] [MainThread]: On master: COMMIT
[0m13:55:08.489289 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:08.490024 [debug] [MainThread]: On master: COMMIT
[0m13:55:08.491027 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:55:08.491785 [debug] [MainThread]: On master: Close
[0m13:55:08.492757 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:55:08.493442 [debug] [MainThread]: Connection 'model.dbt_lead_data.trusted_technical_data' was properly closed.
[0m13:55:08.493408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5328797d-9fe9-4e50-a351-866680f1e6b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c4bb99460>]}
[0m13:55:08.494253 [info ] [MainThread]: 
[0m13:55:08.494481 [info ] [MainThread]: Found 9 models, 10 sources, 428 macros
[0m13:55:08.495029 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 3.67 seconds (3.67s).
[0m13:55:08.495305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5328797d-9fe9-4e50-a351-866680f1e6b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c4bb00d70>]}
[0m13:55:08.496954 [debug] [MainThread]: Command end result
[0m13:55:08.497972 [info ] [MainThread]: 
[0m13:55:08.499061 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:55:08.506992 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m13:55:08.545472 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m13:55:08.546232 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m13:55:08.546878 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:55:08.550144 [info ] [MainThread]: 
[0m13:55:08.551062 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:55:08.551941 [info ] [MainThread]: 
[0m13:55:08.552372 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.005 seconds
[0m13:55:08.553070 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m13:55:08.554476 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.475839, "process_user_time": 3.009712, "process_kernel_time": 0.222792, "process_mem_max_rss": "124880", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:55:08.554668 [debug] [ThreadPool]: On list_airflow: Close
[0m13:55:08.555405 [debug] [MainThread]: Command `dbt run` succeeded at 13:55:08.555276 after 4.48 seconds
[0m13:55:08.556164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5bc073e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5babfa750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5bc756030>]}
[0m13:55:08.556942 [debug] [MainThread]: Flushing usage events
[0m13:55:08.557394 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_lead_staging)
[0m13:55:08.564273 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m13:55:08.565016 [debug] [ThreadPool]: On list_airflow_lead_staging: BEGIN
[0m13:55:08.565700 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:55:08.569898 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m13:55:08.570512 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_staging"
[0m13:55:08.571335 [debug] [ThreadPool]: On list_airflow_lead_staging: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_staging"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_staging'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_staging'
  
[0m13:55:08.574427 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.002 seconds
[0m13:55:08.576226 [debug] [ThreadPool]: On list_airflow_lead_staging: ROLLBACK
[0m13:55:08.577011 [debug] [ThreadPool]: On list_airflow_lead_staging: Close
[0m13:55:08.577949 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow_lead_staging, now list_airflow_lead_trusted)
[0m13:55:08.581221 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m13:55:08.581847 [debug] [ThreadPool]: On list_airflow_lead_trusted: BEGIN
[0m13:55:08.582404 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:55:08.586162 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m13:55:08.586842 [debug] [ThreadPool]: Using postgres connection "list_airflow_lead_trusted"
[0m13:55:08.587480 [debug] [ThreadPool]: On list_airflow_lead_trusted: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_airflow_lead_trusted"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'lead_trusted'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'lead_trusted'
  
[0m13:55:08.590427 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m13:55:08.592157 [debug] [ThreadPool]: On list_airflow_lead_trusted: ROLLBACK
[0m13:55:08.592949 [debug] [ThreadPool]: On list_airflow_lead_trusted: Close
[0m13:55:08.600071 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:08.600872 [debug] [MainThread]: On master: BEGIN
[0m13:55:08.601641 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:55:08.605706 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m13:55:08.606362 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:08.607146 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:55:08.610506 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m13:55:08.612516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5328797d-9fe9-4e50-a351-866680f1e6b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c4a3f18e0>]}
[0m13:55:08.613382 [debug] [MainThread]: On master: ROLLBACK
[0m13:55:08.614203 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:08.614835 [debug] [MainThread]: On master: BEGIN
[0m13:55:08.615790 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:55:08.616454 [debug] [MainThread]: On master: COMMIT
[0m13:55:08.617153 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:08.617799 [debug] [MainThread]: On master: COMMIT
[0m13:55:08.618644 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:55:08.619271 [debug] [MainThread]: On master: Close
[0m13:55:08.620065 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:55:08.620819 [info ] [MainThread]: 
[0m13:55:08.631175 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_non_pii_data
[0m13:55:08.632137 [info ] [Thread-1 (]: 1 of 4 START sql table model lead_trusted.non_pii_data ......................... [RUN]
[0m13:55:08.633153 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_lead_trusted, now model.dbt_lead_data.trusted_non_pii_data)
[0m13:55:08.633906 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_non_pii_data
[0m13:55:08.643935 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_non_pii_data"
[0m13:55:08.646102 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_non_pii_data
[0m13:55:08.685937 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_non_pii_data"
[0m13:55:08.688265 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m13:55:08.688858 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: BEGIN
[0m13:55:08.689429 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:55:08.693371 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m13:55:08.694376 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m13:55:08.695367 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */

  
    

  create  table "airflow"."lead_trusted"."non_pii_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        '***MASKED***' AS person_name,
        SUBSTRING(dp.user_name, 1, 5) || '*****'  user_name,
        SUBSTRING(dp.email, 1, 5) || '*****' AS email,
        '***MASKED***'  AS personal_number, 
        '***MASKED***' AS birth_date, 
        '***MASKED***' AS address,
        '***MASKED***'  AS phone, 
        SUBSTRING(da.mac_address, 1, 5) || '*****' AS mac_address,
        SUBSTRING(da.ip_address, 1, 5) || '*****' AS ip_address,
        SUBSTRING(df.iban, 1, 5) || '*****' AS iban,
        dd.accessed_at,
        fnu.session_duration,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.consumed_traffic,
        fnu.unique_id
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    INNER JOIN
        "airflow"."lead_staging"."dim_address" da ON fnu.unique_id = da.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_date" dd ON da.unique_id = dd.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_finance" df ON dd.unique_id = df.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_person" dp ON df.unique_id = dp.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m13:55:09.173046 [debug] [Thread-1 (]: SQL status: SELECT 100481 in 0.477 seconds
[0m13:55:09.184476 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m13:55:09.185660 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
alter table "airflow"."lead_trusted"."non_pii_data" rename to "non_pii_data__dbt_backup"
[0m13:55:09.187014 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:55:09.191146 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m13:55:09.192041 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
alter table "airflow"."lead_trusted"."non_pii_data__dbt_tmp" rename to "non_pii_data"
[0m13:55:09.193457 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:55:09.222558 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: COMMIT
[0m13:55:09.223657 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m13:55:09.224429 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: COMMIT
[0m13:55:09.257432 [debug] [Thread-1 (]: SQL status: COMMIT in 0.032 seconds
[0m13:55:09.266472 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."non_pii_data__dbt_backup"
[0m13:55:09.274950 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_non_pii_data"
[0m13:55:09.276021 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_non_pii_data"} */
drop table if exists "airflow"."lead_trusted"."non_pii_data__dbt_backup" cascade
[0m13:55:09.281905 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m13:55:09.286226 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_non_pii_data: Close
[0m13:55:09.288952 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5328797d-9fe9-4e50-a351-866680f1e6b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c4dd0deb0>]}
[0m13:55:09.290309 [info ] [Thread-1 (]: 1 of 4 OK created sql table model lead_trusted.non_pii_data .................... [[32mSELECT 100481[0m in 0.65s]
[0m13:55:09.291887 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_non_pii_data
[0m13:55:09.293004 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_payment_data
[0m13:55:09.294195 [info ] [Thread-1 (]: 2 of 4 START sql table model lead_trusted.payment_data ......................... [RUN]
[0m13:55:09.295665 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_non_pii_data, now model.dbt_lead_data.trusted_payment_data)
[0m13:55:09.296668 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_payment_data
[0m13:55:09.301848 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_payment_data"
[0m13:55:09.304612 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_payment_data
[0m13:55:09.309900 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_payment_data"
[0m13:55:09.312359 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m13:55:09.313370 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: BEGIN
[0m13:55:09.314400 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:55:09.319915 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m13:55:09.320893 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m13:55:09.321747 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */

  
    

  create  table "airflow"."lead_trusted"."payment_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        fnu.unique_id,
        df.iban,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.session_duration,
        fnu.consumed_traffic,
        ((fnu.download_speed + fnu.upload_speed + 1)/2) + (fnu.consumed_traffic / (fnu.session_duration + 1)) AS payment_amount
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    JOIN
        "airflow"."lead_staging"."dim_finance" df
    ON
	    fnu.unique_id = df.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m13:55:09.521392 [debug] [Thread-1 (]: SQL status: SELECT 100481 in 0.199 seconds
[0m13:55:09.525699 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m13:55:09.526590 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
alter table "airflow"."lead_trusted"."payment_data" rename to "payment_data__dbt_backup"
[0m13:55:09.527872 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:55:09.532165 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m13:55:09.533313 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
alter table "airflow"."lead_trusted"."payment_data__dbt_tmp" rename to "payment_data"
[0m13:55:09.534687 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:55:09.537166 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: COMMIT
[0m13:55:09.537904 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m13:55:09.538671 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: COMMIT
[0m13:55:09.548215 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m13:55:09.551780 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."payment_data__dbt_backup"
[0m13:55:09.553135 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_payment_data"
[0m13:55:09.553938 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_payment_data"} */
drop table if exists "airflow"."lead_trusted"."payment_data__dbt_backup" cascade
[0m13:55:09.557302 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m13:55:09.559908 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_payment_data: Close
[0m13:55:09.560953 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5328797d-9fe9-4e50-a351-866680f1e6b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c4977ad80>]}
[0m13:55:09.561982 [info ] [Thread-1 (]: 2 of 4 OK created sql table model lead_trusted.payment_data .................... [[32mSELECT 100481[0m in 0.27s]
[0m13:55:09.563123 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_payment_data
[0m13:55:09.563961 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_pii_data
[0m13:55:09.564878 [info ] [Thread-1 (]: 3 of 4 START sql table model lead_trusted.pii_data ............................. [RUN]
[0m13:55:09.565750 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_payment_data, now model.dbt_lead_data.trusted_pii_data)
[0m13:55:09.566489 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_pii_data
[0m13:55:09.572231 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_pii_data"
[0m13:55:09.574399 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_pii_data
[0m13:55:09.580850 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_pii_data"
[0m13:55:09.583145 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m13:55:09.584078 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: BEGIN
[0m13:55:09.585410 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:55:09.591044 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m13:55:09.591939 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m13:55:09.592780 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */

  
    

  create  table "airflow"."lead_trusted"."pii_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        dp.person_name,
        dp.user_name,
        dp.email,
        dp.personal_number, 
        dp.birth_date, 
        da.address,
        dp.phone, 
        da.mac_address,
        da.ip_address,
        df.iban,
        dd.accessed_at,
        fnu.session_duration,
        fnu.download_speed,
        fnu.upload_speed,
        fnu.consumed_traffic,
        fnu.unique_id
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    INNER JOIN
        "airflow"."lead_staging"."dim_address" da ON fnu.unique_id = da.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_date" dd ON da.unique_id = dd.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_finance" df ON dd.unique_id = df.unique_id
    INNER JOIN
        "airflow"."lead_staging"."dim_person" dp ON df.unique_id = dp.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m13:55:10.191278 [debug] [Thread-1 (]: SQL status: SELECT 100481 in 0.598 seconds
[0m13:55:10.195239 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m13:55:10.196147 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */
alter table "airflow"."lead_trusted"."pii_data" rename to "pii_data__dbt_backup"
[0m13:55:10.197345 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:55:10.201273 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m13:55:10.202110 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */
alter table "airflow"."lead_trusted"."pii_data__dbt_tmp" rename to "pii_data"
[0m13:55:10.203368 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:55:10.206172 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: COMMIT
[0m13:55:10.206924 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m13:55:10.207654 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: COMMIT
[0m13:55:10.237680 [debug] [Thread-1 (]: SQL status: COMMIT in 0.029 seconds
[0m13:55:10.240824 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."pii_data__dbt_backup"
[0m13:55:10.242078 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_pii_data"
[0m13:55:10.242828 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_pii_data"} */
drop table if exists "airflow"."lead_trusted"."pii_data__dbt_backup" cascade
[0m13:55:10.248774 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m13:55:10.250893 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_pii_data: Close
[0m13:55:10.251940 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5328797d-9fe9-4e50-a351-866680f1e6b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c49611070>]}
[0m13:55:10.252896 [info ] [Thread-1 (]: 3 of 4 OK created sql table model lead_trusted.pii_data ........................ [[32mSELECT 100481[0m in 0.69s]
[0m13:55:10.253887 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_pii_data
[0m13:55:10.254674 [debug] [Thread-1 (]: Began running node model.dbt_lead_data.trusted_technical_data
[0m13:55:10.255449 [info ] [Thread-1 (]: 4 of 4 START sql table model lead_trusted.technical_data ....................... [RUN]
[0m13:55:10.256261 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_lead_data.trusted_pii_data, now model.dbt_lead_data.trusted_technical_data)
[0m13:55:10.256962 [debug] [Thread-1 (]: Began compiling node model.dbt_lead_data.trusted_technical_data
[0m13:55:10.261001 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_lead_data.trusted_technical_data"
[0m13:55:10.263149 [debug] [Thread-1 (]: Began executing node model.dbt_lead_data.trusted_technical_data
[0m13:55:10.267629 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_lead_data.trusted_technical_data"
[0m13:55:10.285631 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m13:55:10.288695 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: BEGIN
[0m13:55:10.290790 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:55:10.295939 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m13:55:10.296967 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m13:55:10.297837 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */

  
    

  create  table "airflow"."lead_trusted"."technical_data__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT
        fnu.unique_id,
        da.address,
        da.mac_address,
        da.ip_address,
        fnu.download_speed,
        fnu.upload_speed,
        ROUND((fnu.session_duration/60), 1) as min_session_duration,
        CASE 
            WHEN fnu.download_speed < 50 OR fnu.upload_speed < 30 OR fnu.session_duration/60 < 1 THEN true
            ELSE false
        END AS technical_issue
    FROM
        "airflow"."lead_staging"."fact_network_usage" fnu
    JOIN
        "airflow"."lead_staging"."dim_address" da
    ON
	    fnu.unique_id = da.unique_id
)

SELECT
    *
FROM
    source_data
  );
  
[0m13:55:10.492787 [debug] [Thread-1 (]: SQL status: SELECT 100481 in 0.194 seconds
[0m13:55:10.497573 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m13:55:10.498686 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
alter table "airflow"."lead_trusted"."technical_data" rename to "technical_data__dbt_backup"
[0m13:55:10.499797 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:55:10.503565 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m13:55:10.504748 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
alter table "airflow"."lead_trusted"."technical_data__dbt_tmp" rename to "technical_data"
[0m13:55:10.506296 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:55:10.508431 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: COMMIT
[0m13:55:10.509210 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m13:55:10.510242 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: COMMIT
[0m13:55:10.553150 [debug] [Thread-1 (]: SQL status: COMMIT in 0.042 seconds
[0m13:55:10.556296 [debug] [Thread-1 (]: Applying DROP to: "airflow"."lead_trusted"."technical_data__dbt_backup"
[0m13:55:10.557432 [debug] [Thread-1 (]: Using postgres connection "model.dbt_lead_data.trusted_technical_data"
[0m13:55:10.558239 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_lead_data.trusted_technical_data"} */
drop table if exists "airflow"."lead_trusted"."technical_data__dbt_backup" cascade
[0m13:55:10.562232 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m13:55:10.564167 [debug] [Thread-1 (]: On model.dbt_lead_data.trusted_technical_data: Close
[0m13:55:10.565069 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5328797d-9fe9-4e50-a351-866680f1e6b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c49631160>]}
[0m13:55:10.566130 [info ] [Thread-1 (]: 4 of 4 OK created sql table model lead_trusted.technical_data .................. [[32mSELECT 100481[0m in 0.31s]
[0m13:55:10.567222 [debug] [Thread-1 (]: Finished running node model.dbt_lead_data.trusted_technical_data
[0m13:55:10.569743 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:10.570407 [debug] [MainThread]: On master: BEGIN
[0m13:55:10.571086 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:55:10.575101 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m13:55:10.575896 [debug] [MainThread]: On master: COMMIT
[0m13:55:10.576529 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:10.577230 [debug] [MainThread]: On master: COMMIT
[0m13:55:10.578155 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:55:10.578889 [debug] [MainThread]: On master: Close
[0m13:55:10.579845 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:55:10.580534 [debug] [MainThread]: Connection 'model.dbt_lead_data.trusted_technical_data' was properly closed.
[0m13:55:10.581371 [info ] [MainThread]: 
[0m13:55:10.582226 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 2.08 seconds (2.08s).
[0m13:55:10.584106 [debug] [MainThread]: Command end result
[0m13:55:10.638432 [info ] [MainThread]: 
[0m13:55:10.639620 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:55:10.640987 [info ] [MainThread]: 
[0m13:55:10.642429 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m13:55:10.644799 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.9713104, "process_user_time": 3.211676, "process_kernel_time": 0.25754, "process_mem_max_rss": "124784", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:55:10.646452 [debug] [MainThread]: Command `dbt run` succeeded at 13:55:10.646208 after 2.97 seconds
[0m13:55:10.647304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c4d561880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c4ca9e750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c49789340>]}
[0m13:55:10.648127 [debug] [MainThread]: Flushing usage events
